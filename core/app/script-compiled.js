"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
// declare module 'material-ui-pickers' {
//     export type DatePickerProps = {};
//     export class DatePicker extends React.Component<{ selector: string; } & React.SVGProps<SVGSVGElement>>{ }
//     export class SvgLoader extends React.Component<{ path: string; }>{ }
// }
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";

var _ = require(".");
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _Amount = require("./Amount");

Object.keys(_Amount).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Amount[key];
    }
  });
});

var _ApiModel = require("./ApiModel");

Object.keys(_ApiModel).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ApiModel[key];
    }
  });
});

var _ApiResult = require("./ApiResult");

Object.keys(_ApiResult).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ApiResult[key];
    }
  });
});

var _Cashbox = require("./Cashbox");

Object.keys(_Cashbox).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Cashbox[key];
    }
  });
});

var _Category = require("./Category");

Object.keys(_Category).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Category[key];
    }
  });
});

var _Client = require("./Client");

Object.keys(_Client).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Client[key];
    }
  });
});

var _DocumentTemplate = require("./DocumentTemplate");

Object.keys(_DocumentTemplate).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _DocumentTemplate[key];
    }
  });
});

var _Dispatch = require("./Dispatch");

Object.keys(_Dispatch).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Dispatch[key];
    }
  });
});

var _DispatchInfo = require("./DispatchInfo");

Object.keys(_DispatchInfo).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _DispatchInfo[key];
    }
  });
});

var _DispatchMethod = require("./DispatchMethod");

Object.keys(_DispatchMethod).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _DispatchMethod[key];
    }
  });
});

var _DispatchStatus = require("./DispatchStatus");

Object.keys(_DispatchStatus).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _DispatchStatus[key];
    }
  });
});

var _FilterOperator = require("./FilterOperator");

Object.keys(_FilterOperator).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _FilterOperator[key];
    }
  });
});

var _FilterValue = require("./FilterValue");

Object.keys(_FilterValue).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _FilterValue[key];
    }
  });
});

var _FindResult = require("./FindResult");

Object.keys(_FindResult).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _FindResult[key];
    }
  });
});

var _IFilter = require("./IFilter");

Object.keys(_IFilter).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _IFilter[key];
    }
  });
});

var _ModelBase = require("./ModelBase");

Object.keys(_ModelBase).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ModelBase[key];
    }
  });
});

var _ModelType = require("./ModelType");

Object.keys(_ModelType).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ModelType[key];
    }
  });
});

var _Movement = require("./Movement");

Object.keys(_Movement).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Movement[key];
    }
  });
});

var _Order = require("./Order");

Object.keys(_Order).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Order[key];
    }
  });
});

var _OrderItem = require("./OrderItem");

Object.keys(_OrderItem).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _OrderItem[key];
    }
  });
});

var _OrderOption = require("./OrderOption");

Object.keys(_OrderOption).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _OrderOption[key];
    }
  });
});

var _OrderStatus = require("./OrderStatus");

Object.keys(_OrderStatus).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _OrderStatus[key];
    }
  });
});

var _OrderType = require("./OrderType");

Object.keys(_OrderType).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _OrderType[key];
    }
  });
});

var _Payment = require("./Payment");

Object.keys(_Payment).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Payment[key];
    }
  });
});

var _PaymentMethod = require("./PaymentMethod");

Object.keys(_PaymentMethod).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _PaymentMethod[key];
    }
  });
});

var _PaymentProviderName = require("./PaymentProviderName");

Object.keys(_PaymentProviderName).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _PaymentProviderName[key];
    }
  });
});

var _PaymentStatus = require("./PaymentStatus");

Object.keys(_PaymentStatus).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _PaymentStatus[key];
    }
  });
});

var _Person = require("./Person");

Object.keys(_Person).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Person[key];
    }
  });
});

var _Price = require("./Price");

Object.keys(_Price).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Price[key];
    }
  });
});

var _Product = require("./Product");

Object.keys(_Product).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Product[key];
    }
  });
});

var _ProductOption = require("./ProductOption");

Object.keys(_ProductOption).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ProductOption[key];
    }
  });
});

var _ProductOptionSelection = require("./ProductOptionSelection");

Object.keys(_ProductOptionSelection).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ProductOptionSelection[key];
    }
  });
});

var _ProductPreview = require("./ProductPreview");

Object.keys(_ProductPreview).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ProductPreview[key];
    }
  });
});

var _ProductSelection = require("./ProductSelection");

Object.keys(_ProductSelection).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ProductSelection[key];
    }
  });
});

var _Roles = require("./Roles");

Object.keys(_Roles).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Roles[key];
    }
  });
});

var _Setting = require("./Setting");

Object.keys(_Setting).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Setting[key];
    }
  });
});

var _ShippingPrice = require("./ShippingPrice");

Object.keys(_ShippingPrice).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ShippingPrice[key];
    }
  });
});

var _ShippingTemplate = require("./ShippingTemplate");

Object.keys(_ShippingTemplate).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ShippingTemplate[key];
    }
  });
});

var _Shop = require("./Shop");

Object.keys(_Shop).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Shop[key];
    }
  });
});

var _StatisticEventType = require("./StatisticEventType");

Object.keys(_StatisticEventType).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _StatisticEventType[key];
    }
  });
});

var _StatisticPeriodReport = require("./StatisticPeriodReport");

Object.keys(_StatisticPeriodReport).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _StatisticPeriodReport[key];
    }
  });
});

var _StatisticReport = require("./StatisticReport");

Object.keys(_StatisticReport).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _StatisticReport[key];
    }
  });
});

var _StatisticUnit = require("./StatisticUnit");

Object.keys(_StatisticUnit).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _StatisticUnit[key];
    }
  });
});

var _StockUnit = require("./StockUnit");

Object.keys(_StockUnit).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _StockUnit[key];
    }
  });
});

var _TemplateOrder = require("./TemplateOrder");

Object.keys(_TemplateOrder).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _TemplateOrder[key];
    }
  });
});

var _TimeInterval = require("./TimeInterval");

Object.keys(_TimeInterval).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _TimeInterval[key];
    }
  });
});

var _User = require("./User");

Object.keys(_User).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _User[key];
    }
  });
});

var _Warehouse = require("./Warehouse");

Object.keys(_Warehouse).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Warehouse[key];
    }
  });
});

var _Voucher = require("./Voucher");

Object.keys(_Voucher).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Voucher[key];
    }
  });
});

var _index = require("./index");

Object.keys(_index).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _index[key];
    }
  });
});
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";
"use strict";

var React = _interopRequireWildcard(require("react"));

var ReactDOM = _interopRequireWildcard(require("react-dom"));

var _App = _interopRequireDefault(require("./App"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

it('renders without crashing', function () {
  var div = document.createElement('div');
  ReactDOM.render(React.createElement(_App.default, null), div);
});
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _context = require("./_context");

var _notistack = require("notistack");

require("./App.css");

var _ThemeProvider = _interopRequireDefault(require("./components/ThemeProvider/ThemeProvider"));

var _luxon = _interopRequireDefault(require("@date-io/luxon"));

var _materialUiPickers = require("material-ui-pickers");

var _ThemeStylesImporter = _interopRequireDefault(require("./_helpers/ThemeStylesImporter"));

var _HashRouter = _interopRequireDefault(require("./components/HashRouter/HashRouter"));

var _Category = require("./_context/Category");

var _Product = require("./_context/Product");

var _Templates = require("./_context/Templates");

var _Locale = _interopRequireDefault(require("./_context/Locale"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var App =
/*#__PURE__*/
function (_React$Component) {
  _inherits(App, _React$Component);

  function App() {
    _classCallCheck(this, App);

    return _possibleConstructorReturn(this, _getPrototypeOf(App).apply(this, arguments));
  }

  _createClass(App, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      document.body.classList.remove('loading');
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(_Locale.default, {
        default: "en"
      }, React.createElement(_ThemeProvider.default, {
        path: "/theme/orders.json"
      }, React.createElement(_materialUiPickers.MuiPickersUtilsProvider, {
        utils: _luxon.default
      }, React.createElement(_context.AuthProvider, null, React.createElement(_notistack.SnackbarProvider, {
        maxSnack: 3
      }, React.createElement(_Product.ProductProviderStandalone, null, React.createElement(_Templates.TemplatesProviderStandalone, null, React.createElement(_Category.CategoryProviderStandalone, null, React.createElement(_context.UsersProviderStandalone, null, React.createElement(_context.ShopProviderStandalone, null, React.createElement(_context.WarehouseProviderStandalone, null, React.createElement(_context.SettingsProviderStandalone, null, React.createElement("div", {
        className: "app"
      }, React.createElement(_HashRouter.default, null), React.createElement(_ThemeStylesImporter.default, null))))))))))))));
    } // <ThemeSwitchContainer />
    // <LangSwitchContainer />
    // <Notifier />

  }]);

  return App;
}(React.Component);

var _default = App;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.withAuth = exports.AuthProvider = exports.InitUser = exports.LOCALSTORAGE_KEY = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var LOCALSTORAGE_KEY = 'Auth';
exports.LOCALSTORAGE_KEY = LOCALSTORAGE_KEY;
var storedUserJson = localStorage.getItem(LOCALSTORAGE_KEY);
var InitUser = storedUserJson ? JSON.parse(storedUserJson) : undefined;
exports.InitUser = InitUser;
var ReactAuthContext = React.createContext({
  login: function login() {
    return {};
  },
  logout: function logout() {
    return {};
  },
  refresh: function refresh() {
    return {};
  },
  reset: function reset() {
    return {};
  },
  confirmRegister: function confirmRegister() {
    return {};
  },
  setup: function setup() {
    return {};
  }
});

var AuthProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(AuthProvider, _React$Component);

  function AuthProvider(props) {
    var _this;

    _classCallCheck(this, AuthProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(AuthProvider).call(this, props));
    _this.state = {
      user: InitUser,
      loggedin: undefined,
      login: _this._login.bind(_assertThisInitialized(_this)),
      logout: _this._logout.bind(_assertThisInitialized(_this)),
      reset: _this._reset.bind(_assertThisInitialized(_this)),
      refresh: _this._refresh.bind(_assertThisInitialized(_this)),
      setup: _this._setup.bind(_assertThisInitialized(_this)),
      confirmRegister: _this._confirmRegister.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(AuthProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._refresh();
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactAuthContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_login",
    value: function _login(username, password) {
      var _this2 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return new Promise(function (resolve, reject) {
        return (0, _services.Authenticate)(username, password).then(function (user) {
          if (!user) {
            _this2.setState(function () {
              return {
                fetching: false,
                error: true,
                loggedin: false,
                user: undefined
              };
            });

            throw new Error();
          }

          localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(user));

          _this2.setState(function () {
            return {
              fetching: false,
              error: false,
              loggedin: true,
              user: user
            };
          });

          return user;
        }).then(resolve).catch(function (reason) {
          _this2.setState(function () {
            return {
              fetching: false,
              error: true,
              loggedin: false,
              user: undefined
            };
          });

          reject(reason);
        });
      });
    }
  }, {
    key: "_logout",
    value: function _logout() {
      var _this3 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return (0, _services.Logout)().then(function () {
        localStorage.removeItem(LOCALSTORAGE_KEY);

        _this3.setState(function () {
          return {
            fetching: false,
            error: false,
            loggedin: false,
            user: undefined
          };
        });
      }).catch(function () {
        _this3.setState(function () {
          return {
            fetching: false,
            error: true,
            user: undefined
          };
        });
      });
    }
  }, {
    key: "_reset",
    value: function _reset(username) {
      var _this4 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return (0, _services.Reset)(username).then(function () {
        localStorage.removeItem(LOCALSTORAGE_KEY);

        _this4.setState(function () {
          return {
            fetching: false,
            error: false,
            loggedin: false,
            user: undefined
          };
        });
      }).catch(function () {
        _this4.setState(function () {
          return {
            fetching: false,
            error: true,
            user: undefined
          };
        });
      });
    }
  }, {
    key: "_confirmRegister",
    value: function _confirmRegister(userId, key, password) {
      var _this5 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return new Promise(function (resolve, reject) {
        return (0, _services.ConfirmRegister)(userId, key, password).then(function (user) {
          localStorage.removeItem(LOCALSTORAGE_KEY);

          _this5.setState(function () {
            return {
              fetching: false,
              error: false,
              loggedin: false,
              user: undefined
            };
          });

          return user;
        }).then(function (user) {
          return _this5._login(user.UserName, password);
        }).then(resolve).catch(function (resp) {
          _this5.setState(function () {
            return {
              fetching: false,
              error: true,
              user: undefined
            };
          });

          reject(resp);
        });
      });
    }
  }, {
    key: "_setup",
    value: function _setup(username, password, changes) {
      var _this6 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return new Promise(function (resolve, reject) {
        return (0, _services.Setup)(username, password, changes).then(function (user) {
          localStorage.removeItem(LOCALSTORAGE_KEY);

          _this6.setState(function () {
            return {
              fetching: false,
              error: false,
              loggedin: false,
              user: undefined
            };
          });

          return user;
        }).then(function (user) {
          return _this6._login(user.UserName, password);
        }).then(resolve).catch(function (resp) {
          _this6.setState(function () {
            return {
              fetching: false,
              error: true,
              user: undefined
            };
          });

          reject(resp);
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this7 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      });
      return (0, _services.GetUser)().then(function (user) {
        if (!user) {
          localStorage.removeItem(LOCALSTORAGE_KEY);

          _this7.setState(function () {
            return {
              fetching: false,
              error: false,
              loggedin: false,
              user: undefined
            };
          });

          return;
        }

        var oldUser = _this7.state.user || {};
        var Token = oldUser.Token;

        var newUser = _objectSpread({}, user, {
          Token: Token
        });

        localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(newUser));

        _this7.setState(function () {
          return {
            fetching: false,
            error: false,
            loggedin: true,
            user: newUser
          };
        });

        return user;
      }).catch(function (o) {
        _this7.setState(function () {
          return {
            fetching: false,
            needSetup: o.Value === 'setup',
            error: false,
            loggedin: false,
            user: undefined
          };
        });
      });
    }
  }]);

  return AuthProvider;
}(React.Component);

exports.AuthProvider = AuthProvider;

_defineProperty(AuthProvider, "Inject", function (UnwrappedComponent) {
  return (
    /*#__PURE__*/
    function (_React$Component2) {
      _inherits(WithAuth, _React$Component2);

      function WithAuth() {
        _classCallCheck(this, WithAuth);

        return _possibleConstructorReturn(this, _getPrototypeOf(WithAuth).apply(this, arguments));
      }

      _createClass(WithAuth, [{
        key: "render",
        value: function render() {
          var _this8 = this;

          return React.createElement(AuthProvider.Consumer, null, function (context) {
            return React.createElement(UnwrappedComponent, _extends({}, _this8.props, context));
          });
        }
      }]);

      return WithAuth;
    }(React.Component)
  );
});

_defineProperty(AuthProvider, "Consumer", function (props) {
  return React.createElement(ReactAuthContext.Consumer, null, props.children);
});

var withAuth = function withAuth(Component) {
  return function (props) {
    return React.createElement(ReactAuthContext.Consumer, null, function (authCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        authCtx: authCtx
      }));
    });
  };
};

exports.withAuth = withAuth;
var _default = AuthProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.CategoryProviderStandalone = exports.withCategory = exports.CategoryProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactCategoryContext = React.createContext({
  Categories: [],
  update: function update() {
    return null;
  },
  delete: function _delete(id) {
    return null;
  },
  patch: function patch(id, changes) {
    return null;
  },
  create: function create(changes) {
    return null;
  }
});

var CategoryProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CategoryProvider, _React$Component);

  function CategoryProvider(props) {
    var _this;

    _classCallCheck(this, CategoryProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CategoryProvider).call(this, props));
    _this.state = {
      Categories: [],
      update: _this._update.bind(_assertThisInitialized(_this)),
      delete: _this._delete.bind(_assertThisInitialized(_this)),
      patch: _this._patch.bind(_assertThisInitialized(_this)),
      create: _this._create.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(CategoryProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactCategoryContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_setCategories",
    value: function _setCategories(categories) {
      this.setState(function () {
        return {
          Categories: categories
        };
      });
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      _services.Categories.Find({}, 0, 1000).then(function (result) {
        return _this2._setCategories(result.Values);
      });
    }
  }, {
    key: "_patch",
    value: function _patch(id, changes) {
      var _this3 = this;

      return _services.Categories.Patch(id, changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this3.setState(function (prev) {
            return {
              Categories: prev.Categories.map(function (t) {
                return t.Id === model.Id ? model : t;
              })
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }, {
    key: "_delete",
    value: function _delete(id) {
      var _this4 = this;

      return _services.Categories.Delete(id).then(function () {
        return new Promise(function (resolve) {
          return _this4.setState(function (prev) {
            return {
              Categories: prev.Categories.filter(function (t) {
                return t.Id !== id;
              })
            };
          }, function () {
            return resolve(id);
          });
        });
      });
    }
  }, {
    key: "_create",
    value: function _create(changes) {
      var _this5 = this;

      return _services.Categories.Create(changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this5.setState(function (prev) {
            return {
              Categories: [].concat(_toConsumableArray(prev.Categories), [model])
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }]);

  return CategoryProvider;
}(React.Component);

exports.CategoryProvider = CategoryProvider;

_defineProperty(CategoryProvider, "Consumer", function (props) {
  return React.createElement(ReactCategoryContext.Consumer, null, props.children);
});

var withCategory = function withCategory(Component) {
  return function (props) {
    return React.createElement(ReactCategoryContext.Consumer, null, function (categoryCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        categoryCtx: categoryCtx
      }));
    });
  };
};

exports.withCategory = withCategory;
var CategoryProviderStandalone = (0, _.withAuth)(CategoryProvider);
exports.CategoryProviderStandalone = CategoryProviderStandalone;
var _default = CategoryProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.withLocale = exports.LocaleProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _i18nIsoCountries = _interopRequireDefault(require("i18n-iso-countries"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactLocaleContext = React.createContext({
  loading: false,
  set: function set() {
    return null;
  }
});

var LocaleProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(LocaleProvider, _React$Component);

  function LocaleProvider(props) {
    var _this;

    _classCallCheck(this, LocaleProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(LocaleProvider).call(this, props));
    _this.state = {
      loading: false,
      set: _this._set.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(LocaleProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var defaultLocale = this.props.default;

      this._set(defaultLocale);
    }
  }, {
    key: "render",
    value: function render() {
      var _this$state = this.state,
          locale = _this$state.locale,
          messages = _this$state.messages;
      return React.createElement(ReactLocaleContext.Provider, {
        value: this.state
      }, React.createElement(_reactIntl.IntlProvider, {
        locale: locale || 'en',
        messages: messages,
        key: locale
      }, this.props.children));
    }
  }, {
    key: "_set",
    value: function _set(locale) {
      var _this2 = this;

      import(
      /* webpackMode: "lazy" */
      "react-intl/locale-data/".concat(locale)).then(function (localeData) {
        return (0, _reactIntl.addLocaleData)(localeData.default);
      });
      var loadLocale = fetch("locales/".concat(locale, ".json")).then(function (response) {
        if (response.ok) {
          return response.json();
        } else {
          throw new Error('Network response was not ok.');
        }
      }).then(function (messages) {
        _this2.setState(function () {
          return {
            locale: locale,
            messages: messages
          };
        });
      }).catch(function (reason) {
        // tslint:disable-next-line:no-console
        console.log("locale ".concat(locale, " not loaded: (").concat(reason, ")"));

        _this2.setState(function () {
          return {
            loading: false
          };
        });
      });
      var loadCountries = import(
      /* webpackMode: "lazy" */
      "i18n-iso-countries/langs/".concat(locale)).then(function (response) {
        if (response) {
          return response;
        } else {
          throw new Error('Network response was not ok.');
        }
      }).then(function (countries) {
        _i18nIsoCountries.default.registerLocale(countries);

        _this2.setState(function () {
          return {
            locale: locale
          };
        });
      }).catch(function (reason) {
        // tslint:disable-next-line:no-console
        console.log("countries in ".concat(locale, " not loaded: (").concat(reason, ")"));
      });
      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        Promise.all([loadLocale, loadCountries]).then(function () {
          return _this2.setState(function () {
            return {
              loading: false
            };
          });
        }).catch(function (reason) {
          // tslint:disable-next-line:no-console
          console.log("".concat(locale, " not loaded: (").concat(reason, ")"));

          _this2.setState(function () {
            return {
              loading: false
            };
          });
        });
      });
    }
  }]);

  return LocaleProvider;
}(React.Component);

exports.LocaleProvider = LocaleProvider;

_defineProperty(LocaleProvider, "Consumer", function (props) {
  return React.createElement(ReactLocaleContext.Consumer, null, props.children);
});

var withLocale = function withLocale(Component) {
  return function (props) {
    return React.createElement(ReactLocaleContext.Consumer, null, function (ctx) {
      return React.createElement(Component, _objectSpread({}, props, {
        localeCtx: ctx
      }));
    });
  };
};

exports.withLocale = withLocale;
var _default = LocaleProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ProductProviderStandalone = exports.withProduct = exports.ProductProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactProductContext = React.createContext({
  products: [],
  update: function update() {
    return Promise.resolve();
  },
  fetching: false
});

var ProductProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductProvider, _React$Component);

  function ProductProvider(props) {
    var _this;

    _classCallCheck(this, ProductProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductProvider).call(this, props));
    _this.state = {
      products: [],
      update: _this._update.bind(_assertThisInitialized(_this)),
      fetching: false
    };
    return _this;
  }

  _createClass(ProductProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactProductContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      return new Promise(function (resolve) {
        _this2.setState(function () {
          return {
            fetching: true
          };
        }, function () {
          _services.Products.Previews().then(function (products) {
            _this2.setState(function () {
              return {
                products: products,
                fetching: false
              };
            }, resolve);
          });
        });
      });
    }
  }]);

  return ProductProvider;
}(React.Component);

exports.ProductProvider = ProductProvider;

_defineProperty(ProductProvider, "Consumer", function (props) {
  return React.createElement(ReactProductContext.Consumer, null, props.children);
});

var withProduct = function withProduct(Component) {
  return function (props) {
    return React.createElement(ReactProductContext.Consumer, null, function (productCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        productCtx: productCtx
      }));
    });
  };
};

exports.withProduct = withProduct;
var ProductProviderStandalone = (0, _.withAuth)(ProductProvider);
exports.ProductProviderStandalone = ProductProviderStandalone;
var _default = ProductProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SettingsProviderStandalone = exports.withSettings = exports.SettingsProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactSettingsContext = React.createContext({
  Settings: {
    Path: '',
    Currencies: [],
    PaymentProviders: [],
    HidePaymentProviders: [],
    NewsletterProviders: [],
    TransferMessage: '',
    ShowTaxRateExcluded: true,
    ShowTaxRateIncluded: true,
    ShowWeight: false
  },
  refresh: function refresh() {
    return {};
  },
  update: function update() {
    return {};
  }
});

var SettingsProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(SettingsProvider, _React$Component);

  function SettingsProvider(props) {
    var _this;

    _classCallCheck(this, SettingsProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(SettingsProvider).call(this, props));
    _this.state = {
      Settings: {
        Path: '',
        Currencies: [],
        PaymentProviders: [],
        TransferMessage: '',
        HidePaymentProviders: [],
        NewsletterProviders: [],
        ShowTaxRateExcluded: true,
        ShowTaxRateIncluded: true,
        ShowWeight: false
      },
      refresh: _this._refresh.bind(_assertThisInitialized(_this)),
      update: _this._update.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(SettingsProvider, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._refresh();
      }
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {
      this._refresh();
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactSettingsContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this2 = this;

      _services.Settings.Get().then(function (result) {
        return _this2.setState(function (prev) {
          return {
            Settings: result
          };
        });
      });
    }
  }, {
    key: "_update",
    value: function _update(changes) {
      var _this3 = this;

      return _services.Settings.Patch(changes).then(function (result) {
        _this3.setState(function (prev) {
          return {
            Settings: result
          };
        });

        return result;
      });
    }
  }]);

  return SettingsProvider;
}(React.Component);

exports.SettingsProvider = SettingsProvider;

_defineProperty(SettingsProvider, "Consumer", function (props) {
  return React.createElement(ReactSettingsContext.Consumer, null, props.children);
});

var withSettings = function withSettings(Component) {
  return function (props) {
    return React.createElement(ReactSettingsContext.Consumer, null, function (settingsCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        settingsCtx: settingsCtx
      }));
    });
  };
};

exports.withSettings = withSettings;
var SettingsProviderStandalone = (0, _.withAuth)(SettingsProvider);
exports.SettingsProviderStandalone = SettingsProviderStandalone;
var _default = SettingsProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ShopProviderStandalone = exports.withShop = exports.ShopProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _Auth = require("./Auth");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactShopContext = React.createContext({
  Shops: [],
  update: function update() {
    return null;
  },
  delete: function _delete(id) {
    return null;
  },
  patch: function patch(id, changes) {
    return null;
  },
  create: function create(changes) {
    return null;
  }
});

var ShopProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ShopProvider, _React$Component);

  function ShopProvider(props) {
    var _this;

    _classCallCheck(this, ShopProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopProvider).call(this, props));
    _this.state = {
      Shops: [],
      update: _this._update.bind(_assertThisInitialized(_this)),
      delete: _this._delete.bind(_assertThisInitialized(_this)),
      patch: _this._patch.bind(_assertThisInitialized(_this)),
      create: _this._create.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(ShopProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactShopContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_setShops",
    value: function _setShops(shops) {
      this.setState(function () {
        return {
          Shops: shops
        };
      });
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      _services.Shops.Find({}, 0, 1000).then(function (result) {
        return _this2._setShops(result.Values);
      });
    }
  }, {
    key: "_patch",
    value: function _patch(id, changes) {
      var _this3 = this;

      return _services.Shops.Patch(id, changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this3.setState(function (prev) {
            return {
              Shops: prev.Shops.map(function (t) {
                return t.Id === model.Id ? model : t;
              })
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }, {
    key: "_delete",
    value: function _delete(id) {
      var _this4 = this;

      return _services.Shops.Delete(id).then(function () {
        return new Promise(function (resolve) {
          return _this4.setState(function (prev) {
            return {
              Shops: prev.Shops.filter(function (t) {
                return t.Id !== id;
              })
            };
          }, function () {
            return resolve(id);
          });
        });
      });
    }
  }, {
    key: "_create",
    value: function _create(changes) {
      var _this5 = this;

      return _services.Shops.Create(changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this5.setState(function (prev) {
            return {
              Shops: [].concat(_toConsumableArray(prev.Shops), [model])
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }]);

  return ShopProvider;
}(React.Component);

exports.ShopProvider = ShopProvider;

_defineProperty(ShopProvider, "Consumer", function (props) {
  return React.createElement(ReactShopContext.Consumer, null, props.children);
});

var withShop = function withShop(Component) {
  return function (props) {
    return React.createElement(ReactShopContext.Consumer, null, function (shopCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        shopCtx: shopCtx
      }));
    });
  };
};

exports.withShop = withShop;
var ShopProviderStandalone = (0, _Auth.withAuth)(ShopProvider);
exports.ShopProviderStandalone = ShopProviderStandalone;
var _default = ShopProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.TemplatesProviderStandalone = exports.withTemplates = exports.TemplatesProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactTemplatesContext = React.createContext({
  templates: [],
  update: function update() {
    return null;
  },
  delete: function _delete(id) {
    return null;
  },
  patch: function patch(id, changes) {
    return null;
  },
  create: function create(changes) {
    return null;
  }
});

var TemplatesProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(TemplatesProvider, _React$Component);

  function TemplatesProvider(props) {
    var _this;

    _classCallCheck(this, TemplatesProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(TemplatesProvider).call(this, props));
    _this.state = {
      templates: [],
      update: _this._update.bind(_assertThisInitialized(_this)),
      delete: _this._delete.bind(_assertThisInitialized(_this)),
      patch: _this._patch.bind(_assertThisInitialized(_this)),
      create: _this._create.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(TemplatesProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactTemplatesContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_setTemplates",
    value: function _setTemplates(templates) {
      this.setState(function () {
        return {
          templates: templates
        };
      });
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      _services.DocumentTemplates.Find({}, 0, 1000).then(function (result) {
        return _this2._setTemplates(result.Values);
      });
    }
  }, {
    key: "_patch",
    value: function _patch(id, changes) {
      var _this3 = this;

      return _services.DocumentTemplates.Patch(id, changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this3.setState(function (prev) {
            return {
              templates: prev.templates.map(function (t) {
                return t.Id === model.Id ? model : t;
              })
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }, {
    key: "_delete",
    value: function _delete(id) {
      var _this4 = this;

      return _services.DocumentTemplates.Delete(id).then(function () {
        return new Promise(function (resolve) {
          return _this4.setState(function (prev) {
            return {
              templates: prev.templates.filter(function (t) {
                return t.Id !== id;
              })
            };
          }, function () {
            return resolve(id);
          });
        });
      });
    }
  }, {
    key: "_create",
    value: function _create(changes) {
      var _this5 = this;

      return _services.DocumentTemplates.Create(changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this5.setState(function (prev) {
            return {
              templates: [].concat(_toConsumableArray(prev.templates), [model])
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }]);

  return TemplatesProvider;
}(React.Component);

exports.TemplatesProvider = TemplatesProvider;

_defineProperty(TemplatesProvider, "Consumer", function (props) {
  return React.createElement(ReactTemplatesContext.Consumer, null, props.children);
});

var withTemplates = function withTemplates(Component) {
  return function (props) {
    return React.createElement(ReactTemplatesContext.Consumer, null, function (templates) {
      return React.createElement(Component, _objectSpread({}, props, {
        templateCtx: templates
      }));
    });
  };
};

exports.withTemplates = withTemplates;
var TemplatesProviderStandalone = (0, _.withAuth)(TemplatesProvider);
exports.TemplatesProviderStandalone = TemplatesProviderStandalone;
var _default = TemplatesProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.UsersProviderStandalone = exports.withUsers = exports.UsersProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ReactUsersContext = React.createContext({
  Users: [],
  update: function update() {
    return null;
  }
});

var UsersProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(UsersProvider, _React$Component);

  function UsersProvider(props) {
    var _this;

    _classCallCheck(this, UsersProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(UsersProvider).call(this, props));
    _this.state = {
      Users: [],
      update: _this._update.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(UsersProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactUsersContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_setUsers",
    value: function _setUsers(users) {
      this.setState(function () {
        return {
          Users: users
        };
      });
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      _services.Users.GetAll(0, 1000).then(function (result) {
        return _this2._setUsers(result.Values);
      });
    }
  }]);

  return UsersProvider;
}(React.Component);

exports.UsersProvider = UsersProvider;

var withUsers = function withUsers(Component) {
  return function (props) {
    return React.createElement(ReactUsersContext.Consumer, null, function (usersCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        usersCtx: usersCtx
      }));
    });
  };
};

exports.withUsers = withUsers;
var UsersProviderStandalone = (0, _.withAuth)(UsersProvider);
exports.UsersProviderStandalone = UsersProviderStandalone;
var _default = UsersProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.WarehouseProviderStandalone = exports.withWarehouse = exports.WarehouseProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../_services");

var _ = require(".");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactWarehouseContext = React.createContext({
  Warehouses: [],
  update: function update() {
    return null;
  },
  delete: function _delete(id) {
    return null;
  },
  patch: function patch(id, changes) {
    return null;
  },
  create: function create(changes) {
    return null;
  }
});

var WarehouseProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(WarehouseProvider, _React$Component);

  function WarehouseProvider(props) {
    var _this;

    _classCallCheck(this, WarehouseProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(WarehouseProvider).call(this, props));
    _this.state = {
      Warehouses: [],
      update: _this._update.bind(_assertThisInitialized(_this)),
      delete: _this._delete.bind(_assertThisInitialized(_this)),
      patch: _this._patch.bind(_assertThisInitialized(_this)),
      create: _this._create.bind(_assertThisInitialized(_this))
    };
    return _this;
  }

  _createClass(WarehouseProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._update();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      var user = this.props.authCtx.user;
      var prevUser = prevProps.authCtx.user;
      var id = user && user.Id;
      var prevId = prevUser && prevUser.Id;

      if (id !== prevId) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(ReactWarehouseContext.Provider, {
        value: this.state
      }, this.props.children);
    }
  }, {
    key: "_setWarehouses",
    value: function _setWarehouses(warehouses) {
      this.setState(function () {
        return {
          Warehouses: warehouses
        };
      });
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this2 = this;

      _services.Warehouses.Find({}, 0, 1000).then(function (result) {
        return _this2._setWarehouses(result.Values);
      });
    }
  }, {
    key: "_patch",
    value: function _patch(id, changes) {
      var _this3 = this;

      return _services.Warehouses.Patch(id, changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this3.setState(function (prev) {
            return {
              Warehouses: prev.Warehouses.map(function (t) {
                return t.Id === model.Id ? model : t;
              })
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }, {
    key: "_delete",
    value: function _delete(id) {
      var _this4 = this;

      return _services.Warehouses.Delete(id).then(function () {
        return new Promise(function (resolve) {
          return _this4.setState(function (prev) {
            return {
              Warehouses: prev.Warehouses.filter(function (t) {
                return t.Id !== id;
              })
            };
          }, function () {
            return resolve(id);
          });
        });
      });
    }
  }, {
    key: "_create",
    value: function _create(changes) {
      var _this5 = this;

      return _services.Warehouses.Create(changes).then(function (model) {
        return new Promise(function (resolve) {
          return _this5.setState(function (prev) {
            return {
              Warehouses: [].concat(_toConsumableArray(prev.Warehouses), [model])
            };
          }, function () {
            return resolve(model);
          });
        });
      });
    }
  }]);

  return WarehouseProvider;
}(React.Component);

exports.WarehouseProvider = WarehouseProvider;

_defineProperty(WarehouseProvider, "Consumer", function (props) {
  return React.createElement(ReactWarehouseContext.Consumer, null, props.children);
});

var withWarehouse = function withWarehouse(Component) {
  return function (props) {
    return React.createElement(ReactWarehouseContext.Consumer, null, function (warehouseCtx) {
      return React.createElement(Component, _objectSpread({}, props, {
        warehouseCtx: warehouseCtx
      }));
    });
  };
};

exports.withWarehouse = withWarehouse;
var WarehouseProviderStandalone = (0, _.withAuth)(WarehouseProvider);
exports.WarehouseProviderStandalone = WarehouseProviderStandalone;
var _default = WarehouseProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _Auth = require("./Auth");

Object.keys(_Auth).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Auth[key];
    }
  });
});

var _Category = require("./Category");

Object.keys(_Category).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Category[key];
    }
  });
});

var _Locale = require("./Locale");

Object.keys(_Locale).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Locale[key];
    }
  });
});

var _Product = require("./Product");

Object.keys(_Product).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Product[key];
    }
  });
});

var _Settings = require("./Settings");

Object.keys(_Settings).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Settings[key];
    }
  });
});

var _Shop = require("./Shop");

Object.keys(_Shop).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Shop[key];
    }
  });
});

var _Templates = require("./Templates");

Object.keys(_Templates).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Templates[key];
    }
  });
});

var _Users = require("./Users");

Object.keys(_Users).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Users[key];
    }
  });
});

var _Warehouse = require("./Warehouse");

Object.keys(_Warehouse).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Warehouse[key];
    }
  });
});
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Filter = void 0;

var _shortid = require("shortid");

var _FilterOperatorHelpers = require("./FilterOperatorHelpers");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var Filter =
/*#__PURE__*/
function () {
  _createClass(Filter, null, [{
    key: "Empty",
    value: function Empty() {
      return new Filter({});
    }
  }, {
    key: "And",
    value: function And() {
      for (var _len = arguments.length, filters = new Array(_len), _key = 0; _key < _len; _key++) {
        filters[_key] = arguments[_key];
      }

      return new Filter({
        Operator: 'and',
        Children: filters
      });
    }
  }, {
    key: "Eq",
    value: function Eq(property, value) {
      return new Filter({
        Operator: 'eq',
        Property: property,
        Value: value
      });
    }
  }, {
    key: "IsNull",
    value: function IsNull(property) {
      return new Filter({
        Operator: 'isnull',
        Property: property
      });
    }
  }, {
    key: "IsNotNull",
    value: function IsNotNull(property) {
      return new Filter({
        Operator: 'isnotnull',
        Property: property
      });
    }
  }, {
    key: "Like",
    value: function Like(property, Value) {
      return new Filter({
        Operator: 'like',
        Property: property,
        Value: Value
      });
    }
  }, {
    key: "Lt",
    value: function Lt(property, Value) {
      return new Filter({
        Operator: 'lt',
        Property: property,
        Value: Value
      });
    }
  }, {
    key: "Lte",
    value: function Lte(property, Value) {
      return new Filter({
        Operator: 'lte',
        Property: property,
        Value: Value
      });
    }
  }, {
    key: "Gt",
    value: function Gt(property, Value) {
      return new Filter({
        Operator: 'gt',
        Property: property,
        Value: Value
      });
    }
  }, {
    key: "Gte",
    value: function Gte(property, Value) {
      return new Filter({
        Operator: 'gte',
        Property: property,
        Value: Value
      });
    }
  }, {
    key: "Ne",
    value: function Ne(property, value) {
      return new Filter({
        Operator: 'ne',
        Property: property,
        Value: value
      });
    }
  }, {
    key: "Or",
    value: function Or() {
      for (var _len2 = arguments.length, filters = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        filters[_key2] = arguments[_key2];
      }

      return new Filter({
        Operator: 'or',
        Children: filters
      });
    }
  }]);

  function Filter(filter) {
    var _this = this;

    _classCallCheck(this, Filter);

    _defineProperty(this, "Operator", void 0);

    _defineProperty(this, "Value", void 0);

    _defineProperty(this, "Property", void 0);

    _defineProperty(this, "Id", void 0);

    _defineProperty(this, "Children", void 0);

    _defineProperty(this, "toString", function (intl) {
      var operator = _this.Operator;

      if (operator === 'and') {
        var children = _this.Children;

        if (!children) {
          return '';
        }

        return children.map(function (c) {
          return c.toString(intl);
        }).join(" ".concat((0, _FilterOperatorHelpers.GetLegend)(intl, operator), " "));
      }

      if (operator === 'or') {
        var _children = _this.Children;

        if (!_children) {
          return '';
        }

        return _children.map(function (c) {
          return c.toString(intl);
        }).join(" ".concat((0, _FilterOperatorHelpers.GetLegend)(intl, operator), " "));
      }

      var operatorLegend = operator ? (0, _FilterOperatorHelpers.GetLegend)(intl, operator) : '';
      return "".concat(_this.Property || '', " ").concat(operatorLegend, " ").concat(_this.Value || '');
    });

    _defineProperty(this, "toJson", function () {
      var result = {
        Operator: _this.Operator,
        Property: _this.Property,
        Value: _this.Value,
        Children: _this.Children ? _this.Children.map(function (c) {
          return c.toJson();
        }) : undefined
      };
      return result;
    });

    this.Operator = filter.Operator;
    this.Value = filter.Value;
    this.Property = filter.Property;
    this.Id = filter.Id || (0, _shortid.generate)();

    if (filter.Children) {
      this.Children = filter.Children.map(function (c) {
        return new Filter(c);
      });
    }
  }

  _createClass(Filter, [{
    key: "WithProperty",
    value: function WithProperty(property) {
      return new Filter({
        Children: this.Children,
        Value: this.Value,
        Property: property,
        Id: this.Id,
        Operator: this.Operator
      });
    }
  }, {
    key: "WithValue",
    value: function WithValue(value) {
      return new Filter({
        Children: this.Children,
        Value: value,
        Property: this.Property,
        Id: this.Id,
        Operator: this.Operator
      });
    }
  }, {
    key: "WithOperator",
    value: function WithOperator(operator) {
      return new Filter({
        Children: this.Children,
        Value: this.Value,
        Property: this.Property,
        Id: this.Id,
        Operator: operator
      });
    }
  }, {
    key: "WithChildren",
    value: function WithChildren(children) {
      return new Filter({
        Children: children,
        Value: this.Value,
        Property: this.Property,
        Id: this.Id,
        Operator: this.Operator
      });
    }
  }, {
    key: "isValid",
    value: function isValid() {
      if (this.Operator === 'and') {
        return true;
      }

      if (this.Operator === 'or') {
        return true;
      }

      return this.Property !== undefined && this.Value !== undefined && this.Operator !== undefined;
    }
  }]);

  return Filter;
}();

exports.Filter = Filter;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetLegend = void 0;

var _reactIntl = require("react-intl");

var messages = (0, _reactIntl.defineMessages)({
  'eq': {
    "id": "FilterOperator.eq",
    "defaultMessage": "="
  },
  'ne': {
    "id": "FilterOperator.ne",
    "defaultMessage": "!="
  },
  'lt': {
    "id": "FilterOperator.lt",
    "defaultMessage": "<"
  },
  'bt': {
    "id": "FilterOperator.gt",
    "defaultMessage": ">"
  },
  'lte': {
    "id": "FilterOperator.lte",
    "defaultMessage": "<="
  },
  'gte': {
    "id": "FilterOperator.gte",
    "defaultMessage": ">="
  },
  'and': {
    "id": "FilterOperator.and",
    "defaultMessage": "and"
  },
  'or': {
    "id": "FilterOperator.or",
    "defaultMessage": "or"
  },
  'like': {
    "id": "FilterOperator.like",
    "defaultMessage": "like"
  }
});

var GetLegend = function GetLegend(intl, operator) {
  var messageDescriptor = messages[operator] || {
    defaultMessage: operator.toString(),
    id: "FilterOperator.".concat(operator)
  };
  return intl.formatMessage(messageDescriptor);
};

exports.GetLegend = GetLegend;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetOrderStatusLegend = exports.GetOrderStatusProgress = void 0;

var _OrderStatusMessages = require("./OrderStatusMessages");

var GetOrderStatusProgress = function GetOrderStatusProgress(order) {
  switch (order.Status) {
    case 'Canceled':
      return -1;

    case 'Done':
      return 100;

    case 'PendingPayment':
      return 33;

    case 'ToDispatch':
      return 66;

    case 'Empty':
      return 0;

    default:
      return 100;
  }
};

exports.GetOrderStatusProgress = GetOrderStatusProgress;

var GetOrderStatusLegend = function GetOrderStatusLegend(intl, status) {
  var messageDescriptor = _OrderStatusMessages.OrderStatusMessages[status] || {
    defaultMessage: status.toString(),
    id: "OrderStatus.".concat(status)
  };
  return intl.formatMessage(messageDescriptor);
};

exports.GetOrderStatusLegend = GetOrderStatusLegend;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OrderStatusMessages = void 0;

var _reactIntl = require("react-intl");

var OrderStatusMessages = (0, _reactIntl.defineMessages)({
  Empty: {
    "id": "OrderStatus.Empty",
    "defaultMessage": "Empty"
  },
  Canceled: {
    "id": "OrderStatus.Canceled",
    "defaultMessage": "Canceled"
  },
  PendingPayment: {
    "id": "OrderStatus.PendingPayment",
    "defaultMessage": "Awaiting payment"
  },
  ToDispatch: {
    "id": "OrderStatus.ToDispatch",
    "defaultMessage": "ToDispatch"
  },
  Done: {
    "id": "OrderStatus.Done",
    "defaultMessage": "Done"
  }
});
exports.OrderStatusMessages = OrderStatusMessages;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetPaymentMethodLegend = exports.paymentMethodMessages = void 0;

var _reactIntl = require("react-intl");

var paymentMethodMessages = (0, _reactIntl.defineMessages)({
  Electronic: {
    "id": "PaymentMethod.Electronic",
    "defaultMessage": "Electronic"
  },
  Cash: {
    "id": "PaymentMethod.Cash",
    "defaultMessage": "Cash"
  },
  Voucher: {
    "id": "PaymentMethod.Voucher",
    "defaultMessage": "Voucher"
  }
});
exports.paymentMethodMessages = paymentMethodMessages;

var GetPaymentMethodLegend = function GetPaymentMethodLegend(intl, status) {
  var messageDescriptor = paymentMethodMessages[status] || {
    defaultMessage: status.toString(),
    id: "PaymentMethod.".concat(status)
  };
  return intl.formatMessage(messageDescriptor);
};

exports.GetPaymentMethodLegend = GetPaymentMethodLegend;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetPaymentStatusLegend = exports.paymentStatusMessages = void 0;

var _reactIntl = require("react-intl");

var paymentStatusMessages = (0, _reactIntl.defineMessages)({
  Pending: {
    "id": "PaymentStatus.Pending",
    "defaultMessage": "Pending"
  },
  Canceled: {
    "id": "PaymentStatus.Canceled",
    "defaultMessage": "Canceled"
  },
  Failed: {
    "id": "PaymentStatus.Failed",
    "defaultMessage": "Failed"
  },
  Paid: {
    "id": "PaymentStatus.Paid",
    "defaultMessage": "Paid"
  }
});
exports.paymentStatusMessages = paymentStatusMessages;

var GetPaymentStatusLegend = function GetPaymentStatusLegend(intl, status) {
  var messageDescriptor = paymentStatusMessages[status] || {
    defaultMessage: status.toString(),
    id: "PaymentStatus.".concat(status)
  };
  return intl.formatMessage(messageDescriptor);
};

exports.GetPaymentStatusLegend = GetPaymentStatusLegend;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SortableListItemsContainer = exports.SortableListItem = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactSortableHoc = require("react-sortable-hoc");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var MoveItem =
/*#__PURE__*/
function (_React$Component) {
  _inherits(MoveItem, _React$Component);

  function MoveItem() {
    _classCallCheck(this, MoveItem);

    return _possibleConstructorReturn(this, _getPrototypeOf(MoveItem).apply(this, arguments));
  }

  _createClass(MoveItem, [{
    key: "render",
    value: function render() {
      return React.createElement(_core.Grid, _extends({
        item: true
      }, this.props), this.props.children);
    }
  }]);

  return MoveItem;
}(React.Component);

var SortableListItem = (0, _reactSortableHoc.SortableElement)(MoveItem);
exports.SortableListItem = SortableListItem;

var MoveContainer =
/*#__PURE__*/
function (_React$Component2) {
  _inherits(MoveContainer, _React$Component2);

  function MoveContainer() {
    _classCallCheck(this, MoveContainer);

    return _possibleConstructorReturn(this, _getPrototypeOf(MoveContainer).apply(this, arguments));
  }

  _createClass(MoveContainer, [{
    key: "render",
    value: function render() {
      return React.createElement(_GridContainer.GridContainer, _extends({
        direction: "column"
      }, this.props), this.props.children);
    }
  }]);

  return MoveContainer;
}(React.Component);

var SortableList = (0, _reactSortableHoc.SortableContainer)(MoveContainer);

var SortableListItemsContainerWithStyles = function SortableListItemsContainerWithStyles(_ref) {
  var classes = _ref.classes,
      props = _objectWithoutProperties(_ref, ["classes"]);

  return React.createElement(SortableList, _extends({
    helperClass: classes.root
  }, props));
};

var SortableListItemsContainer = (0, _core.withStyles)(function (theme) {
  return {
    root: {
      zIndex: theme.zIndex.tooltip,
      position: 'relative',
      '&:after': {
        content: '""',
        zIndex: -1,
        position: 'absolute',
        left: -theme.spacing.unit,
        right: -theme.spacing.unit,
        top: 0,
        bottom: 0,
        boxShadow: theme.shadows[2],
        background: 'white'
      }
    }
  };
})(SortableListItemsContainerWithStyles);
exports.SortableListItemsContainer = SortableListItemsContainer;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ThemeStylesImporter =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ThemeStylesImporter, _React$Component);

  function ThemeStylesImporter(props) {
    _classCallCheck(this, ThemeStylesImporter);

    return _possibleConstructorReturn(this, _getPrototypeOf(ThemeStylesImporter).call(this, props));
  }

  _createClass(ThemeStylesImporter, [{
    key: "render",
    value: function render() {
      var theme = this.props.theme;

      if (!theme) {
        return null;
      }

      return React.createElement(React.Fragment, null, theme.stylesheets.map(function (src) {
        return React.createElement("link", {
          key: src,
          rel: "stylesheet",
          type: "text/css",
          href: src
        });
      }));
    }
  }]);

  return ThemeStylesImporter;
}(React.Component);

var _default = (0, _core.withTheme)()(ThemeStylesImporter);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetTimeIntervalLegend = exports.TimeIntervalMessages = void 0;

var _reactIntl = require("react-intl");

var TimeIntervalMessages = (0, _reactIntl.defineMessages)({
  Hour: {
    "id": "TimeInterval.Hour",
    "defaultMessage": "{itemCount, plural, one {Hour} other {Hours}}"
  },
  Day: {
    "id": "TimeInterval.Day",
    "defaultMessage": "{itemCount, plural, one {Day} other {Days}}"
  },
  Week: {
    "id": "TimeInterval.Week",
    "defaultMessage": "{itemCount, plural, one {Week} other {Weeks}}"
  },
  Month: {
    "id": "TimeInterval.Month",
    "defaultMessage": "{itemCount, plural, one {Month} other {Months}}"
  },
  Year: {
    "id": "TimeInterval.Year",
    "defaultMessage": "{itemCount, plural, one {Year} other {Years}}"
  }
});
exports.TimeIntervalMessages = TimeIntervalMessages;

var GetTimeIntervalLegend = function GetTimeIntervalLegend(intl, interval, value) {
  var message = TimeIntervalMessages[interval] || {
    defaultMessage: interval.toString(),
    id: "TimeInterval.".concat(interval)
  };
  return intl.formatMessage(message, {
    itemCount: value === undefined ? 1 : value
  });
};

exports.GetTimeIntervalLegend = GetTimeIntervalLegend;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.handleApiResponse = exports.addAuthHeader = void 0;

var _context = require("../_context");

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var addAuthHeader = function addAuthHeader(requestOptions) {
  // return authorization header with jwt token
  var localUser = localStorage.getItem(_context.LOCALSTORAGE_KEY);

  if (!localUser) {
    return requestOptions;
  }

  var user = JSON.parse(localUser);

  if (!user || !user.Token) {
    return requestOptions;
  }

  requestOptions.headers = _objectSpread({}, requestOptions.headers, {
    'Authorization': 'Bearer ' + user.Token
  });
  return requestOptions;
};

exports.addAuthHeader = addAuthHeader;

var handleApiResponse = function handleApiResponse(response) {
  return new Promise(function (resolve, reject) {
    if (response.ok) {
      // return model if it was returned in the response
      var contentType = response.headers.get('content-type');

      if (contentType && contentType.includes('application/json')) {
        response.json().then(function (json) {
          var apiresponse = json;

          if (!apiresponse.Result.Success) {
            // 
            return reject(apiresponse);
          }

          return resolve(apiresponse.Value);
        }).catch(function (reason) {
          // impossible to parse json
          return reject({
            Result: {
              Success: false,
              Message: reason
            },
            Value: null
          });
        });
      } else {
        resolve();
      }
    } else {
      // return error message from response body
      response.text().then(function (reason) {
        return reject({
          Result: {
            Success: false,
            Message: reason
          },
          Value: null
        });
      });
    }
  });
};

exports.handleApiResponse = handleApiResponse;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.hsvToRgb = void 0;
var round = Math.round;

var hsvToRgb = function hsvToRgb(h, s, v) {
  var s = s / 100,
      v = v / 100;
  var c = v * s;
  var hh = h / 60;
  var x = c * (1 - Math.abs(hh % 2 - 1));
  var m = v - c;
  var p = parseInt(hh.toString(), 10);
  var rgb = p === 0 ? [c, x, 0] : p === 1 ? [x, c, 0] : p === 2 ? [0, c, x] : p === 3 ? [0, x, c] : p === 4 ? [x, 0, c] : p === 5 ? [c, 0, x] : [];
  return [round(255 * (rgb[0] + m)), round(255 * (rgb[1] + m)), round(255 * (rgb[2] + m))];
};

exports.hsvToRgb = hsvToRgb;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.config = void 0;
var _window$location = window.location,
    protocol = _window$location.protocol,
    hostname = _window$location.hostname,
    port = _window$location.port,
    pathname = _window$location.pathname;
var REACT_APP_API_URL = process.env.REACT_APP_API_URL;
var path = pathname.replace(/[^\.\/]+\.[^\.\/]+$/g, '').replace(/\/$/g, '');
var config = {
  apiUrl: "".concat(REACT_APP_API_URL ? REACT_APP_API_URL : "".concat(protocol, "//").concat(hostname, ":").concat(port).concat(path))
};
exports.config = config;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _authHeader = require("./auth-header");

Object.keys(_authHeader).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _authHeader[key];
    }
  });
});

var _config = require("./config");

Object.keys(_config).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _config[key];
    }
  });
});

var _colors = require("./colors");

Object.keys(_colors).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _colors[key];
    }
  });
});
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Printer = exports.PrintLink = exports.ToPdf = exports.HTMLStringToCanvas = exports.ReactToCanvas = void 0;

var ReactDOM = _interopRequireWildcard(require("react-dom"));

var html2canvas = _interopRequireWildcard(require("html2canvas"));

var jsPDF = _interopRequireWildcard(require("jspdf"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ReactToCanvas = function ReactToCanvas(elt) {
  return new Promise(function (resolve, reject) {
    var target = document.createElement('div');
    var _document = document,
        documentElement = _document.documentElement;

    if (!documentElement) {
      reject('no document element');
      return;
    }

    documentElement.appendChild(target);
    ReactDOM.render(elt, target, function () {
      var torender = target.querySelector('*');

      if (!torender) {
        reject();
        return;
      }

      html2canvas(torender).then(function (canvas) {
        resolve(canvas);
        documentElement.removeChild(target);
      }).catch(reject);
    });
  });
};

exports.ReactToCanvas = ReactToCanvas;

var HTMLStringToCanvas = function HTMLStringToCanvas(input) {
  return new Promise(function (resolve, reject) {
    var target = document.createElement('div');
    var _document2 = document,
        documentElement = _document2.documentElement;

    if (!documentElement) {
      reject('no document element');
      return;
    }

    documentElement.appendChild(target);
    target.innerHTML = input;
    var torender = target.querySelector('*');

    if (!torender) {
      reject();
      return;
    }

    html2canvas(torender).then(function (canvas) {
      resolve(canvas);
      documentElement.removeChild(target);
    }).catch(reject);
  });
};

exports.HTMLStringToCanvas = HTMLStringToCanvas;

var ToPdf = function ToPdf(canvas, fileName) {
  var r = canvas.width / canvas.height;
  var imgData = canvas.toDataURL('image/png');
  var pdf = new jsPDF({
    unit: 'mm',
    format: ['80', (r * 80).toString()]
  });
  pdf.addImage(imgData, 'JPEG', 0, 0); // pdf.output('dataurlnewwindow');

  pdf.save(fileName);
};

exports.ToPdf = ToPdf;

var dataURLtoBlob = function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
      mime = arr[0].match(/:(.*?);/)[1],
      bstr = atob(arr[1]),
      n = bstr.length,
      u8arr = new Uint8Array(n);

  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }

  return new Blob([u8arr], {
    type: mime
  });
};

var saveData = function saveData(blob, fileName) {
  var a = document.createElement('a');
  document.body.appendChild(a);
  var url = window.URL.createObjectURL(blob);
  a.href = url;
  a.download = fileName;
  a.style.display = 'none';
  a.click();
  window.URL.revokeObjectURL(url);
};

var PrintLink = function PrintLink(url, fileName) {
  var blob = dataURLtoBlob(url);
  saveData(blob, fileName); // // const printWindow = window.open(url, 'Print', 'status=no, toolbar=no, scrollbars=yes', false);
  // var printWindow = window.open();
  // if (!printWindow) { return; }
  // const styles = 'border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;';
  // printWindow.document.write(
  //     `<iframe src='${url}' frameborder="0" style="${styles}" allowfullscreen></iframe>`);
  // printWindow.onload = () => {
  //     // tslint:disable-next-line:no-unused-expression
  //     printWindow &&
  //         // tslint:disable-next-line:no-string-literal
  //         printWindow['print']();
  // };
};

exports.PrintLink = PrintLink;

var Printer =
/*#__PURE__*/
function () {
  function Printer(options) {
    _classCallCheck(this, Printer);

    _defineProperty(this, "linkLoaded", void 0);

    _defineProperty(this, "linkTotal", void 0);

    _defineProperty(this, "imageLoaded", void 0);

    _defineProperty(this, "imageTotal", void 0);

    _defineProperty(this, "_options", void 0);

    this._options = options;
  }

  _createClass(Printer, [{
    key: "Print",
    value: function Print() {
      var _this = this;

      var _this$_options = this._options,
          content = _this$_options.content,
          copyStyles = _this$_options.copyStyles,
          cssStyles = _this$_options.cssStyles,
          cssClasses = _this$_options.cssClasses,
          onAfterPrint = _this$_options.onAfterPrint;
      var printWindow = window.open('', 'Print', 'status=no, toolbar=no, scrollbars=yes', false);

      if (!printWindow) {
        return;
      }

      if (onAfterPrint) {
        printWindow.onbeforeunload = onAfterPrint;
      }

      var contentEl = content();
      var container = document.createElement('div');
      ReactDOM.render(contentEl, container, function () {
        var imageNodes = Array.from(container.getElementsByTagName('img'));
        var linkNodes = document.querySelectorAll('link[rel="stylesheet"]');
        _this.imageTotal = imageNodes.length;
        _this.imageLoaded = 0;
        _this.linkTotal = linkNodes.length;
        _this.linkLoaded = 0;

        var markLoaded = function markLoaded(type) {
          if (type === 'image') {
            _this.imageLoaded++;
          } else if (type === 'link') {
            _this.linkLoaded++;
          }

          if (_this.imageLoaded === _this.imageTotal && _this.linkLoaded === _this.linkTotal) {
            _this._triggerPrint(printWindow);
          }
        };

        _toConsumableArray(imageNodes).forEach(function (child) {
          /** Workaround for Safari if the image has base64 data as a source */
          if (/^data:/.test(child.src)) {
            child.crossOrigin = 'anonymous';
          }

          child.setAttribute('src', child.src);
          child.onload = markLoaded.bind(null, 'image');
          child.onerror = markLoaded.bind(null, 'image');
          child.crossOrigin = 'use-credentials';
        });
        /*
         * IE does not seem to allow appendChild from different window contexts correctly.  They seem to come back
         * as plain objects. In order to get around this each tag is re-created into the printWindow
         * https://stackoverflow.com/questions/38708840
         * /calling-adoptnode-and-importnode-on-a-child-window-fails-in-ie-and-edge
         */


        var _document3 = document,
            location = _document3.location;

        if (copyStyles !== false && location) {
          var headEls = Array.from(document.querySelectorAll('style, link[rel="stylesheet"]'));

          _toConsumableArray(headEls).forEach(function (node) {
            var newHeadEl = printWindow.document.createElement(node.tagName);

            if (node.textContent) {
              newHeadEl.textContent = node.textContent; // tslint:disable-next-line:no-string-literal
            } else if (node['innerText']) {
              // tslint:disable-next-line:no-string-literal
              newHeadEl.innerText = node['innerText'];
            }

            var attributes = Array.from(node.attributes);
            attributes.forEach(function (attr) {
              var nodeValue = attr.nodeValue;
              var newNodeValue = nodeValue;

              if (nodeValue && attr.nodeName === 'href' && /^https?:\/\//.test(nodeValue) === false) {
                var relPath = nodeValue.substr(0, 3) === '../' ? location.pathname.replace(/[^/]*$/, '') : '/';
                newNodeValue = location.protocol + '//' + location.host + relPath + nodeValue;
              }

              newHeadEl.setAttribute(attr.nodeName, newNodeValue || '');
            });

            if (node.tagName === 'LINK') {
              newHeadEl.onload = markLoaded.bind(null, 'link');
              newHeadEl.onerror = markLoaded.bind(null, 'link');
            }

            printWindow.document.head.appendChild(newHeadEl);
          });
        }

        if (document.body.className) {
          var bodyClasses = document.body.className.split(' ');
          bodyClasses.map(function (item) {
            return printWindow.document.body.classList.add(item);
          });
        }

        if (cssClasses) {
          cssClasses.forEach(function (cssClass) {
            return printWindow.document.body.classList.add(cssClass);
          });
        }
        /* remove date/time from top */


        var styleEl = printWindow.document.createElement('style');
        var styles = "\n                ".concat(cssStyles ? cssStyles : '', "\n            ");
        styleEl.appendChild(printWindow.document.createTextNode(styles));
        printWindow.document.head.appendChild(styleEl);
        printWindow.document.body.innerHTML = container.outerHTML;

        if (_this.imageTotal === 0 || copyStyles === false) {
          _this._triggerPrint(printWindow);
        }
      });
    }
  }, {
    key: "_triggerPrint",
    value: function _triggerPrint(target) {
      if (this._options.onBeforePrint) {
        this._options.onBeforePrint();
      }

      setTimeout(function () {
        // tslint:disable-next-line:no-string-literal
        target['print'](); // target.close();
      }, 500);
    }
  }]);

  return Printer;
}();

exports.Printer = Printer;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.IsAdminOrInRole = void 0;

var IsAdminOrInRole = function IsAdminOrInRole(user) {
  for (var _len = arguments.length, roles = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    roles[_key - 1] = arguments[_key];
  }

  return user && (roles.some(function (role) {
    return user.Roles.indexOf('Admin') >= 0;
  }) || roles.some(function (role) {
    return user.Roles.indexOf(role) >= 0;
  }));
};

exports.IsAdminOrInRole = IsAdminOrInRole;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetHashVariable = exports.GetQueryVariable = void 0;

var GetQueryVariable = function GetQueryVariable(variable) {
  var query = window.location.search.substring(1);
  var vars = query.split('&');

  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');

    if (decodeURIComponent(pair[0]) === variable) {
      return decodeURIComponent(pair[1]);
    }
  }

  return '';
};

exports.GetQueryVariable = GetQueryVariable;

var GetHashVariable = function GetHashVariable(variable) {
  var query = window.location.hash.substring(1);
  var vars = query.split('&');

  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');

    if (decodeURIComponent(pair[0]) === variable) {
      return decodeURIComponent(pair[1]);
    }
  }

  return '';
};

exports.GetHashVariable = GetHashVariable;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Setup = exports.Register = exports.PatchUser = exports.GetUser = exports.ChangePassword = exports.ConfirmRegister = exports.Reset = exports.Logout = exports.Authenticate = void 0;

var _helpers = require("../_helpers");

var Authenticate = function Authenticate(username, password) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      username: username,
      password: password
    })
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/authenticate"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (user) {
    return user;
  });
};

exports.Authenticate = Authenticate;

var Logout = function Logout() {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    }
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/logout"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (user) {
    return;
  });
};

exports.Logout = Logout;

var Reset = function Reset(username) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      username: username
    })
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/reset"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
};

exports.Reset = Reset;

var ConfirmRegister = function ConfirmRegister(id, code, password) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      id: id,
      code: code,
      password: password
    })
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/reset"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
};

exports.ConfirmRegister = ConfirmRegister;

var ChangePassword = function ChangePassword(currentPassword, newPassword) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      currentPassword: currentPassword,
      newPassword: newPassword
    })
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/changePassword"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (user) {
    return;
  });
};

exports.ChangePassword = ChangePassword;

var GetUser = function GetUser() {
  var requestOptions = {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  };
  return fetch("".concat(_helpers.config.apiUrl, "/account/current"), (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (user) {
    return user;
  });
};

exports.GetUser = GetUser;

var PatchUser = function PatchUser(changes) {
  var pathModel = Object.keys(changes).map(function (k) {
    return {
      op: 'replace',
      path: "/".concat(k),
      value: changes[k]
    };
  });
  var requestOptions = {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(pathModel)
  };
  var url = "".concat(_helpers.config.apiUrl, "/account");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.PatchUser = PatchUser;

var Register = function Register(email) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(email)
  };
  var url = "".concat(_helpers.config.apiUrl, "/account/register");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.Register = Register;

var Setup = function Setup(userName, password, changes) {
  var pathModel = changes && Object.keys(changes).map(function (k) {
    return {
      op: 'replace',
      path: "/".concat(k),
      value: changes[k]
    };
  });
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      UserName: userName,
      Password: password,
      Patch: pathModel
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/account/setup");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.Setup = Setup;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SubscribeNewsletter = exports.Users = exports.Settings = exports.OrderItems = exports.StockUnits = exports.Movements = exports.DocumentTemplates = exports.Categories = exports.Warehouses = exports.Shops = exports.Vouchers = exports.Clients = exports.Orders = exports.ServerStorage = exports.Products = exports.ServiceApi = void 0;

var _helpers = require("../_helpers");

var _Filter = require("src/_helpers/Filter");

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ServiceApi =
/*#__PURE__*/
function () {
  function ServiceApi() {
    _classCallCheck(this, ServiceApi);

    _defineProperty(this, "type", void 0);
  }

  _createClass(ServiceApi, [{
    key: "_Empty",
    value: function _Empty(changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/empty");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        // tslint:disable-next-line:no-any
        response.Id = undefined;
        return response;
      });
    }
  }, {
    key: "Get",
    value: function Get(id) {
      var requestOptions = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Delete",
    value: function Delete(id) {
      var requestOptions = {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Patch",
    value: function Patch(id, changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "PatchAll",
    value: function PatchAll(all) {
      var patchAllModel = {};
      Object.keys(all).forEach(function (id) {
        var changes = all[id];
        patchAllModel[id] = Object.keys(changes).map(function (k) {
          return {
            op: 'replace',
            path: "/".concat(k),
            value: changes[k]
          };
        });
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(patchAllModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Create",
    value: function Create(entry) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(entry)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Find",
    value: function Find(filterDef, startIndex, stopIndex) {
      var f = filterDef.filters,
          sort = filterDef.sort,
          o = filterDef.operator;
      var filters = f && _toConsumableArray(f) || [];
      var operator = o || 'and'; // if (query) {
      //     filters.push(Filter.Text(query));
      // }

      var body;

      switch (filters.length) {
        case 0:
          body = null;
          break;

        case 1:
          body = filters[0];
          break;

        default:
          body = operator === 'and' ? _Filter.Filter.And.apply(_Filter.Filter, _toConsumableArray(filters)) : _Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(filters));
          break;
      }

      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: body && JSON.stringify(body)
      };
      var querystring = "start=".concat(startIndex, "&take=").concat(stopIndex - startIndex);

      if (sort) {
        querystring += "&sort=".concat(sort);
      }

      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/find?").concat(querystring);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Count",
    value: function Count(filter) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: filter.Operator ? JSON.stringify(filter.toJson()) : undefined
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/count");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return ServiceApi;
}();

exports.ServiceApi = ServiceApi;

var ProductApi =
/*#__PURE__*/
function (_ServiceApi) {
  _inherits(ProductApi, _ServiceApi);

  function ProductApi() {
    var _getPrototypeOf2;

    var _this;

    _classCallCheck(this, ProductApi);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProductApi)).call.apply(_getPrototypeOf2, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this), "type", 'product');

    return _this;
  }

  _createClass(ProductApi, [{
    key: "Empty",
    value: function Empty(title, partial) {
      var empty = {
        Title: title,
        NeedsDispatch: true
      };
      return _get(_getPrototypeOf(ProductApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }, {
    key: "Previews",
    value: function Previews() {
      var requestOptions = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/previews");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return ProductApi;
}(ServiceApi);

var Products = new ProductApi();
exports.Products = Products;

var ServerStorageApi =
/*#__PURE__*/
function () {
  function ServerStorageApi() {
    _classCallCheck(this, ServerStorageApi);
  }

  _createClass(ServerStorageApi, [{
    key: "Post",
    value: function Post(formData) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Accept': 'application/json'
        },
        body: formData
      };
      var url = "".concat(_helpers.config.apiUrl, "/storage");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return ServerStorageApi;
}();

var ServerStorage = new ServerStorageApi();
exports.ServerStorage = ServerStorage;

var OrderApi =
/*#__PURE__*/
function (_ServiceApi2) {
  _inherits(OrderApi, _ServiceApi2);

  function OrderApi() {
    var _getPrototypeOf3;

    var _this2;

    _classCallCheck(this, OrderApi);

    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(OrderApi)).call.apply(_getPrototypeOf3, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this2), "type", 'order');

    return _this2;
  }

  _createClass(OrderApi, [{
    key: "Empty",
    value: function Empty(partial) {
      // const empty: Order = {
      //     Type: 'Order',
      //     Tax: 0,
      //     Price: 0,
      //     Total: 0,
      //     Dispatches: [],
      //     Currency: settings.Settings.Currencies[0],
      //     ShopId: (auth.user && auth.user.ShopId) || undefined,
      //     Weight: 0,
      //     OrderType: 'Order',
      //     Id: '',
      //     PaidAmount: 0,
      //     Paid: false,
      //     Payments: [],
      //     Items: []
      // };
      return _get(_getPrototypeOf(OrderApi.prototype), "_Empty", this).call(this, _objectSpread({}, partial));
    }
  }, {
    key: "Preview",
    value: function Preview(changes, id) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/preview").concat(id ? "/".concat(id) : '');
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Shippings",
    value: function Shippings(order, startIndex, stopIndex) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(order)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/shippings?start=").concat(startIndex, "&take=").concat(stopIndex - startIndex);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "GetReport",
    value: function GetReport(type, dimension, start, count, interval) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          Start: start,
          Count: count,
          TimeInterval: interval
        })
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/reports/").concat(type, "/").concat(dimension);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return OrderApi;
}(ServiceApi);

var Orders = new OrderApi();
exports.Orders = Orders;

var ClientApi =
/*#__PURE__*/
function (_ServiceApi3) {
  _inherits(ClientApi, _ServiceApi3);

  function ClientApi() {
    var _getPrototypeOf4;

    var _this3;

    _classCallCheck(this, ClientApi);

    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf4 = _getPrototypeOf(ClientApi)).call.apply(_getPrototypeOf4, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this3), "type", 'client');

    return _this3;
  }

  _createClass(ClientApi, [{
    key: "Empty",
    value: function Empty(partial) {
      var empty = {};
      return _get(_getPrototypeOf(ClientApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }]);

  return ClientApi;
}(ServiceApi);

var Clients = new ClientApi();
exports.Clients = Clients;

var VoucherApi =
/*#__PURE__*/
function (_ServiceApi4) {
  _inherits(VoucherApi, _ServiceApi4);

  function VoucherApi() {
    var _getPrototypeOf5;

    var _this4;

    _classCallCheck(this, VoucherApi);

    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    _this4 = _possibleConstructorReturn(this, (_getPrototypeOf5 = _getPrototypeOf(VoucherApi)).call.apply(_getPrototypeOf5, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this4), "type", 'voucher');

    return _this4;
  }

  _createClass(VoucherApi, [{
    key: "Empty",
    value: function Empty(partial) {
      var empty = {
        Expiration: new Date()
      };
      return _get(_getPrototypeOf(VoucherApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }]);

  return VoucherApi;
}(ServiceApi);

var Vouchers = new VoucherApi();
exports.Vouchers = Vouchers;

var ShopApi =
/*#__PURE__*/
function (_ServiceApi5) {
  _inherits(ShopApi, _ServiceApi5);

  function ShopApi() {
    var _getPrototypeOf6;

    var _this5;

    _classCallCheck(this, ShopApi);

    for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
      args[_key5] = arguments[_key5];
    }

    _this5 = _possibleConstructorReturn(this, (_getPrototypeOf6 = _getPrototypeOf(ShopApi)).call.apply(_getPrototypeOf6, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this5), "type", 'shop');

    return _this5;
  }

  _createClass(ShopApi, [{
    key: "Empty",
    value: function Empty(name, partial) {
      var empty = {
        Name: name
      };
      return _get(_getPrototypeOf(ShopApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }]);

  return ShopApi;
}(ServiceApi);

var Shops = new ShopApi();
exports.Shops = Shops;

var WarehouseApi =
/*#__PURE__*/
function (_ServiceApi6) {
  _inherits(WarehouseApi, _ServiceApi6);

  function WarehouseApi() {
    var _getPrototypeOf7;

    var _this6;

    _classCallCheck(this, WarehouseApi);

    for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
      args[_key6] = arguments[_key6];
    }

    _this6 = _possibleConstructorReturn(this, (_getPrototypeOf7 = _getPrototypeOf(WarehouseApi)).call.apply(_getPrototypeOf7, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this6), "type", 'Warehouse');

    return _this6;
  }

  _createClass(WarehouseApi, [{
    key: "Empty",
    value: function Empty(name, partial) {
      var empty = {
        Name: name
      };
      return _get(_getPrototypeOf(WarehouseApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }]);

  return WarehouseApi;
}(ServiceApi);

var Warehouses = new WarehouseApi();
exports.Warehouses = Warehouses;

var CategoryApi =
/*#__PURE__*/
function (_ServiceApi7) {
  _inherits(CategoryApi, _ServiceApi7);

  function CategoryApi() {
    var _getPrototypeOf8;

    var _this7;

    _classCallCheck(this, CategoryApi);

    for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
      args[_key7] = arguments[_key7];
    }

    _this7 = _possibleConstructorReturn(this, (_getPrototypeOf8 = _getPrototypeOf(CategoryApi)).call.apply(_getPrototypeOf8, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this7), "type", 'category');

    return _this7;
  }

  _createClass(CategoryApi, [{
    key: "Empty",
    value: function Empty(title, partial) {
      var empty = {
        Title: title
      };
      return _get(_getPrototypeOf(CategoryApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }]);

  return CategoryApi;
}(ServiceApi);

var Categories = new CategoryApi();
exports.Categories = Categories;

var DocumentTemplateApi =
/*#__PURE__*/
function (_ServiceApi8) {
  _inherits(DocumentTemplateApi, _ServiceApi8);

  function DocumentTemplateApi() {
    var _getPrototypeOf9;

    var _this8;

    _classCallCheck(this, DocumentTemplateApi);

    for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {
      args[_key8] = arguments[_key8];
    }

    _this8 = _possibleConstructorReturn(this, (_getPrototypeOf9 = _getPrototypeOf(DocumentTemplateApi)).call.apply(_getPrototypeOf9, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this8), "type", 'documenttemplate');

    return _this8;
  }

  _createClass(DocumentTemplateApi, [{
    key: "Empty",
    value: function Empty(title, partial) {
      var empty = {
        Title: title
      };
      return _get(_getPrototypeOf(DocumentTemplateApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    }
  }, {
    key: "Order",
    value: function (_Order) {
      function Order(_x, _x2, _x3) {
        return _Order.apply(this, arguments);
      }

      Order.toString = function () {
        return _Order.toString();
      };

      return Order;
    }(function (tempalteId, orderId, changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(tempalteId, "/order/").concat(orderId);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    })
  }, {
    key: "Orders",
    value: function Orders(filterDef, tempalteId) {
      var f = filterDef.filters,
          sort = filterDef.sort,
          o = filterDef.operator;
      var filters = f && _toConsumableArray(f) || [];
      var operator = o || 'and';
      var body;

      switch (filters.length) {
        case 0:
          body = null;
          break;

        case 1:
          body = filters[0];
          break;

        default:
          body = operator === 'and' ? _Filter.Filter.And.apply(_Filter.Filter, _toConsumableArray(filters)) : _Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(filters));
          break;
      }

      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: body && JSON.stringify(body)
      };
      var querystring = sort ? "&sort=".concat(sort) : '';
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(tempalteId, "/orders?").concat(querystring);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "OrdersProducts",
    value: function OrdersProducts(filterDef, tempalteId) {
      var f = filterDef.filters,
          sort = filterDef.sort,
          o = filterDef.operator;
      var filters = f && _toConsumableArray(f) || [];
      var operator = o || 'and';
      var body;

      switch (filters.length) {
        case 0:
          body = null;
          break;

        case 1:
          body = filters[0];
          break;

        default:
          body = operator === 'and' ? _Filter.Filter.And.apply(_Filter.Filter, _toConsumableArray(filters)) : _Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(filters));
          break;
      }

      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: body && JSON.stringify(body)
      };
      var querystring = sort ? "&sort=".concat(sort) : '';
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(tempalteId, "/ordersProducts?").concat(querystring);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Client",
    value: function (_Client) {
      function Client(_x4, _x5, _x6) {
        return _Client.apply(this, arguments);
      }

      Client.toString = function () {
        return _Client.toString();
      };

      return Client;
    }(function (tempalteId, clientId, changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/").concat(tempalteId, "/client/").concat(clientId);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    })
  }]);

  return DocumentTemplateApi;
}(ServiceApi);

var DocumentTemplates = new DocumentTemplateApi();
exports.DocumentTemplates = DocumentTemplates;

var MovementApi =
/*#__PURE__*/
function (_ServiceApi9) {
  _inherits(MovementApi, _ServiceApi9);

  function MovementApi() {
    var _getPrototypeOf10;

    var _this9;

    _classCallCheck(this, MovementApi);

    for (var _len9 = arguments.length, args = new Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {
      args[_key9] = arguments[_key9];
    }

    _this9 = _possibleConstructorReturn(this, (_getPrototypeOf10 = _getPrototypeOf(MovementApi)).call.apply(_getPrototypeOf10, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this9), "type", 'movement');

    return _this9;
  }

  _createClass(MovementApi, [{
    key: "Cashbox",
    value: function (_Cashbox) {
      function Cashbox() {
        return _Cashbox.apply(this, arguments);
      }

      Cashbox.toString = function () {
        return _Cashbox.toString();
      };

      return Cashbox;
    }(function () {
      var requestOptions = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/cashbox");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    })
  }, {
    key: "Empty",
    value: function Empty(Currency, partial) {
      var date = new Date().toISOString().substr(0, 10);
      var empty = {
        // User: `${user.FirstName} ${user.LastName}`,
        // UserId: user.Id,
        Date: date,
        Currency: Currency,
        // ShopId: user.ShopId,
        Archived: false
      };

      if (partial) {
        Object.keys(partial).forEach(function (k) {
          empty[k] = partial[k];
        });
      }

      return _get(_getPrototypeOf(MovementApi.prototype), "_Empty", this).call(this, _objectSpread({}, empty, partial));
    } // FindMovement(
    //     binding: FindMovementBindings,
    //     sort: string,
    //     startIndex: number,
    //     stopIndex: number): Promise<FindResult<Movement>> {
    //     const requestOptions = {
    //         method: 'POST',
    //         headers: { 'Content-Type': 'application/json' },
    //         body: JSON.stringify(binding)
    //     };
    //     let querystring = `start=${startIndex}&take=${stopIndex - startIndex}`;
    //     if (sort) { querystring += `&sort=${sort}`; }
    //     const url = `${config.apiUrl}/${this.type}/findMovement?${querystring}`;
    //     return fetch(url, addAuthHeader(requestOptions))
    //         .then<FindResult<Movement>>(handleApiResponse)
    //         .then(response => {
    //             return response;
    //         });
    // }

  }, {
    key: "Balance",
    value: function Balance(shop) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/balance/").concat(shop);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
    }
  }]);

  return MovementApi;
}(ServiceApi);

var Movements = new MovementApi();
exports.Movements = Movements;

var StockUnitApi =
/*#__PURE__*/
function (_ServiceApi10) {
  _inherits(StockUnitApi, _ServiceApi10);

  function StockUnitApi() {
    var _getPrototypeOf11;

    var _this10;

    _classCallCheck(this, StockUnitApi);

    for (var _len10 = arguments.length, args = new Array(_len10), _key10 = 0; _key10 < _len10; _key10++) {
      args[_key10] = arguments[_key10];
    }

    _this10 = _possibleConstructorReturn(this, (_getPrototypeOf11 = _getPrototypeOf(StockUnitApi)).call.apply(_getPrototypeOf11, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_this10), "type", 'stockunit');

    return _this10;
  }

  _createClass(StockUnitApi, [{
    key: "Update",
    value: function Update(stockUpdate) {
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(stockUpdate)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/update");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
    }
  }, {
    key: "Use",
    value: function Use(update) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(update)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/use");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
    }
  }, {
    key: "Warehouse",
    value: function Warehouse(id, filterDef, min, max, startIndex, stopIndex) {
      var f = filterDef.filters,
          sort = filterDef.sort,
          o = filterDef.operator;
      var filters = f && _toConsumableArray(f) || [];
      var operator = o || 'and'; // if (query) {
      //     filters.push(Filter.Text(query));
      // }

      var body;

      switch (filters.length) {
        case 0:
          body = null;
          break;

        case 1:
          body = filters[0];
          break;

        default:
          body = operator === 'and' ? _Filter.Filter.And.apply(_Filter.Filter, _toConsumableArray(filters)) : _Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(filters));
          break;
      }

      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: body && JSON.stringify(body)
      };
      var querystring = "start=".concat(startIndex, "&take=").concat(stopIndex - startIndex);

      if (sort) {
        querystring += "&sort=".concat(sort);
      }

      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.type, "/warehouse/").concat(id, "/").concat(min, "/").concat(max, "?").concat(querystring);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return StockUnitApi;
}(ServiceApi);

var StockUnits = new StockUnitApi();
exports.StockUnits = StockUnits;

var OrderItemApi =
/*#__PURE__*/
function () {
  function OrderItemApi() {
    _classCallCheck(this, OrderItemApi);

    _defineProperty(this, "endpoint", 'orderitem');
  }

  _createClass(OrderItemApi, [{
    key: "Empty",
    value: function Empty(partial) {
      var empty = {
        UID: '',
        Items: []
      };

      if (partial) {
        Object.keys(partial).forEach(function (k) {
          empty[k] = partial[k];
        });
      }

      return Promise.resolve(empty);
    }
  }, {
    key: "FromProducts",
    value: function FromProducts(selections, currency) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          Currency: currency,
          Selections: selections
        })
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return OrderItemApi;
}();

var OrderItems = new OrderItemApi();
exports.OrderItems = OrderItems;

var SettingsApi =
/*#__PURE__*/
function () {
  function SettingsApi() {
    _classCallCheck(this, SettingsApi);
  }

  _createClass(SettingsApi, [{
    key: "Get",
    value: function Get() {
      var requestOptions = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/settings");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Patch",
    value: function Patch(changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/settings");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }]);

  return SettingsApi;
}();

var Settings = new SettingsApi();
exports.Settings = Settings;

var UsersApi =
/*#__PURE__*/
function () {
  function UsersApi() {
    _classCallCheck(this, UsersApi);

    _defineProperty(this, "endpoint", 'user');
  }

  _createClass(UsersApi, [{
    key: "GetAll",
    // Empty(firstName: string, partial: Partial<User>): Promise<User> {
    //     const empty: Partial<User> = {
    //         FirstName: firstName
    //     };
    //     return super._Empty({ ...empty, ...partial });
    // }
    value: function GetAll(startIndex, stopIndex) {
      var requestOptions = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint, "?start=").concat(startIndex, "&take=").concat(stopIndex - startIndex);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Patch",
    value: function Patch(id, changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint, "/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Delete",
    value: function Delete(id) {
      var requestOptions = {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json'
        }
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint, "/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Create",
    value: function Create(changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        return response;
      });
    }
  }, {
    key: "Empty",
    value: function Empty(changes) {
      var pathModel = Object.keys(changes).map(function (k) {
        return {
          op: 'replace',
          path: "/".concat(k),
          value: changes[k]
        };
      });
      var requestOptions = {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(pathModel)
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint, "/empty");
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
        response.Id = '';
        return response;
      });
    }
  }, {
    key: "Reset",
    value: function Reset(id) {
      var requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          Id: id,
          resetFormURL: document.location.href,
          email: false
        })
      };
      var url = "".concat(_helpers.config.apiUrl, "/").concat(this.endpoint, "/reset/").concat(id);
      return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse);
    }
  }]);

  return UsersApi;
}();

var Users = new UsersApi();
exports.Users = Users;

var SubscribeNewsletter = function SubscribeNewsletter(client, provider) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      FirstName: client.FirstName,
      LastName: client.LastName,
      Email: client.Email
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/").concat(provider, "/subscribe");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.SubscribeNewsletter = SubscribeNewsletter;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _AuthenticationApi = require("./AuthenticationApi");

Object.keys(_AuthenticationApi).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _AuthenticationApi[key];
    }
  });
});

var _ServiceApi = require("./ServiceApi");

Object.keys(_ServiceApi).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ServiceApi[key];
    }
  });
});
"use strict";
"use strict";
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../_services");

var _ClientFields = require("../ClientFields/ClientFields");

var _OrderDetail = require("../../Orders/OrderDetail/OrderDetail");

var _OrderListItem = _interopRequireDefault(require("../../Orders/OrderListItem/OrderListItem"));

var _Filter = require("src/_helpers/Filter");

var _core = require("@material-ui/core");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var _ClientDocumentsDialog = _interopRequireWildcard(require("./ClientDocumentsDialog"));

var _OrderDocumentsDialogMessages = _interopRequireDefault(require("src/components/Orders/OrderDetail/OrderDocumentsDialogMessages"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ClientDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ClientDetail, _React$Component);

  // static getDerivedStateFromProps(props: ClientProps, state: State) {
  //     const { creating } = props;
  //     const { creating: stateCreating } = state;
  //     if (creating !== stateCreating) {
  //         return ({ creating: props.creating });
  //     }
  //     return null;
  // }
  function ClientDetail(props) {
    var _this;

    _classCallCheck(this, ClientDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClientDetail).call(this, props));
    _this._Update = _this._Update.bind(_assertThisInitialized(_this));
    _this._Refresh = _this._Refresh.bind(_assertThisInitialized(_this));
    _this._Save = _this._Save.bind(_assertThisInitialized(_this));
    _this._Delete = _this._Delete.bind(_assertThisInitialized(_this));
    var id = props.id,
        preview = props.preview;
    _this.state = {
      id: id,
      changes: id ? {} : preview,
      current: preview,
      orders: []
    };
    return _this;
  }

  _createClass(ClientDetail, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._loadOrders();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          intl = _this$props.intl,
          shopCtx = _this$props.shopCtx,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          settingsCtx = _this$props.settingsCtx,
          templateCtx = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          user = _this$props.authCtx.user;
      var _this$state = this.state,
          id = _this$state.id,
          changes = _this$state.changes,
          current = _this$state.current,
          orderOpened = _this$state.orderOpened,
          loading = _this$state.loading,
          orders = _this$state.orders,
          templatesOpened = _this$state.templatesOpened;
      var changed = !!Object.keys(changes).length;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Clients');
      var saveBtn = {
        icon: React.createElement(_icons.Check, null),
        onClick: function onClick() {
          return _this2._Save();
        },
        themeColor: 'green',
        legend: 'save'
      };
      var cancelBtn = {
        icon: React.createElement(_icons.Close, null),
        onClick: function onClick() {
          return _this2.props.onCancel();
        },
        themeColor: 'gray',
        legend: changed ? 'cancel' : 'close'
      };
      var deleteBtn = {
        icon: React.createElement(_icons.Delete, null),
        legend: 'delete',
        themeColor: 'red',
        onClick: this._Delete
      };
      var newsletters = hasRights ? settingsCtx.Settings.NewsletterProviders.map(function (n) {
        return {
          icon: React.createElement(_icons.ContactMail, null),
          legend: "add to ".concat(n),
          themeColor: 'blue',
          onClick: function onClick() {
            return (0, _services.SubscribeNewsletter)(current, n);
          }
        };
      }) : [];
      var templates = templateCtx.templates.filter(function (t) {
        return t.ApplyTo === 'client';
      });
      var templateBtn = templates.length > 0 && {
        icon: React.createElement(_icons.Print, null),
        legend: templates.length > 1 ? 'documents' : templates[0].Title,
        themeColor: 'gray',
        onClick: templates.length > 1 ? function () {
          return _this2.setState(function () {
            return {
              templatesOpened: true
            };
          });
        } : function () {
          return (0, _ClientDocumentsDialog.PrintClient)(templates[0].Id, current);
        }
      };
      var btns = [hasRights && changed && saveBtn, cancelBtn, hasRights && templateBtn, hasRights && !!id && deleteBtn].concat(_toConsumableArray(newsletters));
      return React.createElement(_DetailGridContainer.default, null, React.createElement(_DetailGridColumn.default, null, React.createElement(_ClientFields.ClientFields, {
        changes: changes,
        initial: current,
        onChange: this._Update,
        intl: intl,
        authCtx: authCtx
      })), React.createElement(_DetailGridColumn.default, null, !loading && orders && orders.map(function (o) {
        var Id = o.Id;

        var open = function open() {
          return _this2.setState(function () {
            return {
              orderOpened: Id
            };
          });
        };

        var close = function close(callback) {
          return _this2.setState(function () {
            return {
              orderOpened: undefined
            };
          }, callback);
        };

        return React.createElement("div", {
          key: Id
        }, React.createElement(_OrderListItem.default, {
          intl: intl,
          onClick: open,
          order: o
        }), React.createElement(_core.Dialog, {
          open: orderOpened === o.Id,
          fullScreen: true
        }, React.createElement(_core.DialogContent, null, React.createElement(_OrderDetail.OrderDetail, _extends({
          intl: intl,
          shopCtx: shopCtx,
          usersCtx: usersCtx,
          warehouseCtx: warehouseCtx,
          templateCtx: templateCtx,
          authCtx: authCtx,
          settingsCtx: settingsCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        }, {
          preventEditClient: true,
          preview: o,
          id: o.Id,
          onCancel: close,
          onChanged: function onChanged() {
            _this2._loadOrders();
          },
          onDelete: function onDelete() {
            close(function () {
              return _this2._loadOrders();
            });
          }
        })))));
      })), templates.length > 1 ? React.createElement(_ClientDocumentsDialog.default, {
        opened: templatesOpened,
        current: current,
        intl: intl,
        templates: templates,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              templatesOpened: false
            };
          });
        }
      }) : null, React.createElement(_Fabs.default, {
        map: btns
      }));
    } // private _OnChanged(changes: Partial<Person>) {
    //     this.setState(() => ({ changes: changes }));
    // }

  }, {
    key: "_Update",
    value: function _Update(changes) {
      var old = this.state.current;

      var current = _objectSpread({}, old, changes);

      this.setState(function (prev) {
        return {
          current: current,
          loading: true,
          changes: _objectSpread({}, prev.changes, changes)
        };
      });
    }
  }, {
    key: "_Refresh",
    value: function _Refresh() {
      this._Update({});
    }
  }, {
    key: "_Save",
    value: function _Save(extrachanges) {
      var _this3 = this;

      var _this$state2 = this.state,
          changes = _this$state2.changes,
          id = _this$state2.id;

      var finalchanges = _objectSpread({}, changes, extrachanges);

      if (id) {
        return _services.Clients.Patch(id, finalchanges).then(function (model) {
          _this3.setState(function () {
            return {
              changes: {},
              current: model
            };
          });

          if (_this3.props.onChanged) {
            _this3.props.onChanged(model);
          }
        });
      } else {
        return _services.Clients.Create(finalchanges).then(function (model) {
          _this3.setState(function () {
            return {
              changes: {},
              current: model,
              id: model.Id
            };
          });

          if (_this3.props.onChanged) {
            _this3.props.onChanged(model);
          }
        });
      }
    }
  }, {
    key: "_Delete",
    value: function _Delete() {
      var id = this.state.id;
      var _this$props2 = this.props,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_OrderDocumentsDialogMessages.default.deleteConfirm));

      if (id && isTodelete) {
        _services.Clients.Delete(id).then(onDelete);
      }
    }
  }, {
    key: "_loadOrders",
    value: function _loadOrders() {
      var _this4 = this;

      var id = this.state.id;

      if (!id) {
        return;
      }

      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        var filter = _Filter.Filter.Eq('ClientId', id);

        var def = {
          filters: [filter]
        };

        _services.Orders.Find(def, 0, 100).then(function (orders) {
          _this4.setState(function () {
            return {
              orders: orders.Values,
              loading: false
            };
          });
        });
      });
    }
  }]);

  return ClientDetail;
}(React.Component);

var _default = ClientDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PrintClient = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _services = require("src/_services");

var _print = require("src/_helpers/print");

var _ClientDocumentsDialogMessages = _interopRequireDefault(require("./ClientDocumentsDialogMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PrintClient = function PrintClient(templateId, current) {
  _services.DocumentTemplates.Client(templateId, current.Id, current).then(function (res) {
    // var pop = window.open();
    // var template = Handlebars.compile(html);
    new _print.Printer({
      content: function content() {
        return React.createElement("div", {
          dangerouslySetInnerHTML: {
            __html: res.html
          }
        });
      },
      cssClasses: ['body--print-reciept'],
      cssStyles: res.styles,
      copyStyles: false
    }).Print();
  });
};

exports.PrintClient = PrintClient;

var ClientDocumentsDialog =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ClientDocumentsDialog, _React$Component);

  function ClientDocumentsDialog(props) {
    var _this;

    _classCallCheck(this, ClientDocumentsDialog);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClientDocumentsDialog).call(this, props));
    _this.state = {};
    return _this;
  }

  _createClass(ClientDocumentsDialog, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          opened = _this$props.opened,
          templates = _this$props.templates,
          onClose = _this$props.onClose,
          formatMessage = _this$props.intl.formatMessage;
      var templateId = this.state.templateId;

      var change = function change(id) {
        return _this2.setState(function () {
          return {
            templateId: id
          };
        });
      };

      var print = function print() {
        return templateId ? _this2._Print(templateId) : void 0;
      };

      return React.createElement(_core.Dialog, {
        open: !!opened,
        onClose: onClose
      }, React.createElement(_core.DialogTitle, null, formatMessage(_ClientDocumentsDialogMessages.default.dialogTitle)), React.createElement(_core.DialogContent, null, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, formatMessage(_ClientDocumentsDialogMessages.default.inputLegend)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(e) {
          return change(e.target.value);
        },
        value: templateId || ''
      }, templates.map(function (t) {
        return React.createElement(_core.MenuItem, {
          key: t.Id,
          value: t.Id
        }, t.Title);
      })))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        size: "small",
        color: "primary",
        disabled: !templateId,
        variant: "contained",
        onClick: print
      }, formatMessage(_ClientDocumentsDialogMessages.default.actionPrint))));
    }
  }, {
    key: "_Print",
    value: function _Print(templateId) {
      var current = this.props.current;
      PrintClient(templateId, current);
    }
  }]);

  return ClientDocumentsDialog;
}(React.Component);

var _default = ClientDocumentsDialog;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderDocumentsDialogMessages = void 0;

var _reactIntl = require("react-intl");

var OrderDocumentsDialogMessages = (0, _reactIntl.defineMessages)({
  actionPrint: {
    "id": "src.components.client.clientDetail.actionPrint",
    "defaultMessage": "Print"
  },
  dialogTitle: {
    "id": "src.components.client.clientDetail.dialogTitle",
    "defaultMessage": "Select template"
  },
  inputLegend: {
    "id": "src.components.client.clientDetail.inputLegend",
    "defaultMessage": "Template"
  },
  deleteConfirm: {
    "id": "src.components.client.clientDetail.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this client?"
  }
});
exports.OrderDocumentsDialogMessages = OrderDocumentsDialogMessages;
var _default = OrderDocumentsDialogMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ClientFieldsStandalone = exports.default = exports.ClientFields = void 0;

var _core = require("@material-ui/core");

var _FormControl = _interopRequireDefault(require("@material-ui/core/FormControl"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _InputLabel = _interopRequireDefault(require("@material-ui/core/InputLabel"));

var _i18nIsoCountries = _interopRequireDefault(require("i18n-iso-countries"));

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _ClientFieldsMessages = _interopRequireDefault(require("./ClientFieldsMessages"));

var _roles = require("src/_helpers/roles");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ClientFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ClientFields, _React$Component);

  function ClientFields(props) {
    var _this;

    _classCallCheck(this, ClientFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClientFields).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_countries", void 0);

    var countriesList = _i18nIsoCountries.default.getNames(props.intl.locale);

    _this._countries = Object.keys(countriesList).map(function (v) {
      return {
        value: v,
        preview: countriesList[v]
      };
    });
    return _this;
  }

  _createClass(ClientFields, [{
    key: "render",
    value: function render() {
      var initial = this.props.initial;
      var changes = this.props.changes || {};

      var preview = _objectSpread({}, initial, changes);

      var FirstName = preview.FirstName,
          LastName = preview.LastName,
          OrganizationName = preview.OrganizationName,
          Address = preview.Address,
          PostalCode = preview.PostalCode,
          City = preview.City,
          State = preview.State,
          CellPhone = preview.CellPhone,
          Phone = preview.Phone,
          Email = preview.Email,
          CountryIso = preview.CountryIso;
      var firstName = FirstName || '';
      var lastName = LastName || '';
      var organizationName = OrganizationName || '';
      var address = Address || '';
      var postalCode = PostalCode || '';
      var city = City || '';
      var state = State || '';
      var cellPhone = CellPhone || '';
      var phone = Phone || '';
      var email = Email || '';
      var country = CountryIso || '';
      var _this$props = this.props,
          formatMessage = _this$props.intl.formatMessage,
          onChange = _this$props.onChange,
          user = _this$props.authCtx.user;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Clients');
      return React.createElement(_GridContainer.GridContainer, {
        spacing: 24
      }, React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.firstName),
        value: firstName,
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            FirstName: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.lastName),
        value: lastName,
        onChange: function (_onChange2) {
          function onChange(_x2) {
            return _onChange2.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange2.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            LastName: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.email),
        value: email,
        onChange: function (_onChange3) {
          function onChange(_x3) {
            return _onChange3.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange3.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            Email: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.organizationName),
        value: organizationName,
        onChange: function (_onChange4) {
          function onChange(_x4) {
            return _onChange4.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange4.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            OrganizationName: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        multiline: true,
        label: formatMessage(_ClientFieldsMessages.default.address),
        value: address,
        disabled: !hasRights,
        onChange: function (_onChange5) {
          function onChange(_x5) {
            return _onChange5.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange5.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            Address: e.target.value
          }));
        })
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.postalCode),
        value: postalCode,
        onChange: function (_onChange6) {
          function onChange(_x6) {
            return _onChange6.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange6.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            PostalCode: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.city),
        value: city,
        onChange: function (_onChange7) {
          function onChange(_x7) {
            return _onChange7.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange7.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            City: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.cellPhone),
        value: cellPhone,
        onChange: function (_onChange8) {
          function onChange(_x8) {
            return _onChange8.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange8.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            CellPhone: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.state),
        value: state,
        onChange: function (_onChange9) {
          function onChange(_x9) {
            return _onChange9.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange9.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            State: e.target.value
          }));
        }),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "age-simple"
      }, formatMessage(_ClientFieldsMessages.default.country)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function (_onChange10) {
          function onChange(_x10) {
            return _onChange10.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange10.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            CountryIso: e.target.value
          }));
        }),
        value: country,
        disabled: !hasRights
      }, this._countries.map(function (c) {
        return React.createElement(_core.MenuItem, {
          key: c.value,
          value: c.value
        }, c.preview);
      })))), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_ClientFieldsMessages.default.phone),
        value: phone,
        onChange: function (_onChange11) {
          function onChange(_x11) {
            return _onChange11.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange11.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            Phone: e.target.value
          }));
        }),
        disabled: !hasRights
      })));
    }
  }]);

  return ClientFields;
}(React.Component);

exports.ClientFields = ClientFields;
var _default = ClientFields;
exports.default = _default;
var ClientFieldsStandalone = (0, _reactIntl.injectIntl)(ClientFields);
exports.ClientFieldsStandalone = ClientFieldsStandalone;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.forms.person.firstName",
    "defaultMessage": "First Name"
  },
  lastName: {
    "id": "src.components.forms.person.lastName",
    "defaultMessage": "Last Name"
  },
  organizationName: {
    "id": "src.components.forms.person.organizationName",
    "defaultMessage": "Organization Name"
  },
  address: {
    "id": "src.components.forms.person.address",
    "defaultMessage": "Address"
  },
  postalCode: {
    "id": "src.components.forms.person.postalCode",
    "defaultMessage": "Postal Code"
  },
  city: {
    "id": "src.components.forms.person.city",
    "defaultMessage": "City"
  },
  state: {
    "id": "src.components.forms.person.state",
    "defaultMessage": "State"
  },
  country: {
    "id": "src.components.forms.person.country",
    "defaultMessage": "Country"
  },
  cellPhone: {
    "id": "src.components.forms.person.cellPhone",
    "defaultMessage": "Cell Phone"
  },
  phone: {
    "id": "src.components.forms.person.phone",
    "defaultMessage": "Phone"
  },
  email: {
    "id": "src.components.forms.person.email",
    "defaultMessage": "Email"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactVirtualized = require("react-virtualized");

var _ClientListItem = _interopRequireDefault(require("../ClientListItem/ClientListItem"));

var _services = require("../../../_services");

var _ClientDetail = _interopRequireDefault(require("../ClientDetail/ClientDetail"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var classNames = _interopRequireWildcard(require("classnames"));

var _Filter = require("src/_helpers/Filter");

var _throttleDebounce = require("throttle-debounce");

var _ClientListMesseges = _interopRequireDefault(require("./ClientListMesseges"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var LOCAL_STORAGE_KEY = 'our.orders.ClientList';

var DefaultFilters = function DefaultFilters() {
  return {
    firstName: '',
    lastName: '',
    email: '',
    telephone: '',
    sortAttribute: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute")) || 'Creation',
    sortDirection: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection")) || 'descending'
  };
};

var ClientList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ClientList, _React$Component);

  function ClientList(props) {
    var _this;

    _classCallCheck(this, ClientList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClientList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_loadedRowsMap", {});

    _defineProperty(_assertThisInitialized(_this), "_list", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStartIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStopIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_firstNameInput", void 0);

    _defineProperty(_assertThisInitialized(_this), "_lastNameInput", void 0);

    _defineProperty(_assertThisInitialized(_this), "_emailNameInput", void 0);

    _defineProperty(_assertThisInitialized(_this), "_telephoneNameInput", void 0);

    _this._isRowLoaded = _this._isRowLoaded.bind(_assertThisInitialized(_this));
    _this._loadMore = _this._loadMore.bind(_assertThisInitialized(_this));
    _this._rowRenderer = _this._rowRenderer.bind(_assertThisInitialized(_this));
    _this._handleItemChanged = _this._handleItemChanged.bind(_assertThisInitialized(_this));
    _this._firstNameInput = React.createRef();
    _this._lastNameInput = React.createRef();
    _this._emailNameInput = React.createRef();
    _this._telephoneNameInput = React.createRef();
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh);
    _this.state = {
      filter: DefaultFilters(),
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      drawerOpen: false,
      lastUpdate: new Date().getTime(),
      lightboxes: []
    };
    return _this;
  }

  _createClass(ClientList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      }, function () {
        _this2._loadMore({
          startIndex: 0,
          stopIndex: 0
        }).then(function () {
          return _this2.setState(function () {
            return {
              fetching: false
            };
          });
        });
      });
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this3 = this;

      setTimeout(function () {
        var _prevState$filter = prevState.filter,
            prevSortAttribute = _prevState$filter.sortAttribute,
            prevSortDirection = _prevState$filter.sortDirection;
        var _this3$state$filter = _this3.state.filter,
            sortAttribute = _this3$state$filter.sortAttribute,
            sortDirection = _this3$state$filter.sortDirection;

        if (sortAttribute !== prevSortAttribute) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute"), sortAttribute);
        }

        if (sortDirection !== prevSortDirection) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection"), sortDirection);
        }
      }, 0);
    }
  }, {
    key: "render",
    value: function render() {
      var _this4 = this,
          _classNames;

      var _this$state = this.state,
          rowCount = _this$state.rowCount,
          editing = _this$state.editing,
          creating = _this$state.creating,
          drawerOpen = _this$state.drawerOpen,
          editingOpened = _this$state.editingOpened,
          creatingOpened = _this$state.creatingOpened,
          _this$state$filter = _this$state.filter,
          firstName = _this$state$filter.firstName,
          lastName = _this$state$filter.lastName,
          email = _this$state$filter.email,
          telephone = _this$state$filter.telephone,
          sortDirection = _this$state$filter.sortDirection,
          sortAttribute = _this$state$filter.sortAttribute;
      var _this$props = this.props,
          intl = _this$props.intl,
          templates = _this$props.templateCtx,
          shopCtx = _this$props.shopCtx,
          authCtx = _this$props.authCtx,
          user = _this$props.authCtx.user,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          classes = _this$props.classes,
          usersCtx = _this$props.usersCtx;
      var infiniteLoaderProps = {
        isRowLoaded: this._isRowLoaded,
        loadMoreRows: this._loadMore,
        rowCount: rowCount
      };

      var add = function add() {
        _this4.setState(function () {
          return {
            fetching: true
          };
        }, function () {
          _services.Clients.Empty({}).then(function (empty) {
            return _this4.setState(function () {
              return {
                creating: empty,
                creatingOpened: true,
                fetching: false
              };
            });
          });
        });
      };

      var cancel = function cancel() {
        _this4.setState(function () {
          return {
            creatingOpened: false,
            editingOpened: false
          };
        });
      };

      var firstNameChange = function firstNameChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              firstName: q
            })
          };
        }, _this4._refresh);
      };

      var lastNameChange = function lastNameChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              lastName: q
            })
          };
        }, _this4._refresh);
      };

      var emailChange = function emailChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              email: q
            })
          };
        }, _this4._refresh);
      };

      var telephoneChange = function telephoneChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              telephone: q
            })
          };
        }, _this4._refresh);
      };

      var toggle = function toggle() {
        _this4.setState(function (prev) {
          return {
            drawerOpen: !prev.drawerOpen
          };
        });
      };

      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classes.menu
      }, React.createElement(_core.ListItem, {
        className: classNames(classes.menuItem, classes.menuItemLast, // classes.menuSort,
        (firstName || lastName || email || telephone) && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_ClientListMesseges.default.sortBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon),
        onClick: toggle
      }, React.createElement(_icons.Sort, null)))))), React.createElement(_core.Grid, {
        className: classNames(classes.drawer, (_classNames = {}, _defineProperty(_classNames, classes.drawerOpen, drawerOpen), _defineProperty(_classNames, classes.drawerClose, !drawerOpen), _classNames))
      }, React.createElement(_GridContainer.GridContainer, {
        className: classes.drawerContent,
        direction: "column"
      }, React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: intl.formatMessage(_ClientListMesseges.default.firstName),
        fullWidth: true,
        value: firstName,
        inputRef: this._firstNameInput,
        onChange: firstNameChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: intl.formatMessage(_ClientListMesseges.default.lastName),
        fullWidth: true,
        value: lastName,
        inputRef: this._lastNameInput,
        onChange: lastNameChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: intl.formatMessage(_ClientListMesseges.default.email),
        fullWidth: true,
        value: email,
        inputRef: this._emailNameInput,
        onChange: emailChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        type: "number",
        label: intl.formatMessage(_ClientListMesseges.default.telephone),
        fullWidth: true,
        value: telephone,
        inputRef: this._telephoneNameInput,
        onChange: telephoneChange
      })), React.createElement(_core.Grid, {
        item: true,
        style: {
          marginTop: 'auto',
          display: 'flex'
        }
      }, React.createElement(_core.IconButton, {
        onClick: function onClick() {
          return _this4.setState(function (prev) {
            var dir = prev.filter.sortDirection === 'ascending' ? 'descending' : 'ascending';
            return {
              filter: _objectSpread({}, prev.filter, {
                sortDirection: dir
              })
            };
          }, _this4._refresh);
        }
      }, sortDirection === 'descending' ? React.createElement(_icons.ArrowUpward, null) : React.createElement(_icons.ArrowDownward, null)), React.createElement(_core.TextField, {
        label: intl.formatMessage(_ClientListMesseges.default.sort),
        fullWidth: true,
        value: sortAttribute || '',
        select: true,
        onChange: function onChange(value) {
          var v = value.target.value;

          _this4.setState(function (prev) {
            return {
              filter: _objectSpread({}, prev.filter, {
                sortAttribute: v
              })
            };
          }, _this4._refresh);
        }
      }, ['FirstName', 'LastName', 'OrganizationName', 'City', 'CountryIso', 'State', 'Creation'].map(function (k) {
        return React.createElement(_core.MenuItem, {
          key: k,
          value: k
        }, k);
      }))))), React.createElement("div", {
        className: classes.content
      }, React.createElement(_reactVirtualized.InfiniteLoader, infiniteLoaderProps, function (_ref) {
        var onRowsRendered = _ref.onRowsRendered,
            registerChild = _ref.registerChild;
        return React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
          var h = _ref2.height,
              w = _ref2.width;
          return React.createElement(_reactVirtualized.List, {
            ref: function ref(list) {
              _this4._list = list;
              registerChild(list);
            },
            height: h,
            onRowsRendered: onRowsRendered,
            rowCount: rowCount,
            rowHeight: _this4.state.rowHeight,
            rowRenderer: _this4._rowRenderer,
            width: w,
            style: {
              outline: 'none'
            }
          });
        });
      })), React.createElement(_Fabs.default, {
        map: [this.state.fetching ? 'loading' : (0, _roles.IsAdminOrInRole)(user, 'CRUD_Clients') && {
          icon: React.createElement(_icons.Add, null),
          legend: 'add new',
          onClick: add,
          color: 'primary',
          themeColor: 'green'
        }]
      }), editing >= 0 && React.createElement(_core.Dialog, {
        open: !!editingOpened,
        fullScreen: true,
        onClose: cancel
      }, React.createElement(_ClientDetail.default, _extends({
        intl: intl,
        usersCtx: usersCtx,
        shopCtx: shopCtx,
        authCtx: authCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templates
      }, {
        id: this._loadedRowsMap[editing].Id,
        preview: this._loadedRowsMap[editing],
        onCancel: function onCancel() {
          _this4.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onChanged: function onChanged(client) {
          _this4._handleItemChanged(client, editing);
        },
        onDelete: function onDelete() {
          _this4._handleOrderDeleted();
        },
        key: editing
      }))), creating && React.createElement(_core.Dialog, {
        open: !!creatingOpened,
        fullScreen: true,
        onClose: close
      }, React.createElement(_ClientDetail.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        usersCtx: usersCtx,
        authCtx: authCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templates
      }, {
        preview: creating,
        onCancel: function onCancel() {
          _this4.setState(function () {
            return {
              editing: -1,
              creatingOpened: false
            };
          });
        },
        onChanged: function onChanged() {
          _this4._resetFilters();
        },
        onDelete: function onDelete() {
          _this4._handleOrderDeleted();
        }
      }))));
    }
  }, {
    key: "_rowRenderer",
    value: function _rowRenderer(props) {
      var _this5 = this;

      var intl = this.props.intl;
      var index = props.index;
      var client = this._loadedRowsMap[index];
      return React.createElement("div", {
        key: "".concat(props.key, "-").concat(this.state.lastUpdate),
        style: props.style
      }, React.createElement(_ClientListItem.default, {
        client: client,
        intl: intl,
        onClick: client ? function () {
          return _this5.setState(function () {
            return {
              editing: index,
              editingOpened: true
            };
          });
        } : undefined
      }));
    }
  }, {
    key: "_loadMore",
    value: function _loadMore(range) {
      var _this6 = this;

      var stopIndex = range.stopIndex,
          startIndex = range.startIndex;
      this._loadMoreRowsStartIndex = startIndex;
      this._loadMoreRowsStopIndex = stopIndex; // const { filter: { query, sortAttribute, sortDirection } } = this.state;

      var _this$state$filter2 = this.state.filter,
          firstName = _this$state$filter2.firstName,
          lastName = _this$state$filter2.lastName,
          telephone = _this$state$filter2.telephone,
          email = _this$state$filter2.email,
          sortAttribute = _this$state$filter2.sortAttribute,
          sortDirection = _this$state$filter2.sortDirection;
      var filters = [];

      if (firstName) {
        filters.push(_Filter.Filter.Like('FirstName', firstName));
      }

      if (lastName) {
        filters.push(_Filter.Filter.Like('LastName', lastName));
      }

      if (email) {
        filters.push(_Filter.Filter.Like('Email', email));
      }

      if (telephone) {
        filters.push(_Filter.Filter.Or(_Filter.Filter.Like('Phone', telephone), _Filter.Filter.Like('CellPhone', telephone)));
      }

      var delta = stopIndex - startIndex;
      this.setState(function (prev) {
        return {
          loading: prev.loading + delta,
          fetching: true
        };
      });
      return _services.Clients.Find({
        filters: filters,
        operator: 'and',
        // query: query,
        sort: "".concat(sortDirection === 'ascending' ? '' : '-').concat(sortAttribute)
      }, startIndex, stopIndex + 1).then(function (response) {
        var count = response.Values.length;
        response.Values.forEach(function (client, i) {
          _this6._loadedRowsMap[startIndex + i] = client;
        });

        _this6.setState(function (prev) {
          return {
            loading: prev.loading - count,
            loaded: prev.loaded + count,
            rowCount: response.Count,
            fetching: false,
            lastUpdate: new Date().getTime()
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this7 = this;

      this._loadedRowsMap = {};

      if (this._list) {
        this._list.forceUpdate();

        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: -1,
          rowCount: 0,
          loaded: 0,
          loading: 0,
          lastUpdate: new Date().getTime()
        };
      }, function () {
        _this7._loadMore({
          startIndex: _this7._loadMoreRowsStartIndex,
          stopIndex: _this7._loadMoreRowsStopIndex
        }).then(function () {
          if (_this7._list) {
            _this7._list.forceUpdate();

            _this7._list.forceUpdateGrid();
          }
        });
      });
    }
  }, {
    key: "_resetFilters",
    value: function _resetFilters() {
      var _this8 = this;

      this.setState(function () {
        return {
          filter: DefaultFilters()
        };
      }, function () {
        return _this8._refresh();
      });
    }
  }, {
    key: "_handleItemChanged",
    value: function _handleItemChanged(client, index) {
      this._loadedRowsMap[index] = client;

      if (this._list) {
        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: index,
          lastUpdate: new Date().getTime()
        };
      });
    }
  }, {
    key: "_handleOrderDeleted",
    value: function _handleOrderDeleted() {
      var _this9 = this;

      this.setState(function () {
        return {
          editing: -1
        };
      }, function () {
        return _this9._refresh();
      });
    }
  }, {
    key: "_isRowLoaded",
    value: function _isRowLoaded(ind) {
      // No entry in this map signifies that the row has never been loaded before
      return !!this._loadedRowsMap[ind.index];
    }
  }]);

  return ClientList;
}(React.Component);

var drawerWidth = '16rem';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    menu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      zIndex: theme.zIndex.drawer + 1,
      display: 'flex',
      flexDirection: 'column',
      boxSizing: 'border-box'
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative',
      padding: '0 40px'
    },
    menuSort: {
      marginTop: 'auto'
    },
    drawer: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    drawerContent: {
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    drawerOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    drawerClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItem: {
      paddingRight: theme.spacing.unit,
      paddingLeft: theme.spacing.unit,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      flex: '0 0 auto',
      opacity: 0.5,
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    tooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      fontSize: 11
    }
  };
})(ClientList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ClientListMesseges = void 0;

var _reactIntl = require("react-intl");

var ClientListMesseges = (0, _reactIntl.defineMessages)({
  sortBtn: {
    "id": "src.components.orders.orderList.sortBtn",
    "defaultMessage": "Sort and Filters"
  },
  firstName: {
    "id": "src.components.orders.orderList.firstName",
    "defaultMessage": "First Name"
  },
  lastName: {
    "id": "src.components.orders.orderList.lastName",
    "defaultMessage": "Last Name"
  },
  email: {
    "id": "src.components.orders.orderList.toDispatch",
    "defaultMessage": "Email"
  },
  telephone: {
    "id": "src.components.orders.orderList.payments",
    "defaultMessage": "Telephone"
  },
  sort: {
    "id": "src.components.orders.orderList.sort",
    "defaultMessage": "Sort"
  }
});
exports.ClientListMesseges = ClientListMesseges;
var _default = ClientListMesseges;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ClientListItem = void 0;

var React = _interopRequireWildcard(require("react"));

var md5 = _interopRequireWildcard(require("md5"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

var ClientListItem = function ClientListItem(props) {
  var onClick = props.onClick,
      client = props.client,
      classes = props.classes;

  if (!client) {
    return React.createElement("div", {
      className: classes.container
    }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, null), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
      loading: true
    }), React.createElement(_ItemPreview.Line, {
      loading: true
    }))));
  }

  var md5Hash = client.Email ? md5(client.Email) : '';
  return React.createElement("div", {
    onClick: onClick,
    className: classes.container
  }, React.createElement(_ItemPreview.default, null, React.createElement(_core.Avatar, {
    src: "https://www.gravatar.com/avatar/".concat(md5Hash, "?d=mm")
  }), React.createElement("div", {
    className: "clients-list-item__lines"
  }, React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, client.FirstName && React.createElement("span", {
    className: classNames(classes.spacing, classes.bold)
  }, client.FirstName), client.LastName && React.createElement("span", {
    className: classNames(classes.spacing, classes.bold)
  }, client.LastName), client.OrganizationName && React.createElement("span", null, client.OrganizationName)), React.createElement(_ItemPreview.Line, null, client.Address && React.createElement("span", {
    className: classes.spacing
  }, client.Address), client.PostalCode && React.createElement("span", {
    className: classes.spacing
  }, client.PostalCode), client.City && React.createElement("span", {
    className: classes.spacing
  }, client.City), client.CountryIso && React.createElement("span", null, client.CountryIso)), React.createElement(_ItemPreview.Line, null, client.Email && React.createElement("a", {
    className: classes.spacing,
    href: "mailto:".concat(client.Email)
  }, client.Email), client.CellPhone && React.createElement("span", {
    className: classes.spacing
  }, client.CellPhone), !client.CellPhone && client.Phone && React.createElement("span", null, client.Phone))))));
};

exports.ClientListItem = ClientListItem;

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2
    },
    bold: {
      fontWeight: 'bold',
      color: 'black'
    },
    spacing: {
      marginRight: theme.spacing.unit
    }
  };
})(ClientListItem);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ContentView = void 0;

var React = _interopRequireWildcard(require("react"));

var _Tab = require("./Tab");

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ContentView =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ContentView, _React$Component);

  function ContentView(props) {
    var _this;

    _classCallCheck(this, ContentView);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ContentView).call(this, props));

    var intiKey = _this.props.InitKey || localStorage.getItem('activeKey') || _this.props.Tabs[0].Key;

    _this.state = {
      ActiveKey: intiKey,
      showMore: false
    };
    return _this;
  }

  _createClass(ContentView, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      if (!this.props.Tabs.length) {
        return null;
      }

      var _this$state = this.state,
          ActiveKey = _this$state.ActiveKey,
          showMore = _this$state.showMore;
      var _this$props = this.props,
          Tabs = _this$props.Tabs,
          classes = _this$props.classes;
      var activeTabs = Tabs.find(function (t) {
        return t.Key === ActiveKey;
      }) || Tabs[0];
      var activeTab = activeTabs.View;
      var tabMoreTitle = showMore ? 'Less' : 'More';
      return React.createElement("div", {
        className: classes.contentView
      }, React.createElement("div", {
        className: classes.view
      }, activeTab), React.createElement("div", {
        className: classes.tabs
      }, React.createElement("div", {
        className: classNames(classes.tabsContainer, showMore && classes.tabsContainerShow)
      }, Tabs.map(function (t) {
        return _this2._renderTab(t, ActiveKey);
      }), React.createElement(_Tab.ContentViewTab, _extends({
        key: "content-view__tab--more"
      }, {
        title: tabMoreTitle,
        id: 'more',
        active: this.state.showMore,
        onClick: function onClick() {
          return _this2._handleMoreClick();
        },
        icon: React.createElement(_icons.MoreHoriz, null)
      })))));
    }
  }, {
    key: "_handleTabClick",
    value: function _handleTabClick(tab) {
      this.setState(function (prev) {
        return {
          ActiveKey: tab.Key
        };
      });
      localStorage.setItem('activeKey', tab.Key);
    }
  }, {
    key: "_handleMoreClick",
    value: function _handleMoreClick() {
      this.setState(function (prev) {
        return {
          showMore: !prev.showMore
        };
      });
    }
  }, {
    key: "_renderTab",
    value: function _renderTab(tab, activeKey) {
      var _this3 = this;

      var key = "content-view__tab--".concat(tab.Key);
      var active = tab.Key === activeKey; // const { classes } = this.props;
      // const classnames = ['content-view__tab', key];
      // if (active) {
      //     classnames.push('content-view__tab--active');
      // }

      return React.createElement(_Tab.ContentViewTab, _extends({
        key: key
      }, {
        title: tab.Title,
        id: tab.Key,
        active: active,
        onClick: function onClick() {
          return _this3._handleTabClick(tab);
        },
        icon: tab.Icon
      }));
    }
  }]);

  return ContentView;
}(React.Component);

exports.ContentView = ContentView;
var heightTabsBarTablet = 60;

var _default = (0, _core.withStyles)(function (theme) {
  return {
    contentView: {
      position: 'relative',
      height: '100%',
      overflow: 'hidden',
      zIndex: 0,
      background: 'white'
    },
    view: {
      height: '100%',
      paddingBottom: heightTabsBarTablet,
      boxSizing: 'border-box',
      zIndex: 0,
      position: 'relative'
    },
    tabs: {
      position: 'absolute',
      left: 0,
      right: 0,
      bottom: 0,
      height: heightTabsBarTablet,
      zIndex: 1,
      boxShadow: '0px -2px 3px rgba(0, 0, 0, 0.15)'
    },
    tabsContainer: {
      display: 'flex',
      flexWrap: 'wrap',
      justifyContent: 'space-around',
      transition: 'all 0.2s ease',
      background: '#F0F0F0'
    },
    tabsContainerShow: {
      transform: 'translateY(-100%)',
      marginTop: heightTabsBarTablet
    },
    orders: {
      position: 'relative',
      display: 'flex',
      flexDirection: 'column',
      flexWrap: 'nowrap',
      height: '100%'
    }
  };
})(ContentView);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ContentViewTab = exports.ContentViewTabWithStyles = void 0;

var React = _interopRequireWildcard(require("react"));

require("./styles.css");

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ContentViewTabWithStyles =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ContentViewTabWithStyles, _React$Component);

  function ContentViewTabWithStyles(props) {
    var _this;

    _classCallCheck(this, ContentViewTabWithStyles);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ContentViewTabWithStyles).call(this, props));
    _this._handleClick = _this._handleClick.bind(_assertThisInitialized(_this));
    return _this;
  }

  _createClass(ContentViewTabWithStyles, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          classes = _this$props.classes,
          active = _this$props.active; // const cls: string[] = [
      //     'tab',
      //     `tab--${this.props.id}`
      // ];
      // if (this.props.active) {
      //     cls.push('tab--active');
      // }

      return React.createElement("a", {
        className: classNames(classes.tab, active && classes.active, "tab--".concat(this.props.id)),
        onClick: this._handleClick
      }, React.createElement("span", {
        className: classes.icon
      }, React.createElement("span", {
        className: classes.iconInner
      }, this.props.icon)), React.createElement("span", {
        className: classes.title
      }, this.props.title));
    }
  }, {
    key: "_handleClick",
    value: function _handleClick(e) {
      e.preventDefault();
      this.props.onClick();
    }
  }]);

  return ContentViewTabWithStyles;
}(React.Component);

exports.ContentViewTabWithStyles = ContentViewTabWithStyles;
var heightTabsBarTablet = 60;
var tabWidth = 80; // const tabsCount = 8;

var tabPadding = '0.5rem';
var ContentViewTab = (0, _core.withStyles)(function (theme) {
  return {
    tab: {
      height: heightTabsBarTablet,
      width: tabWidth,
      fontSize: '0.7rem',
      padding: tabPadding,
      boxSizing: 'border-box',
      color: 'gray',
      cursor: 'pointer',
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      '&.tab--more': {
        display: 'none !important'
      }
    },
    active: {
      color: 'black'
    },
    icon: {
      display: 'flex',
      flexBasis: '60%',
      alignItems: 'center',
      fontSize: '1.4rem'
    },
    iconInner: {
      width: '100%',
      height: '100%'
    },
    title: {}
  };
})(ContentViewTabWithStyles);
exports.ContentViewTab = ContentViewTab;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _exportNames = {
  ContentViewTab: true
};
Object.defineProperty(exports, "ContentViewTab", {
  enumerable: true,
  get: function get() {
    return _ContentViewTab.ContentViewTab;
  }
});

var _ContentViewTab = require("./ContentViewTab");

Object.keys(_ContentViewTab).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ContentViewTab[key];
    }
  });
});
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _exportNames = {};
Object.defineProperty(exports, "default", {
  enumerable: true,
  get: function get() {
    return _ContentView.default;
  }
});

var _ContentView = _interopRequireWildcard(require("./ContentView"));

Object.keys(_ContentView).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _ContentView[key];
    }
  });
});

var _Tab = require("./Tab");

Object.keys(_Tab).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _Tab[key];
    }
  });
});

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _core = require("@material-ui/core");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var CurrenciesField = function CurrenciesField(props) {
  var Currencies = props.settingsCtx.Settings.Currencies,
      textFieldProps = _objectWithoutProperties(props, ["settingsCtx"]);

  if (Currencies.length <= 1) {
    return React.createElement(_TextField.default, _extends({}, textFieldProps, {
      disabled: true
    }));
  }

  return React.createElement(_TextField.default, _extends({}, textFieldProps, {
    select: true
  }), Currencies.map(function (c) {
    return React.createElement(_core.MenuItem, {
      key: c.Code,
      value: c.Code
    }, c.Name);
  }));
};

var _default = CurrenciesField;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _core = require("@material-ui/core");

var _ListItem = _interopRequireDefault(require("@material-ui/core/ListItem"));

var _icons = require("@material-ui/icons");

var classNames = _interopRequireWildcard(require("classnames"));

var _GridContainer = require("../GridContainer/GridContainer");

var _services = require("src/_services");

var _reactVirtualized = require("react-virtualized");

var _recharts = require("recharts");

var moment = _interopRequireWildcard(require("moment"));

var _DashboardMessages = require("./DashboardMessages");

var _materialUiPickers = require("material-ui-pickers");

var _ProductList = _interopRequireDefault(require("../Products/ProductList/ProductList"));

var _Fabs = _interopRequireDefault(require("../Fabs/Fabs"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var LOCAL_STORAGE_KEY = 'our.orders.Dashboard';

var Dashboard =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Dashboard, _React$Component);

  function Dashboard(props) {
    var _this;

    _classCallCheck(this, Dashboard);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Dashboard).call(this, props));
    var now = moment().utc();
    _this.state = {
      labels: [],
      customPeriodFrom: moment.utc(localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".customPeriodFrom")) || now.clone().subtract(15, 'days')).toDate(),
      customPeriodTo: moment.utc(localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".customPeriodTo")) || now.clone()).toDate(),
      metric: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".metric")) || 'Amount',
      period: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".period")) || 'thismonth',
      dimension: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".dimension")) || 'Shops',
      graphType: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".graphType")) || 'lines'
    };
    return _this;
  }

  _createClass(Dashboard, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._fetch();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this2 = this;

      setTimeout(function () {
        var olddimension = prevState.dimension,
            oldmetric = prevState.metric,
            oldperiod = prevState.period,
            oldcustomPeriodFrom = prevState.customPeriodFrom,
            oldcustomPeriodTo = prevState.customPeriodTo,
            oldgraphType = prevState.graphType;
        var _this2$state = _this2.state,
            dimension = _this2$state.dimension,
            metric = _this2$state.metric,
            period = _this2$state.period,
            customPeriodFrom = _this2$state.customPeriodFrom,
            customPeriodTo = _this2$state.customPeriodTo,
            graphType = _this2$state.graphType;

        if (olddimension !== dimension) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".dimension"), dimension);
        }

        if (oldmetric !== metric) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".metric"), metric);
        }

        if (oldperiod !== period) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".period"), period);
        }

        if (oldcustomPeriodFrom.toString() !== customPeriodFrom.toString()) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".customPeriodFrom"), customPeriodFrom.toString());
        }

        if (oldcustomPeriodTo.toString() !== customPeriodTo.toString()) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".customPeriodTo"), customPeriodTo.toString());
        }

        if (oldgraphType.toString() !== graphType.toString()) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".graphType"), graphType.toString());
        }
      }, 0);
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this,
          _classNames;

      var _this$props = this.props,
          classes = _this$props.classes,
          formatMessage = _this$props.intl.formatMessage,
          Shops = _this$props.shopCtx.Shops,
          Users = _this$props.usersCtx.Users,
          categoryCtx = _this$props.categoryCtx,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          productCtx = _this$props.productCtx,
          products = _this$props.productCtx.products,
          intl = _this$props.intl;
      var _this$state = this.state,
          submenuOpen = _this$state.submenuOpen,
          productListOpened = _this$state.productListOpened,
          labels = _this$state.labels,
          metric = _this$state.metric,
          period = _this$state.period,
          dimension = _this$state.dimension,
          data = _this$state.data,
          graphType = _this$state.graphType,
          customPeriodFrom = _this$state.customPeriodFrom,
          customPeriodTo = _this$state.customPeriodTo,
          customPeriodOpened = _this$state.customPeriodOpened,
          selectMultiple = _this$state.selectMultiple;
      var shopsActive = dimension === 'Shops';
      var usersActive = dimension === 'Users';
      var productsActive = dimension === 'Products'; // const openPicker = () => this.setState(() => ({ timePickerOpened: true }));

      var changePeriod = function changePeriod(p) {
        _this3.setState(function () {
          return {
            period: p,
            customPeriodOpened: p === 'custom'
          };
        }, function () {
          return _this3._fetch();
        });
      };

      var toggleLabel = function toggleLabel(label) {
        return function () {
          _this3.setState(function (prev) {
            var lbls = prev.labels.indexOf(label) >= 0 ? prev.labels.filter(function (l) {
              return l !== label;
            }) : [label];
            return {
              selectMultiple: lbls.length > 1 ? true : false,
              labels: lbls,
              productListOpened: false,
              data: prev.report ? _this3._getData(prev.report, lbls, prev.period) : prev.data
            };
          });
        };
      };

      var toggleLabels = function toggleLabels(label) {
        return function () {
          _this3.setState(function (prev) {
            var lbls = prev.labels.indexOf(label) >= 0 ? prev.labels.filter(function (l) {
              return l !== label;
            }) : [].concat(_toConsumableArray(prev.labels), [label]);
            return {
              selectMultiple: lbls.length < 1 ? false : true,
              labels: lbls,
              productListOpened: false,
              data: prev.report ? _this3._getData(prev.report, lbls, prev.period) : prev.data
            };
          });
        };
      };

      var confirmProducts = function confirmProducts() {
        _this3.setState(function (prev) {
          return {
            productListOpened: false,
            submenuOpen: true,
            data: prev.report ? _this3._getData(prev.report, prev.labels, prev.period) : prev.data
          };
        });
      };

      var openProducts = function openProducts() {
        _this3.setState(function () {
          return {
            productListOpened: true
          };
        });
      };

      var changeDimension = function changeDimension(d) {
        _this3.setState(function (prev) {
          return {
            dimension: d,
            labels: [],
            submenuOpen: prev.dimension === d ? !prev.submenuOpen : true
          };
        }, function () {
          return _this3._fetch();
        });
      };

      var closeProductList = function closeProductList() {
        return _this3.setState(function () {
          return {
            productListOpened: false
          };
        });
      };

      var values = data && data.values;
      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classes.menu
      }, React.createElement(_ListItem.default, {
        onClick: function onClick() {
          return changeDimension('Shops');
        },
        className: classNames(classes.menuItem, shopsActive && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_DashboardMessages.DashboardMessages.shopsBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, null, React.createElement(_icons.Store, null)))), React.createElement(_ListItem.default, {
        onClick: function onClick() {
          return changeDimension('Users');
        },
        className: classNames(classes.menuItem, usersActive && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_DashboardMessages.DashboardMessages.usersBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, null, React.createElement(_icons.People, null)))), React.createElement(_ListItem.default, {
        onClick: function onClick() {
          openProducts();
          changeDimension('Products');
        },
        className: classNames(classes.menuItem, productsActive && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_DashboardMessages.DashboardMessages.productsBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, null, React.createElement(_icons.Layers, null)))))), React.createElement(_core.Grid, {
        item: true,
        className: classNames(classes.submenu, (_classNames = {}, _defineProperty(_classNames, classes.submenuOpen, submenuOpen), _defineProperty(_classNames, classes.submenuClose, !submenuOpen), _classNames))
      }, React.createElement(_core.List, {
        className: classes.submenuContent
      }, shopsActive && Shops.map(function (shop) {
        return React.createElement(_ListItem.default, {
          key: "shop-".concat(shop.Id),
          button: true,
          className: classNames(classes.menuItem, labels.indexOf(shop.Id) >= 0 && classes.menuItemActive)
        }, React.createElement("div", {
          className: classes.listItemIconWrapper
        }, React.createElement(_core.ListItemIcon, {
          className: classNames(classes.listItemIcon, classes.listItemIconPerson)
        }, selectMultiple ? labels.indexOf(shop.Id) >= 0 ? React.createElement(_icons.CheckBox, null) : React.createElement(_icons.CheckBoxOutlineBlank, null) : React.createElement(_icons.Store, null)), React.createElement(_core.ListItemIcon, {
          className: classNames(classes.listItemIcon, classes.listItemIconCheckbox),
          onClick: toggleLabels(shop.Id)
        }, labels.indexOf(shop.Id) >= 0 ? React.createElement(_icons.CheckBox, null) : React.createElement(_icons.CheckBoxOutlineBlank, null))), React.createElement(_core.ListItemText, {
          className: classes.listItemText,
          onClick: toggleLabel(shop.Id)
        }, shop.Name));
      }), usersActive && Users.map(function (user) {
        return React.createElement(_ListItem.default, {
          key: "user-".concat(user.Id),
          button: true,
          className: classNames(classes.menuItem, labels.indexOf(user.Id) >= 0 && classes.menuItemActive)
        }, React.createElement("div", {
          className: classes.listItemIconWrapper
        }, React.createElement(_core.ListItemIcon, {
          className: classNames(classes.listItemIcon, classes.listItemIconPerson)
        }, selectMultiple ? labels.indexOf(user.Id) >= 0 ? React.createElement(_icons.CheckBox, null) : React.createElement(_icons.CheckBoxOutlineBlank, null) : React.createElement(_icons.Person, null)), React.createElement(_core.ListItemIcon, {
          className: classNames(classes.listItemIcon, classes.listItemIconCheckbox),
          onClick: toggleLabels(user.Id)
        }, labels.indexOf(user.Id) >= 0 ? React.createElement(_icons.CheckBox, null) : React.createElement(_icons.CheckBoxOutlineBlank, null))), React.createElement(_core.ListItemText, {
          onClick: toggleLabel(user.Id),
          className: classes.listItemText
        }, user.FirstName, " ", user.LastName));
      }), productsActive && React.createElement(React.Fragment, null, labels.map(function (l) {
        var product = products.find(function (p) {
          return p.Id === l;
        });
        return product ? React.createElement(_ListItem.default, {
          key: "product-".concat(product.Id),
          button: true,
          onClick: toggleLabel(product.Id),
          className: classNames(classes.menuItem)
        }, product.Src && React.createElement(_core.ListItemIcon, null, React.createElement(_core.Avatar, {
          src: product.Src
        })), React.createElement(_core.ListItemText, {
          className: classes.listItemText
        }, product.Title)) : null;
      }), React.createElement(_core.Dialog, {
        open: !!productListOpened,
        fullScreen: true,
        onClose: closeProductList
      }, React.createElement(_ProductList.default, {
        productCtx: productCtx,
        categoryCtx: categoryCtx,
        warehouseCtx: warehouseCtx,
        intl: intl,
        settingsCtx: settingsCtx,
        selectedIds: labels,
        showFavorite: false,
        onClick: function onClick(p) {
          _this3.setState(function () {
            return {
              labels: [p.Id]
            };
          }, confirmProducts);
        },
        onSelect: function onSelect(selected) {
          var remove = labels.indexOf(selected.Id) >= 0;

          _this3.setState(function (prev) {
            return {
              labels: remove ? prev.labels.filter(function (p) {
                return p !== selected.Id;
              }) : [].concat(_toConsumableArray(prev.labels), [selected.Id])
            };
          });
        }
      }), React.createElement(_Fabs.default, {
        map: [labels.length ? {
          icon: React.createElement(_icons.Check, null),
          legend: 'confirm select',
          themeColor: 'green',
          onClick: confirmProducts
        } : undefined]
      }))))), data && React.createElement("div", {
        className: classes.main
      }, React.createElement("div", {
        className: classes.mainInner
      }, React.createElement(_GridContainer.GridContainer, {
        style: {
          height: '100%',
          flexWrap: 'nowrap'
        }
      }, React.createElement(_core.List, {
        className: classes.chartSideBar
      }, React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick() {
          return _this3.setState(function () {
            return {
              metric: 'Amount'
            };
          });
        },
        className: classNames(classes.menuItem, metric === 'Amount' && classes.menuItemActive)
      }, React.createElement(_core.ListItemText, null, React.createElement(_reactIntl.FormattedMessage, _DashboardMessages.DashboardMessages.amount), " ", React.createElement("br", null), React.createElement(_reactIntl.FormattedNumber, {
        value: data.global.Amount,
        style: "currency",
        currency: data.currency
      }))), React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick() {
          return _this3.setState(function () {
            return {
              metric: 'Sales'
            };
          });
        },
        className: classNames(classes.menuItem, metric === 'Sales' && classes.menuItemActive)
      }, React.createElement(_core.ListItemText, null, React.createElement(_reactIntl.FormattedMessage, _DashboardMessages.DashboardMessages.sales), " ", React.createElement("br", null), data.global.Sales)), React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick() {
          return _this3.setState(function () {
            return {
              metric: 'Units'
            };
          });
        },
        className: classNames(classes.menuItem, metric === 'Units' && classes.menuItemActive)
      }, React.createElement(_core.ListItemText, null, React.createElement(_reactIntl.FormattedMessage, _DashboardMessages.DashboardMessages.units), " ", React.createElement("br", null), data.global.Units)), React.createElement(_ListItem.default, {
        button: true,
        className: classNames(classes.menuItem, classes.menuItemLast)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.AccessTime, null)), React.createElement(_core.Select, {
        id: "timepicker",
        fullWidth: true,
        value: period,
        onChange: function onChange(e) {
          var v = e.target.value;
          changePeriod(v);
        },
        classes: {
          select: classes.periodSelect,
          icon: classes.periodSelectIcon
        },
        disableUnderline: true
      }, ['today', 'yesterday', 'thisweek', 'lastweek', 'thismonth', 'lastmonth', 'thisyear', 'lastyear', 'last7days', 'last30days', 'last5years'].map(function (v) {
        return React.createElement(_core.MenuItem, {
          key: v,
          value: v
        }, formatMessage(_DashboardMessages.DashboardMessages[v]));
      }), React.createElement(_core.MenuItem, {
        key: "custom",
        value: "custom"
      }, React.createElement(_reactIntl.FormattedDate, {
        value: customPeriodFrom
      }), React.createElement("br", null), React.createElement(_reactIntl.FormattedDate, {
        value: customPeriodTo
      })))), period === 'custom' && React.createElement(React.Fragment, null, React.createElement(_core.Dialog, {
        open: !!customPeriodOpened,
        onClose: function onClose() {
          return _this3.setState(function () {
            return {
              customPeriodOpened: undefined
            };
          });
        }
      }, React.createElement(_core.DialogTitle, null, formatMessage(_DashboardMessages.DashboardMessages.customTimePeriodTitle)), React.createElement(_core.DialogContent, null, React.createElement(_materialUiPickers.DateTimePicker, {
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: customPeriodFrom,
        onChange: function onChange(value) {
          return _this3.setState(function () {
            return {
              customPeriodFrom: value
            };
          });
        },
        disableOpenOnEnter: true,
        animateYearScrolling: false,
        label: formatMessage(_DashboardMessages.DashboardMessages.customTimePeriodTo)
      }), React.createElement(_materialUiPickers.DateTimePicker, {
        fullWidth: true,
        keyboard: true,
        minDate: customPeriodFrom,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: customPeriodTo,
        onChange: function onChange(value) {
          return _this3.setState(function () {
            return {
              customPeriodTo: value
            };
          });
        },
        disableOpenOnEnter: true,
        animateYearScrolling: false,
        label: formatMessage(_DashboardMessages.DashboardMessages.customTimePeriodFrom)
      })), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        onClick: function onClick() {
          return _this3.setState(function () {
            return {
              customPeriodOpened: undefined
            };
          });
        }
      }, formatMessage(_DashboardMessages.DashboardMessages.customTimePeriodSubmit))))), React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick() {
          return _this3.setState(function (prev) {
            return {
              graphType: prev.graphType === 'lines' ? 'pie' : 'lines'
            };
          });
        },
        className: classNames(classes.menuItem)
      }, React.createElement(_core.ListItemIcon, null, graphType === 'pie' ? React.createElement(_icons.PieChart, null) : React.createElement(_icons.ShowChart, null)), React.createElement(_core.ListItemText, null, graphType === 'pie' ? React.createElement(_reactIntl.FormattedMessage, _DashboardMessages.DashboardMessages.pie) : React.createElement(_reactIntl.FormattedMessage, _DashboardMessages.DashboardMessages.chart)))), React.createElement(_core.Grid, {
        item: true,
        style: {
          height: '100%',
          flex: '1 0 auto'
        }
      }, graphType === 'lines' && React.createElement(_reactVirtualized.AutoSizer, null, function (_ref) {
        var width = _ref.width,
            height = _ref.height;
        return React.createElement(_recharts.LineChart, {
          width: width,
          height: height,
          data: _toConsumableArray(values)
        }, React.createElement(_recharts.Line, {
          type: "monotone",
          dataKey: metric,
          className: classes.line
        }), React.createElement(_recharts.Tooltip, {
          content: function content(p) {
            if (!p.payload || !p.payload.length) {
              return null;
            }

            var name = p.payload[0].name; // tslint:disable-next-line:no-any

            var payload = p.payload[0];
            var lbl = payload && payload.payload && payload.payload.label || name;
            var v = p.payload[0].value;
            return React.createElement("div", {
              className: classes.chartTooltip
            }, React.createElement("div", {
              className: classes.chartTooltipTitle
            }, lbl), metric === 'Amount' ? React.createElement(_reactIntl.FormattedNumber, {
              value: v,
              style: "currency",
              currency: data.currency
            }) : v);
          }
        }));
      }), graphType === 'pie' && React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
        var width = _ref2.width,
            height = _ref2.height;
        return React.createElement(_recharts.PieChart, {
          width: width,
          height: height
        }, React.createElement(_recharts.Pie, {
          data: _toConsumableArray(values),
          dataKey: metric,
          className: classes.pie
        }), React.createElement(_recharts.Tooltip, {
          content: function content(p) {
            if (!p.payload || !p.payload.length) {
              return null;
            }

            var name = p.payload[0].name;
            var lbl = values[name] && values[name].label || name;
            var v = p.payload[0].value;
            return React.createElement("div", {
              className: classes.chartTooltip
            }, React.createElement("div", {
              className: classes.chartTooltipTitle
            }, lbl), metric === 'Amount' ? React.createElement(_reactIntl.FormattedNumber, {
              value: v,
              style: "currency",
              currency: data.currency
            }) : v);
          }
        }));
      }))))));
    }
  }, {
    key: "_getData",
    value: function _getData(report, labels, period) {
      var t = this._getTime(period);

      var formatDate = function formatDate(date) {
        var d = moment(date);

        switch (t.interval) {
          case 'Day':
            return d.format('ddd ll');

          case 'Hour':
            return d.format('LT');

          case 'Month':
            return d.format('MMMM');

          case 'Week':
            return d.format('ddd ll');

          case 'Year':
            return d.format('YYYY');

          default:
            return '';
        }
      };

      var totalPeriod = function totalPeriod(p) {
        var periodObj = p.Dimension;
        var allKeys = Object.keys(periodObj);
        var keys = labels.length ? labels : allKeys;
        return {
          Amount: keys.length ? keys.map(function (k) {
            return periodObj[k] && periodObj[k].Amount || 0;
          }).reduce(function (a, b) {
            return a + b;
          }) : 0,
          Sales: keys.length ? keys.map(function (k) {
            return periodObj[k] && periodObj[k].Sales || 0;
          }).reduce(function (a, b) {
            return a + b;
          }) : 0,
          Units: keys.length ? keys.map(function (k) {
            return periodObj[k] && periodObj[k].Units || 0;
          }).reduce(function (a, b) {
            return a + b;
          }) : 0,
          Expected: keys.length ? keys.map(function (k) {
            return periodObj[k] && periodObj[k].Expected || 0;
          }).reduce(function (a, b) {
            return a + b;
          }) : 0,
          label: formatDate(p.StartDate)
        };
      };

      var values = report.Report.map(totalPeriod);
      var data = {
        currency: report.Currency,
        values: values,
        global: values.length ? values.reduce(function (totalPeriod1, totalPeriod2) {
          return {
            Amount: totalPeriod1.Amount + totalPeriod2.Amount,
            Sales: totalPeriod1.Sales + totalPeriod2.Sales,
            Units: totalPeriod1.Units + totalPeriod2.Units,
            Expected: totalPeriod1.Expected + totalPeriod2.Expected,
            label: totalPeriod1.label
          };
        }) : {
          Amount: 0,
          Sales: 0,
          Units: 0,
          Expected: 0,
          label: ''
        }
      };
      return data;
    }
  }, {
    key: "_fetch",
    value: function _fetch() {
      var _this4 = this;

      var _this$state2 = this.state,
          period = _this$state2.period,
          dimension = _this$state2.dimension;
      this.setState(function () {
        return {
          fetching: true
        };
      });

      var p = this._getTime(period);

      var type = dimension === 'Products' ? 'Product' : 'Order';

      _services.Orders.GetReport(type, dimension, p.start, p.count, p.interval).then(function (report) {
        _this4.setState(function (prev) {
          return {
            report: report,
            data: _this4._getData(report, prev.labels, prev.period)
          };
        });
      });
    }
  }, {
    key: "_getTime",
    value: function _getTime(period) {
      var _this$state3 = this.state,
          customPeriodFrom = _this$state3.customPeriodFrom,
          customPeriodTo = _this$state3.customPeriodTo;
      var now = moment();
      var today = now.clone().startOf('day');

      switch (period) {
        case 'today':
          {
            var _start = today;
            var _interval = 'Hour';

            var _count = now.diff(_start, 'hours') + 1;

            return {
              start: _start.toDate(),
              count: _count,
              interval: _interval
            };
          }

        case 'yesterday':
          {
            var _start2 = today.subtract(1, 'day');

            var end = _start2.clone().add(1, 'day');

            var _interval2 = 'Hour';

            var _count2 = end.diff(_start2, 'hours') + 1;

            return {
              start: _start2.toDate(),
              count: _count2,
              interval: _interval2
            };
          }

        case 'thisweek':
          {
            var _start3 = today.startOf('week');

            var _interval3 = 'Day';

            var _count3 = now.diff(_start3, 'days') + 1;

            return {
              start: _start3.toDate(),
              count: _count3,
              interval: _interval3
            };
          }

        case 'lastweek':
          {
            var _start4 = today.subtract(1, 'week').startOf('week');

            var _end = _start4.clone().add(1, 'week');

            var _interval4 = 'Day';

            var _count4 = _end.diff(_start4, 'days') + 1;

            return {
              start: _start4.toDate(),
              count: _count4,
              interval: _interval4
            };
          }

        case 'thisyear':
          {
            var _start5 = today.clone().dayOfYear(1);

            var _interval5 = 'Month';

            var _count5 = today.clone().diff(_start5, 'months') + 1;

            return {
              start: _start5.toDate(),
              count: _count5,
              interval: _interval5
            };
          }

        case 'lastyear':
          {
            var _start6 = today.dayOfYear(1).subtract(1, 'years');

            var _end2 = _start6.clone().add(1, 'year');

            var _interval6 = 'Month';

            var _count6 = _end2.diff(_start6, 'months') + 1;

            return {
              start: _start6.toDate(),
              count: _count6,
              interval: _interval6
            };
          }

        case 'lastmonth':
          {
            var _start7 = today.date(1).subtract(1, 'month');

            var _end3 = _start7.clone().add(1, 'month');

            var _interval7 = 'Day';

            var _count7 = _end3.diff(_start7, 'days') + 1;

            return {
              start: _start7.toDate(),
              count: _count7,
              interval: _interval7
            };
          }

        case 'thismonth':
          {
            var _start8 = today.clone().date(1);

            var _interval8 = 'Day';

            var _count8 = today.clone().diff(_start8, 'days') + 1;

            return {
              start: _start8.toDate(),
              count: _count8,
              interval: _interval8
            };
          }

        case 'custom':
          {
            var _start9 = moment.utc(customPeriodFrom);

            var _end4 = moment.utc(customPeriodTo);

            var duration = moment.duration(_end4.diff(_start9.clone()));
            var _interval9 = 'Day';

            if (duration.asYears() > 2) {
              _interval9 = 'Year';
            } else if (duration.asMonths() > 6) {
              _interval9 = 'Month';
            } else if (duration.asWeeks() > 2) {
              _interval9 = 'Week';
            } else if (duration.asDays() > 2) {
              _interval9 = 'Day';
            } else {
              _interval9 = 'Hour';
            }

            var _count9 = _end4.diff(_start9, _interval9.toLowerCase()) + 1;

            return {
              start: customPeriodFrom,
              count: _count9,
              interval: _interval9
            };
          }

        case 'last7days':
          {
            var _start10 = today.subtract(6, 'day');

            var _interval10 = 'Day';
            var _count10 = 7;
            return {
              start: _start10.toDate(),
              count: _count10,
              interval: _interval10
            };
          }

        case 'last30days':
          {
            var _start11 = today.subtract(29, 'day');

            var _interval11 = 'Day';
            var _count11 = 30;
            return {
              start: _start11.toDate(),
              count: _count11,
              interval: _interval11
            };
          }

        case 'last5years':
          {
            var _start12 = today.subtract(4, 'year');

            var _interval12 = 'Year';
            var _count12 = 5;
            return {
              start: _start12.toDate(),
              count: _count12,
              interval: _interval12
            };
          }

        default:
          return void 0;
      }
    }
  }]);

  return Dashboard;
}(React.Component);

var drawerWidth = '16rem';
var drawerSidesPadding = '11px';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: "calc(100% + ".concat(theme.spacing.unit, "px)"),
      position: 'relative' // flexWrap: 'nowrap'

    },
    menu: {
      height: '100%',
      boxSizing: 'border-box',
      display: 'flex',
      flexDirection: 'column'
    },
    menuItem: {
      paddingLeft: theme.spacing.unit,
      paddingRight: theme.spacing.unit,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      opacity: 0.5,
      flex: '0 0 auto',
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    main: {
      height: '100%',
      position: 'relative',
      flex: '1 1 auto',
      background: theme.Colors.gray.primary.light
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    mainInner: {
      padding: '40px',
      height: '100%',
      boxSizing: 'border-box'
    },
    tooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      fontSize: 11
    },
    submenu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    submenuContent: {
      paddingRight: drawerSidesPadding,
      paddingLeft: drawerSidesPadding,
      width: drawerWidth,
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      boxSizing: 'border-box'
    },
    submenuOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    submenuClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    listItemIconWrapper: {
      display: 'inline-flex',
      '&:hover $listItemIcon:first-child': {
        display: 'none'
      },
      '&:hover $listItemIcon:last-child': {
        display: 'inline-flex'
      }
    },
    listItemIcon: {
      color: 'rgba(0, 0, 0, 0.54)',
      display: 'inline-flex',
      flexShrink: 0,
      marginRight: 16,
      position: 'relative'
    },
    listItemIconChecked: {},
    listItemIconPerson: {},
    listItemIconCheckbox: {
      display: 'none'
    },
    listItemText: {
      whiteSpace: 'normal'
    },
    periodSelectIcon: {
      display: 'none'
    },
    periodSelect: {
      paddingTop: 5,
      paddingBottom: 4,
      '&:focus': {
        background: 'transparent'
      }
    },
    line: {
      '& .recharts-line-curve': {
        stroke: theme.palette.primary.main
      }
    },
    pie: {
      '& .recharts-sector': {
        fill: theme.palette.primary.main
      }
    },
    chartTooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      padding: "".concat(theme.spacing.unit, "px "),
      border: 'none',
      borderRadius: 4
    },
    chartTooltipTitle: {
      color: theme.palette.primary.main,
      marginBottom: 4,
      fontWeight: 'bold'
    },
    chartSideBar: {
      height: '100%',
      flex: '0 0 auto',
      display: 'flex',
      flexDirection: 'column',
      overflow: 'auto'
    }
  };
})(Dashboard);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DashboardMessages = void 0;

var _reactIntl = require("react-intl");

var DashboardMessages = (0, _reactIntl.defineMessages)({
  amount: {
    "id": "src.components.dashboard.amount",
    "defaultMessage": "Amount"
  },
  sales: {
    "id": "src.components.dashboard.sales",
    "defaultMessage": "Sales"
  },
  units: {
    "id": "src.components.dashboard.units",
    "defaultMessage": "Units"
  },
  chart: {
    "id": "src.components.dashboard.chart",
    "defaultMessage": "Chart"
  },
  pie: {
    "id": "src.components.dashboard.pie",
    "defaultMessage": "Pie"
  },
  shopsBtn: {
    "id": "src.components.orders.orderList.shopsBtn",
    "defaultMessage": "Shops"
  },
  usersBtn: {
    "id": "src.components.orders.orderList.usersBtn",
    "defaultMessage": "Users"
  },
  productsBtn: {
    "id": "src.components.orders.orderList.productsBtn",
    "defaultMessage": "Products"
  },
  today: {
    "id": "src.components.dashboard.today",
    "defaultMessage": "Today"
  },
  yesterday: {
    "id": "src.components.dashboard.yesterday",
    "defaultMessage": "Yesterday"
  },
  thisweek: {
    "id": "src.components.dashboard.thisweek",
    "defaultMessage": "This week"
  },
  lastweek: {
    "id": "src.components.dashboard.lastweek",
    "defaultMessage": "Last week"
  },
  thismonth: {
    "id": "src.components.dashboard.thismonth",
    "defaultMessage": "This month"
  },
  lastmonth: {
    "id": "src.components.dashboard.lastmonth",
    "defaultMessage": "Last month"
  },
  thisyear: {
    "id": "src.components.dashboard.thisyear",
    "defaultMessage": "This year"
  },
  lastyear: {
    "id": "src.components.dashboard.lastyear",
    "defaultMessage": "Last year"
  },
  last7days: {
    "id": "src.components.dashboard.last7days",
    "defaultMessage": "Last 7 days"
  },
  last30days: {
    "id": "src.components.dashboard.last30days",
    "defaultMessage": "Last 30 days"
  },
  last5years: {
    "id": "src.components.dashboard.last5years",
    "defaultMessage": "Last 5 years"
  },
  customTimePeriodTitle: {
    "id": "src.components.dashboard.customTimePeriodTitle",
    "defaultMessage": "Pick a range"
  },
  customTimePeriodFrom: {
    "id": "src.components.dashboard.customTimePeriodFrom",
    "defaultMessage": "From"
  },
  customTimePeriodTo: {
    "id": "src.components.dashboard.customTimePeriodTo",
    "defaultMessage": "To"
  },
  customTimePeriodSubmit: {
    "id": "src.components.dashboard.customTimePeriodSubmit",
    "defaultMessage": "ok"
  }
});
exports.DashboardMessages = DashboardMessages;
var _default = DashboardMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var DetailGridColumn = function DetailGridColumn(props) {
  var _props$classes = props.classes,
      detailGridColumn = _props$classes.detailGridColumn,
      cell = _props$classes.cell,
      classes = _objectWithoutProperties(_props$classes, ["detailGridColumn", "cell"]);

  var propsClasses = props.classes,
      className = props.className,
      gridProps = _objectWithoutProperties(props, ["classes", "className"]);

  return React.createElement(_Grid.default, _extends({
    className: classNames(propsClasses.detailGridColumn, className)
  }, _objectSpread({
    item: true,
    xs: true,
    classes: classes
  }, gridProps)), React.createElement("div", {
    className: props.classes.cell
  }, props.children));
};

var _default = (0, _core.withStyles)(function (theme) {
  return {
    detailGridColumn: {
      height: '100%',
      overflow: 'auto',
      paddingTop: theme.spacing.unit * 3,
      paddingBottom: theme.spacing.unit * 3,
      boxSizing: 'border-box',
      flex: '1 1 50%'
    },
    cell: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2,
      paddingTop: theme.spacing.unit * 2,
      paddingBottom: theme.spacing.unit * 2,
      overflow: 'hidden'
    }
  };
})(DetailGridColumn);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _core = require("@material-ui/core");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var DetailGridContainer = function DetailGridContainer(props) {
  var _props$classes = props.classes,
      detailGridContainer = _props$classes.detailGridContainer,
      childrenWrapper = _props$classes.childrenWrapper,
      classes = _objectWithoutProperties(_props$classes, ["detailGridContainer", "childrenWrapper"]);

  var propsClasses = props.classes,
      gridProps = _objectWithoutProperties(props, ["classes"]);

  return React.createElement("div", {
    className: props.classes.detailGridContainer
  }, React.createElement(_Grid.default, _extends({
    style: {
      height: '100%',
      position: 'relative',
      flexWrap: 'nowrap'
    }
  }, _objectSpread({
    container: true,
    spacing: 0,
    direction: 'row',
    classes: classes
  }, gridProps)), React.createElement(_Grid.default, {
    item: true,
    className: props.classes.childrenWrapper
  }), props.children, React.createElement(_Grid.default, {
    item: true,
    className: props.classes.childrenWrapper
  })));
};

var _default = (0, _core.withStyles)(function (theme) {
  return {
    detailGridContainer: {
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box'
    },
    childrenWrapper: {
      width: 50,
      flex: '0 0 50px'
    }
  };
})(DetailGridContainer);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.FabBtn = void 0;

var React = _interopRequireWildcard(require("react"));

var _Fab = _interopRequireDefault(require("@material-ui/core/Fab"));

var _core = require("@material-ui/core");

var _styles = require("@material-ui/core/styles");

var classNames = _interopRequireWildcard(require("classnames"));

var _icons = require("@material-ui/icons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var FabBtn = (0, _styles.withTheme)()((0, _core.withStyles)(function (theme) {
  return {
    btn: {
      margin: '.5rem'
    },
    tooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      fontSize: 11
    },
    blue: {
      '&:hover': {
        background: theme.Colors.blue.primary.main,
        color: theme.Colors.blue.primary.contrastText
      }
    },
    gray: {
      '&:hover': {
        background: theme.Colors.gray.primary.main,
        color: theme.Colors.gray.primary.contrastText
      }
    },
    green: {
      '&:hover': {
        background: theme.Colors.green.primary.main,
        color: theme.Colors.green.primary.contrastText
      }
    },
    orange: {
      '&:hover': {
        background: theme.Colors.orange.primary.main,
        color: theme.Colors.orange.primary.contrastText
      }
    },
    red: {
      '&:hover': {
        background: theme.Colors.red.primary.main,
        color: theme.Colors.red.primary.contrastText
      }
    },
    white: {
      '&:hover': {
        background: theme.Colors.white.primary.main,
        color: theme.Colors.white.primary.contrastText
      }
    }
  };
})(function (props) {
  var icon = props.icon,
      legend = props.legend,
      secondary = props.secondary,
      classes = props.classes,
      themeColor = props.themeColor,
      theme = props.theme,
      overidefabProps = _objectWithoutProperties(props, ["icon", "legend", "secondary", "classes", "themeColor", "theme"]);

  var fabProps = _objectSpread({
    size: secondary ? 'small' : 'large',
    color: 'primary'
  }, overidefabProps, {
    className: classNames(classes.btn, overidefabProps.className, _defineProperty({}, classes[themeColor || 'white'], secondary))
  });

  var btn = React.createElement(_Fab.default, fabProps, icon);

  if (legend) {
    btn = React.createElement(_core.Tooltip, {
      placement: "left",
      title: legend,
      "aria-label": legend,
      classes: {
        tooltip: classes.tooltip
      }
    }, btn);
  }

  var palette = secondary ? theme.Colors.white : theme.Colors[themeColor || 'white'];
  btn = React.createElement(_styles.MuiThemeProvider, {
    theme: _objectSpread({}, theme, {
      palette: palette
    })
  }, btn);
  return btn;
}));
exports.FabBtn = FabBtn;

var Fabs =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Fabs, _React$Component);

  function Fabs() {
    _classCallCheck(this, Fabs);

    return _possibleConstructorReturn(this, _getPrototypeOf(Fabs).apply(this, arguments));
  }

  _createClass(Fabs, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          map = _this$props.map,
          classes = _this$props.classes;
      var loading = {
        icon: React.createElement(_icons.Cached, {
          classes: {
            root: classes.loading
          }
        }),
        legend: 'loading',
        themeColor: 'gray',
        color: 'primary'
      };
      var btns = map.filter(function (m) {
        return m;
      }).map(function (m) {
        return m === 'loading' ? loading : m;
      });
      return React.createElement("div", {
        className: classes.container
      }, btns.map(function (b, i) {
        return React.createElement(FabBtn, _extends({
          key: i
        }, _objectSpread({}, b, {
          secondary: i !== 0
        })));
      }));
    }
  }]);

  return Fabs;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      position: 'absolute',
      bottom: '1rem',
      right: '0',
      display: 'flex',
      flexDirection: 'column-reverse',
      alignItems: 'center',
      zIndex: theme.zIndex.appBar
    },
    '@keyframes loading-rotate': {
      'from': {
        transform: 'rotate(0deg)'
      },
      'to': {
        transform: 'rotate(-360deg)'
      }
    },
    loading: {
      animation: "loading-rotate 1500ms linear infinite"
    }
  };
})(Fabs);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DispatchFields = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _reactIntl = require("react-intl");

var _DispatchFieldsMessages = _interopRequireDefault(require("./DispatchFieldsMessages"));

var _materialUiPickers = require("material-ui-pickers");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var DispatchFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DispatchFields, _React$Component);

  function DispatchFields(props) {
    var _this;

    _classCallCheck(this, DispatchFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(DispatchFields).call(this, props));
    _this._open = _this._open.bind(_assertThisInitialized(_this));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._handleDelete = _this._handleDelete.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(DispatchFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var initial = this.props.initial || {};
      var changes = this.props.changes || {};

      var current = _objectSpread({}, initial, changes);

      var _this$props = this.props,
          intl = _this$props.intl,
          onChange = _this$props.onChange,
          classes = _this$props.classes,
          hasRights = _this$props.hasRights;
      var dateOptions = {
        weekday: 'short',
        year: 'numeric',
        month: 'numeric',
        day: 'numeric'
      };
      var date = current.Date ? this.props.intl.formatDate(new Date(current.Date), dateOptions) : '';
      var empty = Object.keys(changes).length === 0;
      var actionDelete = hasRights ? React.createElement(_core.IconButton, {
        color: "default",
        onClick: function onClick(e) {
          return e.preventDefault(), e.stopPropagation(), _this2.props.onRequestRemove();
        }
      }, React.createElement(_icons.Close, {
        className: classNames(classes.svgIcon, classes.svgIconRemove)
      })) : null;
      var open = this.state.open;
      var previewLine = empty ? React.createElement(_ItemPreview.default, {
        onClick: this._open
      }, React.createElement(_ItemPreview.Thumb, {
        loading: true
      }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        loading: true
      }), React.createElement(_ItemPreview.Line, {
        loading: true
      }))) : React.createElement(_ItemPreview.default, {
        onClick: this._open
      }, React.createElement(_core.Avatar, null, current.Status && this._getDispatchStatusIcon(current.Status)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, React.createElement("span", {
        className: classes.title
      }, current.Method), date && React.createElement("span", {
        className: classes.date
      }, date)), React.createElement(_ItemPreview.Line, null)), React.createElement(_ItemPreview.Lines, {
        actions: true
      }, React.createElement(_ItemPreview.Line, null), React.createElement(_ItemPreview.Line, null, actionDelete)));
      return React.createElement(React.Fragment, null, previewLine, React.createElement(_core.Dialog, _extends({
        open: open
      }, {
        onClose: this._close
      }), React.createElement(_core.DialogTitle, null, "Dispatch Information"), React.createElement(_core.DialogContent, null, React.createElement(_GridContainer.GridContainer, {
        spacing: 16
      }, React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "DispatchMethod"
      }, intl.formatMessage(_DispatchFieldsMessages.default.method)), React.createElement(_core.Select, {
        fullWidth: true,
        value: current.Method || '',
        disabled: !hasRights,
        onChange: function onChange(e) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Method: e.target.value
          }));
        },
        inputProps: {
          name: 'DispatchMethod',
          id: 'DispatchMethod'
        }
      }, [{
        preview: 'Electronic',
        value: 'Electronic'
      }, {
        preview: 'Pickup',
        value: 'Pickup'
      }, {
        preview: 'Courier',
        value: 'Courier'
      }, {
        preview: 'Post',
        value: 'Post'
      }].map(function (dispatchMethod) {
        return React.createElement(_core.MenuItem, {
          key: dispatchMethod.value,
          value: dispatchMethod.value
        }, dispatchMethod.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "DispatchStatus"
      }, intl.formatMessage(_DispatchFieldsMessages.default.status)), React.createElement(_core.Select, {
        fullWidth: true,
        value: current.Status || '',
        disabled: !hasRights,
        onChange: function onChange(e) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Status: e.target.value
          }));
        },
        inputProps: {
          name: 'DispatchStatus',
          id: 'DispatchStatus'
        }
      }, [{
        preview: 'Init',
        value: 'Init'
      }, {
        preview: 'Preparing',
        value: 'Preparing'
      }, {
        preview: 'Ready for delivery',
        value: 'ReadyForDelivery'
      }, {
        preview: 'En route',
        value: 'EnRoute'
      }, {
        preview: 'Undeliverable',
        value: 'Undeliverable'
      }, {
        preview: 'Delivered',
        value: 'Delivered'
      }].map(function (dispatchStatus) {
        return React.createElement(_core.MenuItem, {
          key: dispatchStatus.value,
          value: dispatchStatus.value
        }, dispatchStatus.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: current.Date ? new Date(current.Date) : new Date(),
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Date: value
          }));
        },
        disableOpenOnEnter: true,
        animateYearScrolling: false,
        label: "Date",
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (e) {
          return onChange(_objectSpread({}, changes, {
            Notes: e.target.value
          }));
        }),
        value: current.Notes || '',
        multiline: true,
        fullWidth: true,
        label: intl.formatMessage(_DispatchFieldsMessages.default.notes),
        disabled: !hasRights
      })))), React.createElement(_core.DialogActions, null, hasRights && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._handleDelete
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: this._close
      }, "close"))));
    }
  }, {
    key: "_handleDelete",
    value: function _handleDelete() {
      this.props.onRequestRemove();
      this.setState(function () {
        return {
          open: false
        };
      });
    }
  }, {
    key: "_open",
    value: function _open() {
      this.setState({
        open: true
      });
    }
  }, {
    key: "_close",
    value: function _close() {
      this.setState({
        open: false
      });
    }
  }, {
    key: "_getDispatchStatusIcon",
    value: function _getDispatchStatusIcon(dispatchStatus) {
      switch (dispatchStatus) {
        case 'Undeliverable':
          return React.createElement(_icons.HighlightOff, null);

        case 'Delivered':
          return React.createElement(_icons.Check, null);

        case 'Init':
          return React.createElement(_icons.MoreHoriz, null);

        case 'Pending':
          return React.createElement(_icons.QueryBuilder, null);

        case 'Preparing':
          return React.createElement(_icons.HowToVote, null);

        case 'ReadyForDelivery':
          return React.createElement(_icons.LocalShipping, null);

        case 'EnRoute':
          return React.createElement(_icons.LocalShipping, null);

        default:
          return;
      }
    }
  }]);

  return DispatchFields;
}(React.Component);

exports.DispatchFields = DispatchFields;

var _default = (0, _core.withStyles)(function (theme) {
  return {
    svgIcon: {
      position: 'absolute',
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)'
    },
    svgIconRemove: {
      fontSize: '1rem'
    },
    title: {
      marginRight: '.5rem',
      color: theme.palette.text.primary
    },
    date: {
      marginRight: '.5rem'
    }
  };
})((0, _reactIntl.injectIntl)(DispatchFields));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DispatchFieldsMessages = void 0;

var _reactIntl = require("react-intl");

var DispatchFieldsMessages = (0, _reactIntl.defineMessages)({
  title: {
    "id": "src.components.forms.dispatch.title",
    "defaultMessage": "Dispatch"
  },
  notes: {
    "id": "src.components.forms.dispatch.notes",
    "defaultMessage": "Notes"
  },
  lightboxTitle: {
    "id": "src.components.forms.dispatch.lightboxTitle",
    "defaultMessage": "Dispatch"
  },
  method: {
    "id": "src.components.forms.dispatch.method",
    "defaultMessage": "Method"
  },
  status: {
    "id": "src.components.forms.dispatch.status",
    "defaultMessage": "Status"
  },
  date: {
    "id": "src.components.forms.dispatch.date",
    "defaultMessage": "Date"
  }
});
exports.DispatchFieldsMessages = DispatchFieldsMessages;
var _default = DispatchFieldsMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _shortid = require("shortid");

var _reactSortableHoc = require("react-sortable-hoc");

var _DispatchFields = _interopRequireDefault(require("./DispatchFields"));

var _reactIntl = require("react-intl");

var _DispatchListMessages = _interopRequireDefault(require("./DispatchListMessages"));

var _PlaylistAdd = _interopRequireDefault(require("@material-ui/icons/PlaylistAdd"));

var _core = require("@material-ui/core");

var _SortableListItem = require("src/_helpers/SortableListItem/SortableListItem");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var DispatchList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DispatchList, _React$Component);

  function DispatchList(props) {
    var _this;

    _classCallCheck(this, DispatchList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(DispatchList).call(this, props));
    _this._handleMoveItem = _this._handleMoveItem.bind(_assertThisInitialized(_this));
    _this._handleAddItem = _this._handleAddItem.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(DispatchList, [{
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      if (nextProps.onChange !== this.props.onChange) {
        return true;
      }

      if (JSON.stringify(nextProps.list) !== JSON.stringify(this.props.list)) {
        return true;
      }

      if (JSON.stringify(nextProps.preview) !== JSON.stringify(this.props.preview)) {
        return true;
      }

      if (nextState.activeUID !== this.state.activeUID) {
        return true;
      }

      return false;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var items = this.props.list || [];
      var _this$props = this.props,
          preview = _this$props.preview,
          classes = _this$props.classes,
          hasRights = _this$props.hasRights;
      return React.createElement(React.Fragment, null, React.createElement(_SortableListItem.SortableListItemsContainer, {
        onSortEnd: this._handleMoveItem,
        pressDelay: 200
      }, items.map(function (item, index) {
        var itemPreview = preview.find(function (i) {
          return i.Id === item.Id;
        }) || item;
        return React.createElement(_SortableListItem.SortableListItem, {
          key: item.Id,
          index: index
        }, React.createElement(_DispatchFields.default, {
          initial: item,
          changes: item,
          preview: itemPreview,
          onChange: function onChange(i) {
            return _this2._handleItemChange(item.Id, i);
          },
          onRequestRemove: function onRequestRemove() {
            return _this2._handleRemoveItem(item.Id);
          },
          hasRights: hasRights
        }));
      })), React.createElement(_core.Grid, {
        container: true,
        direction: "row",
        justify: "center",
        alignItems: "center",
        className: classes.button
      }, hasRights && React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: this._handleAddItem
      }, React.createElement(_reactIntl.FormattedMessage, _DispatchListMessages.default.addDispatch), React.createElement(_PlaylistAdd.default, {
        style: {
          paddingLeft: '7px'
        }
      }))));
    }
  }, {
    key: "_handleMoveItem",
    value: function _handleMoveItem(sortEnd) {
      var items = this.props.list || [];
      var newItems = (0, _reactSortableHoc.arrayMove)(items, sortEnd.oldIndex, sortEnd.newIndex);
      this.props.onChange(newItems);
    }
  }, {
    key: "_handleAddItem",
    value: function _handleAddItem() {
      var items = this.props.list || [];
      var newItems = [].concat(_toConsumableArray(items), [{
        Id: (0, _shortid.generate)(),
        Date: new Date().toISOString()
      }]);
      this.props.onChange(newItems);
    }
  }, {
    key: "_handleRemoveItem",
    value: function _handleRemoveItem(uid) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.Id === uid;
      });

      if (index < 0) {
        return;
      } else {
        newItems.splice(index, 1);
      }

      this.props.onChange(newItems);
    }
  }, {
    key: "_handleItemChange",
    value: function _handleItemChange(uid, value) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.Id === uid;
      });

      if (index < 0) {
        newItems.push(value);
      } else {
        newItems[index] = _objectSpread({}, newItems[index], value);
      }

      this.props.onChange(newItems);
    }
  }]);

  return DispatchList;
}(React.Component);

var _default = React.memo((0, _core.withStyles)(function (theme) {
  return {
    root: {},
    button: {
      marginTop: theme.spacing.unit
    }
  };
})((0, _reactIntl.injectIntl)(DispatchList)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DispatchListMessages = void 0;

var _reactIntl = require("react-intl");

var DispatchListMessages = (0, _reactIntl.defineMessages)({
  addDispatch: {
    "id": "src.components.forms.Dispatch.DispatchList.addDispatch",
    "defaultMessage": "add dispatch"
  }
});
exports.DispatchListMessages = DispatchListMessages;
var _default = DispatchListMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _PaymentStatusHelpers = require("../../../_helpers/PaymentStatusHelpers");

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _materialUiPickers = require("material-ui-pickers");

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _PaymentListMessages = _interopRequireDefault(require("./PaymentListMessages"));

var _core = require("@material-ui/core");

var _PaymentMethodHelpers = require("src/_helpers/PaymentMethodHelpers");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var classNames = _interopRequireWildcard(require("classnames"));

var _CurrenciesField = _interopRequireDefault(require("src/components/CurrenciesField/CurrenciesField"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PaymentFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PaymentFields, _React$Component);

  function PaymentFields(props) {
    var _this;

    _classCallCheck(this, PaymentFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PaymentFields).call(this, props));
    _this._open = _this._open.bind(_assertThisInitialized(_this));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._handleDelete = _this._handleDelete.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(PaymentFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var initial = this.props.initial || {};
      var changes = this.props.changes || {};

      var current = _objectSpread({}, initial, changes);

      var _this$props = this.props,
          PaidAmount = _this$props.PaidAmount,
          Total = _this$props.Total,
          classes = _this$props.classes,
          settingsCtx = _this$props.settingsCtx,
          intl = _this$props.intl,
          hasRights = _this$props.hasRights;
      var dateOptions = {
        weekday: 'short',
        year: 'numeric',
        month: 'numeric',
        day: 'numeric'
      };
      var paymentStatus = [{
        preview: (0, _PaymentStatusHelpers.GetPaymentStatusLegend)(intl, 'Pending'),
        value: 'Pending'
      }, {
        preview: (0, _PaymentStatusHelpers.GetPaymentStatusLegend)(intl, 'Canceled'),
        value: 'Canceled'
      }, {
        preview: (0, _PaymentStatusHelpers.GetPaymentStatusLegend)(intl, 'Failed'),
        value: 'Failed'
      }, {
        preview: (0, _PaymentStatusHelpers.GetPaymentStatusLegend)(intl, 'Paid'),
        value: 'Paid'
      }];
      var paymentMethod = [{
        preview: (0, _PaymentMethodHelpers.GetPaymentMethodLegend)(intl, 'Electronic'),
        value: 'Electronic'
      }, {
        preview: (0, _PaymentMethodHelpers.GetPaymentMethodLegend)(intl, 'Cash'),
        value: 'Cash'
      }, {
        preview: (0, _PaymentMethodHelpers.GetPaymentMethodLegend)(intl, 'Voucher'),
        value: 'Voucher'
      }];
      var date = current.Date ? intl.formatDate(new Date(current.Date), dateOptions) : '';
      var leftToPay = Math.ceil((Total - PaidAmount) * 100) / 100;
      var empty = Object.keys(changes).length === 0;
      var actionDelete = hasRights ? React.createElement(_core.IconButton, {
        color: "default",
        onClick: function onClick() {
          return _this2.props.onRequestRemove();
        }
      }, React.createElement(_icons.Close, {
        className: classNames(classes.svgIcon, classes.svgIconRemove)
      })) : null;
      var previewLine = empty ? React.createElement(_ItemPreview.default, {
        onClick: this._open
      }, React.createElement(_ItemPreview.Thumb, {
        loading: true
      }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        loading: true
      }), React.createElement(_ItemPreview.Line, {
        loading: true
      }))) : React.createElement(_ItemPreview.default, {
        onClick: this._open
      }, React.createElement(_core.Avatar, null, current.Status && this._getPaymentStatusIcon(current.Status)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, React.createElement("span", {
        className: classNames(classes.bold, classes.marginRight)
      }, current.Method), date && React.createElement("span", null, date)), React.createElement(_ItemPreview.Line, null, current.Reference && React.createElement("span", {
        className: classes.marginRight
      }, current.Reference), current.Method && React.createElement("span", null, current.Method))), React.createElement(_ItemPreview.Lines, {
        actions: true
      }, React.createElement(_ItemPreview.Line, null, React.createElement("span", {
        className: "forms__order-payment-preview-amount"
      }, React.createElement(_reactIntl.FormattedNumber, {
        value: current.Amount || 0,
        style: "currency",
        currency: current.Currency
      }))), React.createElement(_ItemPreview.Line, null, actionDelete)));
      return React.createElement(React.Fragment, null, previewLine, React.createElement(_core.Dialog, {
        open: this.state.open,
        onClose: this._close
      }, React.createElement(_core.DialogTitle, null, "Payment Information"), React.createElement(_core.DialogContent, null, React.createElement(_GridContainer.GridContainer, null, React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Title: value.target.value
          }));
        },
        value: current.Title || '',
        label: intl.formatMessage(_PaymentListMessages.default.title),
        fullWidth: true,
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_TextField.default, {
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Reference: value.target.value
          }));
        },
        value: current.Reference || '',
        label: intl.formatMessage(_PaymentListMessages.default.reference),
        fullWidth: true,
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: current.Date ? new Date(current.Date) : new Date(),
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Date: value ? value.toString() : undefined
          }));
        },
        disableOpenOnEnter: true,
        animateYearScrolling: false,
        label: "Date",
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "payment_method"
      }, intl.formatMessage(_PaymentListMessages.default.paymentMethod)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Method: value.target.value
          }));
        },
        value: current.Method || '',
        inputProps: {
          name: 'payment_method',
          id: 'payment_method'
        },
        disabled: !hasRights
      }, paymentMethod.map(function (p) {
        return React.createElement(_core.MenuItem, {
          key: p.value,
          value: p.value
        }, p.preview);
      })))), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "payment_status"
      }, intl.formatMessage(_PaymentListMessages.default.status)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Status: value.target.value
          }));
        },
        value: current.Status || '',
        inputProps: {
          name: 'payment_status',
          id: 'payment_status'
        },
        disabled: !hasRights
      }, paymentStatus.map(function (p) {
        return React.createElement(_core.MenuItem, {
          key: p.value,
          value: p.value
        }, p.preview);
      })))), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_TextField.default, {
        fullWidth: true,
        inputProps: {
          step: '0.01'
        },
        type: "number",
        onChange: function onChange(value) {
          var val = value.target.value;
          var w = parseFloat(val);

          _this2.props.onChange(_objectSpread({}, changes, {
            Amount: w
          }));
        },
        label: intl.formatMessage(_PaymentListMessages.default.amount),
        value: current.Amount || leftToPay,
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 6
      }, React.createElement(_CurrenciesField.default, {
        settingsCtx: settingsCtx,
        label: intl.formatMessage(_PaymentListMessages.default.currency),
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, current, {
            Currency: value.target.value
          }));
        },
        value: current.Currency,
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Details: value.target.value
          }));
        },
        value: current.Details || '',
        label: intl.formatMessage(_PaymentListMessages.default.details),
        fullWidth: true,
        multiline: true,
        disabled: !hasRights
      })))), React.createElement(_core.DialogActions, null, hasRights && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._handleDelete
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: this._close
      }, "close"))));
    }
  }, {
    key: "_handleDelete",
    value: function _handleDelete() {
      this.props.onRequestRemove();
      this.setState(function () {
        return {
          open: false
        };
      });
    }
  }, {
    key: "_open",
    value: function _open() {
      this.setState(function () {
        return {
          open: true
        };
      });
    }
  }, {
    key: "_close",
    value: function _close() {
      this.setState(function () {
        return {
          open: false
        };
      });
    }
  }, {
    key: "_getPaymentStatusIcon",
    value: function _getPaymentStatusIcon(paymentStatus) {
      switch (paymentStatus) {
        case 'Canceled':
          return React.createElement(_icons.Cancel, null);

        case 'Failed':
          return React.createElement(_icons.HighlightOff, null);

        case 'Paid':
          return React.createElement(_icons.Check, null);

        case 'Pending':
          return React.createElement(_icons.QueryBuilder, null);

        default:
          return;
      }
    }
  }]);

  return PaymentFields;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    svgIcon: {
      position: 'absolute',
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)'
    },
    svgIconRemove: {
      fontSize: '1rem'
    },
    bold: {
      marginRight: '.5rem',
      color: theme.palette.text.primary
    },
    marginRight: {
      marginRight: '.5rem'
    }
  };
})((0, _reactIntl.injectIntl)(PaymentFields));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactSortableHoc = require("react-sortable-hoc");

var _Fields = _interopRequireDefault(require("./Fields"));

var _PlaylistAdd = _interopRequireDefault(require("@material-ui/icons/PlaylistAdd"));

var _core = require("@material-ui/core");

var _reactIntl = require("react-intl");

var _PaymentListMessages = _interopRequireDefault(require("./PaymentListMessages"));

var _shortid = require("shortid");

var _SortableListItem = require("src/_helpers/SortableListItem/SortableListItem");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PaymentList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PaymentList, _React$Component);

  function PaymentList(props) {
    var _this;

    _classCallCheck(this, PaymentList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PaymentList).call(this, props));
    _this._handleMoveItem = _this._handleMoveItem.bind(_assertThisInitialized(_this));
    _this._handleAddItem = _this._handleAddItem.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(PaymentList, [{
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      if (nextProps.Total !== this.props.Total) {
        return true;
      }

      if (nextProps.PaidAmount !== this.props.PaidAmount) {
        return true;
      }

      if (nextProps.Currency !== this.props.Currency) {
        return true;
      }

      if (nextProps.onChange !== this.props.onChange) {
        return true;
      }

      if (JSON.stringify(nextProps.list) !== JSON.stringify(this.props.list)) {
        return true;
      }

      if (JSON.stringify(nextProps.preview) !== JSON.stringify(this.props.preview)) {
        return true;
      }

      if (nextState.activeUID !== this.state.activeUID) {
        return true;
      }

      return false;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          list = _this$props.list,
          classes = _this$props.classes,
          settingsCtx = _this$props.settingsCtx,
          PaidAmount = _this$props.PaidAmount,
          Total = _this$props.Total,
          hasRights = _this$props.hasRights;
      return React.createElement(React.Fragment, null, React.createElement(_SortableListItem.SortableListItemsContainer, {
        onSortEnd: this._handleMoveItem,
        pressDelay: 200
      }, list && list.map(function (item, index) {
        var itemPreview = _this2.props.preview.find(function (i) {
          return i.Id === item.Id;
        }) || item;
        return React.createElement(_SortableListItem.SortableListItem, {
          key: item.Id,
          index: index
        }, React.createElement(_Fields.default, {
          settingsCtx: settingsCtx,
          initial: item,
          changes: item,
          preview: itemPreview,
          onChange: function onChange(i) {
            return _this2._handleItemChange(item.Id, i);
          },
          onRequestRemove: function onRequestRemove() {
            return _this2._handleRemoveItem(item.Id);
          },
          Total: Total,
          PaidAmount: PaidAmount,
          hasRights: hasRights
        }));
      })), React.createElement(_core.Grid, {
        container: true,
        direction: "row",
        justify: "center",
        alignItems: "center",
        className: classes.button
      }, hasRights && React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: this._handleAddItem
      }, React.createElement(_reactIntl.FormattedMessage, _PaymentListMessages.default.addPayment), React.createElement(_PlaylistAdd.default, {
        style: {
          paddingLeft: '7px'
        }
      }))));
    }
  }, {
    key: "_handleMoveItem",
    value: function _handleMoveItem(sortEnd) {
      var items = this.props.list || [];
      var newItems = (0, _reactSortableHoc.arrayMove)(items, sortEnd.oldIndex, sortEnd.newIndex);
      this.props.onChange(newItems);
    }
  }, {
    key: "_handleAddItem",
    value: function _handleAddItem() {
      var _this$props2 = this.props,
          list = _this$props2.list,
          Settings = _this$props2.settingsCtx.Settings,
          Currency = _this$props2.Currency;
      var items = list || [];
      var newItems = [].concat(_toConsumableArray(items), [{
        Id: (0, _shortid.generate)(),
        Date: new Date().toISOString(),
        Currency: Currency || Settings.Currencies[0]
      }]);
      this.props.onChange(newItems);
    }
  }, {
    key: "_handleRemoveItem",
    value: function _handleRemoveItem(uid) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.Id === uid;
      });

      if (index < 0) {
        return;
      } else {
        newItems.splice(index, 1);
      }

      this.props.onChange(newItems);
    }
  }, {
    key: "_handleItemChange",
    value: function _handleItemChange(uid, value) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.Id === uid;
      });

      if (index < 0) {
        newItems.push(value);
      } else {
        newItems[index] = _objectSpread({}, newItems[index], value);
      }

      this.props.onChange(newItems);
    }
  }]);

  return PaymentList;
}(React.Component);

var _default = React.memo((0, _core.withStyles)(function (theme) {
  return {
    root: {},
    button: {
      marginTop: theme.spacing.unit
    }
  };
})(PaymentList));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PaymentListMessages = void 0;

var _reactIntl = require("react-intl");

var PaymentListMessages = (0, _reactIntl.defineMessages)({
  addPayment: {
    "id": "src.components.forms.Payment.PaymentList.addPayment",
    "defaultMessage": "add payment"
  },
  title: {
    "id": "src.components.forms.orderitem.title",
    "defaultMessage": "Title"
  },
  reference: {
    "id": "src.components.forms.orderitem.reference",
    "defaultMessage": "Reference"
  },
  description: {
    "id": "src.components.forms.orderitem.description",
    "defaultMessage": "Description"
  },
  amount: {
    "id": "src.components.forms.orderitem.amount",
    "defaultMessage": "Amount"
  },
  date: {
    "id": "src.components.forms.orderitem.date",
    "defaultMessage": "Date"
  },
  paymentMethod: {
    "id": "src.components.forms.orderitem.paymentMethod",
    "defaultMessage": "Payment Method"
  },
  status: {
    "id": "src.components.forms.orderitem.status",
    "defaultMessage": "Status"
  },
  provider: {
    "id": "src.components.forms.orderitem.provider",
    "defaultMessage": "Provider"
  },
  currency: {
    "id": "src.components.forms.orderitem.currency",
    "defaultMessage": "Currency"
  },
  details: {
    "id": "src.components.forms.orderitem.details",
    "defaultMessage": "Details"
  },
  lightboxTitle: {
    "id": "src.components.forms.orderitem.lightboxTitle",
    "defaultMessage": "Payment: {Title}"
  }
});
exports.PaymentListMessages = PaymentListMessages;
var _default = PaymentListMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GridContainer = void 0;

var React = _interopRequireWildcard(require("react"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var GridContainer = function GridContainer(props) {
  return React.createElement(_Grid.default, _objectSpread({
    container: true,
    spacing: 8
  }, props), props.children);
};

exports.GridContainer = GridContainer;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactTransitionGroup = require("react-transition-group");

var _context = require("../../_context");

var _url = require("src/_helpers/url");

var _HomePage = require("src/pages/Home/HomePage");

var _RegisterPage = _interopRequireDefault(require("src/pages/Register/RegisterPage"));

var _ResetPage = _interopRequireDefault(require("src/pages/Reset/ResetPage"));

var _LoginPage = _interopRequireDefault(require("src/pages/Login/LoginPage"));

var _core = require("@material-ui/core");

var _SetupPage = _interopRequireDefault(require("src/pages/Setup/SetupPage"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var FadeInDuration = 300;
var FadeOutDuration = 300;

var HashRouter =
/*#__PURE__*/
function (_React$Component) {
  _inherits(HashRouter, _React$Component);

  function HashRouter(props) {
    var _this;

    _classCallCheck(this, HashRouter);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(HashRouter).call(this, props));
    _this._hashChange = _this._hashChange.bind(_assertThisInitialized(_this));
    _this.state = {
      action: (0, _url.GetHashVariable)('action'),
      code: (0, _url.GetHashVariable)('code'),
      id: (0, _url.GetHashVariable)('id'),
      username: (0, _url.GetHashVariable)('username')
    };
    return _this;
  }

  _createClass(HashRouter, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      window.addEventListener('hashchange', this._hashChange, false);
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      window.removeEventListener('hashchange', this._hashChange);
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          authCtx = _this$props.authCtx,
          classes = _this$props.classes;
      var _this$state = this.state,
          action = _this$state.action,
          code = _this$state.code,
          id = _this$state.id,
          username = _this$state.username;
      var key = action || (authCtx.loggedin ? 'home' : authCtx.needSetup ? 'setup' : 'login');
      return React.createElement(_reactTransitionGroup.TransitionGroup, {
        className: classes.page
      }, React.createElement(_reactTransitionGroup.CSSTransition, {
        key: key,
        appear: true,
        classNames: {
          enter: classes.pageEnter,
          enterActive: classes.pageEnterActive,
          exit: classes.pageExit,
          exitActive: classes.pageExitActive
        },
        timeout: {
          enter: FadeInDuration,
          exit: FadeOutDuration
        }
      }, this._getView(key, code, id, username)));
    }
  }, {
    key: "_hashChange",
    value: function _hashChange() {
      this.setState(function (prev) {
        return {
          action: (0, _url.GetHashVariable)('action'),
          code: (0, _url.GetHashVariable)('code'),
          id: (0, _url.GetHashVariable)('id'),
          username: (0, _url.GetHashVariable)('username'),
          previous: prev.action
        };
      });
    }
  }, {
    key: "_getView",
    value: function _getView(action, code, id, username) {
      var classes = this.props.classes;

      switch (action) {
        case 'register':
          return React.createElement("div", {
            key: "register",
            className: classes.page
          }, React.createElement(_RegisterPage.default, {
            key: "register",
            registerKey: code,
            userId: id,
            userName: username
          }));

        case 'setup':
          return React.createElement("div", {
            key: "setup",
            className: classes.page
          }, React.createElement(_SetupPage.default, null));

        case 'reset':
          return React.createElement("div", {
            key: "reset",
            className: classes.page
          }, React.createElement(_ResetPage.default, {
            key: "reset",
            registerKey: code,
            userId: id,
            userName: username
          }));

        case 'login':
          return React.createElement("div", {
            key: "login",
            className: classes.page
          }, React.createElement(_LoginPage.default, {
            key: "login"
          }));

        case 'home':
          return React.createElement("div", {
            key: "home",
            className: classes.page
          }, " ", React.createElement(_HomePage.HomePageStandalone, {
            key: "home"
          }));

        default:
          return null;
      }
    }
  }]);

  return HashRouter;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    page: {
      position: 'absolute',
      top: 0,
      left: 0,
      width: '100%',
      height: '100%'
    },
    pageEnter: {
      opacity: 0.01
    },
    pageEnterActive: {
      opacity: 1,
      transition: "opacity ".concat(FadeInDuration, "ms ease-in")
    },
    pageExit: {
      opacity: 1
    },
    pageExitActive: {
      opacity: 0.01,
      transition: "opacity ".concat(FadeOutDuration, "ms ease-in")
    }
  };
})((0, _context.withAuth)(HashRouter));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DepartureCheck = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

/* tslint:disable:max-line-length */
var DepartureCheck = function DepartureCheck(props) {
  return React.createElement(_core.SvgIcon, props, React.createElement("path", {
    d: "M16,1c-2.4,0-4.5,1.2-5.8,3.1c0,0,0,0,0,0C9.8,4,9.4,4,9,4C4.6,4,1,4.5,1,8v10c0,0.9,0.4,1.7,1,2.2V22c0,0.5,0.5,1,1,1h1 c0.6,0,1-0.5,1-1v-1h8v1c0,0.5,0.4,1,1,1h1c0.6,0,1-0.5,1-1v-1.8c0.6-0.5,1-1.3,1-2.2v-3.1c3.4-0.5,6-3.4,6-6.9C23,4.1,19.9,1,16,1z M4.5,19C3.7,19,3,18.3,3,17.5S3.7,16,4.5,16S6,16.7,6,17.5S5.3,19,4.5,19z M3,13V8h6c0,2,0.8,3.7,2.1,5H3z M13.5,19 c-0.8,0-1.5-0.7-1.5-1.5s0.7-1.5,1.5-1.5s1.5,0.7,1.5,1.5S14.3,19,13.5,19z M16,13c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5 S18.8,13,16,13z M18.9,5.2l-4.1,4.1l-2.2-2.2L11.7,8l3.1,3.1l5-5L18.9,5.2z"
  }));
};

exports.DepartureCheck = DepartureCheck;
var _default = DepartureCheck;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.InteractiveTitle = void 0;

var React = _interopRequireWildcard(require("react"));

require("./InteractiveTitle.css");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

var InteractiveTitle = function InteractiveTitle(props) {
  return React.createElement("div", {
    className: "interactive-title "
  }, props.children);
};

exports.InteractiveTitle = InteractiveTitle;
var _default = InteractiveTitle;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _exportNames = {};
Object.defineProperty(exports, "default", {
  enumerable: true,
  get: function get() {
    return _InteractiveTitle.default;
  }
});

var _InteractiveTitle = _interopRequireWildcard(require("./InteractiveTitle"));

Object.keys(_InteractiveTitle).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _InteractiveTitle[key];
    }
  });
});

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ItemPreview = exports.Lines = exports.Line = exports.LineWithStyles = exports.Thumb = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ThumbWithStyles =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ThumbWithStyles, _React$Component);

  function ThumbWithStyles() {
    _classCallCheck(this, ThumbWithStyles);

    return _possibleConstructorReturn(this, _getPrototypeOf(ThumbWithStyles).apply(this, arguments));
  }

  _createClass(ThumbWithStyles, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          src = _this$props.src,
          classes = _this$props.classes,
          children = _this$props.children,
          loading = _this$props.loading,
          className = _this$props.className,
          divprops = _objectWithoutProperties(_this$props, ["src", "classes", "children", "loading", "className"]);

      return React.createElement(_core.Avatar, _extends({
        src: src,
        className: classNames(classes.root, !!loading && classes.loading, className)
      }, divprops), children);
    }
  }]);

  return ThumbWithStyles;
}(React.Component);

var Thumb = (0, _core.withStyles)(function (theme) {
  return {
    root: {
      flexGrow: 0,
      flexShrink: 0
    },
    loading: {
      backgroundColor: theme.Colors.gray.primary.main
    },
    img: {}
  };
})(ThumbWithStyles);
exports.Thumb = Thumb;

var LineWithStyles =
/*#__PURE__*/
function (_React$Component2) {
  _inherits(LineWithStyles, _React$Component2);

  function LineWithStyles() {
    _classCallCheck(this, LineWithStyles);

    return _possibleConstructorReturn(this, _getPrototypeOf(LineWithStyles).apply(this, arguments));
  }

  _createClass(LineWithStyles, [{
    key: "render",
    value: function render() {
      var _this$props2 = this.props,
          classes = _this$props2.classes,
          children = _this$props2.children,
          loading = _this$props2.loading,
          empty = _this$props2.empty,
          title = _this$props2.isTitle,
          className = _this$props2.className,
          divprops = _objectWithoutProperties(_this$props2, ["classes", "children", "loading", "empty", "isTitle", "className"]);

      return React.createElement("div", _extends({
        className: classNames(classes.root, !!loading && classes.loading, !!empty && classes.empty, !!title && classes.title, className)
      }, divprops), children);
    }
  }]);

  return LineWithStyles;
}(React.Component);

exports.LineWithStyles = LineWithStyles;
var Line = (0, _core.withStyles)(function (theme) {
  return {
    root: {
      lineHeight: '1.2rem',
      minHeight: '1.2rem',
      whiteSpace: 'nowrap',
      overflow: 'hidden',
      textOverflow: 'ellipsis'
    },
    loading: {
      '&:after': {
        content: '',
        backgroundColor: theme.Colors.gray.primary.main,
        width: '4rem',
        height: '1rem',
        margin: '0.1rem 0',
        display: 'inline-block'
      },
      '&:first-child:after': {
        width: '6rem'
      }
    },
    empty: {
      minWidth: '1px',
      fontStyle: 'italic',
      color: theme.Colors.gray.primary.main
    },
    title: {
      color: theme.palette.text.primary
    }
  };
})(LineWithStyles);
exports.Line = Line;

var LinesWithStyles =
/*#__PURE__*/
function (_React$Component3) {
  _inherits(LinesWithStyles, _React$Component3);

  function LinesWithStyles() {
    _classCallCheck(this, LinesWithStyles);

    return _possibleConstructorReturn(this, _getPrototypeOf(LinesWithStyles).apply(this, arguments));
  }

  _createClass(LinesWithStyles, [{
    key: "render",
    value: function render() {
      var _this$props3 = this.props,
          classes = _this$props3.classes,
          children = _this$props3.children,
          actions = _this$props3.actions,
          className = _this$props3.className,
          divprops = _objectWithoutProperties(_this$props3, ["classes", "children", "actions", "className"]);

      return React.createElement("div", _extends({
        className: classNames(classes.root, !!actions && classes.actions, className)
      }, divprops), children);
    }
  }]);

  return LinesWithStyles;
}(React.Component);

var Lines = (0, _core.withStyles)(function (theme) {
  return {
    root: {
      flexGrow: 1,
      flexShrink: 1,
      display: 'flex',
      flexDirection: 'column',
      justifyContent: 'center',
      overflow: 'hidden',
      color: theme.Colors.gray.primary.dark,
      fontSize: '0.8rem'
    },
    actions: {
      textAlign: 'right',
      flexShrink: 0,
      minWidth: '1px'
    }
  };
})(LinesWithStyles);
exports.Lines = Lines;

var ItemPreview =
/*#__PURE__*/
function (_React$Component4) {
  _inherits(ItemPreview, _React$Component4);

  function ItemPreview(props) {
    _classCallCheck(this, ItemPreview);

    return _possibleConstructorReturn(this, _getPrototypeOf(ItemPreview).call(this, props));
  }

  _createClass(ItemPreview, [{
    key: "render",
    value: function render() {
      var _this$props4 = this.props,
          active = _this$props4.active,
          noDividers = _this$props4.noDividers,
          classes = _this$props4.classes,
          divprops = _objectWithoutProperties(_this$props4, ["active", "noDividers", "classes"]);

      return React.createElement("div", _extends({
        className: classNames(classes.main, active && classes.active, noDividers && classes.noDividers)
      }, divprops), this.props.children);
    }
  }]);

  return ItemPreview;
}(React.Component);

exports.ItemPreview = ItemPreview;

var _default = (0, _core.withStyles)(function (theme) {
  return {
    main: {
      display: 'flex',
      flexDirection: 'row',
      flexWrap: 'nowrap',
      alignItems: 'center',
      minHeight: '4.4rem',
      padding: '.7rem 0',
      boxSizing: 'border-box',
      position: 'relative',
      color: 'black',
      '&:after': {
        content: '""',
        position: 'absolute',
        height: 1,
        bottom: 0,
        left: 0,
        right: 0,
        background: '#eee'
      },
      '&:before': {
        content: '""',
        position: 'absolute',
        height: 1,
        bottom: 0,
        left: '50%',
        width: 0,
        background: 'blue',
        transform: 'translateX(-50%)',
        transition: 'width 0.2s ease-in-out',
        zIndex: 1
      },
      '& > *': {
        marginRight: '.7rem',
        '&:last-child': {
          marginRight: 0
        }
      }
    },
    active: {
      color: theme.Colors.white.primary.dark
    },
    noDividers: {
      '&:after': {
        content: 'initial'
      },
      '&:before': {
        content: 'initial'
      }
    }
  };
})(ItemPreview);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.withList = exports.ModelBaseList = void 0;

var React = _interopRequireWildcard(require("react"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ModelBaseList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ModelBaseList, _React$Component);

  function ModelBaseList(props) {
    var _this;

    _classCallCheck(this, ModelBaseList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ModelBaseList).call(this, props));
    _this.state = {
      edit: _this._edit.bind(_assertThisInitialized(_this)),
      refresh: _this._refresh.bind(_assertThisInitialized(_this)),
      delete: _this._delete.bind(_assertThisInitialized(_this)),
      create: _this._create.bind(_assertThisInitialized(_this)),
      fetch: _this._fetch.bind(_assertThisInitialized(_this)),
      close: _this._close.bind(_assertThisInitialized(_this)),
      get: _this._get.bind(_assertThisInitialized(_this)),
      loadMore: _this._loadMore.bind(_assertThisInitialized(_this)),
      filterAndSort: _this._filterAndSort.bind(_assertThisInitialized(_this)),
      loading: false,
      done: false,
      entries: [],
      filters: {
        filters: [],
        query: '',
        operator: 'and',
        sort: ''
      }
    };
    return _this;
  }

  _createClass(ModelBaseList, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._loadMore();
    }
  }, {
    key: "render",
    value: function render() {
      return this.props.children(this.state);
    }
  }, {
    key: "_filterAndSort",
    value: function _filterAndSort(filters) {
      var _this2 = this;

      this.setState(function () {
        return {
          filters: filters
        };
      }, function () {
        _this2._refresh();
      });
    }
  }, {
    key: "_create",
    value: function _create(empty) {
      var _this3 = this;

      var loading = this.state.loading;

      if (loading) {
        return;
      }

      return new Promise(function (resolve) {
        _this3.setState(function () {
          return {
            loading: true
          };
        }, function () {
          _this3.setState(function () {
            return {
              editing: undefined,
              creating: empty,
              loading: false
            };
          }, function () {
            return resolve(empty);
          });
        });
      });
    }
  }, {
    key: "_close",
    value: function _close() {
      var _this4 = this;

      return new Promise(function (resolve) {
        _this4.setState(function () {
          return {
            editing: undefined,
            creating: undefined
          };
        }, resolve);
      });
    }
  }, {
    key: "_delete",
    value: function _delete(id) {
      var _this5 = this;

      var api = this.props.api;
      return api.Delete(id).then(function () {
        return new Promise(function (resolve) {
          _this5.setState(function (prev) {
            return {
              entries: prev.entries.filter(function (e) {
                return e.Id !== id;
              }),
              creating: prev.creating && prev.creating.Id === id ? undefined : prev.creating,
              editing: prev.editing && prev.editing.Id === id ? undefined : prev.editing
            };
          }, function () {
            return resolve(true);
          });
        });
      });
    }
  }, {
    key: "_fetch",
    value: function _fetch(start) {
      var _this6 = this;

      var filters = this.state.filters;
      var _this$props = this.props,
          api = _this$props.api,
          step = _this$props.step;
      return api.Find(filters, start, start + step).then(function (result) {
        return new Promise(function (resolve) {
          _this6.setState(function (prev) {
            var newEntries = _toConsumableArray(prev.entries);

            newEntries.splice(start);
            return {
              entries: [].concat(_toConsumableArray(newEntries), _toConsumableArray(result.Values))
            };
          }, function () {
            return resolve();
          });
        });
      });
    }
  }, {
    key: "_loadMore",
    value: function _loadMore() {
      var entries = this.state.entries;
      return this._fetch(entries.length);
    }
  }, {
    key: "_refresh",
    value: function _refresh(id) {
      var _this7 = this;

      var api = this.props.api;

      if (id) {
        return api.Get(id).then(function (value) {
          return new Promise(function (resolve) {
            _this7.setState(function (prev) {
              return {
                entries: prev.entries.map(function (e) {
                  return e.Id === id ? value : e;
                })
              };
            }, function () {
              return resolve();
            });
          });
        });
      } else {
        return this._fetch(0);
      }
    }
  }, {
    key: "_get",
    value: function _get(id) {
      var api = this.props.api;
      var entries = this.state.entries;
      var entry = entries.find(function (e) {
        return e.Id === id;
      });

      if (entry) {
        return Promise.resolve(entry);
      } else {
        return api.Get(id);
      }
    }
  }, {
    key: "_edit",
    value: function _edit(id) {
      var _this8 = this;

      return this._get(id).then(function (value) {
        return new Promise(function (resolve) {
          _this8.setState(function (prev) {
            return {
              creating: undefined,
              editing: value
            };
          }, function () {
            return resolve(value);
          });
        });
      });
    }
  }]);

  return ModelBaseList;
}(React.Component);

exports.ModelBaseList = ModelBaseList;

var withList = function withList(UnwrappedComponent, api) {
  var ListView = ModelBaseList;
  return (
    /*#__PURE__*/
    function (_React$Component2) {
      _inherits(WithList, _React$Component2);

      function WithList() {
        _classCallCheck(this, WithList);

        return _possibleConstructorReturn(this, _getPrototypeOf(WithList).apply(this, arguments));
      }

      _createClass(WithList, [{
        key: "render",
        value: function render() {
          var _this9 = this;

          return React.createElement(ListView, {
            api: api,
            step: 50
          }, function (list) {
            return React.createElement(UnwrappedComponent, _objectSpread({}, _this9.props, {
              list: list
            }));
          });
        }
      }]);

      return WithList;
    }(React.Component)
  );
};

exports.withList = withList;
var _default = ModelBaseList;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _MovementsFields = _interopRequireDefault(require("../MovementsFields/MovementsFields"));

var _services = require("src/_services");

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var _OrderListItem = _interopRequireDefault(require("src/components/Orders/OrderListItem/OrderListItem"));

var _core = require("@material-ui/core");

var _OrderDetail = _interopRequireDefault(require("src/components/Orders/OrderDetail/OrderDetail"));

var _Filter = require("src/_helpers/Filter");

var _MovementsMessages = _interopRequireDefault(require("./MovementsMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var MovementsDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(MovementsDetail, _React$Component);

  function MovementsDetail(props) {
    var _this;

    _classCallCheck(this, MovementsDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(MovementsDetail).call(this, props));
    _this._Save = _this._Save.bind(_assertThisInitialized(_this));
    _this._Delete = _this._Delete.bind(_assertThisInitialized(_this));
    _this._OnChanged = _this._OnChanged.bind(_assertThisInitialized(_this));
    var id = props.id,
        preview = props.preview;
    _this.state = {
      id: id,
      changes: id ? {} : preview,
      current: preview,
      orders: []
    };
    return _this;
  }

  _createClass(MovementsDetail, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          intl = _this$props.intl,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          settingsCtx = _this$props.settingsCtx,
          shopCtx = _this$props.shopCtx,
          usersCtx = _this$props.usersCtx,
          templateCtx = _this$props.templateCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx;
      var _this$state = this.state,
          current = _this$state.current,
          loading = _this$state.loading,
          orders = _this$state.orders,
          orderOpened = _this$state.orderOpened;
      return React.createElement(_DetailGridContainer.default, null, React.createElement(_DetailGridColumn.default, null, React.createElement(_MovementsFields.default, {
        intl: intl,
        current: current,
        usersCtx: usersCtx,
        shopCtx: shopCtx,
        warehouseCtx: warehouseCtx,
        templateCtx: templateCtx,
        authCtx: authCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        onChange: this._OnChanged
      })), React.createElement(_DetailGridColumn.default, null, !loading && orders && orders.map(function (o) {
        var Id = o.Id;

        var open = function open() {
          return _this2.setState(function () {
            return {
              orderOpened: Id
            };
          });
        };

        var close = function close(callback) {
          return _this2.setState(function () {
            return {
              orderOpened: undefined
            };
          }, callback);
        };

        return React.createElement("div", {
          key: Id
        }, React.createElement(_OrderListItem.default, {
          intl: intl,
          onClick: open,
          order: o
        }), React.createElement(_core.Dialog, {
          open: orderOpened === o.Id
        }, React.createElement(_core.DialogContent, null, React.createElement(_OrderDetail.default, _extends({
          intl: intl,
          shopCtx: shopCtx,
          usersCtx: usersCtx,
          warehouseCtx: warehouseCtx,
          templateCtx: templateCtx,
          authCtx: authCtx,
          settingsCtx: settingsCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        }, {
          preventEditClient: true,
          preview: o,
          id: o.Id,
          onCancel: close,
          onChanged: function onChanged() {
            _this2._loadOrders();
          },
          onDelete: function onDelete() {
            close(function () {
              return _this2._loadOrders();
            });
          }
        })))));
      })), this._renderActions());
    }
  }, {
    key: "_renderActions",
    value: function _renderActions() {
      var _this3 = this;

      var _this$state2 = this.state,
          loading = _this$state2.loading,
          changes = _this$state2.changes,
          id = _this$state2.id;
      var changed = !!Object.keys(changes).length;
      var saveBtn = {
        icon: React.createElement(_icons.Check, null),
        onClick: function onClick() {
          return _this3._Save();
        },
        themeColor: 'green',
        legend: 'save'
      };
      var deleteBtn = {
        icon: React.createElement(_icons.Delete, null),
        legend: 'delete',
        themeColor: 'red',
        onClick: this._Delete
      };
      var cancelBtn = {
        icon: React.createElement(_icons.Close, null),
        onClick: function onClick() {
          return _this3.props.onCancel();
        },
        themeColor: 'gray',
        legend: changed ? 'cancel' : 'close'
      };

      if (loading) {
        return React.createElement(_Fabs.default, {
          map: ['loading']
        });
      }

      return React.createElement(_Fabs.default, {
        map: [changed && saveBtn, cancelBtn, !!id && deleteBtn]
      });
    }
  }, {
    key: "_OnChanged",
    value: function _OnChanged(changes) {
      var old = this.state.current;

      var current = _objectSpread({}, old, changes);

      this.setState(function (prev) {
        return {
          current: current,
          changes: _objectSpread({}, prev.changes, changes)
        };
      });
    }
  }, {
    key: "_loadOrders",
    value: function _loadOrders() {
      var _this4 = this;

      var id = this.state.id;

      if (!id) {
        return;
      }

      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        var filter = _Filter.Filter.Eq('ClientId', id);

        var def = {
          filters: [filter]
        };

        _services.Orders.Find(def, 0, 100).then(function (orders) {
          _this4.setState(function () {
            return {
              orders: orders.Values,
              loading: false
            };
          });
        });
      });
    }
  }, {
    key: "_Save",
    value: function _Save() {
      var _this5 = this;

      var _this$state3 = this.state,
          changes = _this$state3.changes,
          current = _this$state3.current,
          id = _this$state3.id;

      var final = _objectSpread({}, current, changes);

      if (id) {
        return _services.Movements.Patch(id, final).then(function (model) {
          _this5.setState(function () {
            return {
              changes: {},
              current: model
            };
          });

          if (_this5.props.onChanged) {
            _this5.props.onChanged(model);
          }
        });
      } else {
        return _services.Movements.Create(final).then(function (model) {
          _this5.setState(function () {
            return {
              changes: {},
              current: model,
              id: model.Id
            };
          });

          if (_this5.props.onChanged) {
            _this5.props.onChanged(model);
          }
        });
      }
    }
  }, {
    key: "_Delete",
    value: function _Delete() {
      var id = this.state.id;
      var _this$props2 = this.props,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isToDelete = window.confirm(formatMessage(_MovementsMessages.default.deleteConfirm));

      if (id && isToDelete) {
        _services.Movements.Delete(id).then(onDelete);
      }
    }
  }]);

  return MovementsDetail;
}(React.Component);

var _default = MovementsDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.MovementsMessages = void 0;

var _reactIntl = require("react-intl");

var MovementsMessages = (0, _reactIntl.defineMessages)({
  deleteConfirm: {
    "id": "src.components.forms.movements.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this voucher?"
  }
});
exports.MovementsMessages = MovementsMessages;
var _default = MovementsMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _MovementsFieldsMessages = _interopRequireDefault(require("./MovementsFieldsMessages"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _MenuItem = _interopRequireDefault(require("@material-ui/core/MenuItem"));

var _Switch = _interopRequireDefault(require("@material-ui/core/Switch"));

var _FormControlLabel = _interopRequireDefault(require("@material-ui/core/FormControlLabel"));

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _materialUiPickers = require("material-ui-pickers");

var _NumberField = _interopRequireDefault(require("src/components/NumberField/NumberField"));

var _CurrenciesField = _interopRequireDefault(require("src/components/CurrenciesField/CurrenciesField"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var MovementsFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(MovementsFields, _React$Component);

  function MovementsFields(props) {
    _classCallCheck(this, MovementsFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(MovementsFields).call(this, props));
  }

  _createClass(MovementsFields, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          settingsCtx = _this$props.settingsCtx,
          Shops = _this$props.shopCtx.Shops,
          usersCtx = _this$props.usersCtx,
          authCtx = _this$props.authCtx,
          current = _this$props.current,
          onChange = _this$props.onChange,
          formatMessage = _this$props.intl.formatMessage;
      var Amount = current.Amount,
          Archived = current.Archived,
          UserId = current.UserId,
          ShopId = current.ShopId,
          Note = current.Note,
          date = current.Date;

      var isAmdin = this._isAdmin(authCtx.user);

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_NumberField.default, {
        label: formatMessage(_MovementsFieldsMessages.default.amount),
        value: Amount || 0,
        step: "0.01",
        fullWidth: true,
        onNumberChange: function onNumberChange(amount) {
          onChange({
            Amount: amount
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_CurrenciesField.default, _extends({
        settingsCtx: settingsCtx
      }, {
        fullWidth: true,
        label: formatMessage(_MovementsFieldsMessages.default.currency),
        value: current.Currency,
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (e) {
          onChange({
            Currency: e.target.value
          });
        })
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_TextField.default, {
        fullWidth: true,
        select: true,
        label: formatMessage(_MovementsFieldsMessages.default.shop),
        onChange: function (_onChange2) {
          function onChange(_x2) {
            return _onChange2.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange2.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            ShopId: e.target.value
          });
        }),
        value: ShopId || '',
        disabled: !isAmdin
      }, Shops.map(function (s) {
        return React.createElement(_MenuItem.default, {
          key: s.Id,
          value: s.Id
        }, s.Name);
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, formatMessage(_MovementsFieldsMessages.default.user)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function (_onChange3) {
          function onChange(_x3) {
            return _onChange3.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange3.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            UserId: e.target.value
          });
        }),
        value: UserId || '',
        readOnly: !isAmdin
      }, usersCtx.Users.map(function (u) {
        return React.createElement(_MenuItem.default, {
          key: u.Id,
          value: u.Id
        }, u.FirstName, " ", u.LastName);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: "date",
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: date && new Date(date) || new Date(),
        onChange: function (_onChange4) {
          function onChange(_x4) {
            return _onChange4.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange4.toString();
          };

          return onChange;
        }(function (value) {
          return onChange({
            Date: value
          });
        }),
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_FormControlLabel.default, {
        control: React.createElement(_Switch.default, {
          checked: !!Archived,
          onChange: function (_onChange5) {
            function onChange(_x5) {
              return _onChange5.apply(this, arguments);
            }

            onChange.toString = function () {
              return _onChange5.toString();
            };

            return onChange;
          }(function (e) {
            return onChange({
              Archived: e.target.checked
            });
          }),
          color: "primary"
        }),
        label: formatMessage(_MovementsFieldsMessages.default.archived)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        fullWidth: true,
        multiline: true,
        label: formatMessage(_MovementsFieldsMessages.default.note),
        value: Note || '',
        onChange: function (_onChange6) {
          function onChange(_x6) {
            return _onChange6.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange6.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            Note: e.target.value
          });
        })
      })));
    }
  }, {
    key: "_isAdmin",
    value: function _isAdmin(user) {
      return user && user.Roles && user.Roles.indexOf('Admin') >= 0;
    }
  }]);

  return MovementsFields;
}(React.Component);

var _default = MovementsFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.MovementsFieldsMessages = void 0;

var _reactIntl = require("react-intl");

var MovementsFieldsMessages = (0, _reactIntl.defineMessages)({
  shop: {
    "id": "src.components.forms.movements.shop",
    "defaultMessage": "Shop"
  },
  user: {
    "id": "src.components.forms.movements.user",
    "defaultMessage": "User"
  },
  note: {
    "id": "src.components.forms.movements.note",
    "defaultMessage": "Note"
  },
  archived: {
    "id": "src.components.forms.movements.archived",
    "defaultMessage": "Archived"
  },
  currency: {
    "id": "src.components.forms.movements.currency",
    "defaultMessage": "Currency"
  },
  amount: {
    "id": "src.components.forms.movements.amount",
    "defaultMessage": "Amount"
  }
});
exports.MovementsFieldsMessages = MovementsFieldsMessages;
var _default = MovementsFieldsMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../_services");

var _reactIntl = require("react-intl");

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var classNames = _interopRequireWildcard(require("classnames"));

var _throttleDebounce = require("throttle-debounce");

var _materialUiPickers = require("material-ui-pickers");

var _WarehouseIcon = _interopRequireDefault(require("src/components/Products/ProductDetail/WarehouseIcon"));

var _ShopsList = _interopRequireDefault(require("./ShopsList"));

var _StockList = _interopRequireDefault(require("./StockList"));

var _NumberField = _interopRequireDefault(require("src/components/NumberField/NumberField"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var LOCAL_STORAGE_KEY = 'our.orders.MovementsList';

var DefaultFilters = function DefaultFilters() {
  return {
    archived: false,
    sortAttribute: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute")) || 'Creation',
    sortDirection: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection")) || 'descending'
  };
};

var MovementsList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(MovementsList, _React$Component);

  function MovementsList(props) {
    var _this;

    _classCallCheck(this, MovementsList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(MovementsList).call(this, props));
    _this._refreshCashbox = _this._refreshCashbox.bind(_assertThisInitialized(_this));
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh);
    _this._toggleFilterArchived = _this._toggleFilterArchived.bind(_assertThisInitialized(_this));
    _this.state = _objectSpread({}, DefaultFilters(), {
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      drawerOpen: false,
      lastUpdate: new Date().getTime()
    });
    return _this;
  }

  _createClass(MovementsList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      this._refreshCashbox();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this2 = this;

      setTimeout(function () {
        var prevSortAttribute = prevState.sortAttribute,
            prevSortDirection = prevState.sortDirection;
        var _this2$state = _this2.state,
            sortAttribute = _this2$state.sortAttribute,
            sortDirection = _this2$state.sortDirection;

        if (sortAttribute !== prevSortAttribute) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute"), sortAttribute);
        }

        if (sortDirection !== prevSortDirection) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection"), sortDirection);
        }
      }, 0);
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this,
          _classNames;

      var _this$state = this.state,
          drawerOpen = _this$state.drawerOpen,
          archived = _this$state.archived,
          from = _this$state.from,
          to = _this$state.to,
          activeLabel = _this$state.activeLabel,
          min = _this$state.min,
          max = _this$state.max,
          sku = _this$state.sku,
          cashbox = _this$state.cashbox,
          sortAttribute = _this$state.sortAttribute,
          sortDirection = _this$state.sortDirection;
      var _this$props = this.props,
          classes = _this$props.classes,
          intl = _this$props.intl,
          settingsCtx = _this$props.settingsCtx,
          templateCtx = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          user = _this$props.authCtx.user,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          shopCtx = _this$props.shopCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx;

      var fromDateChange = function fromDateChange(value) {
        _this3.setState(function () {
          return {
            from: value || undefined
          };
        }, _this3._refresh);
      };

      var toDateChange = function toDateChange(value) {
        _this3.setState(function () {
          return {
            to: value || undefined
          };
        }, _this3._refresh);
      };

      var isShops = activeLabel && shopCtx.Shops.find(function (s) {
        return s.Id === activeLabel;
      });
      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classNames(classes.menu)
      }, (0, _roles.IsAdminOrInRole)(user, 'View_Shops_Movements') && shopCtx.Shops.map(function (s) {
        var active = activeLabel === s.Id;
        return React.createElement(_core.ListItem, {
          key: "shop-".concat(s.Id),
          button: true,
          onClick: function onClick() {
            return _this3._toggleActive(s.Id);
          },
          className: classNames(classes.menuItem, classes.menuItemCashbox, active && classes.menuItemActive)
        }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Store, null)), React.createElement(_core.ListItemText, null, " ", s.Name, cashbox && cashbox[s.Id] && React.createElement("div", {
          className: classes.cashboxes
        }, Object.keys(cashbox[s.Id]).map(function (currency) {
          return cashbox[s.Id][currency] ? React.createElement("span", {
            key: "".concat(s.Id, "-").concat(currency),
            className: classNames(classes.categoryCount, active && classes.categoryCountActive)
          }, React.createElement(_reactIntl.FormattedNumber, {
            currency: currency,
            style: "currency",
            value: cashbox[s.Id][currency]
          })) : null;
        }))));
      }), React.createElement(_core.Divider, null), warehouseCtx.Warehouses.map(function (w) {
        var active = activeLabel === w.Id;
        return React.createElement(_core.ListItem, {
          key: "warehouse-".concat(w.Id),
          button: true,
          onClick: function onClick() {
            return _this3._toggleActive(w.Id);
          },
          className: classNames(classes.menuItem, classes.menuItemCashbox, active && classes.menuItemActive)
        }, React.createElement(_core.ListItemIcon, null, React.createElement(_WarehouseIcon.default, null)), React.createElement(_core.ListItemText, null, " ", w.Name));
      }), React.createElement(_core.Divider, null), isShops && React.createElement(_core.ListItem, {
        button: true,
        onClick: function onClick() {
          return _this3._toggleFilterArchived();
        },
        className: classNames(classes.menuItem, archived && classes.menuItemActive, classes.menuItemLast)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Archive, null)), React.createElement(_core.ListItemText, null, "Archived")), React.createElement(_core.ListItem, {
        button: true,
        className: classNames(classes.menuItem, !isShops && classes.menuItemLast, (from || to) && classes.menuItemActive),
        onClick: function onClick() {
          return _this3.setState(function (prev) {
            return {
              drawerOpen: !prev.drawerOpen
            };
          });
        }
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Sort, null)), React.createElement(_core.ListItemText, null, "Filters")))), React.createElement(_core.Grid, {
        item: true,
        className: classNames(classes.drawer, (_classNames = {}, _defineProperty(_classNames, classes.drawerOpen, drawerOpen), _defineProperty(_classNames, classes.drawerClose, !drawerOpen), _classNames))
      }, React.createElement(_GridContainer.GridContainer, {
        className: classes.drawerContent,
        direction: "column"
      }, isShops ? React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: "From",
        fullWidth: true,
        keyboard: true,
        clearable: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: from || null,
        onChange: fromDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: "To",
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        clearable: true,
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: to || null,
        onChange: toDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        style: {
          marginTop: 'auto',
          display: 'flex'
        }
      }, React.createElement(_core.IconButton, {
        onClick: function onClick() {
          return _this3.setState(function (prev) {
            var dir = prev.sortDirection === 'ascending' ? 'descending' : 'ascending';
            return {
              sortDirection: dir
            };
          }, _this3._refresh);
        }
      }, sortDirection === 'descending' ? React.createElement(_icons.ArrowUpward, null) : React.createElement(_icons.ArrowDownward, null)), React.createElement(_core.TextField, {
        label: "sort",
        fullWidth: true,
        value: sortAttribute || '',
        select: true,
        onChange: function onChange(value) {
          var v = value.target.value;

          _this3.setState(function () {
            return {
              sortAttribute: v
            };
          }, _this3._refresh);
        }
      }, ['Date', 'User', 'Currency', 'Amount', 'Creation'].map(function (k) {
        return React.createElement(_core.MenuItem, {
          key: k,
          value: k
        }, k);
      })))) : React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: "SKU",
        fullWidth: true,
        value: sku,
        onChange: function onChange(e) {
          var v = e.target.value;

          _this3.setState(function () {
            return {
              sku: v
            };
          });
        }
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_NumberField.default, {
        step: "1",
        label: "Min",
        value: min,
        fullWidth: true,
        onNumberChange: function onNumberChange(num) {
          _this3.setState(function () {
            return {
              min: num
            };
          });
        }
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_NumberField.default, {
        step: "1",
        label: "Max",
        value: max,
        fullWidth: true,
        onNumberChange: function onNumberChange(num) {
          _this3.setState(function () {
            return {
              max: num
            };
          });
        }
      }))))), React.createElement(_core.Grid, {
        item: true,
        className: classes.content
      }, activeLabel && shopCtx.Shops.find(function (s) {
        return s.Id === activeLabel;
      }) && React.createElement(_ShopsList.default, _extends({
        key: activeLabel,
        id: activeLabel,
        refreshCashbox: function refreshCashbox() {
          return _this3._refreshCashbox();
        }
      }, {
        intl: intl,
        settingsCtx: settingsCtx,
        templateCtx: templateCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        shopCtx: shopCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        from: from,
        to: to,
        archived: archived,
        sortAttribute: sortAttribute,
        sortDirection: sortDirection
      })), activeLabel && warehouseCtx.Warehouses.find(function (s) {
        return s.Id === activeLabel;
      }) && React.createElement(_StockList.default, _extends({
        id: activeLabel,
        key: activeLabel
      }, {
        intl: intl,
        settingsCtx: settingsCtx,
        templateCtx: templateCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        shopCtx: shopCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        min: min,
        max: max,
        sku: sku
      }))));
    }
  }, {
    key: "_toggleFilterArchived",
    value: function _toggleFilterArchived() {
      var _this4 = this;

      this.setState(function (prev) {
        return {
          archived: !prev.archived
        };
      }, function () {
        return _this4._refresh();
      });
    }
  }, {
    key: "_toggleActive",
    value: function _toggleActive(id) {
      this.setState(function () {
        return {
          activeLabel: id
        };
      });
    }
  }, {
    key: "_refreshCashbox",
    value: function _refreshCashbox() {
      var _this5 = this;

      _services.Movements.Cashbox().then(function (cashbox) {
        return _this5.setState(function () {
          return {
            cashbox: cashbox
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      this._refreshCashbox();
    }
  }]);

  return MovementsList;
}(React.Component);

var drawerWidth = '16rem';
var drawerSidesPadding = '11px';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      zIndex: theme.zIndex.drawer + 1,
      display: 'flex',
      flexDirection: 'column',
      boxSizing: 'border-box'
    },
    cashboxes: {
      fontSize: theme.typography.body2.fontSize
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    drawer: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    drawerContent: {
      // paddingRight: drawerSidesPadding,
      // paddingLeft: drawerSidesPadding,
      // width: drawerWidth,
      // position: 'absolute',
      // height: '100%',
      // left: 0,
      // right: 0
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative'
    },
    drawerOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    drawerClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItem: {
      paddingRight: drawerSidesPadding,
      paddingLeft: drawerSidesPadding,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      flex: '0 0 auto',
      opacity: 0.5,
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    menuItemCashbox: {},
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    categoryCount: {
      background: '#cccccc',
      borderRadius: '16px',
      color: '#ffffff',
      display: 'inline-block',
      padding: '4px 8px',
      marginRight: theme.spacing.unit
    },
    categoryCountActive: {
      background: theme.palette.primary.main
    },
    noBalance: {
      display: 'flex',
      flexDirection: 'column',
      justifyContent: 'center',
      alignItems: 'center',
      height: '100%'
    },
    noBalanceIcon: {
      fontSize: 200,
      color: theme.palette.grey[200]
    }
  };
})(MovementsList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactVirtualized = require("react-virtualized");

var _MovementsListItem = _interopRequireDefault(require("../MovementsListItem/MovementsListItem"));

var _services = require("../../../_services");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _throttleDebounce = require("throttle-debounce");

var _MovementsDetail = _interopRequireDefault(require("../MovementsDetail/MovementsDetail"));

var _Filter = require("src/_helpers/Filter");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ShopsList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ShopsList, _React$Component);

  function ShopsList(props) {
    var _this;

    _classCallCheck(this, ShopsList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopsList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_loadedRowsMap", {});

    _defineProperty(_assertThisInitialized(_this), "_list", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStartIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStopIndex", void 0);

    _this._isRowLoaded = _this._isRowLoaded.bind(_assertThisInitialized(_this));
    _this._loadMore = _this._loadMore.bind(_assertThisInitialized(_this));
    _this._rowRenderer = _this._rowRenderer.bind(_assertThisInitialized(_this));
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh); // this._toggleFilterArchived = this._toggleFilterArchived.bind(this);

    _this.state = {
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      drawerOpen: false,
      lastUpdate: new Date().getTime()
    };
    return _this;
  }

  _createClass(ShopsList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      this._loadMore({
        startIndex: 0,
        stopIndex: 0
      });

      this._refreshCashbox();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this2 = this;

      if (Object.keys(prevProps).some(function (k) {
        return _this2.props[k] !== prevProps[k];
      })) {
        this._refresh();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$state = this.state,
          rowCount = _this$state.rowCount,
          editing = _this$state.editing,
          creating = _this$state.creating,
          cashbox = _this$state.cashbox,
          fetching = _this$state.fetching,
          balancing = _this$state.balancing;
      var _this$props = this.props,
          intl = _this$props.intl,
          classes = _this$props.classes,
          templates = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          shopCtx = _this$props.shopCtx,
          authCtx = _this$props.authCtx,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          id = _this$props.id,
          archived = _this$props.archived;
      var loading = fetching || balancing;

      var add = function add() {
        _this3.setState(function () {
          return {
            fetching: true
          };
        }, function () {
          _services.Movements.Empty('CHF', {}).then(function (empty) {
            return _this3.setState(function () {
              return {
                creating: empty,
                fetching: false
              };
            });
          });
        });
      };

      var cancel = function cancel() {
        _this3.setState(function () {
          return {
            editing: -1,
            creating: undefined
          };
        });
      };

      var needsBalance = cashbox && id && cashbox[id] && Object.keys(cashbox[id]).some(function (currency) {
        return !!cashbox[id][currency];
      });

      var balance = function balance() {
        if (!cashbox || !id) {
          return;
        }

        _this3.setState(function () {
          return {
            balancing: true
          };
        }, function () {
          _services.Movements.Balance(id).then(function () {
            return _this3.setState(function () {
              return {
                balancing: false
              };
            }, function () {
              _this3._refresh();

              _this3.props.refreshCashbox();
            });
          });
        });
      };

      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.content
      }, needsBalance || archived ? React.createElement(_reactVirtualized.InfiniteLoader, {
        isRowLoaded: this._isRowLoaded,
        loadMoreRows: this._loadMore,
        rowCount: rowCount
      }, function (_ref) {
        var onRowsRendered = _ref.onRowsRendered,
            registerChild = _ref.registerChild;
        return React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
          var h = _ref2.height,
              w = _ref2.width;
          return React.createElement(_reactVirtualized.List, {
            ref: function ref(list) {
              _this3._list = list;
              registerChild(list);
            },
            height: h,
            onRowsRendered: onRowsRendered,
            rowCount: rowCount,
            rowHeight: _this3.state.rowHeight,
            rowRenderer: _this3._rowRenderer,
            width: w,
            style: {
              outline: 'none'
            }
          });
        });
      }) : React.createElement("div", {
        className: classes.noBalance
      }, React.createElement(_icons.CheckCircleOutline, {
        className: classes.noBalanceIcon
      }))), React.createElement(_Fabs.default, {
        map: loading ? [{
          icon: React.createElement(_icons.Cached, null),
          legend: 'loading',
          themeColor: 'gray'
        }] : [{
          icon: React.createElement(_icons.Add, null),
          legend: 'add new',
          onClick: add,
          color: 'primary',
          themeColor: 'green'
        }, needsBalance && {
          icon: React.createElement(_icons.AccountBalance, null),
          legend: 'balance cash',
          themeColor: 'gray',
          onClick: balance
        }]
      }), React.createElement(_core.Dialog, {
        open: editing >= 0,
        fullScreen: true,
        onClose: cancel
      }, editing >= 0 && React.createElement(_MovementsDetail.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templates
      }, {
        id: this._loadedRowsMap[editing].Id,
        preview: this._loadedRowsMap[editing],
        onCancel: function onCancel() {
          _this3.setState(function () {
            return {
              editing: -1,
              creating: undefined
            };
          });
        },
        onChanged: function onChanged(order) {
          _this3._handleItemChanged(order, editing);
        },
        onDelete: function onDelete() {
          _this3._handleOrderDeleted();
        } // uid={this._editingLightboxId}
        ,
        key: editing
      }))), React.createElement(_core.Dialog, {
        open: !!creating,
        fullScreen: true,
        onClose: close
      }, creating && React.createElement(_MovementsDetail.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templates
      }, {
        preview: creating,
        onCancel: function onCancel() {
          _this3.setState(function () {
            return {
              editing: -1,
              creating: undefined
            };
          });
        },
        onChanged: function onChanged() {
          _this3._refresh();
        },
        onDelete: function onDelete() {
          _this3._handleOrderDeleted();
        }
      }))));
    }
  }, {
    key: "_refreshCashbox",
    value: function _refreshCashbox() {
      var _this4 = this;

      _services.Movements.Cashbox().then(function (cashbox) {
        return _this4.setState(function () {
          return {
            cashbox: cashbox
          };
        });
      });
    }
  }, {
    key: "_rowRenderer",
    value: function _rowRenderer(props) {
      var _this5 = this;

      var intl = this.props.intl;
      var index = props.index;
      var movement = this._loadedRowsMap[index];
      return React.createElement("div", {
        key: "".concat(props.key, "-").concat(this.state.lastUpdate),
        style: props.style
      }, React.createElement(_MovementsListItem.default, {
        movement: movement,
        intl: intl,
        onClick: movement ? function () {
          return _this5.setState(function () {
            return {
              editing: index
            };
          });
        } : undefined
      }));
    }
  }, {
    key: "_loadMore",
    value: function _loadMore(range) {
      var _this6 = this;

      var stopIndex = range.stopIndex,
          startIndex = range.startIndex;
      this._loadMoreRowsStartIndex = startIndex;
      this._loadMoreRowsStopIndex = stopIndex;
      var _this$props2 = this.props,
          id = _this$props2.id,
          archived = _this$props2.archived,
          from = _this$props2.from,
          to = _this$props2.to,
          sortAttribute = _this$props2.sortAttribute,
          sortDirection = _this$props2.sortDirection;
      var delta = stopIndex - startIndex;
      var sort = "".concat(sortDirection === 'ascending' ? '' : '-').concat(sortAttribute);
      this.setState(function (prev) {
        return {
          loading: prev.loading + delta,
          fetching: true
        };
      });
      var filters = [];

      if (!archived) {
        filters.push(_Filter.Filter.Eq('Archived', false));
      }

      if (id) {
        filters.push(_Filter.Filter.Eq('ShopId', id));
      }

      if (from) {
        filters.push(_Filter.Filter.Gte('Creation', from));
      }

      if (to) {
        filters.push(_Filter.Filter.Lte('Creation', to));
      }

      return _services.Movements.Find({
        filters: filters,
        operator: 'and',
        sort: sort
      }, startIndex, stopIndex + 1).then(function (response) {
        var count = response.Values.length;
        response.Values.forEach(function (voucher, i) {
          _this6._loadedRowsMap[startIndex + i] = voucher;
        });

        _this6.setState(function (prev) {
          return {
            loading: prev.loading - count,
            loaded: prev.loaded + count,
            rowCount: response.Count,
            lastUpdate: new Date().getTime(),
            fetching: false
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this7 = this;

      this._loadedRowsMap = {};

      if (this._list) {
        this._list.forceUpdate();

        this._list.forceUpdateGrid();
      }

      this._refreshCashbox();

      this.setState(function () {
        return {
          editing: -1,
          rowCount: 0,
          loaded: 0,
          loading: 0,
          lastUpdate: new Date().getTime()
        };
      }, function () {
        _this7._loadMore({
          startIndex: _this7._loadMoreRowsStartIndex,
          stopIndex: _this7._loadMoreRowsStopIndex
        }).then(function () {
          if (_this7._list) {
            _this7._list.forceUpdate();

            _this7._list.forceUpdateGrid();
          }
        });
      });
    }
  }, {
    key: "_handleItemChanged",
    value: function _handleItemChanged(movement, index) {
      this._loadedRowsMap[index] = movement;

      if (this._list) {
        this._list.forceUpdateGrid();
      }

      this._refreshCashbox();

      this.setState(function () {
        return {
          editing: index,
          lastUpdate: new Date().getTime()
        };
      });
    }
  }, {
    key: "_handleOrderDeleted",
    value: function _handleOrderDeleted() {
      var _this8 = this;

      this.setState(function () {
        return {
          editing: -1
        };
      }, function () {
        return _this8._refresh();
      });
    }
  }, {
    key: "_isRowLoaded",
    value: function _isRowLoaded(ind) {
      // No entry in this map signifies that the row has never been loaded before
      return !!this._loadedRowsMap[ind.index];
    }
  }]);

  return ShopsList;
}(React.Component);

var drawerWidth = '16rem';
var drawerSidesPadding = '11px';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      zIndex: theme.zIndex.drawer + 1,
      display: 'flex',
      flexDirection: 'column',
      boxSizing: 'border-box'
    },
    cashboxes: {
      fontSize: theme.typography.body2.fontSize
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    drawer: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    drawerContent: {
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative',
      padding: '0 40px'
    },
    drawerOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    drawerClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItem: {
      paddingRight: drawerSidesPadding,
      paddingLeft: drawerSidesPadding,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      flex: '0 0 auto',
      opacity: 0.5,
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    menuItemCashbox: {},
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    categoryCount: {
      background: '#cccccc',
      borderRadius: '16px',
      color: '#ffffff',
      display: 'inline-block',
      padding: '4px 8px',
      marginRight: theme.spacing.unit
    },
    categoryCountActive: {
      background: theme.palette.primary.main
    },
    noBalance: {
      display: 'flex',
      flexDirection: 'column',
      justifyContent: 'center',
      alignItems: 'center',
      height: '100%'
    },
    noBalanceIcon: {
      fontSize: 200,
      color: theme.palette.grey[200]
    }
  };
})(ShopsList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactVirtualized = require("react-virtualized");

var _services = require("../../../_services");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _throttleDebounce = require("throttle-debounce");

var _Filter = require("src/_helpers/Filter");

var _StockListItem = _interopRequireDefault(require("../StockListItem/StockListItem"));

var _Stock = _interopRequireDefault(require("src/components/Stock/Stock"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var StockList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(StockList, _React$Component);

  function StockList(props) {
    var _this;

    _classCallCheck(this, StockList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(StockList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_loadedRowsMap", {});

    _defineProperty(_assertThisInitialized(_this), "_list", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStartIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStopIndex", void 0);

    _this._handelOpen = _this._handelOpen.bind(_assertThisInitialized(_this));
    _this._handelClose = _this._handelClose.bind(_assertThisInitialized(_this));
    _this._isRowLoaded = _this._isRowLoaded.bind(_assertThisInitialized(_this));
    _this._loadMore = _this._loadMore.bind(_assertThisInitialized(_this));
    _this._rowRenderer = _this._rowRenderer.bind(_assertThisInitialized(_this));
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh);
    _this.state = {
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      drawerOpen: false,
      lastUpdate: new Date().getTime()
    };
    return _this;
  }

  _createClass(StockList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      this._loadMore({
        startIndex: 0,
        stopIndex: 0
      });
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this2 = this;

      if (Object.keys(prevProps).some(function (k) {
        return _this2.props[k] !== prevProps[k];
      })) {
        this._refresh();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$state = this.state,
          rowCount = _this$state.rowCount,
          fetching = _this$state.fetching,
          openDialog = _this$state.openDialog,
          dialogSku = _this$state.dialogSku,
          dialogTitle = _this$state.dialogTitle;
      var _this$props = this.props,
          classes = _this$props.classes,
          settingsCtx = _this$props.settingsCtx,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx;
      var loading = fetching;
      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.content
      }, React.createElement(_reactVirtualized.InfiniteLoader, {
        isRowLoaded: this._isRowLoaded,
        loadMoreRows: this._loadMore,
        rowCount: rowCount
      }, function (_ref) {
        var onRowsRendered = _ref.onRowsRendered,
            registerChild = _ref.registerChild;
        return React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
          var h = _ref2.height,
              w = _ref2.width;
          return React.createElement(_reactVirtualized.List, {
            ref: function ref(list) {
              _this3._list = list;
              registerChild(list);
            },
            height: h,
            onRowsRendered: onRowsRendered,
            rowCount: rowCount,
            rowHeight: _this3.state.rowHeight,
            rowRenderer: _this3._rowRenderer,
            width: w,
            style: {
              outline: 'none'
            }
          });
        });
      })), React.createElement(_core.Dialog, {
        maxWidth: "lg",
        open: !!openDialog,
        onClose: this._handelClose
      }, React.createElement(_core.DialogContent, null, React.createElement(_Stock.default, _extends({
        settingsCtx: settingsCtx,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx
      }, {
        skus: [{
          sku: dialogSku,
          legend: dialogTitle
        }]
      }))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: this._handelClose
      }, "Close"))), React.createElement(_Fabs.default, {
        map: [loading && {
          icon: React.createElement(_icons.Cached, null),
          legend: 'loading',
          themeColor: 'gray'
        }]
      }));
    }
  }, {
    key: "_handelOpen",
    value: function _handelOpen() {
      this.setState({
        openDialog: true
      });
    }
  }, {
    key: "_handelClose",
    value: function _handelClose() {
      this.setState({
        openDialog: false
      });
    }
  }, {
    key: "_rowRenderer",
    value: function _rowRenderer(props) {
      var _this4 = this;

      var _this$props2 = this.props,
          productCtx = _this$props2.productCtx,
          products = _this$props2.productCtx.products;
      var index = props.index;
      var lastUpdate = this.state.lastUpdate;
      var product = this._loadedRowsMap[index];
      var title = product && products.filter(function (p) {
        return p.SKU === product.SKU;
      }).map(function (p) {
        return p.Title;
      }).join(', ');
      return React.createElement(_StockListItem.default, _extends({
        key: "".concat(props.key, "-").concat(lastUpdate),
        style: props.style,
        onClick: function onClick() {
          if (product) {
            _this4.setState(function () {
              return {
                openDialog: true,
                dialogSku: product.SKU,
                dialogTitle: title
              };
            });
          }
        }
      }, {
        productCtx: productCtx,
        product: product,
        title: title
      }));
    }
  }, {
    key: "_loadMore",
    value: function _loadMore(range) {
      var _this5 = this;

      var stopIndex = range.stopIndex,
          startIndex = range.startIndex;
      this._loadMoreRowsStartIndex = startIndex;
      this._loadMoreRowsStopIndex = stopIndex;
      var _this$props3 = this.props,
          id = _this$props3.id,
          min = _this$props3.min,
          max = _this$props3.max,
          sku = _this$props3.sku;
      var delta = stopIndex - startIndex;
      this.setState(function (prev) {
        return {
          loading: prev.loading + delta,
          fetching: true
        };
      });
      var filters = [];

      if (sku) {
        filters.push(_Filter.Filter.Like('SKU', sku));
      }

      return _services.StockUnits.Warehouse(id, {
        filters: filters,
        operator: 'and'
      }, min === undefined ? -1 : min, max === undefined ? -1 : max, startIndex, stopIndex + 1).then(function (response) {
        var count = response.Values.length;
        response.Values.forEach(function (voucher, i) {
          _this5._loadedRowsMap[startIndex + i] = voucher;
        });

        _this5.setState(function (prev) {
          return {
            loading: prev.loading - count,
            loaded: prev.loaded + count,
            rowCount: response.Count,
            lastUpdate: new Date().getTime(),
            fetching: false
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this6 = this;

      this._loadedRowsMap = {};

      if (this._list) {
        this._list.forceUpdate();

        this._list.forceUpdateGrid();
      } // this._refreshCashbox();


      this.setState(function () {
        return {
          editing: -1,
          rowCount: 0,
          loaded: 0,
          loading: 0,
          lastUpdate: new Date().getTime()
        };
      }, function () {
        _this6._loadMore({
          startIndex: _this6._loadMoreRowsStartIndex,
          stopIndex: _this6._loadMoreRowsStopIndex
        }).then(function () {
          if (_this6._list) {
            _this6._list.forceUpdate();

            _this6._list.forceUpdateGrid();
          }
        });
      });
    }
  }, {
    key: "_isRowLoaded",
    value: function _isRowLoaded(ind) {
      // No entry in this map signifies that the row has never been loaded before
      return !!this._loadedRowsMap[ind.index];
    }
  }]);

  return StockList;
}(React.Component);

var drawerWidth = '16rem';
var drawerSidesPadding = '11px';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      zIndex: theme.zIndex.drawer + 1,
      display: 'flex',
      flexDirection: 'column',
      boxSizing: 'border-box'
    },
    cashboxes: {
      fontSize: theme.typography.body2.fontSize
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    drawer: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    drawerContent: {
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative',
      padding: '0 40px'
    },
    drawerOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    drawerClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItem: {
      paddingRight: drawerSidesPadding,
      paddingLeft: drawerSidesPadding,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      flex: '0 0 auto',
      opacity: 0.5,
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    menuItemCashbox: {},
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    categoryCount: {
      background: '#cccccc',
      borderRadius: '16px',
      color: '#ffffff',
      display: 'inline-block',
      padding: '4px 8px',
      marginRight: theme.spacing.unit
    },
    categoryCountActive: {
      background: theme.palette.primary.main
    },
    noBalance: {
      display: 'flex',
      flexDirection: 'column',
      justifyContent: 'center',
      alignItems: 'center',
      height: '100%'
    },
    noBalanceIcon: {
      fontSize: 200,
      color: theme.palette.grey[200]
    }
  };
})(StockList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

var MovementsListItem = function MovementsListItem(props) {
  var onClick = props.onClick,
      movement = props.movement,
      classes = props.classes;

  if (!movement) {
    return React.createElement("div", {
      className: classes.container
    }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, {
      loading: true
    }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
      loading: true
    }), React.createElement(_ItemPreview.Line, {
      loading: true
    }))));
  }

  return React.createElement("div", {
    onClick: onClick,
    className: classes.container
  }, React.createElement(_ItemPreview.default, null, movement.Amount > 0 && React.createElement(_core.Avatar, {
    className: classNames(classes.Icon, !movement.Archived && classes.AmountIn)
  }, React.createElement(_icons.ArrowDownward, null)), movement.Amount <= 0 && React.createElement(_core.Avatar, {
    className: classNames(classes.Icon, !movement.Archived && classes.AmountOut)
  }, React.createElement(_icons.ArrowUpward, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, movement.User), React.createElement(_ItemPreview.Line, null, React.createElement("span", null, React.createElement(_reactIntl.FormattedNumber, {
    value: movement.Amount,
    style: "currency",
    currency: movement.Currency
  }))))));
};

var width = '3rem';
var height = '3rem';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2
    },
    Icon: {
      width: width,
      height: height,
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    AmountIn: {
      background: theme.Colors.green.primary.main,
      color: theme.Colors.green.primary.contrastText
    },
    AmountOut: {
      background: theme.Colors.blue.primary.main,
      color: theme.Colors.blue.primary.contrastText
    },
    Archived: {}
  };
})(MovementsListItem);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _core = require("@material-ui/core");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var StockListItem = function StockListItem(props) {
  var product = props.product,
      classes = props.classes,
      productCtx = props.productCtx,
      title = props.title,
      divProps = _objectWithoutProperties(props, ["product", "classes", "productCtx", "title"]);

  if (!product) {
    return React.createElement("div", _extends({}, divProps, {
      className: classNames(divProps.className, classes.container)
    }), React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, {
      loading: true
    }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
      loading: true
    }), React.createElement(_ItemPreview.Line, {
      loading: true
    }))));
  }

  return React.createElement("div", _extends({}, divProps, {
    className: classNames(divProps.className, classes.container)
  }), React.createElement(_ItemPreview.default, null, React.createElement(_core.Avatar, {
    className: classNames(classes.Icon, product.Stock === 0 && classes.Danger, product.Stock && product.Stock <= 10 && classes.Warning, product.Stock && product.Stock > 10 && classes.Good)
  }, product.Stock), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, product.SKU, ": (", title, ")"))));
};

var width = '3rem';
var height = '3rem';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2
    },
    Icon: {
      width: width,
      height: height,
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main,
      fontSize: '1rem'
    },
    Danger: {
      color: theme.Colors.red.primary.contrastText,
      backgroundColor: theme.Colors.red.primary.main,
      fontSize: '1rem'
    },
    Warning: {
      color: theme.Colors.orange.primary.contrastText,
      backgroundColor: theme.Colors.orange.primary.main,
      fontSize: '1rem'
    },
    Good: {
      color: theme.Colors.green.primary.contrastText,
      backgroundColor: theme.Colors.green.primary.main,
      fontSize: '1rem'
    }
  };
})(StockListItem);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var NumberField =
/*#__PURE__*/
function (_React$PureComponent) {
  _inherits(NumberField, _React$PureComponent);

  function NumberField() {
    _classCallCheck(this, NumberField);

    return _possibleConstructorReturn(this, _getPrototypeOf(NumberField).apply(this, arguments));
  }

  _createClass(NumberField, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          step = _this$props.step,
          onNumberChange = _this$props.onNumberChange,
          _onChange = _this$props.onChange,
          textFieldProps = _objectWithoutProperties(_this$props, ["step", "onNumberChange", "onChange"]);

      return React.createElement(_TextField.default, _extends({}, textFieldProps, {
        inputProps: {
          step: step
        },
        type: "number",
        onChange: function onChange(e) {
          var val = e.target.value;
          var parsedVal = val === '' ? 0 : parseFloat(val);
          onNumberChange(parsedVal);

          if (_onChange) {
            _onChange(e);
          }
        }
      }));
    }
  }]);

  return NumberField;
}(React.PureComponent);

var _default = NumberField;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _OrderReciept = _interopRequireDefault(require("../OrderReciept/OrderReciept"));

var _PostFinanceButton = _interopRequireDefault(require("./Pay/PostFinance/PostFinanceButton"));

var _CCTerminalButton = _interopRequireDefault(require("./Pay/CCTerminal/CCTerminalButton"));

var _Button = _interopRequireDefault(require("./Pay/Transfer/Button"));

var _VoucherButton = _interopRequireDefault(require("./Pay/Voucher/VoucherButton"));

var _PayPalButton = _interopRequireDefault(require("./Pay/PayPal/PayPalButton"));

var _Button2 = _interopRequireDefault(require("./Pay/Cash/Button"));

var _StripeButton = _interopRequireDefault(require("./Pay/Stripe/StripeButton"));

var _OrderCheckoutPickup = _interopRequireDefault(require("./OrderCheckoutPickup"));

var _OrderCheckoutShipping = _interopRequireDefault(require("./OrderCheckoutShipping"));

var _services = require("src/_services");

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _styles = require("@material-ui/core/styles");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("./OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

var _OrderDocumentsDialog = require("../OrderDetail/OrderDocumentsDialog");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderCheckout =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderCheckout, _React$Component);

  function OrderCheckout(props) {
    var _this;

    _classCallCheck(this, OrderCheckout);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderCheckout).call(this, props));
    _this._applyUpdates = _this._applyUpdates.bind(_assertThisInitialized(_this));
    _this.state = {
      stock: _this._getStock()
    };
    return _this;
  }

  _createClass(OrderCheckout, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          save = _this$props.save,
          refresh = _this$props.refresh,
          settingsCtx = _this$props.settingsCtx,
          templateCtx = _this$props.templateCtx,
          shopCtx = _this$props.shopCtx,
          intl = _this$props.intl,
          order = _this$props.order,
          authCtx = _this$props.authCtx,
          _this$props$order = _this$props.order,
          NeedsDispatch = _this$props$order.NeedsDispatch,
          Total = _this$props$order.Total,
          close = _this$props.close,
          classes = _this$props.classes;
      var needsPay = Total !== 0;
      var templates = templateCtx.templates.filter(function (t) {
        return t.ApplyTo === 'payment';
      }); // const templateBtn = templates.length > 0 && {
      //     icon: <Print />,
      //     legend: templates.length > 1 ? 'documents' : templates[0].Title,
      //     themeColor: 'gray',
      //     onClick: templates.length > 1 ?
      //         () => this.setState(() => ({ templatesOpened: true })) : () => PrintOrder(templates[0].Id, current)
      // } as FabBtnProps;

      return React.createElement(_DetailGridContainer.default, null, React.createElement(_DetailGridColumn.default, null, React.createElement("div", {
        className: classes.detailGridColumnInner
      }, React.createElement(_core.Paper, {
        square: true,
        className: classes.paperCls
      }, React.createElement("div", {
        className: classes.paperInnerCLs
      }, React.createElement(_OrderReciept.default, {
        order: order,
        shopCtx: shopCtx,
        intl: intl
      }))))), React.createElement(_DetailGridColumn.default, null, React.createElement("div", {
        className: classes.detailGridColumnInner
      }, React.createElement(_GridContainer.GridContainer, null, needsPay && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.Typography, {
        variant: "h6",
        align: "center"
      }, "Pay")), settingsCtx.Settings.PaymentProviders.filter(function (paymentProvider) {
        return settingsCtx.Settings.HidePaymentProviders.indexOf(paymentProvider) < 0;
      }).map(function (paymentProvider) {
        return React.createElement(React.Fragment, null, paymentProvider === 'postfinance' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_PostFinanceButton.default, {
          onChange: save,
          refresh: refresh,
          order: order
        })), paymentProvider === 'transfer' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_Button.default, {
          onChange: save,
          refresh: refresh,
          order: order
        })), paymentProvider === 'voucher' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_VoucherButton.default, {
          intl: intl,
          onChange: save,
          order: order,
          refresh: refresh,
          authCtx: authCtx
        })), paymentProvider === 'paypal' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_PayPalButton.default, {
          onChange: save,
          order: order
        })), paymentProvider === 'cash' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_Button2.default, {
          settingsCtx: settingsCtx,
          refresh: refresh,
          order: order
        })), paymentProvider === 'stripe' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_StripeButton.default, {
          onChange: save,
          order: order
        })), paymentProvider === 'ccterminal' && React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_CCTerminalButton.default, {
          onChange: save,
          order: order,
          refresh: refresh
        })));
      })), NeedsDispatch && this._renderDispatch(), templates.length > 0 && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.Typography, {
        variant: "h6",
        align: "center"
      }, "Documents")), templates.map(function (t) {
        return React.createElement(_core.Grid, {
          item: true,
          xs: 3
        }, React.createElement(_core.ButtonBase, {
          focusRipple: true,
          onClick: function onClick() {
            return (0, _OrderDocumentsDialog.PrintOrder)(t.Id, order);
          },
          classes: {
            root: classes.buttonBase
          }
        }, React.createElement(_icons.Print, {
          className: classes.btnIcon
        }), React.createElement("span", {
          className: classes.btnText
        }, t.Title)));
      }))))), React.createElement(_Fabs.default, {
        map: [{
          icon: React.createElement(_icons.Close, null),
          onClick: close,
          legend: 'close'
        }]
      }));
    }
  }, {
    key: "_getStock",
    value: function _getStock() {
      var _this$props2 = this.props,
          authCtx = _this$props2.authCtx,
          order = _this$props2.order;

      var stockDone = function stockDone(item) {
        var Quantity = item.Quantity,
            SKU = item.SKU,
            DispatchInfos = item.DispatchInfos;
        var quantity = Quantity || 0;
        return !SKU || quantity === 0 || DispatchInfos && DispatchInfos.Quantity < quantity && DispatchInfos.Warehouse;
      };

      var warehouseId = authCtx.user.WarehouseId || '---';

      var getStock = function getStock(items) {
        if (!items) {
          return [];
        }

        return items.filter(function (item) {
          return !stockDone(item);
        }).reduce(function (result, item) {
          var subitems = getStock(item.Items);
          var Quantity = item.Quantity,
              DispatchInfos = item.DispatchInfos;
          var quantity = (Quantity || 0) - (DispatchInfos && DispatchInfos.Quantity || 0);

          if (quantity <= 0) {
            return [].concat(_toConsumableArray(result), _toConsumableArray(subitems));
          } else {
            return [].concat(_toConsumableArray(result), [{
              quantity: quantity,
              item: item,
              warehouseId: warehouseId
            }], _toConsumableArray(subitems));
          }
        }, []);
      };

      return getStock(order.Items);
    }
  }, {
    key: "_renderDispatch",
    value: function _renderDispatch() {
      var _this2 = this;

      var _this$props3 = this.props,
          warehouseCtx = _this$props3.warehouseCtx,
          authCtx = _this$props3.authCtx,
          order = _this$props3.order,
          stock = this.state.stock;

      var onSelect = function onSelect(d, s) {
        _this2.setState(function () {
          return {
            dispatch: d,
            stock: s
          };
        }, _this2._applyUpdates);
      };

      return React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.Typography, {
        variant: "h6",
        align: "center"
      }, "Dispatch")), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_OrderCheckoutPickup.default, {
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        order: order,
        stock: stock,
        onSelect: onSelect
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_OrderCheckoutShipping.default, {
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        order: order,
        stock: stock,
        onSelect: onSelect
      })));
    }
  }, {
    key: "_applyDispatch",
    value: function _applyDispatch(items, stocks) {
      var _this3 = this;

      return items.map(function (item) {
        var stock = stocks.find(function (s) {
          return s.item.UID === item.UID;
        });
        var Items = item.Items,
            DispatchInfos = item.DispatchInfos;
        return _objectSpread({}, item, {
          Items: Items && _this3._applyDispatch(item.Items, stocks),
          DispatchInfos: stock && _objectSpread({}, DispatchInfos, {
            Warehouse: stock.warehouseId || '',
            Quantity: (DispatchInfos && DispatchInfos.Quantity || 0) + (stock.quantity || 0),
            Date: new Date().toISOString()
          })
        });
      });
    }
  }, {
    key: "_applyUpdates",
    value: function _applyUpdates() {
      var _this$props4 = this.props,
          _this$props4$order = _this$props4.order,
          Dispatches = _this$props4$order.Dispatches,
          Items = _this$props4$order.Items,
          save = _this$props4.save,
          close = _this$props4.close,
          _this$state = this.state,
          dispatch = _this$state.dispatch,
          stock = _this$state.stock;
      var uses = {};
      stock.forEach(function (s) {
        var SKU = s.item.SKU,
            warehouseId = s.warehouseId,
            quantity = s.quantity;

        if (!SKU || !warehouseId || warehouseId === '---') {
          return;
        }

        uses[SKU] = uses[SKU] || {};
        uses[SKU][warehouseId] = quantity;
      });
      var changes = {
        Dispatches: dispatch ? [].concat(_toConsumableArray(Dispatches), [dispatch]) : Dispatches,
        Items: this._applyDispatch(Items, stock)
      };
      return _services.StockUnits.Use(uses).then(function () {
        return save(changes);
      }).then(close);
    }
  }]);

  return OrderCheckout;
}(React.Component);

var _default = (0, _styles.withStyles)(function (theme) {
  return _objectSpread({}, (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#9c27b0',
      contrastText: '#ffffff'
    }
  })), {
    paperCls: {
      width: '500px',
      margin: '20px auto 0 auto'
    },
    paperInnerCLs: {
      padding: '10px'
    },
    detailGridColumnInner: {
      display: 'flex',
      flexDirection: 'column',
      justifyContent: 'center',
      height: '100%'
    }
  });
})(OrderCheckout);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var PayBtnStyles = function PayBtnStyles(theme, palette) {
  return {
    buttonBase: _objectSpread({}, theme.typography.button, {
      borderRadius: theme.shape.borderRadius,
      color: palette.primary.contrastText,
      backgroundColor: palette.primary.main,
      boxShadow: theme.shadows[2],
      width: '100%',
      flexWrap: 'wrap',
      padding: theme.spacing.unit,
      boxSizing: 'border-box',
      '&:active': {
        boxShadow: theme.shadows[8]
      },
      '&:hover': {
        backgroundColor: palette.primary.light,
        // Reset on touch devices, it doesn't add specificity
        '@media (hover: none)': {
          backgroundColor: palette.primary.main
        }
      }
    }),
    btnIcon: {
      display: 'block',
      width: '100%',
      maxHeight: '100px',
      height: '50%'
    },
    btnText: {
      display: 'block',
      paddingTop: theme.spacing.unit,
      whiteSpace: 'nowrap',
      overflow: 'hidden',
      textOverflow: 'ellipsis'
    }
  };
};

var _default = PayBtnStyles;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var shortid = _interopRequireWildcard(require("shortid"));

var _OrderCheckoutStockSelect = _interopRequireDefault(require("./OrderCheckoutStockSelect"));

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("./OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderCheckoutPickup =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderCheckoutPickup, _React$Component);

  function OrderCheckoutPickup(props) {
    var _this;

    _classCallCheck(this, OrderCheckoutPickup);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderCheckoutPickup).call(this, props));
    _this._open = _this._open.bind(_assertThisInitialized(_this));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._select = _this._select.bind(_assertThisInitialized(_this));
    _this._more = _this._more.bind(_assertThisInitialized(_this));
    _this._less = _this._less.bind(_assertThisInitialized(_this));
    var warehouseId = props.authCtx.user.WarehouseId || '---';
    var stock = props.stock;
    _this.state = {
      advanced: stock.length <= 1,
      open: false,
      warehouseId: warehouseId,
      stock: stock
    };
    return _this;
  }

  _createClass(OrderCheckoutPickup, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          order = _this$props.order,
          classes = _this$props.classes;
      var _this$state = this.state,
          open = _this$state.open,
          warehouseId = _this$state.warehouseId,
          advanced = _this$state.advanced,
          stock = _this$state.stock;
      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._open,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.LocalMall, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Pickup")), React.createElement(_core.Dialog, {
        open: open
      }, React.createElement(_core.DialogTitle, null, "Update Stock"), React.createElement(_core.DialogContent, null, !advanced && React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, "Update all items Stock"), React.createElement(_core.Select, {
        fullWidth: true,
        value: warehouseId || '---',
        onChange: this._select
      }, warehouseCtx.Warehouses.map(function (w) {
        return React.createElement(_core.MenuItem, {
          key: w.Id,
          value: w.Id
        }, "".concat(w.Name));
      }), React.createElement(_core.MenuItem, {
        value: "---"
      }, React.createElement("em", null, "Don't update Stock")))), advanced && React.createElement(_OrderCheckoutStockSelect.default, {
        warehouseCtx: warehouseCtx,
        order: order,
        authCtx: authCtx,
        stock: stock,
        onSelect: function onSelect(s) {
          return _this2.setState(function () {
            return {
              stock: s
            };
          });
        }
      })), React.createElement(_core.DialogActions, null, !advanced && stock.length > 1 && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._more
      }, "More options..."), advanced && stock.length > 1 && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._less
      }, "Less options..."), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: this._close
      }, "cancel"), React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: this._add
      }, "update"))));
    }
  }, {
    key: "_less",
    value: function _less() {
      this.setState(function () {
        return {
          advanced: false
        };
      });
    }
  }, {
    key: "_more",
    value: function _more() {
      this.setState(function () {
        return {
          advanced: true
        };
      });
    }
  }, {
    key: "_close",
    value: function _close() {
      this.setState(function () {
        return {
          open: false
        };
      });
    }
  }, {
    key: "_open",
    value: function _open() {
      var stock = this.props.stock;

      if (stock.length >= 1) {
        this.setState(function () {
          return {
            open: true
          };
        });
      } else {
        this._add();
      }
    }
  }, {
    key: "_select",
    value: function _select(event, child) {
      var stock = this.props.stock;
      var warehouseId = event.target.value;
      this.setState(function () {
        return {
          warehouseId: warehouseId,
          stock: stock.map(function (s) {
            return _objectSpread({}, s, {
              warehouseId: warehouseId
            });
          })
        };
      });
    }
  }, {
    key: "_add",
    value: function _add() {
      var onSelect = this.props.onSelect;
      var stock = this.state.stock;
      var dispatch = {
        Method: 'Pickup',
        Status: 'Delivered',
        Date: new Date().toISOString(),
        Id: shortid()
      };
      onSelect(dispatch, stock);

      this._close();
    }
  }]);

  return OrderCheckoutPickup;
}(React.Component);

var _default = (0, _styles.withStyles)(function (theme) {
  return _objectSpread({}, (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#9c27b0',
      contrastText: '#ffffff'
    }
  })), {
    leftIconCls: {
      marginRight: theme.spacing.unit
    }
  });
})(OrderCheckoutPickup);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderCheckoutShippingStyles = void 0;

var React = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _OrderShippingDialog = _interopRequireDefault(require("../OrderShippingDialog/OrderShippingDialog"));

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("./OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var OrderCheckoutShippingStyles = function OrderCheckoutShippingStyles(theme) {
  return {
    stockPanelCls: {
      marginTop: theme.spacing.unit
    },
    iconCls: {
      paddingRight: theme.spacing.unit
    },
    buttonBase: _objectSpread({}, theme.typography.button, {
      borderRadius: theme.shape.borderRadius,
      color: theme.palette.primary.contrastText,
      backgroundColor: theme.palette.primary.main,
      boxShadow: theme.shadows[2],
      width: '100%',
      flexWrap: 'wrap',
      padding: theme.spacing.unit,
      boxSizing: 'border-box',
      '&$focusVisible': {
        boxShadow: theme.shadows[6]
      },
      '&:active': {
        boxShadow: theme.shadows[8]
      },
      '&:hover': {
        backgroundColor: theme.palette.primary.light,
        // Reset on touch devices, it doesn't add specificity
        '@media (hover: none)': {
          backgroundColor: theme.palette.primary.main
        }
      }
    }),
    btnIcon: {
      display: 'block',
      width: '100%',
      height: '100px'
    },
    btnText: {
      display: 'block',
      paddingTop: theme.spacing.unit
    }
  };
};

exports.OrderCheckoutShippingStyles = OrderCheckoutShippingStyles;

var OrderCheckoutShipping =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderCheckoutShipping, _React$Component);

  function OrderCheckoutShipping(props) {
    var _this;

    _classCallCheck(this, OrderCheckoutShipping);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderCheckoutShipping).call(this, props));
    _this._toggle = _this._toggle.bind(_assertThisInitialized(_this));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._open = _this._open.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(OrderCheckoutShipping, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          classes = _this$props.classes,
          props = _objectWithoutProperties(_this$props, ["classes"]),
          open = this.state.open;

      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._open,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.LocalShipping, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Shipping")), React.createElement(_OrderShippingDialog.default, _objectSpread({}, props, {
        toggle: this._toggle,
        open: open,
        methods: ['Post', 'Electronic', 'Courier'],
        defaultMethod: 'Post',
        defaultStatus: 'Init'
      })));
    }
  }, {
    key: "_toggle",
    value: function _toggle(open) {
      this.setState(function () {
        return {
          open: open
        };
      });
    }
  }, {
    key: "_open",
    value: function _open() {
      this._toggle(true);
    }
  }, {
    key: "_close",
    value: function _close() {
      this._toggle(false);
    }
  }]);

  return OrderCheckoutShipping;
}(React.Component);

var _default = (0, _styles.withStyles)(function (theme) {
  return _objectSpread({}, (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#6494ff',
      contrastText: '#ffffff'
    }
  })), {
    stockPanelCls: {
      marginTop: theme.spacing.unit
    },
    iconCls: {
      paddingRight: theme.spacing.unit
    }
  });
})(OrderCheckoutShipping);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderCheckoutStockSelectStyles = void 0;

var React = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderCheckoutStockSelectStyles = function OrderCheckoutStockSelectStyles(theme) {
  return {
    leftIconCls: {
      marginRight: theme.spacing.unit
    },
    alreadyPaidBtnCls: {}
  };
};

exports.OrderCheckoutStockSelectStyles = OrderCheckoutStockSelectStyles;

var OrderCheckoutStockSelect =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderCheckoutStockSelect, _React$Component);

  function OrderCheckoutStockSelect(props) {
    var _this;

    _classCallCheck(this, OrderCheckoutStockSelect);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderCheckoutStockSelect).call(this, props));
    var stock = props.stock;
    _this.state = {
      stock: stock
    };
    return _this;
  }

  _createClass(OrderCheckoutStockSelect, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var warehouseCtx = this.props.warehouseCtx;
      var stock = this.state.stock;
      return React.createElement(_GridContainer.GridContainer, null, stock.map(function (stockItem, i) {
        var _stockItem$item = stockItem.item,
            UID = _stockItem$item.UID,
            Title = _stockItem$item.Title,
            quantity = stockItem.quantity,
            warehouseId = stockItem.warehouseId;
        return React.createElement(_core.Grid, {
          item: true,
          xs: 12,
          key: UID
        }, React.createElement(_core.FormControl, {
          fullWidth: true
        }, React.createElement(_core.InputLabel, null, "".concat(quantity, " ").concat(Title || '', ":")), React.createElement(_core.Select, {
          fullWidth: true,
          value: warehouseId || '---',
          onChange: function onChange(e, c) {
            return _this2._select(i, e);
          }
        }, warehouseCtx.Warehouses.map(function (w) {
          return React.createElement(_core.MenuItem, {
            key: w.Id,
            value: w.Id
          }, "".concat(w.Name));
        }), React.createElement(_core.MenuItem, {
          value: "---"
        }, React.createElement("em", null, "Don't update Stock")))));
      }));
    }
  }, {
    key: "_select",
    value: function _select(index, event) {
      var oldStock = this.state.stock;
      var onSelect = this.props.onSelect;
      var warehouseId = event.target.value;
      var stock = oldStock.map(function (s, i) {
        return i === index ? _objectSpread({}, s, {
          warehouseId: warehouseId
        }) : s;
      });
      this.setState(function () {
        return {
          stock: stock
        };
      }, function () {
        return onSelect(stock);
      });
    }
  }]);

  return OrderCheckoutStockSelect;
}(React.Component);

var _default = (0, _styles.withStyles)(OrderCheckoutStockSelectStyles)(OrderCheckoutStockSelect);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Services = require("./Services");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CCTerminalButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CCTerminalButton, _React$Component);

  function CCTerminalButton(props) {
    var _this;

    _classCallCheck(this, CCTerminalButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CCTerminalButton).call(this, props));
    _this._handleOpen = _this._handleOpen.bind(_assertThisInitialized(_this));
    _this._handleClose = _this._handleClose.bind(_assertThisInitialized(_this));
    _this._addTransfer = _this._addTransfer.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false,
      reference: ''
    };
    return _this;
  }

  _createClass(CCTerminalButton, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var classes = this.props.classes;
      var _this$state = this.state,
          open = _this$state.open,
          reference = _this$state.reference;
      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._handleOpen,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.Dialpad, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Card Terminal")), React.createElement(_core.Dialog, {
        open: open,
        onClose: this._handleClose
      }, React.createElement(_core.DialogTitle, null, "Payment informations"), React.createElement(_core.DialogContent, null, React.createElement(_core.DialogContentText, null, React.createElement(_core.TextField, {
        fullWidth: true,
        type: "text",
        label: "Reference",
        value: reference,
        onChange: function onChange(e) {
          return _this2.setState({
            reference: e.target.value
          });
        }
      }))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: this._handleClose
      }, "Cancel"), React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        onClick: this._addTransfer
      }, "Add Payment"))));
    }
  }, {
    key: "_handleOpen",
    value: function _handleOpen() {
      this.setState({
        open: true
      });
    }
  }, {
    key: "_handleClose",
    value: function _handleClose() {
      this.setState({
        open: false
      });
    }
  }, {
    key: "_addTransfer",
    value: function _addTransfer() {
      var _this$props = this.props,
          order = _this$props.order,
          _this$props$order = _this$props.order,
          Total = _this$props$order.Total,
          PaidAmount = _this$props$order.PaidAmount,
          refresh = _this$props.refresh;
      var reference = this.state.reference;
      var amount = Total - PaidAmount;
      (0, _Services.RegisterCCTerminalPayment)(order, amount, reference).then(refresh).then(this._handleClose);
    }
  }]);

  return CCTerminalButton;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#99e9f2',
      contrastText: '#ffffff'
    }
  }));
})(CCTerminalButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RegisterCCTerminalPayment = void 0;

var _helpers = require("src/_helpers");

var RegisterCCTerminalPayment = function RegisterCCTerminalPayment(order, amount, reference) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Amount: amount,
      Reference: reference
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/ccterminal");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.RegisterCCTerminalPayment = RegisterCCTerminalPayment;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _CashRegister = _interopRequireDefault(require("./CashRegister"));

var _core = require("@material-ui/core");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

var _CashIcon = _interopRequireDefault(require("./CashIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CashButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CashButton, _React$Component);

  function CashButton(props) {
    var _this;

    _classCallCheck(this, CashButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CashButton).call(this, props));
    _this._handleOpen = _this._handleOpen.bind(_assertThisInitialized(_this));
    _this._handleClose = _this._handleClose.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(CashButton, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          classes = _this$props.classes,
          refresh = _this$props.refresh,
          order = _this$props.order,
          settingsCtx = _this$props.settingsCtx;
      var open = this.state.open;

      var toggle = function toggle() {
        return _this2.setState(function (prev) {
          return {
            open: !prev.open
          };
        });
      };

      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: toggle,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_CashIcon.default, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Cash")), React.createElement(_CashRegister.default, {
        settingsCtx: settingsCtx,
        order: order,
        refresh: refresh,
        close: this._handleClose,
        open: open
      }));
    }
  }, {
    key: "_handleOpen",
    value: function _handleOpen() {
      this.setState({
        open: true
      });
    }
  }, {
    key: "_handleClose",
    value: function _handleClose() {
      this.setState({
        open: false
      });
    }
  }]);

  return CashButton;
}(React.Component); // <div className="pay__btn-icon">
//     {getIcon(cashIcon)}
// </div>


var _default = (0, _core.withStyles)(function (theme) {
  return (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#85bb65',
      contrastText: '#ffffff'
    }
  }));
})(CashButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.CashIcon = void 0;

var React = _interopRequireWildcard(require("react"));

var _SvgIcon = _interopRequireDefault(require("@material-ui/core/SvgIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* tslint:disable:max-line-length */
var CashIcon = function CashIcon(props) {
  return React.createElement(_SvgIcon.default, _objectSpread({
    viewBox: '0 0 100 100'
  }, props), React.createElement("path", {
    d: "M27.7,46.5c0,4.8-3.9,8.7-8.7,8.7s-8.7-3.9-8.7-8.7s3.9-8.7,8.7-8.7S27.7,41.7,27.7,46.5 M41.2,63.7  c0-6-4.9-10.9-10.9-10.9s-10.9,4.9-10.9,10.9s4.9,10.9,10.9,10.9S41.2,69.7,41.2,63.7 M61.5,47.4c1.7,0.4,2.5,1.4,2.5,2.5 c0,1.2-0.8,2.2-2.5,2.5V47.4 M59.5,44.4c-1.8-0.3-2.4-1.3-2.4-2.4c0-1.3,0.9-2.3,2.4-2.6V44.4 M61.5,57.4v-2.7c3.3-0.4,5-2.6,5-4.9 c0-2.3-1.7-4.3-4.6-4.8l-0.4-0.1v-5.3c1.6,0.4,2.4,1.8,2.5,2.8l2.3-0.9c-0.4-1.7-1.7-3.8-4.9-4.2v-2.7h-2v2.7c-2.9,0.4-5,2.5-5,4.9 c0,2.5,1.7,4.2,4.3,4.7l0.6,0.1v5.4c-2-0.4-3-2-3.2-3.6l-2.5,0.8c0.3,2.3,2,4.8,5.7,5.1v2.7H61.5z M60.7,60.5 c8,0,14.5-6.5,14.5-14.5c0-8-6.5-14.5-14.5-14.5c-8,0-14.5,6.5-14.5,14.5C46.2,54,52.7,60.5,60.7,60.5 M89.8,65.8l-45.1,0 C45.7,56,38.2,49.1,31,50c0,0,0-23.8,0-23.8h58.8V65.8z"
  }));
};

exports.CashIcon = CashIcon;
var _default = CashIcon;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Services = require("./Services");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CashRegister =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CashRegister, _React$Component);

  function CashRegister(props) {
    var _this;

    _classCallCheck(this, CashRegister);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CashRegister).call(this, props));
    var defaultCurrency = props.order.Currency || props.settingsCtx.Settings.Currencies[0].Code;
    _this.state = {
      amount: '',
      parsedAmount: 0,
      change: 0,
      currencyToPay: defaultCurrency,
      currencyRecieved: defaultCurrency,
      currencyChange: defaultCurrency
    };
    _this._confirm = _this._confirm.bind(_assertThisInitialized(_this));
    _this._handleScreenChange = _this._handleScreenChange.bind(_assertThisInitialized(_this));
    _this._keyDown = _this._keyDown.bind(_assertThisInitialized(_this));
    return _this;
  }

  _createClass(CashRegister, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      window.addEventListener('keydown', this._keyDown, true);
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      window.removeEventListener('keydown', this._keyDown);
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          classes = _this$props.classes,
          close = _this$props.close,
          open = _this$props.open,
          _this$props$order = _this$props.order,
          Total = _this$props$order.Total,
          PaidAmount = _this$props$order.PaidAmount,
          Currencies = _this$props.settingsCtx.Settings.Currencies;
      var _this$state = this.state,
          currencyRecieved = _this$state.currencyRecieved,
          amount = _this$state.amount,
          change = _this$state.change,
          currencyChange = _this$state.currencyChange,
          currencyToPay = _this$state.currencyToPay;
      var btns = ['c', 'cc', '', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '00', '.'];
      var parsed = parseFloat(amount) || 0;
      var toPay = Total - PaidAmount; // const floatingActionButtons: FloatingActionButtonProps[] = [
      //     {
      //         classNames: ['cash__save-button'],
      //         icon: {
      //             className: `material-icons`,
      //             inner: 'check',
      //             tag: 'i'
      //         },
      //         size: 'primary',
      //         onClick: this._confirm
      //     },
      //     {
      //         icon: {
      //             className: `material-icons`,
      //             inner: 'close',
      //             tag: 'i'
      //         },
      //         size: 'secondary',
      //         onClick: close
      //     }
      // ];

      var thereIsChange = parsed > Total;
      return React.createElement(_SideDialog.default, {
        open: open,
        onClose: close
      }, React.createElement(_core.DialogContent, {
        className: classes.container
      }, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_GridContainer.GridContainer, {
        style: {
          flexWrap: 'nowrap'
        }
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.inputContainer
      }, React.createElement(_core.TextField, {
        inputProps: {
          className: classes.inputValue
        },
        fullWidth: true,
        type: "number",
        label: "To pay",
        value: toPay,
        disabled: true
      })), Currencies.map(function (currency) {
        return React.createElement(_core.Grid, {
          key: currency.Code,
          item: true,
          className: classes.currencyContainer,
          xs: 2
        }, React.createElement(_core.ButtonBase, {
          onClick: function onClick() {
            return _this2._handleCurrencyToPayClick(currency.Code);
          },
          classes: {
            root: classNames(classes.currencyButton, currencyToPay === currency.Code && classes.currencyButtonActive)
          }
        }, currency.Code));
      })), React.createElement(_GridContainer.GridContainer, {
        style: {
          flexWrap: 'nowrap'
        }
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.inputContainer
      }, React.createElement(_core.TextField, {
        inputProps: {
          className: classes.inputValue
        },
        fullWidth: true,
        type: "number",
        label: "Recieved",
        value: parsed,
        onChange: function onChange(e) {
          var val = e.target.value;
          var parseVal = val === '' ? 0 : parseInt(val, 10);

          _this2._handleScreenChange(parseVal);
        }
      })), Currencies.map(function (currency) {
        return React.createElement(_core.Grid, {
          key: currency.Code,
          item: true,
          className: classes.currencyContainer,
          xs: 2
        }, React.createElement(_core.ButtonBase, {
          onClick: function onClick() {
            return _this2._handleCurrencyClick(currency.Code);
          },
          classes: {
            root: classNames(classes.currencyButton, currencyRecieved === currency.Code && classes.currencyButtonActive)
          }
        }, currency.Code));
      }))), thereIsChange && React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_GridContainer.GridContainer, {
        style: {
          flexWrap: 'nowrap'
        }
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.inputContainer
      }, React.createElement(_core.TextField, {
        inputProps: {
          className: classes.inputValue
        },
        fullWidth: true,
        type: "number",
        label: "Change",
        value: -change
      })), Currencies.map(function (currency) {
        return React.createElement(_core.Grid, {
          key: currency.Code,
          item: true,
          className: classes.currencyContainer,
          xs: 2
        }, React.createElement(_core.ButtonBase, {
          onClick: function onClick() {
            return _this2._handleCurrencyChangeClick(currency.Code);
          },
          classes: {
            root: classNames(classes.currencyButton, currencyChange === currency.Code && classes.currencyButtonActive)
          }
        }, currency.Code));
      }))), btns.map(function (btn, i) {
        var disabled = btns[i] === '';
        return React.createElement(_core.Grid, {
          item: true,
          key: i,
          xs: 4
        }, React.createElement(_core.ButtonBase, {
          disabled: disabled,
          onClick: function onClick() {
            return _this2._handleNumberClick(btn);
          },
          className: classes.padBtn
        }, btn));
      }))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: close
      }, "Close"), React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: this._confirm
      }, "Confirm")));
    }
  }, {
    key: "_handleScreenChange",
    value: function _handleScreenChange(e) {
      var _this3 = this;

      this.setState(function () {
        _this3._GetChange();

        return {
          amount: e.toString()
        };
      });
    }
  }, {
    key: "_GetChange",
    value: function _GetChange() {
      var _this4 = this;

      this.setState(function (prev) {
        var parsedAmount = prev.parsedAmount,
            currencyRecieved = prev.currencyRecieved,
            currencyChange = prev.currencyChange;
        (0, _Services.GetChange)(_this4.props.order, parsedAmount, currencyRecieved, currencyChange).then(function (c) {
          _this4.setState(function () {
            return {
              loading: false,
              change: c
            };
          });
        });
        return {
          loading: true
        };
      });
    }
  }, {
    key: "_handleNumberClick",
    value: function _handleNumberClick(btn) {
      var _this5 = this;

      switch (btn) {
        case 'c':
          if (!this.state.amount.length) {
            return;
          }

          this.setState(function (prev) {
            var newAmount = prev.amount.substring(0, prev.amount.length - 1);
            var parsed = parseFloat(newAmount);
            var parsedAmount = isFinite(parsed) && !isNaN(parsed) && parsed || 0;

            _this5._GetChange();

            return {
              amount: newAmount,
              parsedAmount: parsedAmount
            };
          });
          break;

        case 'cc':
          if (!this.state.amount.length) {
            return;
          }

          this.setState(function () {
            _this5._GetChange();

            return {
              amount: '',
              parsedAmount: 0
            };
          });
          break;

        default:
          this.setState(function (prev) {
            var newAmount = prev.amount + btn;
            var parsed = parseFloat(newAmount);
            var parsedAmount = isFinite(parsed) && !isNaN(parsed) && parsed || 0;

            _this5._GetChange();

            return {
              amount: newAmount,
              parsedAmount: parsedAmount
            };
          });
          break;
      }
    }
  }, {
    key: "_handleCurrencyToPayClick",
    value: function _handleCurrencyToPayClick(currency) {
      var _this6 = this;

      this.setState(function () {
        _this6._GetChange();

        return {
          currencyToPay: currency
        };
      });
    }
  }, {
    key: "_handleCurrencyClick",
    value: function _handleCurrencyClick(currency) {
      var _this7 = this;

      this.setState(function () {
        _this7._GetChange();

        return {
          currencyRecieved: currency
        };
      });
    }
  }, {
    key: "_keyDown",
    value: function _keyDown(ev) {
      var _this8 = this;

      var num = '';

      switch (ev.keyCode) {
        case 46:
          // delete
          if (!this.state.amount.length) {
            return;
          }

          this.setState(function () {
            _this8._GetChange();

            return {
              amount: '',
              parsedAmount: 0
            };
          });
          return;

        case 220:
        case 67: // c

        case 8:
          // backslash
          if (!this.state.amount.length) {
            return;
          }

          this.setState(function (prev) {
            var newAmount = prev.amount.substring(0, prev.amount.length - 1);
            var parsed = parseFloat(newAmount);
            var parsedAmount = isFinite(parsed) && !isNaN(parsed) && parsed || 0;

            _this8._GetChange();

            return {
              amount: newAmount,
              parsedAmount: parsedAmount
            };
          });
          return;

        case 48: // 0

        case 96:
          // num 0
          num = '0';
          break;

        case 49: // 1

        case 97:
          // num 1
          num = '1';
          break;

        case 50: // 2

        case 98:
          // num 2
          num = '2';
          break;

        case 51: // 3

        case 99:
          // num 3
          num = '3';
          break;

        case 52: // 4

        case 100:
          // num 4
          num = '4';
          break;

        case 53: // 5

        case 101:
          // num 5
          num = '5';
          break;

        case 54: // 6

        case 102:
          // num 6
          num = '6';
          break;

        case 55: // 7

        case 103:
          // num 7
          num = '7';
          break;

        case 56: // 8

        case 104:
          // num 8
          num = '8';
          break;

        case 57: // 9

        case 105:
          // num 9
          num = '9';
          break;

        case 110: // NumpadDecimal

        case 194: // NumpadComma

        case 188: // Comma

        case 190:
          // Period
          num = '.';
          break;

        default:
          num = '';
          break;
      }

      this.setState(function (prev) {
        var newAmount = prev.amount + num;
        var parsed = parseFloat(newAmount);
        var parsedAmount = isFinite(parsed) && !isNaN(parsed) && parsed || 0;

        _this8._GetChange();

        return {
          amount: newAmount,
          parsedAmount: parsedAmount
        };
      });
    }
  }, {
    key: "_handleCurrencyChangeClick",
    value: function _handleCurrencyChangeClick(currency) {
      var _this9 = this;

      this.setState(function () {
        _this9._GetChange();

        return {
          currencyChange: currency
        };
      });
    }
  }, {
    key: "_confirm",
    value: function _confirm() {
      var _this10 = this;

      var _this$state2 = this.state,
          parsedAmount = _this$state2.parsedAmount,
          currencyRecieved = _this$state2.currencyRecieved,
          change = _this$state2.change,
          currencyChange = _this$state2.currencyChange;
      this.setState(function () {
        return {
          loading: true
        };
      });
      (0, _Services.RegisterCashPayment)(this.props.order, parsedAmount, currencyRecieved, change, currencyChange).then(function () {
        _this10.setState(function () {
          return {
            loading: false
          };
        });

        _this10.props.refresh(); // TODO: close the lightbox


        _this10.props.close();
      }).catch(function () {
        _this10.setState(function () {
          return {
            loading: false
          };
        });
      });
    }
  }]);

  return CashRegister;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      maxWidth: 400,
      margin: 'auto'
    },
    currencyButton: {
      height: '100%',
      width: '100%',
      fontSize: 18,
      display: 'flex',
      justifyContent: 'center',
      background: theme.Colors.gray.primary.main,
      color: theme.Colors.gray.primary.contrastText,
      '&:hover': {
        background: theme.palette.primary.main,
        color: theme.palette.primary.contrastText
      }
    },
    currencyButtonActive: {
      background: theme.palette.primary.main,
      color: theme.palette.primary.contrastText
    },
    currencyContainer: {},
    inputContainer: {
      flex: '1 1 auto'
    },
    inputValue: {
      fontFamily: 'monospace',
      textAlign: 'right'
    },
    padBtn: {
      height: 80,
      width: '100%',
      display: 'flex',
      fontSize: 18,
      justifyContent: 'center',
      background: theme.Colors.gray.primary.main,
      color: theme.Colors.gray.primary.contrastText,
      '&:hover': {
        background: theme.palette.primary.main,
        color: theme.palette.primary.contrastText
      }
    }
  };
})(CashRegister);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetChange = exports.RegisterCashPayment = void 0;

var _helpers = require("src/_helpers");

var RegisterCashPayment = function RegisterCashPayment(order, amount, currency, change, changeCurrency) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Amount: amount,
      Change: change,
      AmountCurrency: currency,
      ChangeCurrency: changeCurrency
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/cash/register");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.RegisterCashPayment = RegisterCashPayment;

var GetChange = function GetChange(order, amount, currency, changeCurrency) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Amount: amount,
      AmountCurrency: currency,
      ChangeCurrency: changeCurrency
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/cash/change");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.GetChange = GetChange;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _loadjs = _interopRequireDefault(require("loadjs"));

var ReactDOM = _interopRequireWildcard(require("react-dom"));

var _PayPalServices = require("./PayPalServices");

var _core = require("@material-ui/core");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

var _icons = require("@material-ui/icons");

var _PayPalIcon = _interopRequireDefault(require("./PayPalIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var dependencyRequested = false;

var PayPalButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PayPalButton, _React$Component);

  function PayPalButton(props) {
    var _this;

    _classCallCheck(this, PayPalButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PayPalButton).call(this, props));
    _this._onClick = _this._onClick.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(PayPalButton, [{
    key: "render",
    value: function render() {
      var _this$state = this.state,
          loadingPaypal = _this$state.loadingPaypal,
          loadingSettings = _this$state.loadingSettings;
      var classes = this.props.classes;

      if (loadingSettings || loadingPaypal) {
        return React.createElement(_core.ButtonBase, {
          disabled: true,
          classes: {
            root: classes.buttonBase
          }
        }, React.createElement(_icons.Cached, {
          className: classes.btnIcon
        }), React.createElement("span", {
          className: classes.btnText
        }, "loading"));
      } // const toggle = () => this.setState((prev) => ({ open: !prev.open }));


      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._onClick,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_PayPalIcon.default, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "PayPal")), this._renderLightbox());
    }
  }, {
    key: "_onClick",
    value: function _onClick() {
      var _this2 = this;

      var _this$state2 = this.state,
          loadingPaypal = _this$state2.loadingPaypal,
          loadingSettings = _this$state2.loadingSettings;
      var _this$state3 = this.state,
          settings = _this$state3.settings,
          payPalBtn = _this$state3.payPalBtn;

      if (settings && payPalBtn) {
        this.setState(function () {
          return {
            open: true
          };
        });
      }

      if (loadingPaypal || loadingSettings) {
        return;
      }

      var onload = function onload() {
        var component = paypal.Button.driver('react', {
          React: React,
          ReactDOM: ReactDOM
        });
        dependencyRequested = true;

        _this2.setState(function (prev) {
          return {
            payPalBtn: component,
            loadingPaypal: false,
            open: !!prev.settings
          };
        });
      };

      if (!dependencyRequested) {
        (0, _loadjs.default)('https://www.paypalobjects.com/api/checkout.js', {
          success: onload,
          before: function before(path, tag) {
            tag.setAttribute('data-version-4', '');
            return true;
          }
        });
      } else {
        onload();
      }

      (0, _PayPalServices.GetPaypalClient)().then(function (value) {
        if (!value) {
          _this2.setState(function () {
            return {
              error: true,
              loadingSettings: false
            };
          });

          return;
        }

        _this2.setState(function (prev) {
          return {
            error: false,
            loadingSettings: false,
            settings: value,
            open: !!prev.payPalBtn
          };
        });
      });
      this.setState(function () {
        return {
          loadingSettings: true,
          loadingPaypal: !dependencyRequested
        };
      });
    }
  }, {
    key: "_renderLightbox",
    value: function _renderLightbox() {
      var _this3 = this;

      var open = this.state.open;

      var close = function close() {
        return _this3.setState(function () {
          return {
            open: false
          };
        });
      };

      return React.createElement(_core.Dialog, {
        open: open,
        onClose: close
      }, React.createElement(_core.DialogTitle, null, "Pay with Paypal"), React.createElement(_core.DialogContent, null, this._renderPaypalBtn()), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: close
      }, "Cancel")));
    }
  }, {
    key: "_renderPaypalBtn",
    value: function _renderPaypalBtn() {
      var _this4 = this;

      var Btn = this.state.payPalBtn;

      if (!Btn) {
        return;
      }

      var settings = this.state.settings;

      if (!settings) {
        return;
      }

      var payment = function payment(data, actions) {
        // tslint:disable-next-line:no-console
        console.log('create');
        return actions.payment.create({
          transactions: [{
            amount: {
              total: _this4.props.order.Total,
              currency: _this4.props.order.Currency || 'EUR'
            }
          }]
        }); // return new paypal.Promise((resolve: (paymentID: string) => void, reject: (reason: string) => void) => {
        //     // Make an ajax call to get the Payment ID. This should call your back-end,
        //     // which should invoke the PayPal Payment Create api to retrieve the Payment ID.
        //     // When you have a Payment ID, you need to call the `resolve` method, e.g `resolve(data.paymentID)`
        //     // Or, if you have an error from your server side, you need to call `reject`, e.g. `reject(err)`
        //     CreatePaypalPayment(this.props.order, this.props.order.Total, this.props.order.Currency || 'EUR')
        //         .then(result => resolve(result.paymentID))
        //         .catch(err => reject(err));
        // });
      };

      var onAuth = function onAuth(data, actions) {
        return actions.payment.execute().then(function () {
          (0, _PayPalServices.ChargePaypalPayment)(_this4.props.order, data).then(function (payments) {
            // this.props.onRequestClose();
            _this4.setState(function () {
              return {
                open: false
              };
            });

            _this4.props.onChange({
              Payments: [].concat(_toConsumableArray(_this4.props.order.Payments), _toConsumableArray(payments))
            });
          });
        });
      }; // const onCancel = (data: PaypalData) => {
      //     // tslint:disable-next-line:no-console
      //     console.log('The payment was cancelled!');
      // };


      return React.createElement(Btn, {
        env: settings.Environment,
        style: {
          shape: 'rect',
          size: 'large',
          color: 'blue'
        },
        commit: true,
        client: {
          sandbox: settings.sandbox,
          production: settings.production
        },
        payment: payment,
        onAuthorize: onAuth
      });
    }
  }]);

  return PayPalButton;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#003087',
      contrastText: '#ffffff'
    }
  }));
})(PayPalButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PayPalIcon = void 0;

var React = _interopRequireWildcard(require("react"));

var _SvgIcon = _interopRequireDefault(require("@material-ui/core/SvgIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* tslint:disable:max-line-length */
var PayPalIcon = function PayPalIcon(props) {
  return React.createElement(_SvgIcon.default, _objectSpread({
    viewBox: '0 0 26 26'
  }, props), React.createElement("path", {
    d: "M 4.71875 0.0625 L 0.1875 20.8125 L 6.1875 20.8125 L 7.65625 13.9375 L 11.9375 13.9375 C 16.03125 13.9375 19.429688 11.414063 20.34375 7.125 C 21.382813 2.269531 17.898438 0.0625 14.90625 0.0625 Z M 9.78125 4.28125 L 12.71875 4.28125 C 14.183594 4.28125 15.179688 5.550781 14.75 7.125 C 14.382813 8.703125 12.839844 9.96875 11.3125 9.96875 L 8.5 9.96875 Z M 22.53125 5.5 C 22.527344 6.125 22.46875 6.796875 22.3125 7.53125 C 21.90625 9.441406 21.085938 11.113281 19.9375 12.4375 C 19.453125 13.863281 18.015625 14.96875 16.59375 14.96875 L 16.53125 14.96875 C 15.152344 15.597656 13.613281 15.9375 11.9375 15.9375 L 9.28125 15.9375 L 8.15625 21.21875 L 7.8125 22.8125 L 6.15625 22.8125 L 5.5 25.8125 L 11.46875 25.8125 L 12.9375 18.9375 L 17.21875 18.9375 C 21.3125 18.9375 24.738281 16.414063 25.65625 12.125 C 26.425781 8.519531 24.691406 6.367188 22.53125 5.5 Z "
  }));
};

exports.PayPalIcon = PayPalIcon;
var _default = PayPalIcon;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ChargePaypalPayment = exports.GetPaypalClient = void 0;

var _helpers = require("src/_helpers");

var GetPaypalClient = function GetPaypalClient() {
  var requestOptions = {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  };
  var url = "".concat(_helpers.config.apiUrl, "/paypal");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.GetPaypalClient = GetPaypalClient;

var ChargePaypalPayment = function ChargePaypalPayment(order, data) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      PaymentId: data.paymentID,
      PayerId: data.payerID
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/paypal");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
}; // type createRequest = {
//     OrderID: string;
//     Amount: number;
//     Currency: string;
// };
// export const CreatePaypalPayment = (order: Order, amount: number, currency: string): Promise<PaypalData> => {
//     const requestOptions = {
//         method: 'POST',
//         headers: { 'Content-Type': 'application/json' },
//         body: JSON.stringify({ OrderID: order.Id, Amount: amount, Currency: currency } as createRequest)
//     };
//     const url = `${config.apiUrl}/paypal`;
//     return fetch(url, addAuthHeader(requestOptions))
//         .then<PaypalData>(handleApiResponse)
//         .then(response => {
//             return response;
//         });
// };


exports.ChargePaypalPayment = ChargePaypalPayment;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Services = require("./Services");

var _core = require("@material-ui/core");

var _Button = _interopRequireDefault(require("@material-ui/core/Button"));

var _PostFinanceIcon = _interopRequireDefault(require("./PostFinanceIcon"));

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var PostFinanceButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PostFinanceButton, _React$Component);

  function PostFinanceButton(props) {
    var _this;

    _classCallCheck(this, PostFinanceButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PostFinanceButton).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_formContainer", void 0);

    _this._formContainer = React.createRef();
    _this._request = _this._request.bind(_assertThisInitialized(_this));
    _this._handleOpen = _this._handleOpen.bind(_assertThisInitialized(_this));
    _this._handleClose = _this._handleClose.bind(_assertThisInitialized(_this));
    _this.state = {
      loading: false,
      open: false
    };
    return _this;
  }

  _createClass(PostFinanceButton, [{
    key: "render",
    value: function render() {
      var classes = this.props.classes;
      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._handleOpen,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_PostFinanceIcon.default, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Post Finance")), this._renderLightbox());
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      var _this$state = this.state,
          current = _this$state.current,
          open = _this$state.open;

      if (this._formContainer && this._formContainer.current && open && current) {
        var modalContent = this._formContainer.current.contentWindow.document.body;
        var form = document.createElement('form');
        modalContent.appendChild(form);
        form.action = current.action;

        if (current.method) {
          form.method = current.method;
        }

        for (var name in current.param) {
          if (!current.param.hasOwnProperty(name)) {
            continue;
          }

          var f = document.createElement('input');
          f.type = 'hidden';
          f.name = name;
          f.value = current.param[name];
          form.appendChild(f);
        } // form.target = '_blank';


        form.submit();
        this.setState(function () {
          return {
            current: undefined
          };
        });
      }
    }
  }, {
    key: "_request",
    value: function _request() {
      var _this2 = this;

      (0, _Services.GetFormPostFinance)(this.props.order).then(function (response) {
        _this2.setState(function () {
          return {
            current: response
          };
        });
      });
    }
  }, {
    key: "_handleOpen",
    value: function _handleOpen() {
      this.setState(function () {
        return {
          open: true
        };
      }, this._request);
    }
  }, {
    key: "_handleClose",
    value: function _handleClose() {
      this.setState(function () {
        return {
          open: false
        };
      }, this.props.refresh);
    }
  }, {
    key: "_renderLightbox",
    value: function _renderLightbox() {
      var classes = this.props.classes;
      var open = this.state.open;
      return React.createElement(_SideDialog.default, {
        open: !!open,
        onClose: this._handleClose,
        classes: {
          dialogCls: classes.dialogPaper
        }
      }, React.createElement(_core.DialogTitle, {
        id: "form-dialog-title"
      }, "Pay with Post Finance"), React.createElement(_core.DialogContent, {
        style: {
          height: '100%'
        }
      }, React.createElement("iframe", {
        className: classes.iframe,
        ref: this._formContainer
      })), React.createElement(_core.DialogActions, null, React.createElement(_Button.default, {
        onClick: this._handleClose,
        color: "primary",
        variant: "contained"
      }, "Done")));
    } // private _charge() {
    //     const { cc, cvc, exp } = this.state;
    //     if (!cc || !cvc || !exp) { return; }
    //     ChargePostFinance(this.props.order, cc, cvc, exp)
    //         .then(payment =>
    //             this.props.onChange({ Payments: [...this.props.order.Payments, payment] }));
    // }

  }]);

  return PostFinanceButton;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return _objectSpread({}, (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#fc0',
      contrastText: '#ffffff'
    }
  })), {
    iframe: {
      width: '100%',
      display: 'block',
      height: '100%',
      background: '#FFCC00'
    },
    dialogPaper: {
      background: '#FFCC00'
    }
  });
})(PostFinanceButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PostFinanceIcon = void 0;

var React = _interopRequireWildcard(require("react"));

var _SvgIcon = _interopRequireDefault(require("@material-ui/core/SvgIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* tslint:disable:max-line-length */
var PostFinanceIcon = function PostFinanceIcon(props) {
  return React.createElement(_SvgIcon.default, _objectSpread({
    viewBox: '0 0 60 60'
  }, props), React.createElement("path", {
    d: "M12.2,33.5h2.2c7.1,0,11.1-3.5,11.1-9.4c0-4.4-3.1-7.2-8.4-7.2h-6.6l-5,23.8h5.1L12.2,33.5z M14.8,21.3h2.1 c2.3,0,3.5,1,3.5,3.2c0,2.9-1.8,4.6-5.1,4.6h-2.1L14.8,21.3z"
  }), React.createElement("polygon", {
    points: "3.8,48.5 24.1,48.5 24.9,44.6 4.6,44.6 \t"
  }), React.createElement("path", {
    d: "M45.5,23.1c0,0,2.5-11.4,2.5-11.5H32.2c0,0.1-3.3,15.1-3.3,15.2h4c0,0,2.5-11.4,2.5-11.4h7.7 c0,0-2.4,11.4-2.5,11.5h11.7l-1.5,7H39.2c0,0.1-2.3,10.7-2.3,10.7h-8.8c0,0-0.8,3.8-0.8,3.9h12.9c0,0,2.3-10.7,2.3-10.7h11.6 c0,0,3.1-14.6,3.1-14.7H45.5z"
  }));
};

exports.PostFinanceIcon = PostFinanceIcon;
var _default = PostFinanceIcon;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetFormPostFinance = exports.ChargePostFinance = void 0;

var _helpers = require("src/_helpers");

var ChargePostFinance = function ChargePostFinance(order, CardNo, CvC, expiryDate) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      CVC: CvC,
      ExpiryDate: expiryDate,
      Amount: order.Total,
      CardNo: CardNo
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/postfinance");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.ChargePostFinance = ChargePostFinance;

var GetFormPostFinance = function GetFormPostFinance(order) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Amount: order.Total
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/postfinance/form");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.GetFormPostFinance = GetFormPostFinance;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.StripeCheckout = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactStripeElements = require("react-stripe-elements");

var _Services = require("./Services");

var _core = require("@material-ui/core");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var createOptions = function createOptions(fontSize) {
  return {
    style: {
      base: {
        fontSize: fontSize,
        color: '#424770',
        letterSpacing: '0.025em',
        fontFamily: 'Source Code Pro, monospace',
        '::placeholder': {
          color: '#aab7c4'
        }
      },
      invalid: {
        color: '#9e2146'
      }
    }
  };
};

var Checkout =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Checkout, _React$Component);

  function Checkout(props) {
    var _this;

    _classCallCheck(this, Checkout);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Checkout).call(this, props));
    _this.state = {};
    return _this;
  }

  _createClass(Checkout, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var fontsize = '1rem';
      return React.createElement("form", {
        onSubmit: function onSubmit(e) {
          return _this2._handleSubmit(e);
        },
        className: "stripe"
      }, React.createElement("label", null, "Card number", React.createElement(_reactStripeElements.CardNumberElement, createOptions(fontsize))), React.createElement("label", null, "Expiration date", React.createElement(_reactStripeElements.CardExpiryElement, createOptions(fontsize))), React.createElement("label", null, "CVC", React.createElement(_reactStripeElements.CardCVCElement, createOptions(fontsize))), React.createElement("label", null, "Postal code", React.createElement(_reactStripeElements.PostalCodeElement, createOptions(fontsize))), !this.state.loading && React.createElement(_core.Button, {
        type: "submit"
      }, "Confirm order"), this.state.loading && 'loading result...');
    }
  }, {
    key: "_handleSubmit",
    value: function _handleSubmit(e) {
      var _this3 = this;

      // We don't want to let default form submission happen here, which would refresh the page.
      e.preventDefault(); // Within the context of `Elements`, this call to createToken knows which Element to
      // tokenize, since there's only one in this group.

      var stripe = this.props.stripe;

      if (!stripe) {
        return;
      }

      this.setState(function (prev) {
        return {
          loading: true
        };
      });
      stripe.createToken({}).then(function (_ref) {
        var token = _ref.token,
            error = _ref.error;
        var t = token;

        if (!t || error) {
          _this3.setState(function (prev) {
            return {
              loading: false
            };
          });

          return;
        }

        (0, _Services.ChargeStripe)(_this3.props.order, t).then(function (payment) {
          _this3.props.onRequestClose();

          _this3.props.onChange({
            Payments: [].concat(_toConsumableArray(_this3.props.order.Payments), [payment])
          });
        });
      }); // However, this line of code will do the same thing:
      // this.props.stripe.createToken({type: 'card', name: 'Jenny Rosen'});
    }
  }]);

  return Checkout;
}(React.Component);

var StripeCheckout = (0, _reactStripeElements.injectStripe)(Checkout);
exports.StripeCheckout = StripeCheckout;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ChargeStripe = exports.GetStripeApiKey = void 0;

var _helpers = require("src/_helpers");

var GetStripeApiKey = function GetStripeApiKey() {
  var requestOptions = {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  };
  var url = "".concat(_helpers.config.apiUrl, "/stripe");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.GetStripeApiKey = GetStripeApiKey;

var ChargeStripe = function ChargeStripe(order, token) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Token: token.id,
      Amount: order.Total
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/stripe");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.ChargeStripe = ChargeStripe;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ApiKey = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactStripeElements = require("react-stripe-elements");

var _Services = require("./Services");

var _loadjs = _interopRequireDefault(require("loadjs"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ApiKey = '';
exports.ApiKey = ApiKey;
var dependencyRequested = false;

var StripeButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(StripeButton, _React$Component);

  function StripeButton(props) {
    var _this;

    _classCallCheck(this, StripeButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(StripeButton).call(this, props));
    _this._onClick = _this._onClick.bind(_assertThisInitialized(_this));
    _this._handleOpen = _this._handleOpen.bind(_assertThisInitialized(_this));
    _this._handleClose = _this._handleClose.bind(_assertThisInitialized(_this));
    _this._renderDialog = _this._renderDialog.bind(_assertThisInitialized(_this));
    _this.state = {
      // apiKey: ApiKey,
      // loaded: !!ApiKey,
      open: false // loading: false

    };
    return _this;
  }

  _createClass(StripeButton, [{
    key: "render",
    value: function render() {
      var _this$state = this.state,
          loadingScript = _this$state.loadingScript,
          loadingSettings = _this$state.loadingSettings;
      var classes = this.props.classes;

      if (loadingSettings || loadingScript) {
        return React.createElement(_core.ButtonBase, {
          disabled: true,
          classes: {
            root: classes.buttonBase
          }
        }, React.createElement(_icons.Cached, {
          className: classes.btnIcon
        }), React.createElement("span", {
          className: classes.btnText
        }, "loading"));
      } // load the preferences 


      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._onClick,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.Payment, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Credit card")), this._renderDialog());
    }
  }, {
    key: "_onClick",
    value: function _onClick() {
      var _this2 = this;

      var _this$state2 = this.state,
          scriptLoaded = _this$state2.scriptLoaded,
          apiKey = _this$state2.apiKey;

      if (scriptLoaded && apiKey) {
        this.setState(function () {
          return {
            open: true
          };
        });
        return;
      }

      var onload = function onload() {
        dependencyRequested = true;

        _this2.setState(function (prev) {
          return {
            loadingScript: false,
            scriptLoaded: true,
            open: !prev.loadingSettings
          };
        });
      };

      if (dependencyRequested) {
        onload();
      } else {
        this.setState(function () {
          return {
            loadingScript: true
          };
        }, function () {
          (0, _loadjs.default)('https://js.stripe.com/v3/', {
            success: function success() {
              onload();
            },
            before: function before() {
              return true;
            }
          });
        });
      }

      (0, _Services.GetStripeApiKey)().then(function (value) {
        if (!value) {
          _this2.setState(function () {
            return {
              error: true
            };
          });

          return;
        }

        exports.ApiKey = ApiKey = value;

        _this2.setState(function (prev) {
          return {
            loadingSettings: false,
            apiKey: value,
            open: !prev.loadingSettings
          };
        });
      });
      this.setState(function () {
        return {
          loadingSettings: true,
          loadingScript: !dependencyRequested
        };
      });
    }
  }, {
    key: "_handleOpen",
    value: function _handleOpen() {
      this.setState({
        open: true
      });
    }
  }, {
    key: "_handleClose",
    value: function _handleClose() {
      this.setState({
        open: false
      });
    }
  }, {
    key: "_renderDialog",
    value: function _renderDialog() {
      var _this3 = this;

      var createOptions = function createOptions(fontSize) {
        return {
          style: {
            base: {
              fontSize: fontSize,
              color: '#424770',
              letterSpacing: '0.025em',
              fontFamily: 'Source Code Pro, monospace',
              '::placeholder': {
                color: '#aab7c4'
              }
            },
            invalid: {
              color: '#9e2146'
            }
          }
        };
      };

      var fontsize = '1rem';
      var apiKey = this.state.apiKey;
      var _this$state3 = this.state,
          open = _this$state3.open,
          loadingResult = _this$state3.loadingResult;
      return React.createElement(_core.Dialog, {
        open: open,
        onClose: this._handleClose
      }, React.createElement(_core.DialogTitle, null, "Credit card payment"), React.createElement(_core.DialogContent, null, React.createElement(_reactStripeElements.StripeProvider, {
        apiKey: apiKey
      }, React.createElement(_reactStripeElements.Elements, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          return _this3._handleSubmit(e);
        },
        className: "stripe"
      }, React.createElement("label", null, "Card number", React.createElement(_reactStripeElements.CardNumberElement, createOptions(fontsize))), React.createElement("label", null, "Expiration date", React.createElement(_reactStripeElements.CardExpiryElement, createOptions(fontsize))), React.createElement("label", null, "CVC", React.createElement(_reactStripeElements.CardCVCElement, createOptions(fontsize))), React.createElement("label", null, "Postal code", React.createElement(_reactStripeElements.PostalCodeElement, createOptions(fontsize))))))), React.createElement(_core.DialogActions, null, !!loadingResult ? 'loading result...' : React.createElement(React.Fragment, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: this._handleClose
      }, "Cancel"), React.createElement(_core.Button, {
        type: "submit",
        variant: "contained",
        color: "primary"
      }, "Confirm order"))));
    }
  }, {
    key: "_handleSubmit",
    value: function _handleSubmit(e) {
      var _this4 = this;

      // We don't want to let default form submission happen here, which would refresh the page.
      e.preventDefault(); // Within the context of `Elements`, this call to createToken knows which Element to
      // tokenize, since there's only one in this group.

      var stripe = this.props.stripe;

      if (!stripe) {
        return;
      }

      this.setState(function (prev) {
        return {
          loadingResult: true
        };
      });
      stripe.createToken({}).then(function (_ref) {
        var token = _ref.token,
            error = _ref.error;
        var t = token;

        if (!t || error) {
          _this4.setState(function (prev) {
            return {
              loadingResult: false
            };
          });

          return;
        }

        (0, _Services.ChargeStripe)(_this4.props.order, t).then(function (payment) {
          _this4._handleClose();

          _this4.props.onChange({
            Payments: [].concat(_toConsumableArray(_this4.props.order.Payments), [payment])
          });
        });
      }); // However, this line of code will do the same thing:
      // this.props.stripe.createToken({type: 'card', name: 'Jenny Rosen'});
    }
  }]);

  return StripeButton;
}(React.Component); // <div className="pay__btn-icon">
// {getIcon(
//     {
//         className: 'material-icons',
//         inner: 'cached',
//         tag: 'i'
//     },
//     false,
//     'loading',
//     'icon-loading')}
// </div>
// <div className="pay__btn-icon">
// {getIcon(
//     {
//         className: 'fab fa-stripe',
//         inner: '',
//         tag: 'i'
//     },
//     false,
//     'stripe')}
// </div>


var _default = (0, _core.withStyles)(function (theme) {
  return (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#00afe1',
      contrastText: '#ffffff'
    }
  }));
})(StripeButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.StripeIcon = void 0;

var React = _interopRequireWildcard(require("react"));

var _SvgIcon = _interopRequireDefault(require("@material-ui/core/SvgIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* tslint:disable:max-line-length */
var StripeIcon = function StripeIcon(props) {
  return React.createElement(_SvgIcon.default, _objectSpread({
    viewBox: '0 0 640 512'
  }, props), React.createElement("path", {
    d: "M640 261.6c0-45.5-22-81.4-64.2-81.4s-67.9 35.9-67.9 81.1c0 53.5 30.3 78.2 73.5 78.2 21.2 0 37.1-4.8 49.2-11.5v-33.4c-12.1 6.1-26 9.8-43.6 9.8-17.3 0-32.5-6.1-34.5-26.9h86.9c.2-2.3.6-11.6.6-15.9m-87.9-16.8c0-20 12.3-28.4 23.4-28.4 10.9 0 22.5 8.4 22.5 28.4h-45.9zm-112.9-64.6c-17.4 0-28.6 8.2-34.8 13.9l-2.3-11H363v204.8l44.4-9.4.1-50.2c6.4 4.7 15.9 11.2 31.4 11.2 31.8 0 60.8-23.2 60.8-79.6.1-51.6-29.3-79.7-60.5-79.7m-10.6 122.5c-10.4 0-16.6-3.8-20.9-8.4l-.3-66c4.6-5.1 11-8.8 21.2-8.8 16.2 0 27.4 18.2 27.4 41.4.1 23.9-10.9 41.8-27.4 41.8M346.4 124v36.2l-44.6 9.5v-36.2l44.6-9.5m-44.5 59.2h44.6v153.2h-44.6V183.2zm-47.8 13.1c10.4-19.1 31.1-15.2 37.1-13.1V224c-5.7-1.8-23.4-4.5-33.9 9.3v103.1H213V183.2h38.4l2.7 13.1m-89-13.1h33.7V221h-33.7v63.2c0 26.2 28 18 33.7 15.7v33.8c-5.9 3.2-16.6 5.9-31.2 5.9-26.3 0-46.1-17-46.1-43.3l.2-142.4 43.3-9.2.1 38.5zM44.9 228.3c0 20 67.9 10.5 67.9 63.4 0 32-25.4 47.8-62.3 47.8-15.3 0-32-3-48.5-10.1v-40c14.9 8.1 33.9 14.2 48.6 14.2 9.9 0 17-2.7 17-10.9 0-21.2-67.5-13.2-67.5-62.4 0-31.4 24-50.2 60-50.2 14.7 0 29.4 2.3 44.1 8.1V230c-13.5-7.3-30.7-11.4-44.2-11.4-9.3.1-15.1 2.8-15.1 9.7"
  }));
};

exports.StripeIcon = StripeIcon;
var _default = StripeIcon;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _Services = require("./Services");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var TransferButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(TransferButton, _React$Component);

  function TransferButton(props) {
    var _this;

    _classCallCheck(this, TransferButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(TransferButton).call(this, props));
    _this._handleOpen = _this._handleOpen.bind(_assertThisInitialized(_this));
    _this._handleClose = _this._handleClose.bind(_assertThisInitialized(_this));
    _this._addTransfer = _this._addTransfer.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(TransferButton, [{
    key: "render",
    value: function render() {
      var classes = this.props.classes;
      var _this$state = this.state,
          open = _this$state.open,
          loading = _this$state.loading,
          message = _this$state.message;

      if (loading) {
        return React.createElement(_core.ButtonBase, {
          disabled: true,
          classes: {
            root: classes.buttonBase
          }
        }, React.createElement(_icons.Cached, {
          className: classes.btnIcon
        }), React.createElement("span", {
          className: classes.btnText
        }, "loading"));
      }

      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: this._handleOpen,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.SwapHoriz, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, "Transfer")), React.createElement(_core.Dialog, {
        open: open,
        onClose: this._handleClose
      }, React.createElement(_core.DialogTitle, null, "Transfere payment informations"), React.createElement(_core.DialogContent, null, React.createElement(_core.DialogContentText, null, message)), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: this._handleClose
      }, "Cancel"), React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        onClick: this._addTransfer
      }, "Add Transfer"))));
    }
  }, {
    key: "_handleOpen",
    value: function _handleOpen() {
      var _this2 = this;

      var _this$state2 = this.state,
          loading = _this$state2.loading,
          message = _this$state2.message;

      if (loading) {
        return;
      }

      if (message === undefined) {
        this.setState(function () {
          return {
            loading: true
          };
        }, function () {
          (0, _Services.GetTransferPaymentMessage)(_this2.props.order).then(function (m) {
            _this2.setState(function () {
              return {
                open: true,
                message: m,
                loading: false
              };
            });
          });
        });
        return;
      }

      this.setState({
        open: true
      });
    }
  }, {
    key: "_handleClose",
    value: function _handleClose() {
      this.setState({
        open: false
      });
    }
  }, {
    key: "_addTransfer",
    value: function _addTransfer() {
      var _this3 = this;

      var amount = this.props.order.Total - this.props.order.PaidAmount;
      (0, _Services.RegisterTransferPayment)(this.props.order, amount).then(function (order) {
        _this3.props.refresh();
      }).then(this._handleClose);
    }
  }]);

  return TransferButton;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#99e9f2',
      contrastText: '#ffffff'
    }
  }));
})(TransferButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.GetTransferPaymentMessage = exports.RegisterTransferPayment = void 0;

var _helpers = require("src/_helpers");

var RegisterTransferPayment = function RegisterTransferPayment(order, amount) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderID: order.Id,
      Amount: amount
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/transfer");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.RegisterTransferPayment = RegisterTransferPayment;

var GetTransferPaymentMessage = function GetTransferPaymentMessage(order) {
  var requestOptions = {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  };
  var url = "".concat(_helpers.config.apiUrl, "/transfer/message/").concat(order.Id);
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.GetTransferPaymentMessage = GetTransferPaymentMessage;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _styles = require("@material-ui/core/styles");

var _icons = require("@material-ui/icons");

var _OrderCheckoutBtnStyles = _interopRequireDefault(require("../../OrderCheckoutBtnStyles"));

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

var _VoucherServices = require("./VoucherServices");

var _VoucherCode = _interopRequireWildcard(require("src/components/VoucherCode/VoucherCode"));

var _VoucherMessages = _interopRequireDefault(require("./VoucherMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var VoucherButton =
/*#__PURE__*/
function (_React$Component) {
  _inherits(VoucherButton, _React$Component);

  function VoucherButton(props) {
    var _this;

    _classCallCheck(this, VoucherButton);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(VoucherButton).call(this, props));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._use = _this._use.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false,
      code: Array.from({
        length: _VoucherCode.CODE_LENGTH
      }, function () {
        return '';
      }),
      focussed: 0
    };
    return _this;
  }

  _createClass(VoucherButton, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          classes = _this$props.classes,
          intl = _this$props.intl;

      var toggle = function toggle() {
        return _this2.setState(function (prev) {
          return {
            open: !prev.open
          };
        });
      };

      return React.createElement(React.Fragment, null, React.createElement(_core.ButtonBase, {
        focusRipple: true,
        onClick: toggle,
        classes: {
          root: classes.buttonBase
        }
      }, React.createElement(_icons.CardGiftcard, {
        className: classes.btnIcon
      }), React.createElement("span", {
        className: classes.btnText
      }, intl.formatMessage(_VoucherMessages.default.voucher))), this._renderLightbox());
    }
  }, {
    key: "_renderLightbox",
    value: function _renderLightbox() {
      var _this3 = this;

      var _this$props2 = this.props,
          classes = _this$props2.classes,
          intl = _this$props2.intl,
          authCtx = _this$props2.authCtx;
      var _this$state = this.state,
          open = _this$state.open,
          code = _this$state.code,
          error = _this$state.error,
          valid = _this$state.valid,
          reason = _this$state.reason;

      var change = function change(newCode) {
        var toValidate = newCode.every(function (c) {
          return !!c;
        });

        _this3.setState(function () {
          return {
            code: newCode,
            valid: toValidate ? valid : undefined,
            reason: undefined
          };
        }, function () {
          if (newCode.every(function (c) {
            return !!c;
          })) {
            _this3._validate();
          }
        });
      };

      var legend = intl.formatMessage(_VoucherMessages.default.ok);

      if (reason && reason === 'used') {
        legend = intl.formatMessage(_VoucherMessages.default.used);
      }

      if (reason && reason === 'notfound') {
        legend = intl.formatMessage(_VoucherMessages.default.notfound);
      }

      if (reason && reason === 'expired') {
        legend = intl.formatMessage(_VoucherMessages.default.expired);
      }

      if (reason && reason === 'empty') {
        legend = intl.formatMessage(_VoucherMessages.default.empty);
      }

      return React.createElement(_SideDialog.default, {
        open: open,
        onClose: function onClose() {
          return _this3.setState(function () {
            return {
              open: false
            };
          });
        }
      }, React.createElement(_core.DialogContent, {
        className: classes.content
      }, React.createElement(_core.Typography, {
        variant: "h6",
        align: "center",
        className: classes.title
      }, "Voucher code"), React.createElement(_VoucherCode.default, {
        valid: valid,
        code: code,
        onChange: change,
        authCtx: authCtx
      })), React.createElement(_core.DialogActions, null, error, React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: this._close
      }, "Cancel"), React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        disabled: !valid,
        onClick: this._use
      }, legend)));
    }
  }, {
    key: "_close",
    value: function _close() {
      this.setState(function () {
        return {
          open: false
        };
      });
    }
  }, {
    key: "_use",
    value: function _use() {
      var _this4 = this;

      var _this$props3 = this.props,
          order = _this$props3.order,
          refresh = _this$props3.refresh;
      var code = this.state.code;
      (0, _VoucherServices.UseVoucher)(order, code.join('')).then(function () {
        refresh();

        _this4._close();
      }).catch(function (r) {
        return _this4.setState(function () {
          return {
            error: r.Result && r.Result.Message || ''
          };
        });
      });
    }
  }, {
    key: "_validate",
    value: function _validate() {
      var _this5 = this;

      var order = this.props.order;
      var code = this.state.code;
      (0, _VoucherServices.ValidateVoucher)(order, code.join('')).then(function (r) {
        return _this5.setState(function () {
          return {
            valid: r.Result,
            reason: r.Reason
          };
        });
      });
    }
  }]);

  return VoucherButton;
}(React.Component);

var _default = (0, _styles.withStyles)(function (theme) {
  return _objectSpread({
    content: {
      display: 'flex',
      justifyContent: 'center',
      flexDirection: 'column'
    },
    title: {
      marginBottom: theme.spacing.unit
    }
  }, (0, _OrderCheckoutBtnStyles.default)(theme, (0, _createPalette.default)({
    primary: {
      main: '#ff6464',
      contrastText: '#ffffff'
    }
  })), {
    input: {
      display: 'flex',
      height: 150,
      borderRadius: theme.shape.borderRadius,
      border: "1px solid ".concat(theme.palette.divider),
      boxShadow: "inset 2px 1px 15px -7px rgba(0, 0, 0, 0.2)",
      fontSize: 80,
      width: '100%',
      justifyContent: 'center',
      // tslint:disable-next-line:no-any
      textAlign: 'center',
      fontFamily: 'monospace'
    },
    inputWrong: {
      borderColor: theme.palette.error.main,
      boxShadow: "inset 2px 1px 15px -7px ".concat(theme.palette.error.light),
      color: theme.palette.error.main
    },
    inputGood: {
      borderColor: theme.Colors.green.primary.main,
      boxShadow: "inset 2px 1px 15px -7px ".concat(theme.Colors.green.primary.light),
      color: theme.Colors.green.primary.main
    }
  });
})(VoucherButton);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherMessages = void 0;

var _reactIntl = require("react-intl");

var VoucherMessages = (0, _reactIntl.defineMessages)({
  voucher: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.voucher",
    "defaultMessage": "voucher"
  },
  ok: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.ok",
    "defaultMessage": "Use voucher"
  },
  notfound: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.notfound",
    "defaultMessage": "Voucher not found"
  },
  expired: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.expired",
    "defaultMessage": "Voucher expired"
  },
  empty: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.empty",
    "defaultMessage": "Voucher empty"
  },
  used: {
    "id": "src.components.order.orderCheckout.Pay.Voucher.used",
    "defaultMessage": "Voucher used"
  }
});
exports.VoucherMessages = VoucherMessages;
var _default = VoucherMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ValidateVoucher = exports.UseVoucher = void 0;

var _helpers = require("src/_helpers");

var UseVoucher = function UseVoucher(order, code) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderId: order.Id,
      Code: code
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/voucherpayment/use");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.UseVoucher = UseVoucher;

var ValidateVoucher = function ValidateVoucher(order, code) {
  var requestOptions = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      OrderId: order.Id,
      Code: code
    })
  };
  var url = "".concat(_helpers.config.apiUrl, "/voucherpayment/validate");
  return fetch(url, (0, _helpers.addAuthHeader)(requestOptions)).then(_helpers.handleApiResponse).then(function (response) {
    return response;
  });
};

exports.ValidateVoucher = ValidateVoucher;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderClientFieldsMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var md5 = _interopRequireWildcard(require("md5"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _reactIntl = require("react-intl");

var _ourOrders = require("src/@types/our-orders");

var _core = require("@material-ui/core");

var _PersonFields = _interopRequireDefault(require("src/components/Person/PersonFields"));

var _services = require("src/_services");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _notistack = require("notistack");

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderClientFieldsMessages = (0, _reactIntl.defineMessages)({
  searchPlaceholder: {
    "id": "src.components.forms.client.searchPlaceholder",
    "defaultMessage": "Choose existing client"
  },
  closeDetail: {
    "id": "src.components.forms.client.closeDetail",
    "defaultMessage": "Close"
  },
  updateClient: {
    "id": "src.components.forms.client.updateClient",
    "defaultMessage": "Update Client infos"
  },
  createClient: {
    "id": "src.components.forms.client.createClient",
    "defaultMessage": "Create Client"
  }
});
exports.OrderClientFieldsMessages = OrderClientFieldsMessages;

var OrderClientFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderClientFields, _React$Component);

  function OrderClientFields(props) {
    var _this;

    _classCallCheck(this, OrderClientFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderClientFields).call(this, props));
    _this._handleClientChange = _this._handleClientChange.bind(_assertThisInitialized(_this));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(OrderClientFields, [{
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      if (nextProps.preventEditClient !== this.props.preventEditClient) {
        return true;
      }

      if (nextProps.onChange !== this.props.onChange) {
        return true;
      }

      if (JSON.stringify(nextProps.current) !== JSON.stringify(this.props.current)) {
        return true;
      }

      if (JSON.stringify(nextState) !== JSON.stringify(this.state)) {
        return true;
      }

      return false;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          open = _this$state.open,
          updating = _this$state.updating,
          updated = _this$state.updated,
          creating = _this$state.creating,
          created = _this$state.created;
      var _this$props = this.props,
          _this$props$current = _this$props.current,
          current = _this$props$current.Client,
          ClientId = _this$props$current.ClientId,
          intl = _this$props.intl,
          onChange = _this$props.onChange,
          classes = _this$props.classes,
          enqueueSnackbar = _this$props.enqueueSnackbar,
          user = _this$props.authCtx.user;
      var client = current || {};
      var firstname = client.FirstName || '';
      var lastname = client.LastName || '';
      var organizationname = client.OrganizationName || '';
      var phone = client.Phone || '';
      var cellphone = client.CellPhone || '';
      var email = client.Email || '';
      var city = client.City || '';
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Clients');
      var empty = !(firstname || lastname || organizationname);
      var preview = empty ? React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, {
        loading: true
      }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        loading: true
      }), React.createElement(_ItemPreview.Line, {
        loading: true
      }))) : React.createElement(_ItemPreview.default, {
        onClick: function onClick() {
          return _this2.setState(function (prev) {
            return {
              open: !prev.open
            };
          });
        }
      }, React.createElement(_ItemPreview.Thumb, {
        src: "https://www.gravatar.com/avatar/".concat(md5(email), "?d=mm")
      }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, firstname && React.createElement("span", {
        className: classes.firstName
      }, firstname), lastname && React.createElement("span", {
        className: classes.lastName
      }, lastname)), React.createElement(_ItemPreview.Line, null, city && React.createElement("span", null, city)), React.createElement(_ItemPreview.Line, null, email && React.createElement("a", {
        href: "mailto:".concat(email)
      }, email), cellphone && React.createElement("span", null, cellphone), !cellphone && phone && React.createElement("span", null, phone))));

      if (this.props.preventEditClient) {
        return preview;
      }

      var close = function close() {
        return _this2.setState(function () {
          return {
            open: false
          };
        });
      };

      var updateClient = function updateClient() {
        _this2.setState(function () {
          return {
            updating: true,
            updated: false
          };
        }, function () {
          return _services.Clients.Patch(ClientId, client).then(function () {
            enqueueSnackbar("Successfully updated Client ".concat(client.FirstName || '', " ").concat(client.LastName || ''), {
              variant: 'success'
            });

            _this2.setState(function () {
              return {
                updating: false,
                updated: true
              };
            });
          }).catch(function (reason) {
            enqueueSnackbar("Impossible to update Client (".concat(reason, ")"), {
              variant: 'error'
            });
          });
        });
      };

      var newClient = function newClient() {
        _this2.setState(function () {
          return {
            creating: true,
            created: false
          };
        }, function () {
          return _services.Clients.Create(client).then(function (c) {
            enqueueSnackbar("Successfully created Client ".concat(c.FirstName || '', " ").concat(c.LastName || ''), {
              variant: 'success'
            });

            _this2.setState(function () {
              return {
                creating: false,
                created: true
              };
            }, function () {
              return onChange({
                ClientId: c.Id
              });
            });
          }).catch(function (reason) {
            enqueueSnackbar("Impossible to create Client (".concat(reason, ")"), {
              variant: 'error'
            });
          });
        });
      };

      return React.createElement(React.Fragment, null, preview, React.createElement(_SideDialog.default, {
        open: open,
        onClose: close
      }, React.createElement(_core.DialogContent, null, React.createElement(_PersonFields.default, {
        current: current,
        onChange: this._handleClientChange,
        intl: intl,
        hasRights: !!hasRights
      })), React.createElement(_core.DialogActions, null, hasRights && !ClientId && React.createElement(_core.Button, {
        size: "small",
        color: creating ? 'secondary' : 'primary',
        disabled: creating || created,
        variant: "contained",
        onClick: newClient
      }, creating && React.createElement(_core.CircularProgress, {
        size: 24
      }), React.createElement(_reactIntl.FormattedMessage, OrderClientFieldsMessages.createClient)), hasRights && ClientId && React.createElement(_core.Button, {
        size: "small",
        color: updated ? 'secondary' : 'primary',
        disabled: updating || updated,
        variant: "contained",
        onClick: updateClient
      }, updating && React.createElement(_core.CircularProgress, {
        size: 24
      }), React.createElement(_reactIntl.FormattedMessage, OrderClientFieldsMessages.updateClient)), React.createElement(_core.Button, {
        size: "small",
        color: "default",
        variant: "contained",
        onClick: close
      }, React.createElement(_reactIntl.FormattedMessage, OrderClientFieldsMessages.closeDetail)))));
    } // private _handleClientSelectChange(options: SelectOption<string>) {
    //     const id = options.value;
    //     const { current, onChange } = this.props;
    //     if (id) {
    //         this._fetchClient(id).then((client) => {
    //             if (current.ClientID !== client.Id) { return; }
    //             onChange({ ClientID: id, Client: client });
    //         });
    //     } else {
    //         this.props.onChange({ ClientID: undefined });
    //     }
    // }
    // private _fetchOptions(input: string) {
    //     return Clients.List(input, 0, 100)
    //         .then((json) => {
    //             const options = json.Values.map(v => ({ value: v.Id, label: v.Title }));
    //             return {
    //                 options: options
    //             };
    //         });
    // }
    // private _fetchClient(id: string) {
    //     return Clients.Get(id);
    // }

  }, {
    key: "_handleClientChange",
    value: function _handleClientChange(changes) {
      var _this$props2 = this.props,
          current = _this$props2.current,
          onChange = _this$props2.onChange;
      onChange({
        Client: _objectSpread({}, current.Client, changes)
      });
    }
  }]);

  return OrderClientFields;
}(React.Component);

var _default = React.memo((0, _core.withStyles)(function (theme) {
  return {
    firstName: {
      marginRight: theme.spacing.unit,
      fontWeight: 'bold',
      color: 'black'
    },
    lastName: {
      fontWeight: 'bold',
      color: 'black'
    }
  };
})((0, _notistack.withSnackbar)(OrderClientFields)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderDetail = void 0;

var React = _interopRequireWildcard(require("react"));

var _OrderFields = _interopRequireDefault(require("../OrderFields/OrderFields"));

var _services = require("../../../_services");

var _throttleDebounce = require("throttle-debounce");

var _OrderCheckout = _interopRequireDefault(require("../OrderCheckout/OrderCheckout"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _textEllipsis = _interopRequireDefault(require("text-ellipsis"));

var _OrderShippingDialog = _interopRequireDefault(require("../OrderShippingDialog/OrderShippingDialog"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _OrderDocumentsDialog = _interopRequireWildcard(require("./OrderDocumentsDialog"));

var _OrderDocumentsDialogMessages = _interopRequireDefault(require("./OrderDocumentsDialogMessages"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var LOCAL_STORAGE_KEY = 'our.orders.OrderDetail';

var OrderDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderDetail, _React$Component);

  function OrderDetail(props) {
    var _this;

    _classCallCheck(this, OrderDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderDetail).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_lastRefresh", new Date());

    _this._UpdateDebounced = (0, _throttleDebounce.debounce)(500, false, _this._UpdateDebounced);
    _this._Update = _this._Update.bind(_assertThisInitialized(_this));
    _this._Refresh = _this._Refresh.bind(_assertThisInitialized(_this));
    _this._Save = _this._Save.bind(_assertThisInitialized(_this));
    _this._Delete = _this._Delete.bind(_assertThisInitialized(_this));
    var id = props.id,
        preview = props.preview;
    _this.state = {
      id: id,
      changes: id ? {} : preview || {},
      current: preview || {}
    };
    return _this;
  }

  _createClass(OrderDetail, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          shopCtx = _this$props.shopCtx,
          preventEditClient = _this$props.preventEditClient,
          intl = _this$props.intl,
          authCtx = _this$props.authCtx,
          warehouseCtx = _this$props.warehouseCtx,
          templateCtx = _this$props.templateCtx,
          settingsCtx = _this$props.settingsCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          usersCtx = _this$props.usersCtx;
      var _this$state = this.state,
          current = _this$state.current,
          checkoutOpened = _this$state.checkoutOpened;

      var close = function close() {
        return _this2.setState(function () {
          return {
            checkoutOpened: false
          };
        });
      };

      return React.createElement(React.Fragment, null, React.createElement(_OrderFields.default, {
        preventEditClient: preventEditClient,
        onChange: this._Update,
        refresh: this._Refresh,
        authCtx: authCtx,
        productCtx: productCtx,
        categoryCtx: categoryCtx,
        settingsCtx: settingsCtx,
        shopCtx: shopCtx,
        warehouseCtx: warehouseCtx,
        usersCtx: usersCtx,
        current: current,
        intl: intl
      }), this._Dispatch(), this._ConfirmDisptach(), this._renderActions(), React.createElement(_core.Dialog, {
        open: !!checkoutOpened,
        fullScreen: true,
        onClose: close
      }, React.createElement(_OrderCheckout.default, _extends({
        authCtx: authCtx,
        warehouseCtx: warehouseCtx,
        intl: intl,
        settingsCtx: settingsCtx,
        shopCtx: shopCtx,
        templateCtx: templateCtx
      }, {
        order: current,
        close: close,
        save: this._Save,
        refresh: this._Refresh
      }))));
    }
  }, {
    key: "_Dispatch",
    value: function _Dispatch() {
      var _this3 = this;

      var _this$props2 = this.props,
          authCtx = _this$props2.authCtx,
          warehouseCtx = _this$props2.warehouseCtx,
          _this$state2 = this.state,
          current = _this$state2.current,
          dispatchOpened = _this$state2.dispatchOpened,
          Status = _this$state2.current.Status;

      if (Status !== 'ToDispatch') {
        return null;
      }

      return React.createElement(_OrderShippingDialog.default, {
        authCtx: authCtx,
        defaultMethod: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".defaultMethod")) || 'Post',
        defaultStatus: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".defaultStatus")) || 'EnRoute',
        methods: ['Post', 'Pickup', 'Electronic', 'Courier'],
        open: !!dispatchOpened,
        warehouseCtx: warehouseCtx,
        stock: this._getStock(),
        order: current,
        onSelect: function onSelect(d, s) {
          return _this3._applyUpdates(d, s);
        },
        toggle: function toggle(o) {
          return _this3.setState({
            dispatchOpened: o
          });
        }
      });
    }
  }, {
    key: "_ConfirmDisptach",
    value: function _ConfirmDisptach() {
      var _this4 = this;

      var intl = this.props.intl,
          _this$state3 = this.state,
          confirmDispatchOpened = _this$state3.confirmDispatchOpened,
          confirmDispatchId = _this$state3.confirmDispatchId,
          _this$state3$current = _this$state3.current,
          Dispatches = _this$state3$current.Dispatches,
          Status = _this$state3$current.Status;

      if (Status !== 'Dispatching') {
        return null;
      }

      var toConfim = Dispatches.filter(function (d) {
        return d.Status === 'EnRoute';
      });
      return React.createElement(_core.Dialog, {
        open: !!confirmDispatchOpened
      }, React.createElement(_core.DialogTitle, null, "Dispatch Shipping"), React.createElement(_core.DialogContent, null, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "DispatchStatus"
      }, "Confirm dispatch"), React.createElement(_core.Select, {
        fullWidth: true,
        value: confirmDispatchId || '',
        onChange: function onChange(e) {
          return _this4.setState(function () {
            return {
              confirmDispatchId: e.target.value
            };
          });
        },
        inputProps: {
          name: 'DispatchStatus',
          id: 'DispatchStatus'
        }
      }, toConfim.map(function (d) {
        return React.createElement(_core.MenuItem, {
          key: d.Id,
          value: d.Id
        }, "".concat(d.Method ? d.Method : '', "\n                                    from ").concat(d.Date ? intl.formatDate(new Date(d.Date)) : '', "\n                                    ").concat(d.Notes ? "(".concat((0, _textEllipsis.default)(d.Notes, 30), ")") : ''));
      })))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: function onClick() {
          return _this4.setState(function () {
            return {
              confirmDispatchOpened: false
            };
          });
        }
      }, "cancel"), React.createElement(_core.Button, {
        disabled: !confirmDispatchId,
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          return _this4._applyConfirmDispatch();
        }
      }, "update")));
    }
  }, {
    key: "_applyConfirmDispatch",
    value: function _applyConfirmDispatch() {
      var _this5 = this;

      var _this$state4 = this.state,
          confirmDispatchId = _this$state4.confirmDispatchId,
          Dispatches = _this$state4.current.Dispatches;
      var changes = {
        Dispatches: Dispatches.map(function (d) {
          return d.Id === confirmDispatchId ? _objectSpread({}, d, {
            Status: 'Delivered'
          }) : d;
        })
      };
      return this._Save(changes).then(function () {
        return _this5.setState(function () {
          return {
            confirmDispatchOpened: false
          };
        });
      });
    }
  }, {
    key: "_renderActions",
    value: function _renderActions() {
      var _this6 = this;

      var _this$props3 = this.props,
          templateCtx = _this$props3.templateCtx,
          intl = _this$props3.intl,
          user = _this$props3.authCtx.user;
      var _this$state5 = this.state,
          current = _this$state5.current,
          changes = _this$state5.changes,
          loading = _this$state5.loading,
          id = _this$state5.id,
          templatesOpened = _this$state5.templatesOpened;
      var changed = !!Object.keys(changes).length;
      var hasItems = current.Items && current.Items.length > 0 || changes.Items && changes.Items.length > 0;
      var ownOrder = current.UserId === user.Id;
      var hasRights = ownOrder && (0, _roles.IsAdminOrInRole)(user, 'CRUD_Own_Orders') || (0, _roles.IsAdminOrInRole)(user, 'CRUD_All_Orders');
      var isOrderType = current.OrderType === 'Order';
      var Status = current.Status;

      var opencheckout = function opencheckout() {
        return _this6.setState(function () {
          return {
            checkoutOpened: true
          };
        });
      };

      var saveBtn = {
        icon: React.createElement(_icons.Check, null),
        onClick: function onClick() {
          return _this6._Save();
        },
        themeColor: 'green',
        legend: 'save'
      };
      var payBtn = {
        icon: React.createElement(_icons.Payment, null),
        onClick: function onClick() {
          return _this6._Save().then(opencheckout);
        },
        themeColor: 'orange',
        legend: 'pay'
      };
      var toDispatchBtn = {
        icon: React.createElement(_icons.HowToVote, null),
        onClick: function onClick() {
          return _this6.setState(function () {
            return {
              dispatchOpened: true
            };
          });
        },
        themeColor: 'blue',
        legend: 'dispatch'
      };
      var confirmDeliveredBtn = {
        icon: React.createElement(_icons.LocalShipping, null),
        onClick: function onClick() {
          return _this6.setState(function () {
            return {
              confirmDispatchOpened: true
            };
          });
        },
        themeColor: 'green',
        legend: 'confirm'
      };
      var cancelBtn = {
        icon: React.createElement(_icons.Close, null),
        onClick: function onClick() {
          return _this6.props.onCancel();
        },
        themeColor: 'gray',
        legend: changed ? 'cancel' : 'close'
      };
      var deleteBtn = {
        icon: React.createElement(_icons.Delete, null),
        legend: 'delete',
        themeColor: 'red',
        onClick: this._Delete
      }; // const activateBtn: FabBtnProps = {
      //     icon: current.Canceled ? <CheckCircleOutline /> : <Block />,
      //     legend: current.Canceled ? 'set active' : 'set cancelled',
      //     onClick: () => {
      //         const deleteChanges = { ...this.state.changes, Canceled: !current.Canceled };
      //         this._Save(deleteChanges);
      //     }
      // };
      // const printBtn: FloatingActionButtonProps = {
      //     icon:
      //     {
      //         className: 'material-icons',
      //         inner: 'print',
      //         tag: 'i'
      //     },
      //     color: 'grey',
      //     children: [
      //         {
      //             icon: receiptIcon,
      //             size: 'secondary',
      //             legend: 'reciept',
      //             onClick: () => {
      //                 ToCanvas(
      //                     <Reciept
      //                         {...{ order: this.state.preview, shopCtx, intl }}
      //                     />
      //                 ).then((canvas) => {
      //                     ToPdf(canvas, 'reciept');
      //                     // PrintLink(canvas.toDataURL(), 'reciept');
      //                     // new Printer({
      //                     //     content: () => (
      //                     //         <img
      //                     //             src={canvas.toDataURL()}
      //                     //         />
      //                     //     ),
      //                     //     cssClasses: ['body--print-reciept'],
      //                     //     cssStyles:
      //                     //         `size: 8cm auto;
      //                     //          width: 8cm;`
      //                     // }).Print();
      //                 });
      //             }
      //         },
      //         {
      //             icon: offerIcon,
      //             size: 'secondary',
      //             legend: 'offer'
      //         }
      //     ]
      // };

      var templates = templateCtx.templates.filter(function (t) {
        return t.ApplyTo === 'order';
      });
      var templateBtn = templates.length > 0 && {
        icon: React.createElement(_icons.Print, null),
        legend: templates.length > 1 ? 'documents' : templates[0].Title,
        themeColor: 'gray',
        onClick: templates.length > 1 ? function () {
          return _this6.setState(function () {
            return {
              templatesOpened: true
            };
          });
        } : function () {
          return (0, _OrderDocumentsDialog.PrintOrder)(templates[0].Id, current);
        }
      };

      if (loading) {
        return React.createElement(_Fabs.default, {
          map: ['loading']
        });
      }

      if (!hasRights) {
        return React.createElement(_Fabs.default, {
          map: [cancelBtn]
        });
      }

      if (!hasItems) {
        return React.createElement(_Fabs.default, {
          map: [changed && saveBtn, cancelBtn, !!id && deleteBtn]
        });
      }

      var btns = [isOrderType && Status === 'Dispatching' && confirmDeliveredBtn, isOrderType && Status === 'ToDispatch' && toDispatchBtn, isOrderType && Status === 'PendingPayment' && payBtn, changed && saveBtn, templateBtn, // sendBtn,
      current.Canceled && deleteBtn, // activateBtn,
      cancelBtn, !!id && deleteBtn];
      return React.createElement(React.Fragment, null, templates.length > 1 ? React.createElement(_OrderDocumentsDialog.default, {
        opened: templatesOpened,
        current: current,
        intl: intl,
        templates: templates,
        onClose: function onClose() {
          return _this6.setState(function () {
            return {
              templatesOpened: false
            };
          });
        }
      }) : null, React.createElement(_Fabs.default, {
        map: btns
      }));
    } // backIcon={{
    //     className: 'material-icons',
    //     inner: 'chevron_left',
    //     tag: 'i'
    // }}

  }, {
    key: "_Update",
    value: function _Update(changes) {
      var old = this.state.current;

      var current = _objectSpread({}, old, changes);

      this.setState(function (prev) {
        return {
          current: current,
          loading: true,
          changes: _objectSpread({}, prev.changes, changes)
        };
      }, this._UpdateDebounced);
    }
  }, {
    key: "_UpdateDebounced",
    value: function _UpdateDebounced() {
      var _this7 = this;

      var refreshTimeStamp = new Date();
      this._lastRefresh = refreshTimeStamp;
      var _this$state6 = this.state,
          id = _this$state6.id,
          changes = _this$state6.changes;

      _services.Orders.Preview(changes, id).then(function (order) {
        if (refreshTimeStamp.valueOf() !== _this7._lastRefresh.valueOf()) {
          return;
        }

        _this7.setState(function () {
          return {
            current: order,
            loading: false
          };
        });
      });
    }
  }, {
    key: "_Refresh",
    value: function _Refresh() {
      this._Update({});
    }
  }, {
    key: "_Save",
    value: function _Save(extrachanges) {
      var _this8 = this;

      var _this$state7 = this.state,
          changes = _this$state7.changes,
          id = _this$state7.id;

      var finalchanges = _objectSpread({}, changes, extrachanges);

      var save = function save(saveChanges) {
        if (id) {
          return _services.Orders.Patch(id, saveChanges).then(function (model) {
            _this8.setState(function () {
              return {
                changes: {},
                current: model
              };
            });

            if (_this8.props.onChanged) {
              _this8.props.onChanged(model);
            }
          });
        } else {
          return _services.Orders.Create(saveChanges).then(function (model) {
            _this8.setState(function () {
              return {
                changes: {},
                current: model,
                id: model.Id
              };
            });

            if (_this8.props.onChanged) {
              _this8.props.onChanged(model);
            }
          });
        }
      };

      return save(finalchanges);
    }
  }, {
    key: "_Delete",
    value: function _Delete() {
      var id = this.state.id;
      var _this$props4 = this.props,
          onDelete = _this$props4.onDelete,
          formatMessage = _this$props4.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_OrderDocumentsDialogMessages.default.deleteConfirm));

      if (id && isTodelete) {
        _services.Orders.Delete(id).then(onDelete);
      }
    }
  }, {
    key: "_getStock",
    value: function _getStock() {
      var authCtx = this.props.authCtx,
          order = this.state.current;

      var stockDone = function stockDone(item) {
        var Quantity = item.Quantity,
            SKU = item.SKU,
            DispatchInfos = item.DispatchInfos;
        var quantity = Quantity || 0;
        return !SKU || quantity === 0 || DispatchInfos && DispatchInfos.Quantity < quantity && DispatchInfos.Warehouse;
      };

      var warehouseId = authCtx.user.WarehouseId || '---';

      var getStock = function getStock(items) {
        if (!items) {
          return [];
        }

        return items.filter(function (item) {
          return !stockDone(item);
        }).reduce(function (result, item) {
          var subitems = getStock(item.Items);
          var Quantity = item.Quantity,
              DispatchInfos = item.DispatchInfos;
          var quantity = (Quantity || 0) - (DispatchInfos && DispatchInfos.Quantity || 0);

          if (quantity <= 0) {
            return [].concat(_toConsumableArray(result), _toConsumableArray(subitems));
          } else {
            return [].concat(_toConsumableArray(result), [{
              quantity: quantity,
              item: item,
              warehouseId: warehouseId
            }], _toConsumableArray(subitems));
          }
        }, []);
      };

      return getStock(order.Items);
    }
  }, {
    key: "_applyDispatch",
    value: function _applyDispatch(items, stocks) {
      var _this9 = this;

      return items.map(function (item) {
        var stock = stocks.find(function (s) {
          return s.item.UID === item.UID;
        });
        var Items = item.Items,
            DispatchInfos = item.DispatchInfos;

        if (stock) {
          DispatchInfos = _objectSpread({}, DispatchInfos, {
            Warehouse: stock.warehouseId || '',
            Quantity: (DispatchInfos && DispatchInfos.Quantity || 0) + (stock.quantity || 0),
            Date: new Date().toISOString()
          });
        } else if (!item.SKU && item.NeedsDispatch) {
          DispatchInfos = _objectSpread({}, DispatchInfos, {
            Warehouse: '',
            Quantity: item.Quantity || 0,
            Date: new Date().toISOString()
          });
        }

        return _objectSpread({}, item, {
          Items: Items && _this9._applyDispatch(item.Items, stocks),
          DispatchInfos: DispatchInfos
        });
      });
    }
  }, {
    key: "_applyUpdates",
    value: function _applyUpdates(dispatch, stock) {
      var _this10 = this;

      var _this$state$current = this.state.current,
          Dispatches = _this$state$current.Dispatches,
          Items = _this$state$current.Items;

      if (dispatch.Method) {
        localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".defaultMethod"), dispatch.Method);
      }

      if (dispatch.Status) {
        localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".defaultStatus"), dispatch.Status);
      }

      var uses = {};
      stock.forEach(function (s) {
        var SKU = s.item.SKU,
            warehouseId = s.warehouseId,
            quantity = s.quantity;

        if (!SKU || !warehouseId || warehouseId === '---') {
          return;
        }

        uses[SKU] = uses[SKU] || {};
        uses[SKU][warehouseId] = quantity;
      });
      var changes = {
        Dispatches: dispatch ? [].concat(_toConsumableArray(Dispatches), [dispatch]) : Dispatches,
        Items: this._applyDispatch(Items, stock)
      };
      return _services.StockUnits.Use(uses).then(function () {
        return _this10._Save(changes);
      }).then(function () {
        return _this10.setState(function () {
          return {
            dispatchOpened: false
          };
        });
      });
    }
  }]);

  return OrderDetail;
}(React.Component);

exports.OrderDetail = OrderDetail;
var _default = OrderDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PrintOrder = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _services = require("src/_services");

var _print = require("src/_helpers/print");

var _OrderDocumentsDialogMessages = _interopRequireDefault(require("./OrderDocumentsDialogMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PrintOrder = function PrintOrder(templateId, current) {
  _services.DocumentTemplates.Order(templateId, current.Id, current).then(function (res) {
    // var pop = window.open();
    // var template = Handlebars.compile(html);
    new _print.Printer({
      content: function content() {
        return React.createElement("div", {
          dangerouslySetInnerHTML: {
            __html: res.html
          }
        });
      },
      cssClasses: ['body--print-reciept'],
      cssStyles: res.styles,
      copyStyles: false
    }).Print();
  });
};

exports.PrintOrder = PrintOrder;

var OrderDocumentsDialog =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderDocumentsDialog, _React$Component);

  function OrderDocumentsDialog(props) {
    var _this;

    _classCallCheck(this, OrderDocumentsDialog);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderDocumentsDialog).call(this, props));
    _this.state = {};
    return _this;
  }

  _createClass(OrderDocumentsDialog, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          opened = _this$props.opened,
          templates = _this$props.templates,
          onClose = _this$props.onClose,
          formatMessage = _this$props.intl.formatMessage;
      var templateId = this.state.templateId;

      var change = function change(id) {
        return _this2.setState(function () {
          return {
            templateId: id
          };
        });
      };

      var print = function print() {
        return templateId ? _this2._Print(templateId) : void 0;
      };

      return React.createElement(_core.Dialog, {
        open: !!opened,
        onClose: onClose
      }, React.createElement(_core.DialogTitle, null, formatMessage(_OrderDocumentsDialogMessages.default.dialogTitle)), React.createElement(_core.DialogContent, null, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, formatMessage(_OrderDocumentsDialogMessages.default.inputLegend)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(e) {
          return change(e.target.value);
        },
        value: templateId || ''
      }, templates.map(function (t) {
        return React.createElement(_core.MenuItem, {
          key: t.Id,
          value: t.Id
        }, t.Title);
      })))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        size: "small",
        color: "primary",
        disabled: !templateId,
        variant: "contained",
        onClick: print
      }, formatMessage(_OrderDocumentsDialogMessages.default.actionPrint))));
    }
  }, {
    key: "_Print",
    value: function _Print(templateId) {
      var current = this.props.current;
      PrintOrder(templateId, current);
    }
  }]);

  return OrderDocumentsDialog;
}(React.Component);

var _default = OrderDocumentsDialog;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderDocumentsDialogMessages = void 0;

var _reactIntl = require("react-intl");

var OrderDocumentsDialogMessages = (0, _reactIntl.defineMessages)({
  actionPrint: {
    "id": "src.components.order.orderDetail.orderDocumentsDialog.actionPrint",
    "defaultMessage": "Print"
  },
  dialogTitle: {
    "id": "src.components.order.orderDetail.orderDocumentsDialog.dialogTitle",
    "defaultMessage": "Select template"
  },
  inputLegend: {
    "id": "src.components.order.orderDetail.orderDocumentsDialog.inputLegend",
    "defaultMessage": "Template"
  },
  deleteConfirm: {
    "id": "src.components.order.orderDetail.orderDocumentsDialog.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this order?"
  }
});
exports.OrderDocumentsDialogMessages = OrderDocumentsDialogMessages;
var _default = OrderDocumentsDialogMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactSelect = require("react-select");

var _styles = require("@material-ui/core/styles");

var _Typography = _interopRequireDefault(require("@material-ui/core/Typography"));

var _NoSsr = _interopRequireDefault(require("@material-ui/core/NoSsr"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Paper = _interopRequireDefault(require("@material-ui/core/Paper"));

var _MenuItem = _interopRequireDefault(require("@material-ui/core/MenuItem"));

var _services = require("src/_services");

var _Filter = require("src/_helpers/Filter");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var styles = function styles(theme) {
  return {
    root: {
      flexGrow: 1
    },
    input: {
      display: 'flex',
      padding: 0
    },
    valueContainer: {
      display: 'flex',
      flexWrap: 'wrap',
      flex: 1,
      alignItems: 'center',
      overflow: 'hidden'
    },
    noOptionsMessage: {
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px")
    },
    singleValue: {
      fontSize: 16
    },
    placeholder: {
      position: 'absolute',
      left: 2,
      fontSize: 16
    },
    paper: {
      position: 'absolute',
      zIndex: 1,
      marginTop: theme.spacing.unit,
      left: 0,
      right: 0
    },
    divider: {
      height: theme.spacing.unit * 2
    }
  };
};

var NoOptionsMessage = function NoOptionsMessage(props) {
  return React.createElement(_Typography.default, _extends({
    color: "textSecondary",
    className: props.selectProps.classes.noOptionsMessage
  }, props.innerProps), props.children);
};

var inputComponent = function inputComponent(props) {
  var inputRef = props.inputRef,
      rest = _objectWithoutProperties(props, ["inputRef"]);

  return React.createElement("div", _extends({
    ref: inputRef
  }, rest));
};

var Control = function Control(props) {
  return React.createElement(_TextField.default, _extends({
    fullWidth: true,
    InputProps: {
      inputComponent: inputComponent,
      inputProps: _objectSpread({
        className: props.selectProps.classes.input,
        inputRef: props.innerRef,
        children: props.children
      }, props.innerProps)
    }
  }, props.selectProps.textFieldProps));
};

var Option = function Option(props) {
  return React.createElement(_MenuItem.default, _extends({
    buttonRef: props.innerRef,
    selected: props.isFocused,
    disabled: props.isDisabled,
    component: "div",
    style: {
      fontWeight: props.isSelected ? 500 : 400
    }
  }, props.innerProps), props.children);
};

var Placeholder = function Placeholder(props) {
  return React.createElement(_Typography.default, _extends({
    color: "textSecondary",
    className: props.selectProps.classes.placeholder
  }, props.innerProps), props.children);
};

var SingleValue = function SingleValue(props) {
  return React.createElement(_Typography.default, _extends({
    className: props.selectProps.classes.singleValue
  }, props.innerProps), props.children);
};

var ValueContainer = function ValueContainer(props) {
  return React.createElement("div", {
    className: props.selectProps.classes.valueContainer
  }, props.children);
};

var Menu = function Menu(props) {
  return React.createElement(_Paper.default, _extends({
    square: true,
    className: props.selectProps.classes.paper
  }, props.innerProps), props.children);
};

var components = {
  Control: Control,
  Menu: Menu,
  NoOptionsMessage: NoOptionsMessage,
  Option: Option,
  Placeholder: Placeholder,
  SingleValue: SingleValue,
  ValueContainer: ValueContainer
};

var ClientSelect =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ClientSelect, _React$Component);

  function ClientSelect(props) {
    var _this;

    _classCallCheck(this, ClientSelect);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClientSelect).call(this, props));
    _this.state = {};
    return _this;
  }

  _createClass(ClientSelect, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this2 = this;

      var value = this.props.value;

      if (value) {
        _services.Clients.Get(value).then(function (client) {
          if (!_this2.state.current) {
            if (client === undefined) {
              return;
            }

            _this2.setState(function () {
              return {
                current: {
                  value: client.Id,
                  label: "".concat(client.FirstName, " ").concat(client.LastName),
                  client: client
                }
              };
            });
          }
        });
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      if (!prevState.current || prevState.current.value !== prevProps.value) {
        this._update();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$props = this.props,
          classes = _this$props.classes,
          theme = _this$props.theme,
          onChange = _this$props.onChange;
      var current = this.state.current;
      var selectStyles = {
        input: function input(base) {
          return _objectSpread({}, base, {
            color: theme.palette.text.primary,
            '& input': {
              font: 'inherit'
            }
          });
        }
      };

      var loadOptions = function loadOptions(inputValue) {
        return _services.Clients.Find({
          filters: [_Filter.Filter.Like('Firstname', inputValue), _Filter.Filter.Like('Lastname', inputValue), _Filter.Filter.Like('Phone', inputValue), _Filter.Filter.Like('Email', inputValue)],
          operator: 'or'
        }, 0, 1000).then(function (result) {
          return result.Values.map(function (client) {
            return {
              value: client.Id,
              label: "".concat(client.FirstName, " ").concat(client.LastName),
              client: client
            };
          });
        });
      };

      var AsyncSelectWCl = // tslint:disable-next-line:no-any
      _reactSelect.Async;

      var change = function change(opt) {
        _this3.setState(function () {
          return {
            current: opt
          };
        });

        onChange(opt && opt.client);
      };

      return React.createElement("div", {
        className: classes.root
      }, React.createElement(_NoSsr.default, null, React.createElement(AsyncSelectWCl, {
        isClearable: true,
        isSearchable: true,
        name: "color",
        classes: classes,
        noOptionsMessage: function noOptionsMessage() {
          return null;
        },
        styles: selectStyles,
        components: components,
        loadOptions: loadOptions,
        value: current // || value && { label: `loading client...`, value }
        ,
        onChange: change,
        placeholder: "Client..."
      })));
    }
  }, {
    key: "_update",
    value: function _update() {
      var _this4 = this;

      var value = this.props.value;

      if (value) {
        _services.Clients.Get(value).then(function (client) {
          if (!_this4.state.current) {
            if (client === undefined) {
              return;
            }

            _this4.setState(function () {
              return {
                current: {
                  value: client.Id,
                  label: "".concat(client.FirstName, " ").concat(client.LastName),
                  client: client
                }
              };
            });
          }
        });
      }
    }
  }]);

  return ClientSelect;
}(React.Component);

var _default = (0, _styles.withStyles)(styles, {
  withTheme: true
})(ClientSelect);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _OrderFieldsMessages = _interopRequireDefault(require("./OrderFieldsMessages"));

var _OrderItemList = _interopRequireDefault(require("../OrderItem/OrderItemList"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _List = _interopRequireDefault(require("../../Forms/Payment/List"));

var _services = require("../../../_services");

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _MenuItem = _interopRequireDefault(require("@material-ui/core/MenuItem"));

var _core = require("@material-ui/core");

var _DispatchList = _interopRequireDefault(require("../../Forms/Dispatch/DispatchList"));

var _ourOrders = require("src/@types/our-orders");

var _materialUiPickers = require("material-ui-pickers");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _OrderClientFields = _interopRequireDefault(require("../OrderClientFields/OrderClientFields"));

var _OrderShippingPersonFields = _interopRequireDefault(require("src/components/Orders/OrderShippingPersonFields/OrderShippingPersonFields"));

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var _ClientSelect = _interopRequireDefault(require("./ClientSelect"));

var _icons = require("@material-ui/icons");

var _CurrenciesField = _interopRequireDefault(require("src/components/CurrenciesField/CurrenciesField"));

var _ShopsField = _interopRequireDefault(require("src/components/ShopsField/ShopsField"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderFields, _React$Component);

  function OrderFields(props) {
    var _this;

    _classCallCheck(this, OrderFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderFields).call(this, props));
    _this._handleClientChange = _this._handleClientChange.bind(_assertThisInitialized(_this));
    _this._handleItemsChange = _this._handleItemsChange.bind(_assertThisInitialized(_this));
    _this._handleShippingPersonChange = _this._handleShippingPersonChange.bind(_assertThisInitialized(_this));
    _this._fetchShippings = _this._fetchShippings.bind(_assertThisInitialized(_this));
    _this._handleShippingsSelectChange = _this._handleShippingsSelectChange.bind(_assertThisInitialized(_this));
    _this.state = {
      shippingTemplates: []
    };
    return _this;
  }

  _createClass(OrderFields, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._fetchShippings();
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props,
          _this$props = this.props,
          current = _this$props.current,
          preventEditClient = _this$props.preventEditClient,
          onChange = _this$props.onChange,
          intl = _this$props.intl,
          formatMessage = _this$props.intl.formatMessage,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          settingsCtx = _this$props.settingsCtx,
          Currencies = _this$props.settingsCtx.Settings.Currencies,
          warehouseCtx = _this$props.warehouseCtx,
          shopCtx = _this$props.shopCtx,
          Users = _this$props.usersCtx.Users,
          user = _this$props.authCtx.user,
          authCtx = _this$props.authCtx,
          classes = _this$props.classes;
      var Status = current.Status,
          Items = current.Items,
          Note = current.Note,
          Canceled = current.Canceled,
          client = current.Client,
          date = current.Date,
          ClientId = current.ClientId,
          Currency = current.Currency,
          Paid = current.Paid,
          Reference = current.Reference,
          NeedsDispatch = current.NeedsDispatch,
          orderType = current.OrderType,
          UserId = current.UserId;
      var needsDispatchInfos = NeedsDispatch;
      var ownOrder = (current.UserId && current.UserId) === (user && user.Id);
      var hasRights = ownOrder && (0, _roles.IsAdminOrInRole)(user, 'CRUD_Own_Orders') || (0, _roles.IsAdminOrInRole)(user, 'CRUD_All_Orders');
      return React.createElement(_DetailGridContainer.default, null, React.createElement(_DetailGridColumn.default, null, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        select: true,
        label: formatMessage(_OrderFieldsMessages.default.orderType),
        fullWidth: true,
        value: orderType || '',
        className: Canceled ? classes.cancelled : '',
        disabled: !hasRights,
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (value) {
          var v = value.target.value;

          if (v === 'Cancelled') {
            onChange({
              Canceled: !Canceled
            });
          } else {
            onChange({
              OrderType: v
            });
          }
        })
      }, ['Cart', 'Order', 'Offer'].map(function (v) {
        return React.createElement(_MenuItem.default, {
          key: v,
          value: v
        }, formatMessage(_OrderFieldsMessages.default[v.toLowerCase()]));
      }), React.createElement(_MenuItem.default, {
        key: "Cancelled",
        value: "Cancelled"
      }, React.createElement("span", {
        className: classes.cancelledWrapper
      }, Canceled ? React.createElement(_icons.CheckBox, {
        className: classes.cancelledIcon
      }) : React.createElement(_icons.CheckBoxOutlineBlankOutlined, {
        className: classes.cancelledIcon
      }), formatMessage(_OrderFieldsMessages.default.canceled))))), React.createElement(_core.Grid, {
        item: true,
        xs: 5
      }, React.createElement(_TextField.default, {
        label: "".concat(orderType || 'Reference', " # (").concat(Status, ")"),
        fullWidth: true,
        className: "forms-fields__title-reference-field",
        onChange: function (_onChange2) {
          function onChange(_x2) {
            return _onChange2.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange2.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            Reference: e.target.value
          });
        }),
        value: Reference || '',
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: "date",
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: date && new Date(date),
        onChange: function (_onChange3) {
          function onChange(_x3) {
            return _onChange3.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange3.toString();
          };

          return onChange;
        }(function (value) {
          return onChange({
            Date: value
          });
        }),
        disableOpenOnEnter: true,
        animateYearScrolling: false,
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_CurrenciesField.default, {
        settingsCtx: settingsCtx,
        label: formatMessage(_OrderFieldsMessages.default.currency),
        fullWidth: true,
        value: current.Currency,
        onChange: function (_onChange4) {
          function onChange(_x4) {
            return _onChange4.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange4.toString();
          };

          return onChange;
        }(function (e) {
          onChange({
            Currency: e.target.value
          });
        }),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 5
      }, React.createElement(_ShopsField.default, {
        shopCtx: shopCtx,
        label: formatMessage(_OrderFieldsMessages.default.shop),
        fullWidth: true,
        value: current.ShopId || '',
        onChange: function (_onChange5) {
          function onChange(_x5) {
            return _onChange5.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange5.toString();
          };

          return onChange;
        }(function (e) {
          onChange({
            ShopId: e.target.value
          });
        }),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        select: true,
        label: formatMessage(_OrderFieldsMessages.default.user),
        fullWidth: true,
        value: UserId || '',
        disabled: !hasRights,
        onChange: function (_onChange6) {
          function onChange(_x6) {
            return _onChange6.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange6.toString();
          };

          return onChange;
        }(function (value) {
          onChange({
            UserId: value.target.value
          });
        })
      }, Users.map(function (u) {
        return React.createElement(_MenuItem.default, {
          key: u.Id,
          value: u.Id
        }, u.FirstName, " ", u.LastName);
      }))), hasRights && React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_ClientSelect.default, {
        onChange: function (_onChange7) {
          function onChange(_x7) {
            return _onChange7.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange7.toString();
          };

          return onChange;
        }(function (value) {
          return onChange({
            ClientId: value && value.Id || undefined,
            Client: value && confirm('update client infos ?') ? value : client
          });
        }),
        value: ClientId || ''
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_OrderClientFields.default, {
        preventEditClient: preventEditClient,
        current: {
          ClientId: current.ClientId,
          Client: current.Client
        },
        onChange: this._handleClientChange,
        intl: intl,
        authCtx: authCtx
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        style: {
          marginTop: '4rem'
        }
      }, React.createElement(_OrderItemList.default, _extends({
        productCtx: productCtx,
        categoryCtx: categoryCtx,
        settingsCtx: settingsCtx,
        intl: intl,
        warehouseCtx: warehouseCtx,
        currency: Currency || Currencies[0] && Currencies[0].Code || 'EUR',
        orderPaid: Paid
      }, {
        list: Items || [],
        preview: current.Items,
        onChange: this._handleItemsChange,
        hasRights: !!hasRights
      }))))), React.createElement(_DetailGridColumn.default, null, React.createElement(_GridContainer.GridContainer, {
        justify: "center"
      }, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, this._renderAmounts()), hasRights && NeedsDispatch && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, this._renderShippingsDropdown()), needsDispatchInfos && React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_OrderShippingPersonFields.default, {
        intl: intl,
        initial: current.ShippingPerson,
        changes: {},
        onChange: this._handleShippingPersonChange,
        current: current,
        hasRights: !hasRights
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        style: {
          marginTop: '4rem'
        }
      }, React.createElement(_List.default, _extends({
        settingsCtx: settingsCtx
      }, {
        Currency: current.Currency,
        PaidAmount: current.PaidAmount,
        Total: current.Total,
        list: current.Payments,
        preview: current.Payments,
        onChange: function (_onChange8) {
          function onChange(_x8) {
            return _onChange8.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange8.toString();
          };

          return onChange;
        }(function (value) {
          return onChange({
            Payments: value
          });
        }),
        hasRights: !!hasRights
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        style: {
          marginTop: '4rem'
        }
      }, React.createElement(_DispatchList.default, {
        intl: intl,
        order: current,
        list: current.Dispatches || [],
        preview: current.Dispatches || [],
        onChange: function (_onChange9) {
          function onChange(_x9) {
            return _onChange9.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange9.toString();
          };

          return onChange;
        }(function (d) {
          return onChange({
            Dispatches: d
          });
        }),
        hasRights: !!hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        style: {
          marginTop: '4rem'
        }
      }, React.createElement(_TextField.default, {
        label: formatMessage(_OrderFieldsMessages.default.note),
        multiline: true,
        fullWidth: true,
        onChange: function onChange(e) {
          return props.onChange({
            Note: e.target.value
          });
        },
        value: Note,
        disabled: !hasRights
      })))));
    }
  }, {
    key: "_renderShippingsDropdown",
    value: function _renderShippingsDropdown() {
      var _this$props2 = this.props,
          current = _this$props2.current,
          intl = _this$props2.intl,
          shippingTemplates = this.state.shippingTemplates;
      var ShippingTemplateId = current.ShippingTemplateId;
      return React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "shipping_options"
      }, intl.formatMessage(_OrderFieldsMessages.default.shippingOptions)), React.createElement(_core.Select, {
        fullWidth: true,
        value: ShippingTemplateId || '',
        onChange: this._handleShippingsSelectChange,
        inputProps: {
          name: 'shipping_options',
          id: 'shipping_options'
        }
      }, shippingTemplates.map(function (shippingTemplate) {
        return React.createElement(_MenuItem.default, {
          key: shippingTemplate.Id,
          value: shippingTemplate.Id
        }, shippingTemplate.Title);
      })));
    }
  }, {
    key: "_handleShippingsSelectChange",
    value: function _handleShippingsSelectChange(e) {
      var value = e.target.value;

      if (!value) {
        return;
      }

      var shipping = this.state.shippingTemplates.find(function (s) {
        return s.Id === value;
      });

      if (!shipping) {
        return;
      }

      this.props.onChange({
        ShippingTemplateId: shipping.Id,
        ShippingTemplateName: shipping.Title
      });
    }
  }, {
    key: "_fetchShippings",
    value: function _fetchShippings() {
      var _this2 = this;

      return _services.Orders.Shippings(this.props.current, 0, 100).then(function (json) {
        var templates = json.Values;

        _this2.setState(function () {
          return {
            shippingTemplates: templates
          };
        });

        return templates;
      });
    }
  }, {
    key: "_renderAmounts",
    value: function _renderAmounts() {
      var _this$props$current = this.props.current,
          Total = _this$props$current.Total,
          Tax = _this$props$current.Tax,
          Delivery = _this$props$current.Delivery,
          Currency = _this$props$current.Currency,
          PaidAmount = _this$props$current.PaidAmount;
      var lines = [{
        legend: React.createElement("span", {
          className: "forms__order-amount-text  forms__order-amount-text--total"
        }, React.createElement(_reactIntl.FormattedMessage, {
          id: "src.components.forms.order.fields.totalAmount",
          defaultMessage: "Total"
        })),
        value: React.createElement("span", {
          className: "forms__order-amount-text forms__order-amount-text--total"
        }, Currency ? React.createElement(_reactIntl.FormattedNumber, {
          value: Total || 0,
          style: "currency",
          currency: Currency
        }) : Total)
      }];

      if (Tax) {
        lines.push({
          legend: React.createElement("span", {
            className: "forms__order-amount-text"
          }, React.createElement(_reactIntl.FormattedMessage, {
            id: "src.components.forms.order.fields.tax",
            defaultMessage: "Incl. Tax"
          })),
          value: React.createElement("span", {
            className: "forms__order-amount-text"
          }, Currency ? React.createElement(_reactIntl.FormattedNumber, {
            value: Tax,
            style: "currency",
            currency: Currency
          }) : Tax)
        });
      }

      if (Delivery && Delivery.Final) {
        lines.push({
          legend: React.createElement("span", {
            className: "forms__order-amount-text"
          }, React.createElement(_reactIntl.FormattedMessage, {
            id: "src.components.forms.order.fields.shipping",
            defaultMessage: "Incl. Shipping"
          })),
          value: React.createElement("span", {
            className: "forms__order-amount-text"
          }, Currency ? React.createElement(_reactIntl.FormattedNumber, {
            value: Delivery.Final,
            style: "currency",
            currency: Currency
          }) : Delivery.Final)
        });
      } // if (discount) {
      //     lines.push({
      //         legend: (
      //             <span className="forms__order-amount-text">
      //                 <FormattedMessage
      //                     id="src.components.forms.order.fields.discount"
      //                     defaultMessage="Incl. Discount"
      //                     description="Legend for the Discount amount of the order"
      //                 />
      //             </span>
      //         ),
      //         value: (
      //             <span className="order-items-fields__final-price">
      //                 <FormattedNumber
      //                     value={discount || 0}
      //                     style="currency"
      //                     currency={preview.Currency}
      //                 />
      //             </span>)
      //     });
      // }
      // if (extra) {
      //     lines.push({
      //         legend: (
      //             <span className="forms__order-amount-text">
      //                 <FormattedMessage
      //                     id="src.components.forms.order.fields.extra"
      //                     defaultMessage="Extra"
      //                     description="Legend for the Extra amount of the order"
      //                 />
      //             </span>
      //         ),
      //         value: (
      //             <span className="forms__order-amount-text">
      //                 <FormattedNumber
      //                     value={extra || 0}
      //                     style="currency"
      //                     currency={preview.Currency}
      //                 />
      //             </span>)
      //     });
      // }


      if (PaidAmount) {
        lines.push({
          legend: React.createElement("span", {
            className: "forms__order-amount-text forms__order-amount-text--paied-amount"
          }, React.createElement(_reactIntl.FormattedMessage, _OrderFieldsMessages.default.paidAmount)),
          value: React.createElement("span", {
            className: "forms__order-amount-text forms__order-amount-text--paied-amount"
          }, Currency ? React.createElement(_reactIntl.FormattedNumber, {
            value: PaidAmount,
            style: "currency",
            currency: Currency
          }) : PaidAmount)
        });
      }

      var firstpreview = lines.filter(function (v, i) {
        return i < 3;
      });
      var secondpreview = lines.filter(function (v, i) {
        return i >= 3;
      });
      return React.createElement("div", {
        className: "forms__order-amount"
      }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Lines, null, firstpreview.map(function (l, i) {
        return React.createElement(_ItemPreview.Line, {
          key: i
        }, l.legend);
      })), React.createElement(_ItemPreview.Lines, {
        actions: true
      }, firstpreview.map(function (l, i) {
        return React.createElement(_ItemPreview.Line, {
          key: i
        }, l.value);
      }))), secondpreview.length > 0 && React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, null), React.createElement(_ItemPreview.Lines, null, [0, 1, 2].map(function (i) {
        return secondpreview[i] ? React.createElement(_ItemPreview.Line, {
          key: i
        }, secondpreview[i].legend) : React.createElement(_ItemPreview.Line, {
          key: i
        });
      })), React.createElement(_ItemPreview.Lines, {
        actions: true
      }, [0, 1, 2].map(function (i) {
        return secondpreview[i] ? React.createElement(_ItemPreview.Line, {
          key: i
        }, secondpreview[i].value) : React.createElement(_ItemPreview.Line, {
          key: i
        });
      }))));
    }
  }, {
    key: "_handleClientChange",
    value: function _handleClientChange(changes) {
      var _this$props3 = this.props,
          client = _this$props3.current.Client,
          onChange = _this$props3.onChange;

      var finalClient = _objectSpread({}, client, changes.Client);

      var chg = {};

      if (changes.ClientId !== undefined) {
        chg.ClientId = changes.ClientId;
      }

      chg.Client = finalClient;
      onChange(chg);
    }
  }, {
    key: "_handleShippingPersonChange",
    value: function _handleShippingPersonChange(changes) {
      var _this$props4 = this.props,
          shippingPerson = _this$props4.current.ShippingPerson,
          onChange = _this$props4.onChange;
      onChange({
        ShippingPerson: _objectSpread({}, shippingPerson, changes)
      });
    }
  }, {
    key: "_handleItemsChange",
    value: function _handleItemsChange(newItems) {
      var onChange = this.props.onChange;
      onChange({
        Items: newItems
      });
    }
  }]);

  return OrderFields;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    cancelled: {
      color: theme.palette.grey[500]
    },
    cancelledWrapper: {
      display: 'flex',
      alignItems: 'center'
    },
    cancelledIcon: {
      marginRight: 5,
      fontSize: 20
    }
  };
})((0, _reactIntl.injectIntl)(OrderFields)); // Client shipping information
// {needsDispatchInfos &&
//     <Grid item={true} xs={12}>
//         <OrderShippingPersonFields
//             intl={intl}
//             initial={current.ShippingPerson}
//             changes={{}}
//             onChange={this._handleShippingPersonChange}
//             current={current}
//         />
//     </Grid>}


exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderFieldsMessages = void 0;

var _reactIntl = require("react-intl");

var OrderFieldsMessages = (0, _reactIntl.defineMessages)({
  orderType: {
    "id": "src.components.forms.order.orderType",
    "defaultMessage": "Type"
  },
  user: {
    "id": "src.components.forms.order.user",
    "defaultMessage": "user"
  },
  updateCLient: {
    "id": "src.components.forms.order.updateCLient",
    "defaultMessage": "Update client"
  },
  createCLient: {
    "id": "src.components.forms.order.createCLient",
    "defaultMessage": "Create client"
  },
  ShipToClient: {
    "id": "src.components.forms.order.ShipToClient",
    "defaultMessage": "Devilery Client Address"
  },
  items: {
    "id": "src.components.forms.order.items",
    "defaultMessage": "Items"
  },
  discounts: {
    "id": "src.components.forms.order.discounts",
    "defaultMessage": "Discounts"
  },
  dispatches: {
    "id": "src.components.forms.order.dispatches",
    "defaultMessage": "Dispatches"
  },
  cost: {
    "id": "src.components.forms.order.cost",
    "defaultMessage": "Cost"
  },
  paymentList: {
    "id": "src.components.forms.order.paymentList",
    "defaultMessage": "Payments"
  },
  shippingTitle: {
    "id": "src.components.forms.order.shippingTitle",
    "defaultMessage": "Shipping"
  },
  shipmentInfos: {
    "id": "src.components.forms.order.shipmentInfos",
    "defaultMessage": "Shipment Infos"
  },
  shop: {
    "id": "src.components.forms.order.shop",
    "defaultMessage": "Shop"
  },
  currency: {
    "id": "src.components.forms.order.currency",
    "defaultMessage": "Currency"
  },
  note: {
    "id": "src.components.forms.order.note",
    "defaultMessage": "Note"
  },
  pay: {
    "id": "src.components.forms.order.pay",
    "defaultMessage": "Pay with"
  },
  canceled: {
    "id": "src.components.forms.order.canceled",
    "defaultMessage": "cancelled"
  },
  shippingOptions: {
    "id": "src.components.forms.order.shippingOptions",
    "defaultMessage": "Shipping Options"
  },
  paidAmount: {
    "id": "src.components.forms.order.paidAmount",
    "defaultMessage": "Paid amount"
  },
  cart: {
    "id": "src.components.forms.order.cart",
    "defaultMessage": "cart"
  },
  order: {
    "id": "src.components.forms.order.order",
    "defaultMessage": "order"
  },
  offer: {
    "id": "src.components.forms.order.offer",
    "defaultMessage": "offer"
  }
});
exports.OrderFieldsMessages = OrderFieldsMessages;
var _default = OrderFieldsMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OrderIconStyles = void 0;

var OrderIconStyles = function OrderIconStyles(theme) {
  return {
    Empty: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Cancelled: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    PendingPayment: {
      color: theme.Colors.orange.primary.contrastText,
      backgroundColor: theme.Colors.orange.primary.main
    },
    ToDispatch: {
      color: theme.Colors.blue.primary.contrastText,
      backgroundColor: theme.Colors.blue.primary.main
    },
    Dispatching: {
      color: theme.Colors.green.primary.contrastText,
      backgroundColor: theme.Colors.green.primary.light
    },
    Done: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Offer: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Cart: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    }
  };
};

exports.OrderIconStyles = OrderIconStyles;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _core = require("@material-ui/core");

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _OrderItemFieldsMessages = require("./OrderItemFieldsMessages");

var _materialUiPickers = require("material-ui-pickers");

var _icons = require("@material-ui/icons");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderItemFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderItemFields, _React$Component);

  function OrderItemFields(props) {
    var _this;

    _classCallCheck(this, OrderItemFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderItemFields).call(this, props));
    _this.state = {
      open: false
    };
    return _this;
  }

  _createClass(OrderItemFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var initial = this.props.initial || {};
      var changes = this.props.changes || {};
      var preview = this.props.preview || {};
      var _this$props = this.props,
          intl = _this$props.intl,
          warehouseCtx = _this$props.warehouseCtx,
          orderPaid = _this$props.orderPaid,
          currency = _this$props.currency,
          classes = _this$props.classes,
          formatMessage = _this$props.intl.formatMessage,
          onRequestAddSubItem = _this$props.onRequestAddSubItem,
          leaf = _this$props.leaf,
          hasRights = _this$props.hasRights,
          _this$props$settingsC = _this$props.settingsCtx.Settings,
          ShowTaxRateExcluded = _this$props$settingsC.ShowTaxRateExcluded,
          ShowTaxRateIncluded = _this$props$settingsC.ShowTaxRateIncluded;
      var open = this.state.open;

      var current = _objectSpread({}, initial, preview, changes);

      var currentOption = current.Option || {};
      var FinalPrice = preview.FinalPrice;
      var UID = current.UID,
          SKU = current.SKU,
          Title = current.Title,
          Src = current.Src,
          Description = current.Description,
          Quantity = current.Quantity,
          NeedsDispatch = current.NeedsDispatch,
          DispatchInfos = current.DispatchInfos;
      var empty = !(SKU || Title || Description);
      var isItemDispatched = DispatchInfos && (Quantity || 0) <= DispatchInfos.Quantity;
      var actionAddSubitem = React.createElement(_ItemPreview.Line, null, hasRights && !leaf && React.createElement(_core.Button, {
        color: "default",
        "aria-label": formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.addSubitem),
        onClick: onRequestAddSubItem,
        size: "small",
        className: classes.addSubItemBtn
      }, React.createElement(_icons.SubdirectoryArrowRight, {
        className: classNames(classes.svgIconSubItem)
      }), formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.addSubitem)));
      var actionAdd = hasRights ? React.createElement(_ItemPreview.Line, null, React.createElement(_core.IconButton, {
        color: "default",
        "aria-label": "Add one",
        onClick: function onClick() {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Quantity: (Quantity || 0) + 1
          }));
        }
      }, React.createElement(_icons.ArrowDropUp, {
        className: classes.svgIcon
      }))) : React.createElement(_ItemPreview.Line, null);
      var actionRemove = hasRights ? React.createElement(_ItemPreview.Line, null, React.createElement(_core.IconButton, {
        color: "default",
        "aria-label": "Remove one",
        onClick: function onClick() {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Quantity: Math.max(0, (Quantity || 0) - 1)
          }));
        }
      }, React.createElement(_icons.ArrowDropDown, {
        className: classes.svgIcon
      }))) : React.createElement(_ItemPreview.Line, null);
      var actionDelete = hasRights ? React.createElement(_ItemPreview.Line, null, React.createElement(_core.IconButton, {
        color: "default",
        "aria-label": "Delete",
        onClick: function onClick() {
          return _this2.props.onRequestRemove();
        }
      }, React.createElement(_icons.Close, {
        className: classNames(classes.svgIcon, classes.svgIconRemove)
      }))) : React.createElement(_ItemPreview.Line, null);

      var toggle = function toggle() {
        return _this2.setState(function (prev) {
          return {
            open: !prev.open
          };
        });
      };

      var close = function close() {
        return _this2.setState(function () {
          return {
            open: false
          };
        });
      }; // const dispatchIcon =
      //     Paid && NeedsDispatch && !isItemDispatched ?
      //         <Avatar><HowToVote /></Avatar> : Src ? <Thumb src={Src} /> : null;


      var titleLine = React.createElement(_ItemPreview.Line, {
        onClick: toggle,
        isTitle: true
      }, Title && React.createElement("span", {
        className: classes.title
      }, Title));
      var previewLine = empty ? React.createElement(_ItemPreview.default, {
        active: open
      }, React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        empty: true,
        onClick: toggle
      }, formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.empty)), actionAddSubitem), React.createElement(_ItemPreview.Lines, {
        actions: true,
        onClick: toggle
      }, React.createElement(_ItemPreview.Line, null), React.createElement(_ItemPreview.Line, null), React.createElement(_ItemPreview.Line, null, actionDelete))) : React.createElement(_ItemPreview.default, {
        active: open
      }, orderPaid && NeedsDispatch && !isItemDispatched && React.createElement(_core.Avatar, null, React.createElement(_icons.HowToVote, null)), orderPaid && NeedsDispatch && isItemDispatched && React.createElement(_core.Avatar, null, React.createElement(_icons.LocalShipping, null)), orderPaid && !NeedsDispatch && Src ? React.createElement(_ItemPreview.Thumb, {
        src: Src
      }) : null, React.createElement(_ItemPreview.Lines, {
        className: classes.quantityActions
      }, React.createElement(_ItemPreview.Line, {
        className: classes.quantityLine
      }, actionAdd, React.createElement("span", {
        className: classes.quantity
      }, " ", Quantity || 0), actionRemove)), React.createElement(_ItemPreview.Lines, null, current.Option ? titleLine : React.createElement(_ItemPreview.Line, null), current.Option ? React.createElement(_ItemPreview.Line, null, React.createElement("span", null, "".concat(current.Option.Title || '', " "), "".concat(current.Option.Value || '', " "))) : titleLine, actionAddSubitem), React.createElement(_ItemPreview.Lines, {
        actions: true,
        onClick: toggle
      }, React.createElement(_ItemPreview.Line, null, FinalPrice && React.createElement("span", {
        className: classes.finalPrice
      }, React.createElement(_reactIntl.FormattedNumber, {
        value: FinalPrice,
        style: "currency",
        currency: currency
      }))), React.createElement(_ItemPreview.Line, null, actionDelete)));
      return React.createElement(React.Fragment, null, React.createElement("div", null, previewLine), React.createElement(_SideDialog.default, {
        open: open,
        onClose: close
      }, React.createElement(_core.DialogContent, null, React.createElement(_GridContainer.GridContainer, {
        spacing: 8
      }, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, React.createElement(_GridContainer.GridContainer, {
        spacing: 8
      }, React.createElement(_core.Grid, {
        item: true,
        xs: 9
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.title),
        value: Title,
        fullWidth: true,
        onChange: function onChange(e) {
          _this2.props.onChange(_objectSpread({}, changes, {
            Title: e.target.value
          }));
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.sku),
        value: SKU,
        fullWidth: true,
        onChange: function onChange(e) {
          _this2.props.onChange(_objectSpread({}, changes, {
            SKU: e.target.value
          }));
        },
        disabled: !hasRights
      }))))))), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.basePrice),
        value: current.Price && current.Price.Base || 0,
        inputProps: {
          step: '0.01'
        },
        type: "number",
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var Base = val === '' ? 0 : parseFloat(val);

          _this2._changeAmount({
            Base: Base
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, ShowTaxRateIncluded && React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.includedTaxRate),
        value: current.Price && current.Price.TaxRateIncluded || 0,
        type: "number",
        inputProps: {
          step: '0.01'
        },
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var TaxRateIncluded = val === '' ? 0 : parseFloat(val);

          _this2._changeAmount({
            TaxRateIncluded: TaxRateIncluded
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, ShowTaxRateExcluded && React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.excludedTaxRate),
        value: current.Price && current.Price.TaxRateExcluded || 0,
        type: "number",
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var TaxRateExcluded = val === '' ? 0 : parseFloat(val);

          _this2._changeAmount({
            TaxRateExcluded: TaxRateExcluded
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        multiline: true,
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            Description: value.target.value
          }));
        },
        value: Description,
        label: this.props.intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.description),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 2
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.OptionId),
        value: currentOption.OptionId || '',
        fullWidth: true,
        onChange: function onChange(e) {
          _this2._changeOption(currentOption, {
            OptionId: e.target.value
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.optionsTitle),
        value: currentOption.Title || '',
        fullWidth: true,
        onChange: function onChange(e) {
          _this2._changeOption(currentOption, {
            Title: e.target.value
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.optionsValue),
        value: currentOption.Value || '',
        inputProps: {
          step: '0.01'
        },
        fullWidth: true,
        onChange: function onChange(e) {
          _this2._changeOption(currentOption, {
            Value: e.target.value
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.optionsExtraPrice),
        value: currentOption.ExtraPrice || 0,
        type: "number",
        inputProps: {
          step: '0.01'
        },
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var ExtraPrice = val === '' ? 0 : parseFloat(val);

          _this2._changeOption(currentOption, {
            ExtraPrice: ExtraPrice
          });
        },
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!NeedsDispatch,
          onChange: function onChange(e) {
            return _this2.props.onChange(_objectSpread({}, changes, {
              NeedsDispatch: e.target.checked
            }));
          },
          color: "primary",
          disabled: !hasRights
        }),
        label: intl.formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.needsDispatch)
      })), UID && React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!DispatchInfos,
          onChange: function onChange(e) {
            return _this2.props.onChange(_objectSpread({}, changes, {
              DispatchInfos: e.target.checked ? current.DispatchInfos || {
                Warehouse: warehouseCtx.Warehouses[0].Id,
                Date: new Date().toISOString(),
                Quantity: current.Quantity || 0
              } : undefined
            }));
          },
          color: "primary",
          disabled: !hasRights
        }),
        label: formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.dispatched)
      })), UID && DispatchInfos && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "shipping_options"
      }, formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.dispatchWareHouse)), React.createElement(_core.Select, {
        fullWidth: true,
        value: DispatchInfos.Warehouse || '',
        onChange: function onChange(value) {
          return _this2.props.onChange(_objectSpread({}, changes, {
            DispatchInfos: _objectSpread({}, DispatchInfos, {
              Warehouse: value.target.value
            })
          }));
        },
        inputProps: {
          name: 'shipping_options',
          id: 'shipping_options'
        },
        disabled: !hasRights
      }, warehouseCtx.Warehouses.map(function (w) {
        return React.createElement(_core.MenuItem, {
          key: w.Id,
          value: w.Id
        }, w.Name);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: "Dispatch date",
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: DispatchInfos.Date && new Date(DispatchInfos.Date) || new Date(),
        onChange: function onChange(value) {
          _this2.props.onChange(_objectSpread({}, changes, {
            DispatchInfos: _objectSpread({}, DispatchInfos, {
              Date: value
            })
          }));
        },
        disabled: !hasRights,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        value: DispatchInfos.Quantity || 0,
        fullWidth: true,
        label: formatMessage(_OrderItemFieldsMessages.OrderItemFieldsMessages.dispatchQuantity),
        type: "number",
        onChange: function onChange(e) {
          var val = e.target.value;
          var q = val === '' ? 0 : parseInt(val, 10);

          _this2.props.onChange(_objectSpread({}, changes, {
            DispatchInfos: _objectSpread({}, DispatchInfos, {
              Quantity: q
            })
          }));
        },
        disabled: !hasRights
      }))))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        size: "small",
        color: "default",
        variant: "contained",
        onClick: close
      }, React.createElement(_reactIntl.FormattedMessage, _OrderItemFieldsMessages.OrderItemFieldsMessages.close)))));
    }
  }, {
    key: "_changeOption",
    value: function _changeOption(currentOption, change) {
      this.props.onChange(_objectSpread({}, this.props.changes, {
        Option: _objectSpread({}, currentOption, change)
      }));
    }
  }, {
    key: "_changeAmount",
    value: function _changeAmount(amount) {
      var initial = this.props.initial || {};
      var changes = this.props.changes || {};

      var current = _objectSpread({}, initial, changes);

      var price = current.Price || {
        Base: 0,
        Extra: 0,
        TaxRateExcluded: 0,
        TaxRateIncluded: 0,
        Tax: 0,
        Final: 0
      };
      this.props.onChange(_objectSpread({}, changes, {
        Price: _objectSpread({}, price, amount)
      }));
    }
  }]);

  return OrderItemFields;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    title: {
      color: theme.Colors.white.primary.dark
    },
    quantity: {
      display: 'block',
      minWidth: '1rem',
      fontVariant: 'tabular-nums',
      fontWeight: 'bold',
      color: theme.Colors.white.primary.dark
    },
    quantityActions: {
      flexGrow: 0,
      flexShrink: 0,
      textAlign: 'center',
      overflow: 'visible',
      marginRight: '1rem'
    },
    quantityLine: {
      position: 'relative',
      textAlign: 'center',
      overflow: 'visible'
    },
    addSubItemBtn: {
      fontSize: '0.7rem',
      textTransform: 'none',
      padding: '2px'
    },
    svgIcon: {
      position: 'absolute',
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)'
    },
    svgIconRemove: {
      fontSize: '1rem'
    },
    svgIconSubItem: {
      fontSize: '1rem'
    },
    finalPrice: {
      color: 'black',
      fontVariant: 'tabular-nums'
    }
  };
})(OrderItemFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OrderItemFieldsMessages = void 0;

var _reactIntl = require("react-intl");

var OrderItemFieldsMessages = (0, _reactIntl.defineMessages)({
  empty: {
    "id": "src.components.forms.orderitem.empty",
    "defaultMessage": "(no information)"
  },
  title: {
    "id": "src.components.forms.orderitem.title",
    "defaultMessage": "Title"
  },
  sku: {
    "id": "src.components.forms.orderitem.sku",
    "defaultMessage": "SKU"
  },
  description: {
    "id": "src.components.forms.orderitem.description",
    "defaultMessage": "Description"
  },
  basePrice: {
    "id": "src.components.forms.orderitem.basePrice",
    "defaultMessage": "Base Price"
  },
  extraPrice: {
    "id": "src.components.forms.orderitem.extraPrice",
    "defaultMessage": "Extra Price"
  },
  includedTaxRate: {
    "id": "src.components.forms.orderitem.includedTaxRate",
    "defaultMessage": "included Tax Rate"
  },
  excludedTaxRate: {
    "id": "src.components.forms.orderitem.excludedTaxRate",
    "defaultMessage": "excluded Tax Rate"
  },
  quantity: {
    "id": "src.components.forms.orderitem.quantity",
    "defaultMessage": "Quantity"
  },
  needsDispatch: {
    "id": "src.components.forms.orderitem.needsDispatch",
    "defaultMessage": "Needs Delivery"
  },
  dispatched: {
    "id": "src.components.forms.orderitem.dispatched",
    "defaultMessage": "Dispatched"
  },
  addSubitem: {
    "id": "src.components.forms.orderitem.addSubitem",
    "defaultMessage": "add sub-item"
  },
  lightboxTitle: {
    "id": "src.components.forms.orderitem.lightboxTitle",
    "defaultMessage": "Order item: {Title}"
  },
  lightboxTitleLeaf: {
    "id": "src.components.forms.orderitem.lightboxTitleLeaf",
    "defaultMessage": "Order sub-item: {Title}"
  },
  searchPlaceholder: {
    "id": "src.components.forms.orderitem.searchPlaceholder",
    "defaultMessage": "Choose existing Product"
  },
  newProduct: {
    "id": "src.components.forms.orderitem.newProduct",
    "defaultMessage": "Empty product"
  },
  optionsExtraPrice: {
    "id": "src.components.forms.orderitem.optionsPrice",
    "defaultMessage": "Option price"
  },
  optionsTitle: {
    "id": "src.components.forms.orderitem.optionsTitle",
    "defaultMessage": "Option Title"
  },
  OptionId: {
    "id": "src.components.forms.orderitem.OptionId",
    "defaultMessage": "Id"
  },
  close: {
    "id": "src.components.forms.orderitem.close",
    "defaultMessage": "Close"
  },
  optionsValue: {
    "id": "src.components.forms.orderitem.optionsValue",
    "defaultMessage": "Option Value"
  },
  lightboxSubItemOptionsTitle: {
    "id": "src.components.forms.orderitem.lightboxSubItemOptionsTitle",
    "defaultMessage": "Options:"
  },
  optionsAddOption: {
    "id": "src.components.forms.orderitem.optionsAddOption",
    "defaultMessage": "add option"
  },
  dispatchWareHouse: {
    "id": "src.components.forms.orderitem.dispatchWareHouse",
    "defaultMessage": "dispatch WareHouse"
  },
  dispatchDate: {
    "id": "src.components.forms.orderitem.dispatchDate",
    "defaultMessage": "dispatch Date"
  },
  dispatchQuantity: {
    "id": "src.components.forms.orderitem.dispatchQuantity",
    "defaultMessage": "dispatch Quantity"
  }
});
exports.OrderItemFieldsMessages = OrderItemFieldsMessages;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderItemListMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var _shortid = require("shortid");

var _OrderItemFields = _interopRequireDefault(require("./OrderItemFields"));

var _reactSortableHoc = require("react-sortable-hoc");

var _reactIntl = require("react-intl");

var _OrderProductSelector = _interopRequireDefault(require("./OrderProductSelector"));

var _PlaylistAdd = _interopRequireDefault(require("@material-ui/icons/PlaylistAdd"));

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _SortableListItem = require("src/_helpers/SortableListItem/SortableListItem");

var _services = require("src/_services");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderItemListMessages = (0, _reactIntl.defineMessages)({
  addItem: {
    "id": "src.components.forms.orderitem.list.addItem",
    "defaultMessage": "Add item"
  },
  newProduct: {
    "id": "src.components.forms.orderitem.list.newProduct",
    "defaultMessage": "Add product"
  }
});
exports.OrderItemListMessages = OrderItemListMessages;

var OrderItemList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderItemList, _React$Component);

  function OrderItemList(props) {
    var _this;

    _classCallCheck(this, OrderItemList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderItemList).call(this, props));
    _this._addEmpty = _this._addEmpty.bind(_assertThisInitialized(_this));
    _this._handleMoveItem = _this._handleMoveItem.bind(_assertThisInitialized(_this));
    _this.state = {
      selectorOpened: false
    };
    return _this;
  }

  _createClass(OrderItemList, [{
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      if (nextProps.orderPaid !== this.props.orderPaid) {
        return true;
      }

      if (nextProps.currency !== this.props.currency) {
        return true;
      }

      if (nextProps.leaf !== this.props.leaf) {
        return true;
      }

      if (nextProps.onChange !== this.props.onChange) {
        return true;
      }

      if (JSON.stringify(nextProps.list) !== JSON.stringify(this.props.list)) {
        return true;
      }

      if (JSON.stringify(nextProps.preview) !== JSON.stringify(this.props.preview)) {
        return true;
      }

      if (JSON.stringify(nextState) !== JSON.stringify(this.state)) {
        return true;
      }

      return false;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          intl = _this$props.intl,
          productCtx = _this$props.productCtx,
          categoryCtx = _this$props.categoryCtx,
          orderPaid = _this$props.orderPaid,
          currency = _this$props.currency,
          leaf = _this$props.leaf,
          hasRights = _this$props.hasRights,
          classes = _this$props.classes;
      var items = this.props.list || [];
      var preview = this.props.preview || [];
      return React.createElement(React.Fragment, null, React.createElement(_SortableListItem.SortableListItemsContainer, {
        onSortEnd: this._handleMoveItem,
        pressDelay: 200
      }, items.map(function (item, index) {
        var itemPreview = preview.find(function (i) {
          return i.UID === item.UID;
        }) || item;
        return React.createElement(_SortableListItem.SortableListItem, {
          key: item.UID,
          index: index
        }, React.createElement(_OrderItemFields.default, _extends({
          intl: intl,
          warehouseCtx: warehouseCtx,
          settingsCtx: settingsCtx,
          orderPaid: orderPaid,
          currency: currency
        }, {
          initial: item,
          changes: item,
          preview: itemPreview,
          onChange: function onChange(i) {
            return _this2._handleItemChange(item.UID, i);
          },
          onRequestRemove: function onRequestRemove() {
            return _this2._handleRemoveItem(item.UID);
          },
          onRequestAddSubItem: function onRequestAddSubItem() {
            return _this2._handleAddSubItem(item.UID);
          },
          leaf: !!leaf,
          hasRights: hasRights
        })), !_this2.props.leaf && item.Items && item.Items.length !== 0 && React.createElement("div", {
          className: classes.subItemsList
        }, React.createElement(OrderItemList, _extends({
          intl: intl,
          warehouseCtx: warehouseCtx,
          settingsCtx: settingsCtx,
          hasRights: hasRights,
          productCtx: productCtx,
          categoryCtx: categoryCtx,
          orderPaid: orderPaid,
          currency: currency,
          classes: classes
        }, {
          key: "".concat(item.UID, "-subitems"),
          preview: itemPreview.Items,
          onChange: function onChange(i) {
            return _this2._handleItemChange(item.UID, {
              Items: i
            });
          },
          list: item.Items,
          leaf: true
        }))));
      })), hasRights && !leaf && this._renderProductList());
    }
  }, {
    key: "_renderProductList",
    value: function _renderProductList() {
      var _this3 = this;

      var _this$props2 = this.props,
          intl = _this$props2.intl,
          settingsCtx = _this$props2.settingsCtx,
          productCtx = _this$props2.productCtx,
          categoryCtx = _this$props2.categoryCtx,
          warehouseCtx = _this$props2.warehouseCtx,
          classes = _this$props2.classes,
          currency = _this$props2.currency;
      var selectorOpened = this.state.selectorOpened;

      var open = function open() {
        return _this3.setState(function () {
          return {
            selectorOpened: true
          };
        });
      };

      var close = function close() {
        return _this3.setState(function () {
          return {
            selectorOpened: false
          };
        });
      }; // TODO: select from product List in localization


      return React.createElement(_GridContainer.GridContainer, {
        direction: "row",
        justify: "center",
        alignItems: "center"
      }, React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: open,
        className: classes.button
      }, React.createElement(_reactIntl.FormattedMessage, OrderItemListMessages.addItem), React.createElement(_PlaylistAdd.default, {
        style: {
          paddingLeft: '7px'
        }
      })), React.createElement(_OrderProductSelector.default, _extends({
        intl: intl,
        settingsCtx: settingsCtx,
        productCtx: productCtx,
        categoryCtx: categoryCtx,
        warehouseCtx: warehouseCtx,
        currency: currency
      }, {
        onSelectEmpty: this._addEmpty,
        open: selectorOpened,
        onClose: close,
        onConfirm: function onConfirm(selections) {
          return _this3._handleProductsSelectChange(selections);
        }
      })));
    }
  }, {
    key: "_handleMoveItem",
    value: function _handleMoveItem(sortEnd) {
      var items = this.props.list || [];
      var newItems = (0, _reactSortableHoc.arrayMove)(items, sortEnd.oldIndex, sortEnd.newIndex);
      this.props.onChange(newItems);
    }
  }, {
    key: "_addEmpty",
    value: function _addEmpty() {
      var _this4 = this;

      var _this$props$settingsC = this.props.settingsCtx.Settings,
          TaxRateExcluded = _this$props$settingsC.TaxRateExcluded,
          TaxRateIncluded = _this$props$settingsC.TaxRateIncluded;
      var items = this.props.list || [];
      var title = this.props.intl.formatMessage(OrderItemListMessages.newProduct);
      var partial = {
        Title: title,
        Price: {
          TaxRateExcluded: TaxRateExcluded === undefined ? 0 : TaxRateExcluded,
          TaxRateIncluded: TaxRateIncluded === undefined ? 0 : TaxRateIncluded
        }
      };

      _services.OrderItems.Empty(partial).then(function (empty) {
        _this4.props.onChange([].concat(_toConsumableArray(items), [empty]));
      });
    }
  }, {
    key: "_handleProductsSelectChange",
    value: function _handleProductsSelectChange(selections) {
      var _this5 = this;

      var items = this.props.list || []; // selection : quantity and options of each menu item :

      _services.OrderItems.FromProducts(selections, this.props.currency).then(function (orderitems) {
        if (!orderitems || !orderitems.length) {
          return;
        }

        var newItems = [].concat(_toConsumableArray(items), _toConsumableArray(orderitems));

        _this5.setState(function () {
          return {
            selectorOpened: false
          };
        });

        _this5.props.onChange(newItems);
      });
    }
  }, {
    key: "_handleAddSubItem",
    value: function _handleAddSubItem(uid) {
      var items = this.props.list || [];
      var item = items.find(function (i) {
        return i.UID === uid;
      });

      if (!item) {
        return;
      }

      var newUID = (0, _shortid.generate)();
      var old = item.Items ? _toConsumableArray(item.Items) : [];
      var newItems = [].concat(_toConsumableArray(old), [{
        UID: newUID
      }]);

      this._handleItemChange(uid, {
        Items: newItems
      });
    }
  }, {
    key: "_handleRemoveItem",
    value: function _handleRemoveItem(uid) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.UID === uid;
      });

      if (index < 0) {
        return;
      } else {
        newItems.splice(index, 1);
      }

      this.props.onChange(newItems);
    }
  }, {
    key: "_handleItemChange",
    value: function _handleItemChange(uid, value) {
      var items = this.props.list || [];

      var newItems = _toConsumableArray(items);

      var index = newItems.findIndex(function (i) {
        return i.UID === uid;
      });

      if (index < 0) {
        newItems.push(value);
      } else {
        newItems[index] = _objectSpread({}, newItems[index], value);
      }

      this.props.onChange(newItems);
    }
  }]);

  return OrderItemList;
}(React.Component);

var _default = React.memo((0, _core.withStyles)(function (theme) {
  return {
    root: {},
    button: {
      marginTop: theme.spacing.unit
    },
    subItemsList: {
      paddingLeft: '1.8rem'
    }
  };
})(OrderItemList));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OrderProductSelectionEditor = exports.OrderProductSelectionEditorMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _core = require("@material-ui/core");

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var OrderProductSelectionEditorMessages = (0, _reactIntl.defineMessages)({
  quantity: {
    "id": "src.components.OrderProductSelectionEditorMessages.quantity",
    "defaultMessage": "quantity"
  },
  value: {
    "id": "src.components.OrderProductSelectionEditorMessages.value",
    "defaultMessage": "value"
  },
  title: {
    "id": "src.components.OrderProductSelectionEditorMessages.title",
    "defaultMessage": "title"
  },
  option: {
    "id": "src.components.OrderProductSelectionEditorMessages.option",
    "defaultMessage": "option"
  },
  optionValue: {
    "id": "src.components.OrderProductSelectionEditorMessages.optionValue",
    "defaultMessage": "optionValue"
  }
});
exports.OrderProductSelectionEditorMessages = OrderProductSelectionEditorMessages;

var OrderProductSelectionEditor = function OrderProductSelectionEditor(props) {
  var intl = props.intl,
      _props$selection = props.selection,
      Quantity = _props$selection.Quantity,
      Option = _props$selection.Option,
      selection = props.selection,
      onChange = props.onChange;

  var getPrice = function getPrice(bp) {
    return bp && bp.length && (bp.find(function (p) {
      return p.Currency === props.currency;
    }) || bp[0]);
  };

  var hasOptions = props.product.Options && props.product.Options.length > 0;
  return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
    item: true,
    xs: 2
  }, React.createElement(_TextField.default, {
    label: intl.formatMessage(OrderProductSelectionEditorMessages.quantity),
    value: Quantity || 0,
    type: "number",
    fullWidth: true,
    onChange: function (_onChange) {
      function onChange(_x) {
        return _onChange.apply(this, arguments);
      }

      onChange.toString = function () {
        return _onChange.toString();
      };

      return onChange;
    }(function (e) {
      var val = e.target.value;
      var q = val === '' ? 0 : parseInt(val, 10);
      onChange(_objectSpread({}, props.selection, {
        Quantity: q
      }));
    })
  })), React.createElement(_core.Grid, {
    item: true,
    xs: hasOptions ? 4 : 10
  }, React.createElement(_TextField.default, {
    label: intl.formatMessage(OrderProductSelectionEditorMessages.title),
    value: props.product.Title || '',
    fullWidth: true,
    disabled: true
  })), hasOptions && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
    item: true,
    xs: 3
  }, React.createElement(_core.FormControl, {
    fullWidth: true
  }, React.createElement(_core.InputLabel, {
    htmlFor: "selectOption"
  }, intl.formatMessage(OrderProductSelectionEditorMessages.option)), React.createElement(_core.Select, {
    fullWidth: true,
    value: Option && Option.index || '',
    onChange: function (_onChange2) {
      function onChange(_x2) {
        return _onChange2.apply(this, arguments);
      }

      onChange.toString = function () {
        return _onChange2.toString();
      };

      return onChange;
    }(function (e) {
      return onChange(_objectSpread({}, selection, {
        Option: {
          index: parseInt(e.target.value, 10),
          value: selection.Option && selection.Option.value || ''
        }
      }));
    }),
    inputProps: {
      name: 'selectOption',
      id: 'selectOption'
    }
  }, props.product.Options.map(function (opt, i) {
    var price = getPrice(opt.BasePrice);
    return React.createElement(_core.MenuItem, {
      key: i,
      value: i
    }, React.createElement("span", null, opt.Title), price && price.Value > 0 ? React.createElement("span", {
      style: {
        fontStyle: 'italic',
        marginLeft: '0.2rem'
      }
    }, "(+ ", React.createElement(_reactIntl.FormattedNumber, {
      style: "currency",
      currency: price.Currency,
      value: price.Value
    }), ")") : null);
  })))), React.createElement(_core.Grid, {
    item: true,
    xs: 3
  }, React.createElement(_TextField.default, {
    label: intl.formatMessage(OrderProductSelectionEditorMessages.optionValue),
    value: Option && Option.value || '',
    fullWidth: true,
    onChange: function (_onChange3) {
      function onChange(_x3) {
        return _onChange3.apply(this, arguments);
      }

      onChange.toString = function () {
        return _onChange3.toString();
      };

      return onChange;
    }(function (e) {
      return onChange(_objectSpread({}, selection, {
        Option: {
          index: selection.Option && selection.Option.index || -1,
          value: e.target.value
        }
      }));
    })
  }))));
};

exports.OrderProductSelectionEditor = OrderProductSelectionEditor;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderProductSelector = void 0;

var React = _interopRequireWildcard(require("react"));

var _ProductList = _interopRequireDefault(require("../../Products/ProductList/ProductList"));

var _OrderProductSelectionEditor = require("./OrderProductSelectionEditor");

var _core = require("@material-ui/core");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var toSelection = function toSelection(p) {
  return {
    ProductId: p.Id,
    Products: p.Products ? p.Products.map(toSelection) : [],
    Quantity: p.MinQuantity || 1
  };
};

var OrderProductSelector =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderProductSelector, _React$Component);

  function OrderProductSelector(props) {
    var _this;

    _classCallCheck(this, OrderProductSelector);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderProductSelector).call(this, props));
    _this.state = {
      orderProductDialogOpen: false,
      selections: [],
      products: []
    };
    return _this;
  }

  _createClass(OrderProductSelector, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          settingsCtx = _this$props.settingsCtx,
          warehouseCtx = _this$props.warehouseCtx,
          intl = _this$props.intl,
          onSelectEmpty = _this$props.onSelectEmpty,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          fetching = _this$props.productCtx.fetching,
          open = _this$props.open,
          currency = _this$props.currency,
          onClose = _this$props.onClose;
      var _this$state = this.state,
          orderProductDialogOpen = _this$state.orderProductDialogOpen,
          selections = _this$state.selections,
          products = _this$state.products;
      var confirmSelectBtn = {
        icon: React.createElement(_icons.LibraryAdd, null),
        legend: 'confirm select',
        themeColor: 'green',
        onClick: function onClick() {
          _this2.setState(function () {
            return {
              orderProductDialogOpen: true
            };
          });
        }
      };
      var selectEmptyBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'emptyproduct',
        themeColor: 'green',
        onClick: onSelectEmpty ? function () {
          onSelectEmpty();
          onClose();
        } : undefined
      };
      var loadingBtn = {
        icon: React.createElement(_icons.Cached, null),
        legend: 'loading',
        themeColor: 'gray'
      };
      return React.createElement(React.Fragment, null, React.createElement(_core.Dialog, {
        open: open,
        fullScreen: true,
        onClose: onClose
      }, React.createElement(_ProductList.default, {
        productCtx: productCtx,
        categoryCtx: categoryCtx,
        warehouseCtx: warehouseCtx,
        intl: intl,
        settingsCtx: settingsCtx,
        selectedIds: products.map(function (p) {
          return p.Id;
        }),
        showFavorite: false,
        onClick: function onClick(p) {
          _this2.setState(function () {
            return {
              products: [p],
              selections: [toSelection(p)],
              orderProductDialogOpen: true
            };
          });
        },
        onSelect: function onSelect(selected) {
          var remove = !!products.find(function (p) {
            return p.Id === selected.Id;
          });

          _this2.setState(function (prev) {
            return {
              products: remove ? prev.products.filter(function (p) {
                return p.Id !== selected.Id;
              }) : [].concat(_toConsumableArray(prev.products), [selected]),
              selections: remove ? prev.selections.filter(function (p) {
                return p.ProductId !== selected.Id;
              }) : [].concat(_toConsumableArray(prev.selections), [toSelection(selected)])
            };
          });
        }
      }), React.createElement(_Fabs.default, {
        map: [!fetching && products && products.length > 0 && confirmSelectBtn, !fetching && selectEmptyBtn, fetching && loadingBtn]
      })), selections && products && React.createElement(_core.Dialog, {
        open: orderProductDialogOpen,
        onClose: function onClose() {
          return _this2.setState({
            orderProductDialogOpen: false
          });
        }
      }, React.createElement(_core.DialogTitle, null, "Choose quantities"), React.createElement(_core.DialogContent, null, products.map(function (p, i) {
        var changeSelection = function changeSelection(arr, index, value) {
          return arr.map(function (v, ind) {
            return ind === index ? value : v;
          });
        };

        return React.createElement("div", {
          key: "".concat(i, "-").concat(p.Id)
        }, React.createElement(_OrderProductSelectionEditor.OrderProductSelectionEditor, {
          intl: intl,
          currency: currency,
          product: p,
          selection: selections[i],
          onChange: function onChange(sel) {
            return _this2.setState(function () {
              return {
                selections: changeSelection(selections, i, sel)
              };
            });
          }
        }), p.Products && p.Products.map(function (sp, j) {
          return React.createElement(_OrderProductSelectionEditor.OrderProductSelectionEditor, {
            key: i,
            intl: intl,
            currency: currency,
            product: sp,
            selection: selections[i].Products[j],
            onChange: function onChange(sel) {
              return _this2.setState(function () {
                return {
                  selections: changeSelection(selections, i, _objectSpread({}, selections[i], {
                    Products: changeSelection(selections[i].Products, j, sel)
                  }))
                };
              });
            }
          });
        }));
      })), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        onClick: function onClick() {
          return _this2.setState({
            orderProductDialogOpen: false
          });
        }
      }, "Cancel"), React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2.props.onConfirm(selections);

          _this2.setState({
            orderProductDialogOpen: false
          });
        }
      }, "Add"))));
    }
  }]);

  return OrderProductSelector;
}(React.Component);

exports.OrderProductSelector = OrderProductSelector;
var _default = OrderProductSelector;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactVirtualized = require("react-virtualized");

var _OrderListItem = _interopRequireDefault(require("../OrderListItem/OrderListItem"));

var _services = require("../../../_services");

var _OrderDetail = require("../OrderDetail/OrderDetail");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var classNames = _interopRequireWildcard(require("classnames"));

var _Filter = require("src/_helpers/Filter");

var _throttleDebounce = require("throttle-debounce");

var _materialUiPickers = require("material-ui-pickers");

var _OrderListMesseges = require("./OrderListMesseges");

var _print = require("src/_helpers/print");

var _ShopsField = _interopRequireDefault(require("src/components/ShopsField/ShopsField"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var LOCAL_STORAGE_KEY = 'our.orders.OrderList';

var DefaultFilters = function DefaultFilters() {
  return {
    types: [],
    status: ['Dispatching', 'PendingPayment', 'ToDispatch'],
    reference: '',
    shopId: '',
    userId: '',
    fromDate: null,
    toDate: null,
    sortAttribute: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute")) || 'Date',
    sortDirection: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection")) || 'descending'
  };
};

var OrderList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderList, _React$Component);

  function OrderList(props) {
    var _this;

    _classCallCheck(this, OrderList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_loadedRowsMap", {});

    _defineProperty(_assertThisInitialized(_this), "_list", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStartIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStopIndex", void 0);

    _this._isRowLoaded = _this._isRowLoaded.bind(_assertThisInitialized(_this));
    _this._loadMore = _this._loadMore.bind(_assertThisInitialized(_this));
    _this._rowRenderer = _this._rowRenderer.bind(_assertThisInitialized(_this));
    _this._handleItemChanged = _this._handleItemChanged.bind(_assertThisInitialized(_this));
    _this._printOrders = _this._printOrders.bind(_assertThisInitialized(_this));
    _this._printOrdersProducts = _this._printOrdersProducts.bind(_assertThisInitialized(_this));
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh);
    _this.state = {
      filter: DefaultFilters(),
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      submenuOpen: false,
      lastUpdate: new Date().getTime(),
      lightboxes: []
    };
    return _this;
  }

  _createClass(OrderList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      this.setState(function () {
        return {
          fetching: true
        };
      }, function () {
        _this2._loadMore({
          startIndex: 0,
          stopIndex: 0
        }).then(function () {
          return _this2.setState(function () {
            return {
              fetching: false
            };
          });
        });
      });
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this3 = this;

      setTimeout(function () {
        var _prevState$filter = prevState.filter,
            prevSortAttribute = _prevState$filter.sortAttribute,
            prevSortDirection = _prevState$filter.sortDirection;
        var _this3$state$filter = _this3.state.filter,
            sortAttribute = _this3$state$filter.sortAttribute,
            sortDirection = _this3$state$filter.sortDirection;

        if (sortAttribute !== prevSortAttribute) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute"), sortAttribute);
        }

        if (sortDirection !== prevSortDirection) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection"), sortDirection);
        }
      }, 0);
    }
  }, {
    key: "render",
    value: function render() {
      var _this4 = this,
          _classNames;

      var _this$state = this.state,
          rowCount = _this$state.rowCount,
          editing = _this$state.editing,
          creating = _this$state.creating,
          submenuOpen = _this$state.submenuOpen,
          editingOpened = _this$state.editingOpened,
          creatingOpened = _this$state.creatingOpened,
          _this$state$filter = _this$state.filter,
          types = _this$state$filter.types,
          status = _this$state$filter.status,
          query = _this$state$filter.reference,
          shopQuery = _this$state$filter.shopId,
          userQuery = _this$state$filter.userId,
          fromDate = _this$state$filter.fromDate,
          toDate = _this$state$filter.toDate,
          sortAttribute = _this$state$filter.sortAttribute,
          sortDirection = _this$state$filter.sortDirection;
      var _this$props = this.props,
          intl = _this$props.intl,
          shopCtx = _this$props.shopCtx,
          authCtx = _this$props.authCtx,
          user = _this$props.authCtx.user,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          usersCtx = _this$props.usersCtx,
          classes = _this$props.classes,
          templateCtx = _this$props.templateCtx;
      var infiniteLoaderProps = {
        isRowLoaded: this._isRowLoaded,
        loadMoreRows: this._loadMore,
        rowCount: rowCount
      };
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_All_Orders', 'CRUD_Own_Orders');

      var add = function add() {
        _this4.setState(function () {
          return {
            fetching: true
          };
        }, function () {
          _services.Orders.Empty({}).then(function (empty) {
            return _this4.setState(function () {
              return {
                creating: empty,
                creatingOpened: true,
                fetching: false
              };
            });
          });
        });
      };

      var cancel = function cancel() {
        _this4.setState(function () {
          return {
            creatingOpened: false,
            editingOpened: false
          };
        });
      };

      var referenceChange = function referenceChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              reference: q
            })
          };
        }, _this4._refresh);
      };

      var shopIdChange = function shopIdChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              shopId: q
            })
          };
        }, _this4._refresh);
      };

      var userIdChange = function userIdChange(e) {
        var q = e.target.value;

        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              userId: q
            })
          };
        }, _this4._refresh);
      };

      var fromDateChange = function fromDateChange(value) {
        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              fromDate: value
            })
          };
        }, _this4._refresh);
      };

      var toDateChange = function toDateChange(value) {
        _this4.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              toDate: value
            })
          };
        }, _this4._refresh);
      }; // tslint:disable-next-line:no-any
      // const searchBlur = (e: any) => {
      //     const q = e.target.value;
      //     if (!q) {
      //         this.setState(
      //             () => ({ drawerOpen: false })
      //         );
      //     }
      // };


      var toggle = function toggle() {
        _this4.setState(function (prev) {
          return {
            submenuOpen: !prev.submenuOpen
          };
        });
      }; // const focusSearch = () => {
      //     this.setState(
      //         () => ({ drawerOpen: true }),
      //         () => this._searchInput && this._searchInput.current && this._searchInput.current.focus()
      //     );
      // };


      var ordersTemplates = templateCtx.templates.filter(function (t) {
        return t.ApplyTo === 'Orders';
      });
      var ordersProductsTemplates = templateCtx.templates.filter(function (t) {
        return t.ApplyTo === 'OrdersProducts';
      });
      var ordersTemplatesBtn = ordersTemplates.length > 0 && {
        icon: React.createElement(_icons.Print, null),
        legend: ordersTemplates.length > 1 ? 'documents' : ordersTemplates[0].Title,
        themeColor: 'gray',
        onClick: ordersTemplates.length > 1 ? function () {
          return _this4.setState(function () {
            return {
              templatesOpened: true
            };
          });
        } : function () {
          return _this4._printOrders(ordersTemplates[0].Id);
        }
      };
      var ordersProductsTemplatesBtn = ordersProductsTemplates.length > 0 && {
        icon: React.createElement(_icons.Print, null),
        legend: ordersProductsTemplates.length > 1 ? 'documents' : ordersProductsTemplates[0].Title,
        themeColor: 'gray',
        onClick: ordersProductsTemplates.length > 1 ? function () {
          return _this4.setState(function () {
            return {
              templatesOpened: true
            };
          });
        } : function () {
          return _this4._printOrdersProducts(ordersProductsTemplates[0].Id);
        }
      };
      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classNames(classes.menu)
      }, React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterType('Cart');
        },
        className: classNames(classes.menuItem, types.indexOf('Cart') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.cart),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classes.menuItemIcon
      }, React.createElement(_icons.ShoppingCart, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterType('Offer');
        },
        className: classNames(classes.menuItem, types.indexOf('Offer') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.offer),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.Assignment, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterStatus('Canceled');
        },
        className: classNames(classes.menuItem, status.indexOf('Canceled') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.canceled),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.Block, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterStatus('PendingPayment');
        },
        className: classNames(classes.menuItem, status.indexOf('PendingPayment') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.payments),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.Payment, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterStatus('ToDispatch');
        },
        className: classNames(classes.menuItem, status.indexOf('ToDispatch') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.toDispatch),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.HowToVote, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterStatus('Dispatching');
        },
        className: classNames(classes.menuItem, status.indexOf('Dispatching') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.dispatching),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.LocalShipping, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick(e) {
          return _this4._toggleFilterStatus('Done');
        },
        className: classNames(classes.menuItem, status.indexOf('Done') >= 0 && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.done),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.Check, null)))), React.createElement(_core.ListItem, {
        className: classNames(classes.menuItem, classes.menuItemLast, (query || fromDate || toDate) && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_OrderListMesseges.OrderListMessages.sortBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon),
        onClick: toggle
      }, React.createElement(_icons.Sort, null)))))), React.createElement(_core.Grid, {
        item: true,
        className: classNames(classes.submenu, (_classNames = {}, _defineProperty(_classNames, classes.submenuOpen, submenuOpen), _defineProperty(_classNames, classes.submenuClose, !submenuOpen), _classNames))
      }, React.createElement(_GridContainer.GridContainer, {
        className: classes.submenuContent,
        direction: "column"
      }, React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: intl.formatMessage(_OrderListMesseges.OrderListMessages.reference),
        fullWidth: true,
        value: query,
        onChange: referenceChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        select: true,
        label: "User",
        fullWidth: true,
        value: userQuery || '',
        onChange: userIdChange
      }, usersCtx.Users.map(function (u) {
        return React.createElement(_core.MenuItem, {
          key: u.Id,
          value: u.Id
        }, u.FirstName, " ", u.LastName);
      }))), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_ShopsField.default, {
        label: "Shop",
        shopCtx: shopCtx,
        fullWidth: true,
        value: shopQuery,
        onChange: shopIdChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        className: classes.MuiPickerDTHeader,
        label: intl.formatMessage(_OrderListMesseges.OrderListMessages.from),
        fullWidth: true,
        keyboard: true,
        clearable: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: fromDate,
        onChange: fromDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        className: classes.MuiPickerDTHeader,
        label: intl.formatMessage(_OrderListMesseges.OrderListMessages.to),
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        clearable: true,
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: toDate,
        onChange: toDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        className: classes.sort
      }, React.createElement(_core.IconButton, {
        onClick: function onClick() {
          return _this4.setState(function (prev) {
            var dir = prev.filter.sortDirection === 'ascending' ? 'descending' : 'ascending';
            return {
              filter: _objectSpread({}, prev.filter, {
                sortDirection: dir
              })
            };
          }, _this4._refresh);
        }
      }, sortDirection === 'descending' ? React.createElement(_icons.ArrowUpward, null) : React.createElement(_icons.ArrowDownward, null)), React.createElement(_core.TextField, {
        label: intl.formatMessage(_OrderListMesseges.OrderListMessages.sort),
        fullWidth: true,
        value: sortAttribute || '',
        select: true,
        onChange: function onChange(value) {
          var v = value.target.value;

          _this4.setState(function (prev) {
            return {
              filter: _objectSpread({}, prev.filter, {
                sortAttribute: v
              })
            };
          }, _this4._refresh);
        }
      }, React.createElement(_core.MenuItem, {
        value: "Date"
      }, "Date"), React.createElement(_core.MenuItem, {
        value: "Reference"
      }, "Reference"), React.createElement(_core.MenuItem, {
        value: "Total"
      }, "Price"))))), React.createElement(_core.Grid, {
        item: true,
        className: classes.content
      }, React.createElement(_reactVirtualized.InfiniteLoader, infiniteLoaderProps, function (_ref) {
        var onRowsRendered = _ref.onRowsRendered,
            registerChild = _ref.registerChild;
        return React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
          var h = _ref2.height,
              w = _ref2.width;
          return React.createElement(_reactVirtualized.List, {
            ref: function ref(list) {
              _this4._list = list;
              registerChild(list);
            },
            height: h,
            onRowsRendered: onRowsRendered,
            rowCount: rowCount,
            rowHeight: _this4.state.rowHeight,
            rowRenderer: _this4._rowRenderer,
            width: w,
            style: {
              outline: 'none'
            }
          });
        });
      })), React.createElement(_Fabs.default, {
        map: [this.state.fetching ? 'loading' : hasRights ? {
          icon: React.createElement(_icons.Add, null),
          legend: 'add new',
          onClick: add,
          color: 'primary',
          themeColor: 'green'
        } : null, hasRights && ordersTemplatesBtn, hasRights && ordersProductsTemplatesBtn]
      }), editing >= 0 && React.createElement(_core.Dialog, {
        open: !!editingOpened,
        fullScreen: true,
        onClose: cancel
      }, React.createElement(_OrderDetail.OrderDetail, _extends({
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        usersCtx: usersCtx,
        templateCtx: templateCtx
      }, {
        id: this._loadedRowsMap[editing].Id,
        preview: this._loadedRowsMap[editing],
        onCancel: function onCancel() {
          _this4.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onChanged: function onChanged(order) {
          _this4._handleItemChanged(order, editing);
        },
        onDelete: function onDelete() {
          _this4._handleOrderDeleted();
        },
        key: editing
      }))), creating && React.createElement(_core.Dialog, {
        open: !!creatingOpened,
        fullScreen: true,
        onClose: close
      }, React.createElement(_OrderDetail.OrderDetail, _extends({
        intl: intl,
        templateCtx: templateCtx,
        usersCtx: usersCtx,
        shopCtx: shopCtx,
        authCtx: authCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx
      }, {
        preview: creating,
        onCancel: function onCancel() {
          _this4.setState(function () {
            return {
              editing: -1,
              creatingOpened: false
            };
          });
        },
        onChanged: function onChanged() {
          _this4._resetFilters();
        },
        onDelete: function onDelete() {
          _this4._handleOrderDeleted();
        }
      }))));
    } //     <div className="orders__filter-bar">
    //     <InteractiveTitle>
    //         <FilterBar
    //             intl={intl}
    //             typeMap={map}
    //             def={filters}
    //             change={this._setFilters}
    //         />
    //     </InteractiveTitle>
    // </div>

  }, {
    key: "_toggleFilterType",
    value: function _toggleFilterType(type) {
      var _this5 = this;

      this.setState(function (prev) {
        return {
          filter: _objectSpread({}, prev.filter, {
            types: prev.filter.types.indexOf(type) < 0 ? [].concat(_toConsumableArray(prev.filter.types), [type]) : prev.filter.types.filter(function (t) {
              return t !== type;
            })
          })
        };
      }, function () {
        return _this5._refresh();
      });
    }
  }, {
    key: "_toggleFilterStatus",
    value: function _toggleFilterStatus(status) {
      var _this6 = this;

      this.setState(function (prev) {
        return {
          filter: _objectSpread({}, prev.filter, {
            status: prev.filter.status.indexOf(status) < 0 ? [].concat(_toConsumableArray(prev.filter.status), [status]) : prev.filter.status.filter(function (t) {
              return t !== status;
            })
          })
        };
      }, function () {
        return _this6._refresh();
      });
    }
  }, {
    key: "_rowRenderer",
    value: function _rowRenderer(props) {
      var _this7 = this;

      var intl = this.props.intl;
      var index = props.index;
      var order = this._loadedRowsMap[index];
      return React.createElement("div", {
        key: "".concat(props.key, "-").concat(this.state.lastUpdate),
        style: props.style
      }, React.createElement(_OrderListItem.default, {
        order: order,
        intl: intl,
        onClick: order ? function () {
          return _this7.setState(function () {
            return {
              editing: index,
              editingOpened: true
            };
          });
        } : undefined
      }));
    }
  }, {
    key: "_getFilters",
    value: function _getFilters() {
      var _this$state$filter2 = this.state.filter,
          status = _this$state$filter2.status,
          types = _this$state$filter2.types,
          reference = _this$state$filter2.reference,
          shopId = _this$state$filter2.shopId,
          userId = _this$state$filter2.userId,
          fromDate = _this$state$filter2.fromDate,
          toDate = _this$state$filter2.toDate,
          sortAttribute = _this$state$filter2.sortAttribute,
          sortDirection = _this$state$filter2.sortDirection;
      var filters = [];

      if (status && status.length) {
        filters.push(_Filter.Filter.And(_Filter.Filter.Eq('OrderType', 'Order'), _Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(status.map(function (s) {
          return _Filter.Filter.Eq('Status', s);
        })))));
      }

      if (types && types.length) {
        filters.push(_Filter.Filter.Or.apply(_Filter.Filter, _toConsumableArray(types.map(function (t) {
          return _Filter.Filter.Eq('OrderType', t);
        }))));
      }

      if (reference || fromDate || toDate || shopId || userId) {
        var morefilters = [];

        if (reference) {
          morefilters.push(_Filter.Filter.Like('Reference', reference));
        }

        if (shopId) {
          morefilters.push(_Filter.Filter.Like('ShopId', shopId));
        }

        if (userId) {
          morefilters.push(_Filter.Filter.Like('UserId', userId));
        }

        if (fromDate) {
          morefilters.push(_Filter.Filter.Gte('Date', fromDate));
        }

        if (toDate) {
          morefilters.push(_Filter.Filter.Lte('Date', toDate));
        }

        filters = [_Filter.Filter.And.apply(_Filter.Filter, _toConsumableArray(filters).concat(morefilters))]; // filters.push(Filter.Or(...types.map(t => Filter.Eq('OrderType', t))));
      }

      return {
        filters: filters,
        operator: 'or',
        sort: "".concat(sortDirection === 'ascending' ? '' : '-').concat(sortAttribute)
      };
    }
  }, {
    key: "_loadMore",
    value: function _loadMore(range) {
      var _this8 = this;

      var stopIndex = range.stopIndex,
          startIndex = range.startIndex;
      this._loadMoreRowsStartIndex = startIndex;
      this._loadMoreRowsStopIndex = stopIndex;

      var filterDef = this._getFilters();

      var delta = stopIndex - startIndex;
      this.setState(function (prev) {
        return {
          loading: prev.loading + delta,
          fetching: true
        };
      });
      return _services.Orders.Find(filterDef, startIndex, stopIndex + 1).then(function (response) {
        var count = response.Values.length;
        response.Values.forEach(function (order, i) {
          _this8._loadedRowsMap[startIndex + i] = order;
        });

        _this8.setState(function (prev) {
          return {
            loading: prev.loading - count,
            loaded: prev.loaded + count,
            rowCount: response.Count,
            fetching: false,
            lastUpdate: new Date().getTime()
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this9 = this;

      this._loadedRowsMap = {};

      if (this._list) {
        this._list.forceUpdate();

        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: -1,
          rowCount: 0,
          loaded: 0,
          loading: 0,
          lastUpdate: new Date().getTime()
        };
      }, function () {
        _this9._loadMore({
          startIndex: _this9._loadMoreRowsStartIndex,
          stopIndex: _this9._loadMoreRowsStopIndex
        }).then(function () {
          if (_this9._list) {
            _this9._list.forceUpdate();

            _this9._list.forceUpdateGrid();
          }
        });
      });
    }
  }, {
    key: "_resetFilters",
    value: function _resetFilters() {
      var _this10 = this;

      this.setState(function () {
        return {
          filter: DefaultFilters()
        };
      }, function () {
        return _this10._refresh();
      });
    }
  }, {
    key: "_printOrders",
    value: function _printOrders(templateId) {
      var filterDef = this._getFilters();

      _services.DocumentTemplates.Orders(filterDef, templateId).then(function (res) {
        new _print.Printer({
          content: function content() {
            return React.createElement("div", {
              dangerouslySetInnerHTML: {
                __html: res.html
              }
            });
          },
          cssClasses: ['body--print-reciept'],
          cssStyles: res.styles,
          copyStyles: false
        }).Print();
      });
    }
  }, {
    key: "_printOrdersProducts",
    value: function _printOrdersProducts(templateId) {
      var filterDef = this._getFilters();

      _services.DocumentTemplates.OrdersProducts(filterDef, templateId).then(function (res) {
        new _print.Printer({
          content: function content() {
            return React.createElement("div", {
              dangerouslySetInnerHTML: {
                __html: res.html
              }
            });
          },
          cssClasses: ['body--print-reciept'],
          cssStyles: res.styles,
          copyStyles: false
        }).Print();
      });
    }
  }, {
    key: "_handleItemChanged",
    value: function _handleItemChanged(order, index) {
      this._loadedRowsMap[index] = order;

      if (this._list) {
        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: index,
          lastUpdate: new Date().getTime()
        };
      });
    }
  }, {
    key: "_handleOrderDeleted",
    value: function _handleOrderDeleted() {
      var _this11 = this;

      this.setState(function () {
        return {
          editing: -1
        };
      }, function () {
        return _this11._refresh();
      });
    }
  }, {
    key: "_isRowLoaded",
    value: function _isRowLoaded(ind) {
      // No entry in this map signifies that the row has never been loaded before
      return !!this._loadedRowsMap[ind.index];
    }
  }]);

  return OrderList;
}(React.Component);

var drawerWidth = '16rem';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    menu: {
      height: '100%',
      boxSizing: 'border-box',
      display: 'flex',
      flexDirection: 'column'
    },
    menuItem: {
      paddingLeft: theme.spacing.unit,
      paddingRight: theme.spacing.unit,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      opacity: 0.5,
      flex: '0 0 auto',
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    submenu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    submenuOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    submenuClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    submenuContent: {
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative',
      padding: '0 40px'
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    tooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      fontSize: 11
    },
    sort: {
      marginTop: 'auto',
      display: 'flex',
      flexShrink: 0
    },
    MuiPickerDTHeader: {
      hourMinuteLabel: {
        flexDirection: 'row'
      }
    }
  };
})(OrderList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderListMessages = void 0;

var _reactIntl = require("react-intl");

var OrderListMessages = (0, _reactIntl.defineMessages)({
  sortBtn: {
    "id": "src.components.orders.orderList.sortBtn",
    "defaultMessage": "Sort and Filters"
  },
  done: {
    "id": "src.components.orders.orderList.done",
    "defaultMessage": "Done"
  },
  dispatching: {
    "id": "src.components.orders.orderList.dispatching",
    "defaultMessage": "Dispatching"
  },
  toDispatch: {
    "id": "src.components.orders.orderList.toDispatch",
    "defaultMessage": "To dispatch"
  },
  payments: {
    "id": "src.components.orders.orderList.payments",
    "defaultMessage": "Payments"
  },
  canceled: {
    "id": "src.components.orders.orderList.canceled",
    "defaultMessage": "Canceled"
  },
  offer: {
    "id": "src.components.orders.orderList.offer",
    "defaultMessage": "Offer"
  },
  cart: {
    "id": "src.components.orders.orderList.cart",
    "defaultMessage": "Cart"
  },
  to: {
    "id": "src.components.orders.orderList.to",
    "defaultMessage": "To"
  },
  from: {
    "id": "src.components.orders.orderList.from",
    "defaultMessage": "From"
  },
  reference: {
    "id": "src.components.orders.orderList.reference",
    "defaultMessage": "Reference"
  },
  sort: {
    "id": "src.components.orders.orderList.sort",
    "defaultMessage": "Sort"
  }
});
exports.OrderListMessages = OrderListMessages;
var _default = OrderListMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderListItem = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _PersonPreview = _interopRequireDefault(require("../../PersonPreview"));

var _classnames = _interopRequireDefault(require("classnames"));

var _icons = require("@material-ui/icons");

var _OrderStatus = require("src/_helpers/OrderStatus");

var _core = require("@material-ui/core");

var _OrderIcons = require("../OrderIcons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var OrderListItem = function OrderListItem(props) {
  var onClick = props.onClick,
      order = props.order,
      classes = props.classes;

  if (!order) {
    return React.createElement("div", {
      className: classes.container
    }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, {
      loading: true
    }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
      loading: true
    }), React.createElement(_ItemPreview.Line, {
      loading: true
    }))));
  }

  var client = order.Client;
  var total = order.Total;
  var paidDate = order.Payments.filter(function (p) {
    return p.Status === 'Paid';
  }).map(function (p) {
    return new Date(p.Date);
  }).sort().pop();
  var dispatchDate = order.Dispatches.map(function (p) {
    return new Date(p.Date);
  }).sort().pop();

  var getSubtitle = function getSubtitle() {
    if (order.Type !== 'order') {
      return null;
    }

    switch (order.Status) {
      case 'Canceled':
        return React.createElement(React.Fragment, null, React.createElement("span", {
          className: "order-list-item__status"
        }, (0, _OrderStatus.GetOrderStatusLegend)(props.intl, order.Status)));

      case 'Done':
        return React.createElement(React.Fragment, null, React.createElement("span", {
          className: "order-list-item__status"
        }, (0, _OrderStatus.GetOrderStatusLegend)(props.intl, order.Status)), paidDate && React.createElement("span", {
          className: "order-list-item__paid-date"
        }, React.createElement(_reactIntl.FormattedMessage, {
          id: "src.views.orders.orderListItem.paidDatePrefix",
          defaultMessage: " paid on: "
        }), React.createElement(_reactIntl.FormattedDate, {
          value: new Date(paidDate)
        })), dispatchDate && React.createElement("span", {
          className: "order-list-item__dispatch-date"
        }, React.createElement(_reactIntl.FormattedMessage, {
          id: "src.views.orders.orderListItem.dispatchedPrefix",
          defaultMessage: " dispatched on: "
        }), React.createElement(_reactIntl.FormattedDate, {
          value: new Date(dispatchDate)
        })));

      case 'PendingPayment':
        return React.createElement(React.Fragment, null, React.createElement("span", {
          className: "order-list-item__status"
        }, (0, _OrderStatus.GetOrderStatusLegend)(props.intl, order.Status)));

      case 'ToDispatch':
        return React.createElement(React.Fragment, null, React.createElement("span", {
          className: "order-list-item__status"
        }, (0, _OrderStatus.GetOrderStatusLegend)(props.intl, order.Status)), paidDate && React.createElement("span", {
          className: "order-list-item__paid-date"
        }, "paid on: ", React.createElement(_reactIntl.FormattedDate, {
          value: new Date(paidDate)
        })));

      case 'Empty':
        return React.createElement(React.Fragment, null, React.createElement("span", {
          className: "order-list-item__status"
        }, (0, _OrderStatus.GetOrderStatusLegend)(props.intl, order.Status)));

      default:
        return 100;
    }
  };

  return React.createElement("div", {
    onClick: onClick,
    className: classes.container
  }, React.createElement(_ItemPreview.default, null, order.OrderType === 'Cart' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Cart)
  }, React.createElement(_icons.ShoppingCart, null)), order.OrderType === 'Order' && order.Status === 'Empty' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Empty)
  }), order.OrderType === 'Order' && order.Status === 'Canceled' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Cancelled)
  }, React.createElement(_icons.Block, null)), order.OrderType === 'Order' && order.Status === 'PendingPayment' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.PendingPayment)
  }, React.createElement(_icons.Payment, null)), order.OrderType === 'Order' && order.Status === 'ToDispatch' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.ToDispatch)
  }, React.createElement(_icons.HowToVote, null)), order.OrderType === 'Order' && order.Status === 'Dispatching' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Dispatching)
  }, React.createElement(_icons.LocalShipping, null)), order.OrderType === 'Order' && order.Status === 'Done' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Done)
  }, React.createElement(_icons.Check, null)), order.OrderType === 'Offer' && React.createElement(_core.Avatar, {
    className: (0, _classnames.default)(classes.Offer)
  }, React.createElement(_icons.Assignment, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
    isTitle: true
  }, order.Reference), React.createElement(_ItemPreview.Line, null, client && React.createElement(_PersonPreview.default, client), client && client.City), React.createElement(_ItemPreview.Line, null, getSubtitle())), React.createElement(_ItemPreview.Lines, {
    actions: true
  }, React.createElement(_ItemPreview.Line, {
    isTitle: true
  }, total && order.Currency && React.createElement(_reactIntl.FormattedNumber, {
    value: total,
    style: "currency",
    currency: order.Currency
  })), React.createElement(_ItemPreview.Line, null, order.Date && React.createElement(_reactIntl.FormattedDate, {
    value: new Date(order.Date),
    year: "2-digit",
    month: "numeric",
    day: "numeric"
  })), React.createElement(_ItemPreview.Line, null))));
};

exports.OrderListItem = OrderListItem;
var width = '3rem';
var height = '3rem';

var _default = (0, _core.withStyles)(function (theme) {
  var iconStyles = (0, _OrderIcons.OrderIconStyles)(theme);
  return {
    container: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2
    },
    Empty: _objectSpread({}, iconStyles.Empty, {
      width: width,
      height: height
    }),
    Cancelled: _objectSpread({}, iconStyles.Cancelled, {
      width: width,
      height: height
    }),
    PendingPayment: _objectSpread({}, iconStyles.PendingPayment, {
      width: width,
      height: height
    }),
    ToDispatch: _objectSpread({}, iconStyles.ToDispatch, {
      width: width,
      height: height
    }),
    Dispatching: _objectSpread({}, iconStyles.Dispatching, {
      width: width,
      height: height
    }),
    Done: _objectSpread({}, iconStyles.Done, {
      width: width,
      height: height
    }),
    Offer: _objectSpread({}, iconStyles.Offer, {
      width: width,
      height: height
    }),
    Cart: _objectSpread({}, iconStyles.Cart, {
      width: width,
      height: height
    })
  };
})(OrderListItem);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderReciept = exports.OrderReceiptItem = exports.formatPrice = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _reactIntl = require("react-intl");

var _styles = require("@material-ui/core/styles");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

var formatPrice = function formatPrice(value) {
  return value ? parseFloat((Math.round(value * 100) / 100).toString()).toFixed(2) : '0';
};

exports.formatPrice = formatPrice;

var OrderReceiptItem = function OrderReceiptItem(props) {
  var orderItem = props.orderItem;
  return React.createElement(_core.Grid, {
    key: orderItem.UID,
    container: true,
    spacing: 8
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 1
  }, orderItem.Quantity || ''), React.createElement(_core.Grid, {
    item: true,
    xs: 6
  }, orderItem.Title || ''), React.createElement(_core.Grid, {
    item: true,
    xs: 2,
    style: {
      flexGrow: 1,
      textAlign: 'right'
    }
  }, formatPrice(orderItem.UnitPrice)), React.createElement(_core.Grid, {
    item: true,
    xs: 1,
    style: {
      flexGrow: 1,
      textAlign: 'right'
    }
  }, formatPrice(orderItem.Price && orderItem.Price.TaxRateIncluded)), React.createElement(_core.Grid, {
    item: true,
    xs: 2,
    style: {
      flexGrow: 1,
      textAlign: 'right'
    }
  }, formatPrice(orderItem.FinalPrice)), orderItem.Items && orderItem.Items.length ? orderItem.Items.map(function (i) {
    return React.createElement(React.Fragment, {
      key: i.UID
    }, React.createElement(_core.Grid, {
      item: true,
      xs: 1
    }), React.createElement(_core.Grid, {
      item: true,
      xs: 11
    }, "- ", i.Quantity || '', " ", i.Title || ''));
  }) : undefined);
};

exports.OrderReceiptItem = OrderReceiptItem;

var OrderReciept = function OrderReciept(props) {
  var order = props.order,
      _props$order = props.order,
      Client = _props$order.Client,
      ShopId = _props$order.ShopId,
      OrderType = _props$order.OrderType,
      Reference = _props$order.Reference,
      date = _props$order.Date,
      Items = _props$order.Items,
      Payments = _props$order.Payments,
      Dispatches = _props$order.Dispatches,
      intl = props.intl,
      classes = props.classes;
  var shop = props.shopCtx.Shops.find(function (s) {
    return s.Id === ShopId;
  });
  var client = Client;
  var paymentsToRender = Payments.filter(function (p) {
    return p.Status === 'Pending' || p.Status === 'Paid';
  });
  return React.createElement("div", {
    className: classes.OrderReceipt
  }, shop && React.createElement(_core.Grid, {
    container: true
  }, shop.OrganizationName && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classNames(classes.headerCls, classes.BoldCls)
  }, React.createElement("span", null, shop.OrganizationName)), shop.Address && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classes.headerCls
  }, React.createElement("span", null, shop.Address)), (shop.PostalCode || shop.City) && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classes.headerCls
  }, shop.PostalCode && React.createElement("span", {
    className: classes.OrganizationName
  }, shop.PostalCode), shop.City && React.createElement("span", null, shop.City)), (shop.State || shop.CountryIso) && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classes.headerCls
  }, shop.State && React.createElement("span", null, shop.State), shop.CountryIso && React.createElement("span", null, shop.CountryIso)), shop.Phone && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classes.headerCls
  }, React.createElement("span", null, shop.Phone)), shop.Email && React.createElement(_core.Grid, {
    item: true,
    xs: 12,
    className: classes.headerCls
  }, React.createElement("span", null, shop.Email))), React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 12
  }, OrderType, " #", Reference), React.createElement(_core.Grid, {
    item: true,
    xs: 12
  }, date && intl.formatDate(new Date(date), {
    year: 'numeric',
    month: 'numeric',
    day: 'numeric',
    hour: 'numeric',
    minute: 'numeric',
    second: 'numeric',
    hour12: false
  }))), client && React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, client.OrganizationName && React.createElement("div", {
    className: classes.OrganizationName
  }, client.OrganizationName), (client.FirstName || client.LastName) && React.createElement("div", null, client.FirstName, " ", client.LastName), client.VATNumber && React.createElement("div", null, client.VATNumber)), React.createElement(_core.Grid, {
    container: true,
    className: classNames(classes.SectionCls, classes.SectionTitleCls)
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 1
  }, "Qt."), React.createElement(_core.Grid, {
    item: true,
    xs: 6
  }, "Description"), React.createElement(_core.Grid, {
    item: true,
    xs: 2,
    className: classes.Price
  }, "Unit"), React.createElement(_core.Grid, {
    item: true,
    xs: 1,
    className: classes.Price
  }, "Tx"), React.createElement(_core.Grid, {
    item: true,
    xs: 2,
    className: classes.Price
  }, "Price")), React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, Items.map(function (item) {
    return OrderReceiptItem({
      orderItem: item,
      order: order
    });
  })), React.createElement(_core.Grid, {
    container: true,
    className: classNames(classes.SectionCls, classes.BoldCls)
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 8
  }, order.Delivery && order.Delivery.Final !== 0 ? '' : 'Total'), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.Price
  }, React.createElement(_reactIntl.FormattedNumber, {
    value: order.Price || 0,
    style: "currency",
    currency: order.Currency
  }))), order.Delivery && order.Delivery.Final !== 0 && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 8
  }, "Shipping"), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.Price
  }, React.createElement(_reactIntl.FormattedNumber, {
    value: order.Delivery.Final || 0,
    style: "currency",
    currency: order.Currency
  }))), React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 8
  }, "Total"), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.Price
  }, React.createElement(_reactIntl.FormattedNumber, {
    value: order.Total || 0,
    style: "currency",
    currency: order.Currency
  })))), order.Tax !== 0 && React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 8
  }, "Included tax"), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.TextAlignRight
  }, React.createElement(_reactIntl.FormattedNumber, {
    value: order.Tax || 0,
    style: "currency",
    currency: order.Currency
  }))), paymentsToRender.length > 0 && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
    container: true,
    className: classNames(classes.SectionCls, classes.SectionTitleCls)
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 5
  }, "Payments"), React.createElement(_core.Grid, {
    item: true,
    xs: 3
  }, "Status"), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.Price
  }, "Amount")), React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, paymentsToRender.map(function (payment) {
    return React.createElement(React.Fragment, {
      key: payment.Id
    }, React.createElement(_core.Grid, {
      item: true,
      xs: 5
    }, payment.Title), React.createElement(_core.Grid, {
      item: true,
      xs: 3
    }, payment.Status), React.createElement(_core.Grid, {
      item: true,
      xs: 4,
      className: classes.Price
    }, React.createElement(_reactIntl.FormattedNumber, {
      value: payment.Amount || 0,
      style: "currency",
      currency: payment.Currency
    })));
  }))), Dispatches.length > 0 && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
    container: true,
    className: classNames(classes.SectionCls, classes.SectionTitleCls)
  }, React.createElement(_core.Grid, {
    item: true,
    xs: 5
  }, "Dispatches"), React.createElement(_core.Grid, {
    item: true,
    xs: 3
  }, "Status"), React.createElement(_core.Grid, {
    item: true,
    xs: 4,
    className: classes.Price
  }, "Date")), React.createElement(_core.Grid, {
    container: true,
    className: classes.SectionCls
  }, Dispatches.map(function (dispatch) {
    return React.createElement(React.Fragment, {
      key: dispatch.Id
    }, React.createElement(_core.Grid, {
      item: true,
      xs: 5
    }, dispatch.Method && dispatch.Method), React.createElement(_core.Grid, {
      item: true,
      xs: 3
    }, dispatch.Status && dispatch.Status), React.createElement(_core.Grid, {
      item: true,
      xs: 4,
      style: {
        textAlign: 'right'
      }
    }, intl.formatDate(new Date(dispatch.Date), {
      year: 'numeric',
      month: 'numeric',
      day: 'numeric'
    })));
  }))));
};

exports.OrderReciept = OrderReciept;

var _default = (0, _styles.withStyles)(function (theme) {
  return {
    headerCls: {
      textAlign: 'center'
    },
    BoldCls: {
      fontWeight: 'bold'
    },
    SectionCls: {
      padding: '0.25cm 0',
      borderBottom: '1px solid #444'
    },
    SectionTitleCls: {
      color: 'black'
    },
    OrderReceipt: {
      position: 'relative',
      fontFamily: '"Courier New", Courier, monospace',
      color: '#444',
      background: 'white',
      boxSizing: 'border-box',
      margin: '0 auto'
    },
    SectionShop: {
      color: 'black',
      textAlign: 'center'
    },
    SectionItemsTitle: {
      color: 'black'
    },
    SectionPaymentsTitle: {
      color: 'black'
    },
    SectionDispatchesTitle: {
      color: 'black'
    },
    Section: {
      padding: '0.25cm 0',
      borderBottom: '1px solid #444'
    },
    TextAlignRight: {
      textAlign: 'right'
    },
    Price: {
      flexGrow: 1,
      textAlign: 'right'
    },
    SubSection: {
      borderTop: '1px dashed #444'
    },
    SubItems: {
      width: '100%',
      paddingLeft: '0.2cm'
    },
    Item: {
      display: 'flex',
      width: '100%',
      flexWrap: 'wrap'
    },
    OrganizationName: {
      marginRight: 5
    }
  };
})(OrderReciept);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderShippingDialogStyles = void 0;

var React = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var shortid = _interopRequireWildcard(require("shortid"));

var _OrderCheckoutStockSelect = _interopRequireDefault(require("../OrderCheckout/OrderCheckoutStockSelect"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderShippingDialogStyles = function OrderShippingDialogStyles(theme) {
  return {
    submitBtnCls: {
      backgroundColor: theme.Colors.green.primary.main,
      '&:hover': {
        backgroundColor: theme.Colors.green.primary.dark
      }
    },
    stockPanelCls: {
      marginTop: theme.spacing.unit
    }
  };
};

exports.OrderShippingDialogStyles = OrderShippingDialogStyles;

var OrderShippingDialog =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderShippingDialog, _React$Component);

  function OrderShippingDialog(props) {
    var _this;

    _classCallCheck(this, OrderShippingDialog);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderShippingDialog).call(this, props));
    _this._open = _this._open.bind(_assertThisInitialized(_this));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this._close = _this._close.bind(_assertThisInitialized(_this));
    _this._select = _this._select.bind(_assertThisInitialized(_this));
    _this._more = _this._more.bind(_assertThisInitialized(_this));
    _this._less = _this._less.bind(_assertThisInitialized(_this));
    var warehouseId = props.authCtx.user.WarehouseId || '---';
    var stock = props.stock,
        defaultStatus = props.defaultStatus,
        defaultMethod = props.defaultMethod;
    _this.state = {
      advanced: stock.length <= 1,
      warehouseId: warehouseId,
      stock: stock,
      method: defaultMethod,
      status: defaultStatus
    };
    return _this;
  }

  _createClass(OrderShippingDialog, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          order = _this$props.order,
          methods = _this$props.methods,
          open = _this$props.open,
          _this$props$classes = _this$props.classes,
          submitBtnCls = _this$props$classes.submitBtnCls,
          stockPanelCls = _this$props$classes.stockPanelCls;
      var _this$state = this.state,
          warehouseId = _this$state.warehouseId,
          advanced = _this$state.advanced,
          stock = _this$state.stock,
          method = _this$state.method,
          status = _this$state.status;
      return React.createElement(_core.Dialog, {
        open: open
      }, React.createElement(_core.DialogTitle, null, "Dispatch Shipping"), React.createElement(_core.DialogContent, null, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, "Method"), React.createElement(_core.Select, {
        fullWidth: true,
        value: method,
        onChange: function onChange(e) {
          return _this2.setState(function () {
            return {
              method: e.target.value
            };
          });
        },
        inputProps: {
          name: 'DispatchMethod',
          id: 'DispatchMethod'
        }
      }, methods.map(function (m) {
        return {
          preview: m,
          value: m
        };
      }).map(function (dispatchMethod) {
        return React.createElement(_core.MenuItem, {
          key: dispatchMethod.value,
          value: dispatchMethod.value
        }, dispatchMethod.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "DispatchStatus"
      }, "Status"), React.createElement(_core.Select, {
        fullWidth: true,
        value: status || '',
        onChange: function onChange(e) {
          return _this2.setState(function () {
            return {
              status: e.target.value
            };
          });
        },
        inputProps: {
          name: 'DispatchStatus',
          id: 'DispatchStatus'
        }
      }, [{
        preview: 'Init',
        value: 'Init'
      }, {
        preview: 'Preparing',
        value: 'Preparing'
      }, {
        preview: 'Ready for delivery',
        value: 'ReadyForDelivery'
      }, {
        preview: 'En route',
        value: 'EnRoute'
      }, {
        preview: 'Undeliverable',
        value: 'Undeliverable'
      }, {
        preview: 'Delivered',
        value: 'Delivered'
      }].map(function (dispatchStatus) {
        return React.createElement(_core.MenuItem, {
          key: dispatchStatus.value,
          value: dispatchStatus.value
        }, dispatchStatus.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        classes: {
          item: stockPanelCls
        }
      }, !advanced && React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, "Update all items Stock"), React.createElement(_core.Select, {
        fullWidth: true,
        value: warehouseId || '---',
        onChange: this._select
      }, warehouseCtx.Warehouses.map(function (w) {
        return React.createElement(_core.MenuItem, {
          key: w.Id,
          value: w.Id
        }, "".concat(w.Name));
      }), React.createElement(_core.MenuItem, {
        value: "---"
      }, React.createElement("em", null, "Don't update Stock")))), advanced && React.createElement(_OrderCheckoutStockSelect.default, {
        warehouseCtx: warehouseCtx,
        order: order,
        authCtx: authCtx,
        stock: stock,
        onSelect: function onSelect(s) {
          return _this2.setState(function () {
            return {
              stock: s
            };
          });
        }
      })))), React.createElement(_core.DialogActions, null, !advanced && stock.length > 1 && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._more
      }, "More options..."), advanced && stock.length > 1 && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: this._less
      }, "Less options..."), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: this._close
      }, "cancel"), React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: this._add,
        classes: {
          root: submitBtnCls
        }
      }, "update")));
    }
  }, {
    key: "_less",
    value: function _less() {
      this.setState(function () {
        return {
          advanced: false
        };
      });
    }
  }, {
    key: "_more",
    value: function _more() {
      this.setState(function () {
        return {
          advanced: true
        };
      });
    }
  }, {
    key: "_close",
    value: function _close() {
      this.props.toggle(false);
    }
  }, {
    key: "_open",
    value: function _open() {
      this.props.toggle(false);
    }
  }, {
    key: "_select",
    value: function _select(event, child) {
      var stock = this.props.stock;
      var warehouseId = event.target.value;
      this.setState(function () {
        return {
          warehouseId: warehouseId,
          stock: stock.map(function (s) {
            return _objectSpread({}, s, {
              warehouseId: warehouseId
            });
          })
        };
      });
    }
  }, {
    key: "_add",
    value: function _add() {
      var onSelect = this.props.onSelect;
      var _this$state2 = this.state,
          stock = _this$state2.stock,
          status = _this$state2.status,
          method = _this$state2.method;
      var dispatch = {
        Method: method,
        Status: status,
        Date: new Date().toISOString(),
        Id: shortid()
      };
      onSelect(dispatch, stock);

      this._close();
    }
  }]);

  return OrderShippingDialog;
}(React.Component);

var _default = (0, _styles.withStyles)(OrderShippingDialogStyles)(OrderShippingDialog);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderShippingPersonMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _reactIntl = require("react-intl");

var _icons = require("@material-ui/icons");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _core = require("@material-ui/core");

var _PersonFields = _interopRequireDefault(require("src/components/Person/PersonFields"));

var _notistack = require("notistack");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var OrderShippingPersonMessages = (0, _reactIntl.defineMessages)({
  empty: {
    "id": "src.components.forms.shipping.empty",
    "defaultMessage": "Devilery address"
  },
  name: {
    "id": "src.components.forms.shipping.name",
    "defaultMessage": "Name"
  },
  address: {
    "id": "src.components.forms.shipping.address",
    "defaultMessage": "Adrress"
  }
});
exports.OrderShippingPersonMessages = OrderShippingPersonMessages;

var OrderShippingPersonFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(OrderShippingPersonFields, _React$Component);

  function OrderShippingPersonFields(props) {
    var _this;

    _classCallCheck(this, OrderShippingPersonFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderShippingPersonFields).call(this, props));
    _this._handleChange = _this._handleChange.bind(_assertThisInitialized(_this));
    _this.state = {
      dialogOpened: false
    };
    return _this;
  }

  _createClass(OrderShippingPersonFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          intl = _this$props.intl,
          onChange = _this$props.onChange,
          currentOrder = _this$props.current,
          enqueueSnackbar = _this$props.enqueueSnackbar,
          hasRights = _this$props.hasRights;
      var dialogOpened = this.state.dialogOpened;
      var initial = this.props.initial || {};
      var changes = this.props.changes || {};

      var current = _objectSpread({}, initial, changes);

      var firstname = current.FirstName || '';
      var lastname = current.LastName || '';
      var organizationname = current.OrganizationName || '';
      var address = current.Address || '';
      var city = current.City || '';
      var state = current.State || '';
      var postalcode = current.PostalCode || '';
      var empty = !(firstname || lastname || organizationname || address || city || state);
      var preview = empty ? React.createElement(_ItemPreview.default, null, React.createElement(_core.Avatar, null, React.createElement(_icons.LocationOn, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        empty: true
      }, this.props.intl.formatMessage(OrderShippingPersonMessages.name)), React.createElement(_ItemPreview.Line, {
        empty: true
      }, this.props.intl.formatMessage(OrderShippingPersonMessages.address)))) : React.createElement(_ItemPreview.default, null, React.createElement(_core.Avatar, null, React.createElement(_icons.LocationOn, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, this.props.intl.formatMessage(OrderShippingPersonMessages.empty)), React.createElement(_ItemPreview.Line, null, firstname && React.createElement("span", {
        className: "client-fields__item client-fields__item--firstname"
      }, firstname), lastname && React.createElement("span", {
        className: "client-fields__item client-fields__item--lastname"
      }, lastname)), React.createElement(_ItemPreview.Line, null, address && React.createElement("span", {
        className: "client-fields__item client-fields__item--address"
      }, address), postalcode && React.createElement("span", {
        className: "client-fields__item client-fields__item--postalcode"
      }, postalcode), city && React.createElement("span", {
        className: "client-fields__item client-fields__item--city"
      }, city))));

      var open = function open() {
        return _this2.setState(function () {
          return {
            dialogOpened: true
          };
        });
      };

      var close = function close() {
        return _this2.setState(function () {
          return {
            dialogOpened: false
          };
        });
      };

      var currentClient = currentOrder.Client;
      var copy = currentClient ? function () {
        onChange(currentClient);
        enqueueSnackbar( // tslint:disable-next-line:max-line-length
        "Successfully copied Client informations", {
          variant: 'success'
        });
      } : null;
      return React.createElement(React.Fragment, null, React.createElement("div", {
        className: "forms-fields__preview",
        onClick: open
      }, preview), React.createElement(_SideDialog.default, {
        open: dialogOpened,
        onClose: close
      }, React.createElement(_core.DialogContent, null, React.createElement(_PersonFields.default, {
        current: initial,
        onChange: this._handleChange,
        intl: intl,
        hasRights: hasRights
      })), React.createElement(_core.DialogActions, null, copy && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: copy
      }, "copy from Client"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: close
      }, "close"))));
    }
  }, {
    key: "_handleChange",
    value: function _handleChange(changes) {
      var person = _objectSpread({}, this.props.initial, changes);

      this.props.onChange(person);
    }
  }]);

  return OrderShippingPersonFields;
}(React.Component);

var _default = (0, _notistack.withSnackbar)(OrderShippingPersonFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PersonFieldsMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _core = require("@material-ui/core");

var _i18nIsoCountries = _interopRequireDefault(require("i18n-iso-countries"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PersonFieldsMessages = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.forms.person.firstName",
    "defaultMessage": "First Name"
  },
  lastName: {
    "id": "src.components.forms.person.lastName",
    "defaultMessage": "Last Name"
  },
  organizationName: {
    "id": "src.components.forms.person.organizationName",
    "defaultMessage": "Organization Name"
  },
  address: {
    "id": "src.components.forms.person.address",
    "defaultMessage": "Address"
  },
  postalCode: {
    "id": "src.components.forms.person.postalCode",
    "defaultMessage": "Postal Code"
  },
  city: {
    "id": "src.components.forms.person.city",
    "defaultMessage": "City"
  },
  state: {
    "id": "src.components.forms.person.state",
    "defaultMessage": "State"
  },
  country: {
    "id": "src.components.forms.person.country",
    "defaultMessage": "Country"
  },
  cellPhone: {
    "id": "src.components.forms.person.cellPhone",
    "defaultMessage": "Cell Phone"
  },
  phone: {
    "id": "src.components.forms.person.phone",
    "defaultMessage": "Phone"
  },
  email: {
    "id": "src.components.forms.person.email",
    "defaultMessage": "Email"
  }
});
exports.PersonFieldsMessages = PersonFieldsMessages;

var PersonFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PersonFields, _React$Component);

  function PersonFields() {
    _classCallCheck(this, PersonFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(PersonFields).apply(this, arguments));
  }

  _createClass(PersonFields, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          current = _this$props.current,
          onChange = _this$props.onChange,
          formatMessage = _this$props.intl.formatMessage,
          hasRights = _this$props.hasRights;
      current = current || {};

      var countries = _i18nIsoCountries.default.getNames('en');

      var chg = function chg(key) {
        return function (val) {
          return onChange(_defineProperty({}, key, val.target.value));
        };
      };

      var v = function v(key) {
        return current && current[key] || '';
      };

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('FirstName'),
        value: v('FirstName'),
        label: formatMessage(PersonFieldsMessages.firstName),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('LastName'),
        value: v('LastName'),
        label: formatMessage(PersonFieldsMessages.lastName),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('Email'),
        value: v('Email'),
        label: formatMessage(PersonFieldsMessages.email),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('OrganizationName'),
        value: v('OrganizationName'),
        label: formatMessage(PersonFieldsMessages.organizationName),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('Address'),
        value: v('Address'),
        multiline: true,
        label: formatMessage(PersonFieldsMessages.address),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('PostalCode'),
        value: v('PostalCode'),
        label: formatMessage(PersonFieldsMessages.postalCode),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('City'),
        value: v('City'),
        label: formatMessage(PersonFieldsMessages.city),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('State'),
        value: v('State'),
        label: formatMessage(PersonFieldsMessages.state),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('CellPhone'),
        value: v('CellPhone'),
        label: formatMessage(PersonFieldsMessages.cellPhone),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "PersonCountry"
      }, formatMessage(PersonFieldsMessages.country)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: chg('CountryIso'),
        value: v('CountryIso'),
        inputProps: {
          name: 'PersonCountry',
          id: 'PersonCountry'
        },
        disabled: !hasRights
      }, Object.keys(countries).map(function (c) {
        return React.createElement(_core.MenuItem, {
          key: c,
          value: c
        }, countries[c]);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: chg('Phone'),
        value: v('Phone'),
        label: formatMessage(PersonFieldsMessages.phone),
        disabled: !hasRights
      })));
    }
  }]);

  return PersonFields;
}(React.Component);

var _default = PersonFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _PersonFields = _interopRequireDefault(require("./PersonFields"));

var _core = require("@material-ui/core");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PersonForm =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PersonForm, _React$Component);

  function PersonForm(props) {
    var _this;

    _classCallCheck(this, PersonForm);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PersonForm).call(this, props));
    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(PersonForm, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          model = _this$props.model,
          intl = _this$props.intl,
          hasRights = _this$props.hasRights;

      var onChange = function onChange(changes) {
        return _this2.setState(function () {
          return {
            changes: changes
          };
        });
      };

      var changed = !!Object.keys(this.state.changes).length;
      return React.createElement("div", {
        className: "forms forms--person"
      }, React.createElement(_PersonFields.default, {
        current: model,
        onChange: onChange,
        intl: intl,
        hasRights: hasRights
      }), changed && React.createElement(React.Fragment, null, React.createElement(_core.Button, null, "Save"), React.createElement(_core.Button, {
        onClick: function onClick() {
          return _this2.props.onDone();
        }
      }, "Cancel")), !changed && React.createElement(_core.Button, {
        onClick: function onClick() {
          return _this2.props.onDone();
        }
      }, "Close"));
    }
  }]);

  return PersonForm;
}(React.Component);

var _default = PersonForm;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PersonPreview = void 0;

var React = _interopRequireWildcard(require("react"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

var PersonPreview = function PersonPreview(person) {
  var firstname = person.FirstName || '';
  var lastname = person.LastName || '';
  var organizationname = person.OrganizationName || '';
  return React.createElement(React.Fragment, null, firstname && React.createElement("span", {
    className: "person-preview__firstname"
  }, firstname), lastname && React.createElement("span", {
    className: "person-preview__lastname"
  }, lastname), organizationname && React.createElement("span", {
    className: "person-preview__organization-name"
  }, organizationname));
};

exports.PersonPreview = PersonPreview;
var _default = PersonPreview;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.StandalonePriceField = exports.default = exports.PricesField = exports.PriceField = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNumberFormat = _interopRequireDefault(require("react-number-format"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _PricesFieldMessages = _interopRequireDefault(require("./PricesFieldMessages"));

var _reactIntl = require("react-intl");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

// tslint:disable-next-line:no-any
var NumberFormatCustom = function NumberFormatCustom(props) {
  var inputRef = props.inputRef,
      onChange = props.onChange,
      title = props.title,
      other = _objectWithoutProperties(props, ["inputRef", "onChange", "title"]);

  return React.createElement(_reactNumberFormat.default, _extends({}, other, {
    getInputRef: inputRef,
    onValueChange: function onValueChange(values) {
      onChange({
        target: {
          value: values.value
        }
      });
    },
    thousandSeparator: true,
    prefix: "".concat(title, " ")
  }));
};

var PriceField = function PriceField(props) {
  var value = props.value,
      currency = props.currency,
      fieldProps = props.fieldProps;
  return React.createElement(_TextField.default, _extends({
    value: value === null ? '' : value.Value,
    fullWidth: true,
    title: currency.Name,
    onChange: props.onChange ? function (e) {
      var val = e.target.value;

      if (val === '') {
        props.onChange(null);
      }

      props.onChange({
        Value: parseInt(val, 10),
        Currency: currency.Code
      });
    } : undefined,
    inputProps: {
      title: currency.Name,
      placeholder: props.intl.formatMessage(_PricesFieldMessages.default.pricePlaceholder, {
        currency: currency.Code
      })
    },
    InputProps: {
      inputComponent: NumberFormatCustom
    }
  }, fieldProps));
};

exports.PriceField = PriceField;

var PricesField = function PricesField(props) {
  var currencies = props.currencies,
      gridProps = props.gridProps,
      fieldProps = props.fieldProps,
      intl = props.intl;
  return React.createElement(React.Fragment, null, currencies.map(function (currency) {
    var price = props.value.find(function (p) {
      return p.Currency === currency.Code;
    });
    return React.createElement(_Grid.default, _extends({
      key: currency.Code,
      item: true,
      xs: true
    }, gridProps), React.createElement(PriceField, {
      intl: intl,
      onChange: props.onChange ? function (e) {
        var newprices = _toConsumableArray(props.value).filter(function (p) {
          return p.Currency !== currency.Code;
        });

        if (e !== null) {
          newprices.push(e);
        }

        props.onChange(newprices);
      } : undefined,
      value: price || null,
      currency: currency,
      fieldProps: fieldProps
    }));
  }));
};

exports.PricesField = PricesField;
var _default = PricesField;
exports.default = _default;
var StandalonePriceField = (0, _reactIntl.injectIntl)(PricesField);
exports.StandalonePriceField = StandalonePriceField;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  pricePlaceholder: {
    "id": "PricesFieldMessages.pricePlaceholder",
    "defaultMessage": "Price in {currency}"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OrderProducDetailStyles = exports.ProductsViewMessages = void 0;

var _reactIntl = require("react-intl");

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../_services");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _reactSortableHoc = require("react-sortable-hoc");

var _Stock = _interopRequireDefault(require("src/components/Stock/Stock"));

var _core = require("@material-ui/core");

var _PlaylistAdd = _interopRequireDefault(require("@material-ui/icons/PlaylistAdd"));

var _ProductList = _interopRequireDefault(require("../ProductList/ProductList"));

var _icons = require("@material-ui/icons");

var _WarehouseIcon = _interopRequireDefault(require("./WarehouseIcon"));

var _styles = require("@material-ui/core/styles");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var classNames = _interopRequireWildcard(require("classnames"));

var _ProductDetailMessages = _interopRequireDefault(require("./ProductDetailMessages"));

var _SortableListItem = require("src/_helpers/SortableListItem/SortableListItem");

var _ProductFields = _interopRequireDefault(require("../ProductFields/ProductFields"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var ProductsViewMessages = (0, _reactIntl.defineMessages)({
  subItems: {
    "id": "ProductDetail.subItems",
    "defaultMessage": "Sub items"
  },
  addSubItems: {
    "id": "ProductDetail.addSubItem",
    "defaultMessage": "add sub item"
  },
  removeSubItems: {
    "id": "ProductDetail.removeSubItem",
    "defaultMessage": "remove"
  },
  closeSubItem: {
    "id": "ProductDetail.closeSubItem",
    "defaultMessage": "close"
  }
});
exports.ProductsViewMessages = ProductsViewMessages;

var OrderProducDetailStyles = function OrderProducDetailStyles(theme) {
  return {
    warehouseCls: {
      '& path': {
        fill: theme.Colors.gray.primary.main
      }
    },
    SubProductDialogCls: {
      width: '50%',
      left: 'auto'
    },
    SubProductDialogScrollPaperCls: {
      justifyContent: 'flex-end'
    },
    svgIcon: {
      position: 'absolute',
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)'
    },
    svgIconRemove: {
      fontSize: '1rem'
    },
    sortableItem: {
      zIndex: 99999
    }
  };
};

exports.OrderProducDetailStyles = OrderProducDetailStyles;

var Transition = function Transition(direction) {
  return function (props) {
    return React.createElement(_core.Slide, _extends({
      direction: direction
    }, props));
  };
};

var TransitionUp = Transition('up');

var ProductDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductDetail, _React$Component);

  _createClass(ProductDetail, null, [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(props, state) {
      if (props.initial.Id !== state.initial.Id) {
        return {
          changes: props.changes || {},
          initial: props.initial
        };
      }

      return null;
    }
  }]);

  function ProductDetail(props) {
    var _this;

    _classCallCheck(this, ProductDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductDetail).call(this, props));
    _this._handleMoveItem = _this._handleMoveItem.bind(_assertThisInitialized(_this));
    _this._OnSave = _this._OnSave.bind(_assertThisInitialized(_this));
    _this._OnDelete = _this._OnDelete.bind(_assertThisInitialized(_this));
    _this._addFromProduct = _this._addFromProduct.bind(_assertThisInitialized(_this));
    _this._addEmpty = _this._addEmpty.bind(_assertThisInitialized(_this));
    _this._handelOpen = _this._handelOpen.bind(_assertThisInitialized(_this));
    _this._handelClose = _this._handelClose.bind(_assertThisInitialized(_this));
    var _this$props = _this.props,
        changes = _this$props.changes,
        initial = _this$props.initial;
    _this.state = {
      changes: changes || {},
      initial: initial,
      openSubProduct: {}
    };
    return _this;
  }

  _createClass(ProductDetail, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          initial = _this$state.initial,
          changes = _this$state.changes,
          openDialog = _this$state.openDialog,
          openSubProductSelector = _this$state.openSubProductSelector,
          openSubProduct = _this$state.openSubProduct;
      var _this$props2 = this.props,
          settingsCtx = _this$props2.settingsCtx,
          warehouseCtx = _this$props2.warehouseCtx,
          cancel = _this$props2.cancel,
          intl = _this$props2.intl,
          categoryCtx = _this$props2.categoryCtx,
          productCtx = _this$props2.productCtx,
          classes = _this$props2.classes,
          authCtx = _this$props2.authCtx,
          user = _this$props2.authCtx.user;

      var preview = _objectSpread({}, initial, changes);

      var changed = !!Object.keys(this.state.changes).length;
      var hasID = !!preview.Id;
      var subProducts = preview.Products || [];
      var skus = [];
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Products');

      var addSKU = function addSKU(p) {
        var SKU = p.SKU,
            Options = p.Options;

        if (SKU) {
          skus.push({
            sku: SKU,
            legend: p.Title
          });
        }

        if (Options && Options.length) {
          var optionsSKU = Options.filter(function (o) {
            return o.SKU;
          }).map(function (o) {
            return {
              sku: o.SKU,
              legend: "".concat(p.Title, " ").concat(o.Title)
            };
          });
          skus.push.apply(skus, _toConsumableArray(optionsSKU));
        }
      };

      addSKU(preview);
      subProducts.forEach(addSKU);
      return React.createElement(_DetailGridContainer.default, null, React.createElement(_DetailGridColumn.default, null, React.createElement(_ProductFields.default, _extends({
        settingsCtx: settingsCtx,
        intl: intl,
        initial: initial,
        changes: changes,
        categoryCtx: categoryCtx,
        authCtx: authCtx
      }, {
        onChange: function onChange(product) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, product)
            };
          });
        }
      }))), React.createElement(_DetailGridColumn.default, null, React.createElement(_SortableListItem.SortableListItemsContainer, {
        onSortEnd: this._handleMoveItem,
        pressDelay: 200,
        helperClass: classes.sortableItem
      }, subProducts.map(function (sp, i) {
        var subProductSku = sp.SKU || '';
        var spBasePrice = sp.BasePrice || [];
        var Settings = _this2.props.settingsCtx.Settings;
        var defaultCurrency = Settings.Currencies.find(function () {
          return true;
        }) || 'EUR';
        var price = spBasePrice.find(function (p) {
          return p.Currency === defaultCurrency;
        }) || spBasePrice.find(function () {
          return true;
        });

        var open = function open() {
          return _this2.setState(function () {
            return {
              openSubProduct: _objectSpread({}, openSubProduct, _defineProperty({}, sp.Id, true))
            };
          });
        };

        var close = function close() {
          return _this2.setState(function () {
            return {
              openSubProduct: _objectSpread({}, openSubProduct, _defineProperty({}, sp.Id, false))
            };
          });
        };

        var actionDelete = React.createElement(_core.IconButton, {
          className: "order-items-fields__delete",
          onClick: function onClick() {
            return _this2._handleRemoveItem(sp.Id);
          }
        }, React.createElement(_icons.Close, {
          className: classNames(classes.svgIcon, classes.svgIconRemove)
        }));
        return React.createElement(_SortableListItem.SortableListItem, {
          key: "".concat(i),
          index: i
        }, React.createElement(_core.Grid, {
          item: true,
          xs: 12,
          key: "".concat(sp.Title, "-").concat(i)
        }, React.createElement(_ItemPreview.default, null, sp.Src && React.createElement(_ItemPreview.Thumb, {
          src: sp.Src,
          onClick: open
        }), React.createElement(_ItemPreview.Lines, {
          onClick: open
        }, React.createElement(_ItemPreview.Line, {
          isTitle: true
        }, sp.Title), subProductSku && React.createElement(_ItemPreview.Line, null, subProductSku)), React.createElement(_ItemPreview.Lines, {
          actions: true
        }, React.createElement(_ItemPreview.Line, {
          isTitle: true
        }, price && React.createElement("span", {
          className: "products__preview-price"
        }, React.createElement(_reactIntl.FormattedNumber, {
          style: "currency",
          currency: price.Currency,
          value: price.Value
        }))), React.createElement(_ItemPreview.Line, null, hasRights && actionDelete)))), React.createElement(_SideDialog.default, {
          onClose: close,
          key: sp.Id,
          open: !!openSubProduct[sp.Id]
        }, React.createElement(_core.DialogContent, null, React.createElement(_ProductFields.default, _extends({
          settingsCtx: settingsCtx,
          intl: intl,
          categoryCtx: categoryCtx,
          authCtx: authCtx
        }, {
          subProduct: true,
          initial: sp,
          changes: sp,
          onChange: function onChange(p) {
            _this2._handleItemChange(sp.Id, p);
          },
          key: sp.Id
        }))), React.createElement(_core.DialogActions, null, hasRights && React.createElement(_core.Button, {
          size: "small",
          color: "secondary",
          variant: "contained",
          onClick: function onClick() {
            return _this2._handleRemoveItem(sp.Id);
          }
        }, React.createElement(_reactIntl.FormattedMessage, ProductsViewMessages.removeSubItems), React.createElement(_icons.Delete, null)), React.createElement(_core.Button, {
          size: "small",
          color: "default",
          variant: "contained",
          onClick: close
        }, React.createElement(_reactIntl.FormattedMessage, ProductsViewMessages.closeSubItem)))));
      }), hasRights && React.createElement(React.Fragment, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_GridContainer.GridContainer, {
        justify: "center",
        spacing: 8
      }, React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: function onClick() {
          return _this2.setState(function () {
            return {
              openSubProductSelector: true
            };
          });
        }
      }, React.createElement(_reactIntl.FormattedMessage, ProductsViewMessages.addSubItems), React.createElement(_PlaylistAdd.default, {
        style: {
          paddingLeft: '7px'
        }
      })))), React.createElement(_core.Dialog, {
        fullScreen: true,
        TransitionComponent: TransitionUp,
        open: !!openSubProductSelector
      }, React.createElement(_ProductList.default, {
        productCtx: productCtx,
        warehouseCtx: warehouseCtx,
        intl: intl,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        onClick: this._addFromProduct
      }), React.createElement(_Fabs.default, {
        map: [{
          icon: React.createElement(_icons.Add, null),
          onClick: this._addEmpty
        }, {
          icon: React.createElement(_icons.Close, null),
          onClick: function onClick() {
            return _this2.setState(function () {
              return {
                openSubProductSelector: false
              };
            });
          }
        }]
      }))))), skus.length > 0 && React.createElement(_core.Dialog, {
        maxWidth: "lg",
        open: !!openDialog,
        onClose: this._handelClose
      }, React.createElement(_core.DialogContent, null, React.createElement(_Stock.default, _extends({
        settingsCtx: settingsCtx,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx
      }, {
        skus: skus
      }))), React.createElement(_core.DialogActions, null, React.createElement(_core.Button, {
        variant: "contained",
        color: "default",
        onClick: this._handelClose
      }, "Close"))), React.createElement(_Fabs.default, {
        map: [hasRights && changed && {
          icon: React.createElement(_icons.Check, null),
          legend: 'save',
          themeColor: 'green',
          onClick: this._OnSave
        }, skus.length > 0 && {
          icon: React.createElement(_WarehouseIcon.default, null),
          legend: 'stocks',
          themeColor: 'gray',
          onClick: this._handelOpen
        }, {
          icon: React.createElement(_icons.Close, null),
          legend: changed ? 'cancel' : 'close',
          themeColor: 'gray',
          onClick: cancel
        }, hasRights && hasID && {
          icon: React.createElement(_icons.Delete, null),
          legend: 'delete product',
          themeColor: 'red',
          onClick: this._OnDelete
        }]
      }));
    }
  }, {
    key: "_handleMoveItem",
    value: function _handleMoveItem(sortEnd) {
      var preview = _objectSpread({}, this.state.initial, this.state.changes);

      var subProducts = preview.Products || [];
      var newSubProducts = (0, _reactSortableHoc.arrayMove)(subProducts, sortEnd.oldIndex, sortEnd.newIndex);

      this._OnChange({
        Products: newSubProducts
      });
    }
  }, {
    key: "_addFromProduct",
    value: function _addFromProduct(product) {
      var _this$state2 = this.state,
          initial = _this$state2.initial,
          changes = _this$state2.changes;

      var preview = _objectSpread({}, initial, changes);

      this._OnChange({
        Products: [].concat(_toConsumableArray(preview.Products || []), [// tslint:disable-next-line:no-any
        _objectSpread({}, product, {
          Products: undefined,
          Id: undefined
        })])
      });

      this.setState(function () {
        return {
          openSubProductSelector: false
        };
      });
    }
  }, {
    key: "_addEmpty",
    value: function _addEmpty() {
      var _this3 = this;

      var _this$state3 = this.state,
          initial = _this$state3.initial,
          changes = _this$state3.changes;

      var preview = _objectSpread({}, initial, changes);

      var subProducts = preview.Products || []; // const newUID = shortid();
      // todo: localization

      _services.Products.Empty('new product', {}).then(function (newProduct) {
        var newItems = [].concat(_toConsumableArray(subProducts), [newProduct]);

        _this3._OnChange({
          Products: newItems
        });

        _this3.setState(function () {
          return {
            openSubProductSelector: false
          };
        });
      });
    }
  }, {
    key: "_handleRemoveItem",
    value: function _handleRemoveItem(id) {
      var preview = _objectSpread({}, this.state.initial, this.state.changes);

      var subProducts = preview.Products || [];

      var newItems = _toConsumableArray(subProducts);

      var index = newItems.findIndex(function (i) {
        return i.Id === id;
      });

      if (index < 0) {
        return;
      } else {
        newItems.splice(index, 1);
      }

      this._OnChange({
        Products: newItems
      });
    }
  }, {
    key: "_handleItemChange",
    value: function _handleItemChange(id, value) {
      var preview = _objectSpread({}, this.state.initial, this.state.changes);

      var subProducts = preview.Products || [];

      var newItems = _toConsumableArray(subProducts);

      var index = newItems.findIndex(function (i) {
        return i.Id === id;
      });

      if (index < 0) {
        newItems.push(value);
      } else {
        newItems[index] = _objectSpread({}, newItems[index], value);
      }

      this._OnChange({
        Products: newItems
      });
    }
  }, {
    key: "_OnChange",
    value: function _OnChange(changes) {
      this.setState(function (prev) {
        return {
          changes: _objectSpread({}, prev.changes, changes)
        };
      });
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete() {
      var _this4 = this;

      var _this$props3 = this.props,
          Id = _this$props3.initial.Id,
          formatMessage = _this$props3.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_ProductDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        _services.Products.Delete(Id).then(function () {
          _this4.props.onDelete();
        });
      }
    }
  }, {
    key: "_handelOpen",
    value: function _handelOpen() {
      this.setState({
        openDialog: true
      });
    }
  }, {
    key: "_handelClose",
    value: function _handelClose() {
      this.setState({
        openDialog: false
      });
    }
  }, {
    key: "_UploadBlobs",
    value: function _UploadBlobs(product) {
      var _this5 = this;

      var products = product.Products || [];
      var blob = product.Blob;
      return Promise.all((products || []).map(function (p) {
        return _this5._UploadBlobs(p);
      })).then(function (v) {
        if (!blob) {
          return Promise.resolve(_objectSpread({}, product, {
            Products: v
          }));
        }

        var data = new FormData();
        data.set('image', blob);
        return _services.ServerStorage.Post(data).then(function (result) {
          product.Src = "".concat(result.image);
          delete product.Blob;
          return product;
        });
      });
    }
  }, {
    key: "_OnSave",
    value: function _OnSave() {
      var _this6 = this;

      var save = function save(saveChanges) {
        if (_this6.state.initial.Id) {
          return _services.Products.Patch(_this6.props.initial.Id, _this6.state.changes).then(function (model) {
            _this6.setState(function (prev) {
              return _objectSpread({}, prev, {
                changes: {},
                preview: model,
                initial: model
              });
            });

            _this6.props.changed(model);
          });
        } else {
          return _services.Products.Create(saveChanges).then(function (model) {
            _this6.setState(function (prev) {
              return _objectSpread({}, prev, {
                changes: {},
                preview: model,
                initial: model
              });
            });

            _this6.props.changed(model);
          });
        }
      };

      this._UploadBlobs(this.state.changes).then(save);
    }
  }]);

  return ProductDetail;
}(React.Component);

var _default = (0, _styles.withStyles)(OrderProducDetailStyles)(ProductDetail);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ProductDetailMessages = void 0;

var _reactIntl = require("react-intl");

var ProductDetailMessages = (0, _reactIntl.defineMessages)({
  deleteConfirm: {
    "id": "src.components.prodcuts.productDetail.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this product?"
  }
});
exports.ProductDetailMessages = ProductDetailMessages;
var _default = ProductDetailMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.WarehouseIcon = void 0;

var React = _interopRequireWildcard(require("react"));

var _SvgIcon = _interopRequireDefault(require("@material-ui/core/SvgIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* tslint:disable:max-line-length */
var WarehouseIcon = function WarehouseIcon(props) {
  return React.createElement(_SvgIcon.default, _objectSpread({
    viewBox: '0 0 640 512'
  }, props), React.createElement("path", {
    d: "M504,352H136.4c-4.4,0-8,3.6-8,8l-0.1,48c0,4.4,3.6,8,8,8H504c4.4,0,8-3.6,8-8v-48C512,355.6,508.4,352,504,352z"
  }), React.createElement("path", {
    d: "M504,448H136.1c-4.4,0-8,3.6-8,8l-0.1,48c0,4.4,3.6,8,8,8h368c4.4,0,8-3.6,8-8v-48C512,451.6,508.4,448,504,448z"
  }), React.createElement("path", {
    d: "M504,256H136.6c-4.4,0-8,3.6-8,8l-0.1,48c0,4.4,3.6,8,8,8H504c4.4,0,8-3.6,8-8v-48C512,259.6,508.4,256,504,256z"
  }), React.createElement("path", {
    d: "M610.5,117L338.4,3.7c-11.8-4.9-25.1-4.9-36.9,0L29.5,117C11.7,124.5,0,141.9,0,161.3V504c0,4.4,3.6,8,8,8h80c4.4,0,8-3.6,8-8V256c0-17.6,14.6-32,32.6-32h382.8c18,0,32.6,14.4,32.6,32v248c0,4.4,3.6,8,8,8h80c4.4,0,8-3.6,8-8V161.3C640,141.9,628.3,124.5,610.5,117z"
  }));
};

exports.WarehouseIcon = WarehouseIcon;
var _default = WarehouseIcon;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _reactDropzone = _interopRequireDefault(require("react-dropzone"));

var React = _interopRequireWildcard(require("react"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _ExpansionPanel = _interopRequireDefault(require("@material-ui/core/ExpansionPanel"));

var _ExpandMore = _interopRequireDefault(require("@material-ui/icons/ExpandMore"));

var _ExpansionPanelSummary = _interopRequireDefault(require("@material-ui/core/ExpansionPanelSummary"));

var _ExpansionPanelDetails = _interopRequireDefault(require("@material-ui/core/ExpansionPanelDetails"));

var _PlaylistAdd = _interopRequireDefault(require("@material-ui/icons/PlaylistAdd"));

var _Delete = _interopRequireDefault(require("@material-ui/icons/Delete"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _colorHash = _interopRequireDefault(require("color-hash"));

var _ProductFieldsMessages = _interopRequireDefault(require("./ProductFieldsMessages"));

var _core = require("@material-ui/core");

var _ProductFieldsOption = _interopRequireDefault(require("./ProductFieldsOption"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _PricesField = _interopRequireDefault(require("src/components/PricesField/PricesField"));

var _NumberField = _interopRequireDefault(require("src/components/NumberField/NumberField"));

var _roles = require("src/_helpers/roles");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ProductFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductFields, _React$Component);

  function ProductFields(props) {
    var _this;

    _classCallCheck(this, ProductFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductFields).call(this, props));
    _this._onDrop = _this._onDrop.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(ProductFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          intl = _this$props.intl,
          initial = _this$props.initial,
          classes = _this$props.classes,
          changes = _this$props.changes,
          user = _this$props.authCtx.user,
          settingsCtx = _this$props.settingsCtx,
          subProduct = _this$props.subProduct,
          categoryCtx = _this$props.categoryCtx,
          _this$props$settingsC = _this$props.settingsCtx.Settings,
          ShowWeight = _this$props$settingsC.ShowWeight,
          ShowTaxRateExcluded = _this$props$settingsC.ShowTaxRateExcluded,
          ShowTaxRateIncluded = _this$props$settingsC.ShowTaxRateIncluded;

      var preview = _objectSpread({}, initial, changes);

      var currencies = settingsCtx.Settings.Currencies;
      var sku = preview.SKU || '';
      var title = preview.Title || '';
      var basePrice = preview.BasePrice || [];
      var weight = preview.Weight;
      var minQuantity = preview.MinQuantity;
      var maxQuantity = preview.MaxQuantity;
      var taxRateExcluded = preview.TaxRateExcluded;
      var taxRateIncluded = preview.TaxRateIncluded;
      var NeedsDispatch = preview.NeedsDispatch;
      var categories = preview.Categories || [];
      var description = preview.Description || '';
      var colorHash = new _colorHash.default();
      var options = preview.Options;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Products');
      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_ItemPreview.default, {
        noDividers: true
      }, React.createElement(_ItemPreview.Thumb, {
        src: preview.Src,
        style: {
          backgroundColor: colorHash.hex(preview.Id)
        }
      }, React.createElement(_reactDropzone.default, {
        className: classes.dropZone,
        onDrop: this._onDrop,
        disabled: !hasRights
      }, React.createElement("label", {
        className: classes.dropZoneLabel
      }))), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
        className: 'forms-fields'
      }, React.createElement(_GridContainer.GridContainer, null, React.createElement(_Grid.default, {
        item: true,
        xs: 9
      }, React.createElement(_TextField.default, {
        onChange: this._handleChange('Title'),
        value: title,
        fullWidth: true,
        label: intl.formatMessage(_ProductFieldsMessages.default.title),
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 3
      }, React.createElement(_TextField.default, {
        onChange: this._handleChange('SKU'),
        value: sku,
        fullWidth: true,
        label: intl.formatMessage(_ProductFieldsMessages.default.sku),
        disabled: !hasRights
      }))))))), React.createElement(_PricesField.default, {
        gridProps: {
          xs: Math.max(4, 12 / currencies.length)
        },
        intl: this.props.intl,
        onChange: function onChange(value) {
          return _this2._OnChange({
            BasePrice: value
          });
        },
        value: basePrice,
        currencies: currencies,
        fieldProps: {
          disabled: !hasRights
        }
      }), ShowWeight && React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_NumberField.default, {
        label: intl.formatMessage(_ProductFieldsMessages.default.weight),
        value: weight === null ? '' : weight,
        step: "0.01",
        fullWidth: true,
        onNumberChange: function onNumberChange(w) {
          _this2._OnChange({
            Weight: w
          });
        },
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_ProductFieldsMessages.default.minQuantity),
        value: minQuantity === null ? '' : minQuantity,
        type: "number",
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var min = val === '' ? null : parseInt(val, 10);

          _this2._OnChange({
            MinQuantity: min
          });
        },
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        label: intl.formatMessage(_ProductFieldsMessages.default.maxQuantity),
        value: maxQuantity === null ? '' : maxQuantity,
        type: "number",
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;
          var max = val === '' ? null : parseInt(val, 10);

          _this2._OnChange({
            MaxQuantity: max
          });
        },
        disabled: !hasRights
      })), ShowTaxRateIncluded && React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_NumberField.default, {
        label: intl.formatMessage(_ProductFieldsMessages.default.taxRateIncluded),
        value: taxRateIncluded === null ? '' : taxRateIncluded,
        step: "0.01",
        fullWidth: true,
        onNumberChange: function onNumberChange(w) {
          _this2._OnChange({
            TaxRateIncluded: w
          });
        },
        disabled: !hasRights
      })), ShowTaxRateExcluded && React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_NumberField.default, {
        label: intl.formatMessage(_ProductFieldsMessages.default.taxRateExcluded),
        value: taxRateExcluded === null ? '' : taxRateExcluded,
        step: "0.01",
        fullWidth: true,
        onNumberChange: function onNumberChange(w) {
          _this2._OnChange({
            TaxRateExcluded: w
          });
        },
        disabled: !hasRights
      })), React.createElement(_Grid.default, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!NeedsDispatch,
          onChange: function onChange(e) {
            return _this2.props.onChange(_objectSpread({}, changes, {
              NeedsDispatch: e.target.checked
            }));
          },
          color: "primary",
          disabled: !hasRights
        }),
        label: intl.formatMessage(_ProductFieldsMessages.default.needsDispatch)
      })), !subProduct && React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "select-categories"
      }, React.createElement(_reactIntl.FormattedMessage, _ProductFieldsMessages.default.categories)), React.createElement(_core.Select, {
        fullWidth: true,
        multiple: true,
        value: categories,
        disabled: !hasRights // tslint:disable-next-line:no-any
        ,
        onChange: function onChange(e) {
          return _this2._OnChange({
            Categories: e.target.value
          });
        },
        input: React.createElement(_core.Input, {
          id: "select-categories"
        }),
        renderValue: function renderValue(cats) {
          return React.createElement("div", {
            style: {
              display: 'flex',
              flexWrap: 'wrap'
            }
          }, cats.map(function (value) {
            var cat = categoryCtx.Categories.find(function (c) {
              return c.Id === value;
            });
            return cat ? React.createElement(_core.Chip, {
              key: cat.Id,
              label: cat.Title,
              style: {
                marginRight: '5px'
              }
            }) : null;
          }));
        }
      }, categoryCtx.Categories.map(function (cat) {
        var selected = categories.indexOf(cat.Id) >= 0;
        return React.createElement(_core.MenuItem, {
          key: cat.Id,
          value: cat.Id,
          style: {
            fontWeight: selected ? 'bold' : 'inherit'
          }
        }, cat.Title);
      })))), React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_TextField.default, {
        onChange: this._handleChange('Description'),
        multiline: true,
        fullWidth: true,
        value: description,
        label: intl.formatMessage(_ProductFieldsMessages.default.description),
        disabled: !hasRights
      })), options && options.length > 0 && React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, options && options.map(function (option, i) {
        return _this2._renderOption(options, option, i);
      })), hasRights && React.createElement(_Grid.default, {
        item: true,
        xs: 12
      }, React.createElement(_GridContainer.GridContainer, {
        justify: "center"
      }, React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: function onClick() {
          return _this2._addOption(options || []);
        }
      }, React.createElement(_reactIntl.FormattedMessage, _ProductFieldsMessages.default.addOption), React.createElement(_PlaylistAdd.default, {
        style: {
          paddingLeft: '7px'
        }
      })))));
    }
  }, {
    key: "_handleChange",
    value: function _handleChange(name) {
      var _this3 = this;

      return function (e) {
        _this3.props.onChange(_defineProperty({}, name, e.target.value));
      };
    }
  }, {
    key: "_renderOption",
    value: function _renderOption(list, current, index) {
      var _this4 = this;

      var _this$props2 = this.props,
          settingsCtx = _this$props2.settingsCtx,
          intl = _this$props2.intl;
      var expandedIndex = this.state.expandedIndex;
      var expanded = expandedIndex === index;
      return React.createElement(_ExpansionPanel.default, {
        key: index,
        expanded: expanded,
        onChange: function onChange() {
          return _this4.setState(function () {
            return {
              expandedIndex: expanded ? undefined : index
            };
          });
        }
      }, React.createElement(_ExpansionPanelSummary.default, {
        expandIcon: React.createElement(_ExpandMore.default, null)
      }, React.createElement("div", null, current.Title)), React.createElement(_ExpansionPanelDetails.default, null, React.createElement(_ProductFieldsOption.default, {
        settingsCtx: settingsCtx,
        intl: intl,
        option: current,
        onChanged: function onChanged(l) {
          return _this4._changeOption(list, index, l);
        }
      })), React.createElement(_core.Divider, null), React.createElement(_core.ExpansionPanelActions, null, React.createElement(_core.Button, {
        size: "small",
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this4._removeOption(list, index);
        }
      }, React.createElement(_reactIntl.FormattedMessage, _ProductFieldsMessages.default.removeOption), React.createElement(_Delete.default, null))));
    }
  }, {
    key: "_changeOption",
    value: function _changeOption(current, optionIndex, change) {
      var Options = current.map(function (o, i) {
        return i !== optionIndex ? o : _objectSpread({}, o, change);
      });
      this.props.onChange({
        Options: Options
      });
    }
  }, {
    key: "_removeOption",
    value: function _removeOption(current, optionIndex) {
      var Options = current.filter(function (o, i) {
        return i !== optionIndex;
      });
      this.props.onChange({
        Options: Options
      });
    }
  }, {
    key: "_addOption",
    value: function _addOption(current) {
      var formatMessage = this.props.intl.formatMessage;
      var emptyOptionTitle = _ProductFieldsMessages.default.emptyOptionTitle;
      var emptyOption = {
        Title: formatMessage(emptyOptionTitle, {
          number: current.length + 1
        }),
        Id: '',
        Src: '',
        SKU: '',
        BasePrice: []
      };
      var Options = [].concat(_toConsumableArray(current), [emptyOption]);
      this.setState(function () {
        return {
          expandedIndex: Options.length - 1
        };
      });
      this.props.onChange({
        Options: Options
      });
    }
  }, {
    key: "_onDrop",
    value: function _onDrop(acceptedFiles) {
      var _this5 = this;

      var first = acceptedFiles[0];

      if (!first) {
        return;
      }

      var reader = new FileReader();

      reader.onload = function () {
        if (reader.result) {
          _this5.props.onChange({
            Src: reader.result
          });
        }
      }; // tslint:disable-next-line:no-console


      reader.onabort = function () {
        return console.log('file reading was aborted');
      }; // tslint:disable-next-line:no-console


      reader.onerror = function () {
        return console.log('file reading has failed');
      };

      reader.readAsDataURL(first);
      this.props.onChange({
        Blob: acceptedFiles[0]
      });
    }
  }, {
    key: "_OnChange",
    value: function _OnChange(change) {
      this.props.onChange(change);
    }
  }]);

  return ProductFields;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    dropZone: {
      width: '100%',
      height: '100%'
    },
    dropZoneNoImage: {},
    dropZoneLabel: {
      width: '100%',
      height: '100%'
    }
  };
})(ProductFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  items: {
    "id": "src.view.productsView.fields.items",
    "defaultMessage": "Items"
  },
  subItems: {
    "id": "src.view.productsView.fields.subItems",
    "defaultMessage": "Sub items"
  },
  sku: {
    "id": "src.view.productsView.fields.sku",
    "defaultMessage": "SKU"
  },
  description: {
    "id": "src.view.productsView.fields.description",
    "defaultMessage": "Description"
  },
  title: {
    "id": "src.view.productsView.fields.title",
    "defaultMessage": "Title"
  },
  price: {
    "id": "src.view.productsView.fields.price",
    "defaultMessage": "Base price"
  },
  weight: {
    "id": "src.view.productsView.fields.weight",
    "defaultMessage": "Weight"
  },
  minQuantity: {
    "id": "src.view.productsView.fields.minQuantity",
    "defaultMessage": "Min Quantity"
  },
  maxQuantity: {
    "id": "src.view.productsView.fields.maxQuantity",
    "defaultMessage": "Max Quantity"
  },
  taxRateExcluded: {
    "id": "src.view.productsView.fields.taxRateExcluded",
    "defaultMessage": "Tax rate excluded"
  },
  taxRateIncluded: {
    "id": "src.view.productsView.fields.taxRateIncluded",
    "defaultMessage": "Tax rate included"
  },
  applyGlobalTaxes: {
    "id": "src.view.productsView.fields.applyGlobalTaxes",
    "defaultMessage": "apply Global Taxes"
  },
  categories: {
    "id": "src.view.productsView.fields.categories",
    "defaultMessage": "Categories"
  },
  optionTitle: {
    "id": "src.view.productsView.fields.optionTitle",
    "defaultMessage": "Name"
  },
  optionSKU: {
    "id": "src.view.productsView.fields.optionSKU",
    "defaultMessage": "SKU"
  },
  optionId: {
    "id": "src.view.productsView.fields.optionId",
    "defaultMessage": "Id"
  },
  optionPrice: {
    "id": "src.view.productsView.fields.optionPrice",
    "defaultMessage": "Price"
  },
  optionRemoveOption: {
    "id": "src.view.productsView.fields.optionRemoveOption",
    "defaultMessage": "remove"
  },
  optionAddOption: {
    "id": "src.view.productsView.fields.optionAddOption",
    "defaultMessage": "add option"
  },
  emptyOptionTitle: {
    "id": "src.view.productsView.fields.emptyOptionTitle",
    "defaultMessage": "option #{number}"
  },
  optionListTitle: {
    "id": "src.view.productsView.fields.optionListTitle",
    "defaultMessage": "Set name"
  },
  addOption: {
    "id": "src.view.productsView.fields.addOption",
    "defaultMessage": "Add option"
  },
  removeOption: {
    "id": "src.view.productsView.fields.removeOption",
    "defaultMessage": "Remove"
  },
  needsDispatch: {
    "id": "src.view.productsView.fields.needsDispatch",
    "defaultMessage": "Needs Dispatch"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ProductFieldsOption = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactDropzone = _interopRequireDefault(require("react-dropzone"));

var _Grid = _interopRequireDefault(require("@material-ui/core/Grid"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _ProductFieldsMessages = _interopRequireDefault(require("./ProductFieldsMessages"));

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _PricesField = _interopRequireDefault(require("src/components/PricesField/PricesField"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ProductFieldsOption = function ProductFieldsOption(props) {
  var option = props.option,
      onChanged = props.onChanged,
      intl = props.intl,
      settingsCtx = props.settingsCtx;
  var Id = option.Id,
      Title = option.Title,
      BasePrice = option.BasePrice,
      SKU = option.SKU,
      Src = option.Src;
  var dropClassName = "product-fields__image-drop ".concat(Src ? '' : 'product-fields__image-drop--no-src');

  var onDrop = function onDrop(acceptedFiles) {
    var first = acceptedFiles[0];

    if (!first) {
      return;
    }

    var reader = new FileReader();

    reader.onload = function () {
      if (reader.result) {
        onChanged(_objectSpread({}, option, {
          Src: reader.result
        }));
      }
    }; // tslint:disable-next-line:no-console


    reader.onabort = function () {
      return console.log('file reading was aborted');
    }; // tslint:disable-next-line:no-console


    reader.onerror = function () {
      return console.log('file reading has failed');
    };

    reader.readAsDataURL(first);
    onChanged(_objectSpread({}, option, {
      Blob: acceptedFiles[0]
    }));
  };

  return React.createElement(_ItemPreview.default, {
    noDividers: true
  }, React.createElement(_ItemPreview.Thumb, {
    src: Src,
    style: {
      backgroundColor: '#ddd'
    }
  }, React.createElement(_reactDropzone.default, {
    className: dropClassName,
    onDrop: onDrop
  })), React.createElement(_ItemPreview.Lines, null, React.createElement(_GridContainer.GridContainer, {
    spacing: 24
  }, React.createElement(_Grid.default, {
    item: true,
    xs: 6
  }, React.createElement(_TextField.default, {
    onChange: function onChange(e) {
      return onChanged(_objectSpread({}, option, {
        Title: e.target.value
      }));
    },
    value: Title || '',
    fullWidth: true,
    label: intl.formatMessage(_ProductFieldsMessages.default.optionTitle)
  })), React.createElement(_Grid.default, {
    item: true,
    xs: 3
  }, React.createElement(_TextField.default, {
    onChange: function onChange(e) {
      return onChanged(_objectSpread({}, option, {
        Id: e.target.value
      }));
    },
    value: Id || '',
    fullWidth: true,
    label: intl.formatMessage(_ProductFieldsMessages.default.optionId)
  })), React.createElement(_Grid.default, {
    item: true,
    xs: 3
  }, React.createElement(_TextField.default, {
    onChange: function onChange(e) {
      return onChanged(_objectSpread({}, option, {
        SKU: e.target.value
      }));
    },
    value: SKU || '',
    fullWidth: true,
    label: intl.formatMessage(_ProductFieldsMessages.default.optionSKU)
  })), React.createElement(_PricesField.default, {
    gridProps: {
      xs: Math.max(4, 12 / settingsCtx.Settings.Currencies.length)
    },
    intl: intl,
    onChange: function onChange(value) {
      return onChanged(_objectSpread({}, option, {
        BasePrice: value
      }));
    },
    value: BasePrice || [],
    currencies: settingsCtx.Settings.Currencies
  }))));
};

exports.ProductFieldsOption = ProductFieldsOption;
var _default = ProductFieldsOption;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ProductList = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../_services");

var classNames = _interopRequireWildcard(require("classnames"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _core = require("@material-ui/core");

var _styles = require("@material-ui/core/styles");

var _ProductListPreview = _interopRequireDefault(require("../ProductListPreview/ProductListPreview"));

var _reactVirtualized = require("react-virtualized");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var COL_NUMBER = 4;

var ProductList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductList, _React$Component);

  function ProductList(props) {
    var _this;

    _classCallCheck(this, ProductList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductList).call(this, props));
    _this.state = {
      list: []
    };
    return _this;
  }

  _createClass(ProductList, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          categoryCtx = _this$props.categoryCtx,
          products = _this$props.productCtx.products,
          classes = _this$props.classes;
      var _this$state = this.state,
          category = _this$state.category,
          query = _this$state.query;

      var list = this._getList();

      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classNames(classes.menu)
      }, React.createElement(_core.ListItem, {
        button: true,
        onClick: function onClick() {
          return _this2.setState(function () {
            return {
              category: undefined
            };
          });
        },
        className: classNames(classes.menuItem, category === undefined && classes.menuItemActive)
      }, React.createElement(_core.ListItemText, null, "All"), React.createElement("span", {
        className: classNames(classes.categoryCount, category === undefined && classes.categoryCountActive)
      }, products.filter(function (p) {
        return _this2._filterQuery(query)(p);
      }).length)), categoryCtx.Categories.map(function (c) {
        return React.createElement(_core.ListItem, {
          key: "category-".concat(c.Id),
          button: true,
          onClick: function onClick() {
            return _this2._setCategory(c);
          },
          className: classNames(classes.menuItem, category === c && classes.menuItemActive)
        }, React.createElement(_core.ListItemText, null, c.Title), React.createElement("span", {
          className: classes.categoryCount
        }, products.filter(function (p) {
          return p.Categories && p.Categories.indexOf(c.Id) >= 0;
        }).filter(function (p) {
          return _this2._filterQuery(query)(p);
        }).length));
      }), React.createElement(_core.ListItem, {
        key: "search",
        className: classNames(classes.menuItem, query && classes.menuItemActive, classes.menuItemLast)
      }, React.createElement(_core.TextField, {
        label: "Search",
        value: query || '',
        type: "search",
        fullWidth: true,
        onChange: function onChange(e) {
          var val = e.target.value;

          _this2.setState(function () {
            return {
              query: val
            };
          });
        }
      })))), React.createElement(_core.Grid, {
        item: true,
        className: classes.productsContainer
      }, React.createElement("div", {
        className: classes.productsInner
      }, React.createElement(_reactVirtualized.AutoSizer, null, function (_ref) {
        var width = _ref.width,
            height = _ref.height;
        var w = width - 20;
        return React.createElement(_reactVirtualized.Grid, {
          columnCount: COL_NUMBER,
          columnWidth: Math.floor(w / COL_NUMBER),
          cellRenderer: function cellRenderer(cellRendererProps) {
            return _this2._cellRenderer(cellRendererProps, list);
          } // className={styles.collection}
          ,
          height: height,
          rowCount: Math.ceil(list.length / COL_NUMBER),
          rowHeight: Math.floor(w / COL_NUMBER) + 30 // scrollToCell={scrollToCell}
          ,
          width: width,
          style: {
            outline: 'none'
          }
        });
      }))));
    }
  }, {
    key: "_filterQuery",
    value: function _filterQuery(query) {
      return function (p) {
        if (!query) {
          return true;
        }

        var elts = query.split(' ');
        return elts.every(function (e) {
          return p.Title.toLowerCase().indexOf(e.toLowerCase()) >= 0 || p.SKU !== undefined && p.SKU.toLowerCase().indexOf(e.toLowerCase()) >= 0;
        });
      };
    }
  }, {
    key: "_getList",
    value: function _getList() {
      var _this3 = this;

      var _this$state2 = this.state,
          category = _this$state2.category,
          query = _this$state2.query;
      var products = this.props.productCtx.products;

      var compare = function compare(a, b) {
        if (a.Favorite !== b.Favorite) {
          return a.Favorite ? -1000 : 1000;
        }

        if (!a.Title || !b.Title) {
          return a.Title ? -1 : 0;
        }

        return a.Title.localeCompare(b.Title);
      };

      return products.filter(function (p) {
        return !category || p.Categories && p.Categories.indexOf(category.Id) >= 0;
      }).filter(function (p) {
        return _this3._filterQuery(query)(p);
      }).sort(compare);
    }
  }, {
    key: "_cellRenderer",
    value: function _cellRenderer(cellRendererProps, list) {
      var columnIndex = cellRendererProps.columnIndex,
          rowIndex = cellRendererProps.rowIndex,
          style = cellRendererProps.style,
          key = cellRendererProps.key,
          isVisible = cellRendererProps.isVisible;
      var index = rowIndex * COL_NUMBER + columnIndex;
      var p = list[index];

      if (!p) {
        return null;
      }

      var _this$props2 = this.props,
          settingsCtx = _this$props2.settingsCtx,
          warehouseCtx = _this$props2.warehouseCtx,
          onSelect = _this$props2.onSelect,
          update = _this$props2.productCtx.update,
          selectedIds = _this$props2.selectedIds,
          onClick = _this$props2.onClick,
          showFavorite = _this$props2.showFavorite;
      return React.createElement("div", {
        style: _objectSpread({}, style),
        key: key
      }, isVisible ? React.createElement(_ProductListPreview.default, {
        warehouseCtx: warehouseCtx,
        product: p,
        settingsCtx: settingsCtx,
        onClick: function (_onClick) {
          function onClick() {
            return _onClick.apply(this, arguments);
          }

          onClick.toString = function () {
            return _onClick.toString();
          };

          return onClick;
        }(function () {
          _services.Products.Get(p.Id).then(function (product) {
            return onClick(product);
          });
        }),
        onSelect: onSelect ? function () {
          _services.Products.Get(p.Id).then(function (product) {
            return onSelect(product);
          });
        } : undefined,
        onFavorite: showFavorite ? function () {
          _services.Products.Patch(p.Id, {
            Favorite: !p.Favorite
          }).then(function () {
            update();
          });
        } : undefined,
        selected: selectedIds && selectedIds.indexOf(p.Id) >= 0
      }) : null);
    }
  }, {
    key: "_setCategory",
    value: function _setCategory(category) {
      this.setState(function () {
        return {
          category: category
        };
      });
    }
  }]);

  return ProductList;
}(React.Component);

exports.ProductList = ProductList;

var _default = (0, _styles.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative',
      flexWrap: 'nowrap'
    },
    menu: {
      height: '100%',
      boxSizing: 'border-box',
      display: 'flex',
      flexDirection: 'column'
    },
    menuItem: {
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      opacity: 0.5,
      flex: '0 0 auto',
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemLast: {
      marginTop: 'auto'
    },
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    productsContainer: {
      height: '100%',
      position: 'relative',
      flex: '1 1 auto'
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    productsInner: {
      height: '100%',
      paddingRight: 50,
      paddingLeft: 50
    },
    categoryCount: {
      background: '#cccccc',
      borderRadius: '16px',
      color: '#ffffff',
      display: 'inline-block',
      padding: '4px 8px'
    },
    categoryCountActive: {
      background: theme.palette.primary.main
    }
  };
})((0, _styles.withTheme)()(ProductList));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _colorHash = _interopRequireDefault(require("color-hash"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var colorHash = new _colorHash.default();

var ProductListPreview =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductListPreview, _React$Component);

  function ProductListPreview(props) {
    _classCallCheck(this, ProductListPreview);

    return _possibleConstructorReturn(this, _getPrototypeOf(ProductListPreview).call(this, props));
  }

  _createClass(ProductListPreview, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          onSelect = _this$props.onSelect,
          onClick = _this$props.onClick,
          onFavorite = _this$props.onFavorite,
          _this$props$product = _this$props.product,
          Id = _this$props$product.Id,
          Src = _this$props$product.Src,
          Title = _this$props$product.Title,
          Favorite = _this$props$product.Favorite,
          classes = _this$props.classes,
          selected = _this$props.selected;
      return React.createElement("div", {
        className: classes.container
      }, React.createElement("figure", {
        className: classes.figure,
        style: {
          backgroundColor: colorHash.hex(Id)
        },
        onClick: onClick
      }, Src && React.createElement("img", {
        className: classes.image,
        src: "".concat(Src, "?width=500")
      })), React.createElement("div", {
        className: classes.text
      }, React.createElement("span", {
        className: classes.title
      }, Title), React.createElement("span", {
        className: classes.action
      }, onFavorite && React.createElement(_core.IconButton, {
        onClick: onFavorite
      }, Favorite ? React.createElement(_icons.Star, null) : React.createElement(_icons.StarBorder, null)), onSelect && React.createElement(_core.IconButton, {
        onClick: onSelect
      }, selected ? React.createElement(_icons.CheckBox, null) : React.createElement(_icons.CheckBoxOutlineBlank, null)))));
    }
  }]);

  return ProductListPreview;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {
      display: 'flex',
      flexDirection: 'column',
      alignContent: 'center',
      justifyContent: 'center',
      margin: theme.spacing.unit
    },
    figure: {
      paddingBottom: '100%',
      position: 'relative'
    },
    title: {
      overflow: 'hidden',
      textOverflow: 'ellipsis',
      whiteSpace: 'nowrap'
    },
    image: {
      overflow: 'hidden',
      position: 'absolute',
      left: 0,
      right: 0,
      top: 0,
      bottom: 0,
      width: '100%',
      height: '100%',
      objectFit: 'cover'
    },
    text: {
      display: 'flex',
      justifyContent: 'space-between',
      alignItems: 'center'
    },
    action: {}
  };
})(ProductListPreview);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ProductPage = void 0;

var React = _interopRequireWildcard(require("react"));

var _ModelBaseList = require("../../ModelBaseList/ModelBaseList");

var _services = require("../../../_services");

var _ProductDetail = _interopRequireDefault(require("../ProductDetail/ProductDetail"));

var _ProductList = _interopRequireDefault(require("../ProductList/ProductList"));

var _core = require("@material-ui/core");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ProductPage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ProductPage, _React$Component);

  function ProductPage(props) {
    var _this;

    _classCallCheck(this, ProductPage);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductPage).call(this, props));
    _this.state = {};
    return _this;
  }

  _createClass(ProductPage, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          list = _this$props.list,
          settingsCtx = _this$props.settingsCtx,
          warehouseCtx = _this$props.warehouseCtx,
          intl = _this$props.intl,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          fetching = _this$props.productCtx.fetching,
          authCtx = _this$props.authCtx,
          user = _this$props.authCtx.user;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened,
          creating = _this$state.creating,
          creatingOpened = _this$state.creatingOpened;
      var loadingBtn = {
        icon: React.createElement(_icons.Cached, null),
        legend: 'loading',
        themeColor: 'gray'
      };

      var add = function add() {
        _services.Products.Empty('New Product', {}).then(function (newCreated) {
          _this2.setState(function () {
            return {
              creating: newCreated,
              creatingOpened: true
            };
          });
        });
      };

      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'add new product',
        themeColor: 'green',
        onClick: add
      };

      var closeCreating = function closeCreating() {
        _this2.setState(function () {
          return {
            creatingOpened: false
          };
        });
      };

      var closeEditing = function closeEditing() {
        _this2.setState(function () {
          return {
            editingOpened: false
          };
        });
      };

      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Products');
      return React.createElement("div", {
        style: {
          position: 'relative',
          height: '100%'
        }
      }, React.createElement(_ProductList.default, _extends({
        categoryCtx: categoryCtx,
        list: list,
        settingsCtx: settingsCtx,
        warehouseCtx: warehouseCtx,
        productCtx: productCtx,
        intl: intl
      }, {
        onClick: function onClick(p) {
          _this2.setState(function () {
            return {
              editing: p,
              editingOpened: true
            };
          });
        },
        showFavorite: true
      })), React.createElement(_Fabs.default, {
        map: [hasRights && !fetching && addBtn, fetching && loadingBtn]
      }), editing && React.createElement(_core.Dialog, {
        open: !!editingOpened,
        fullScreen: true,
        onClose: closeEditing
      }, React.createElement(_ProductDetail.default, _extends({
        intl: intl,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        authCtx: authCtx
      }, {
        key: editing.Id,
        warehouseCtx: warehouseCtx,
        cancel: closeEditing,
        changed: function changed(p) {
          _this2._editingChanged(p);
        },
        onDelete: function onDelete() {
          _this2._editingDeleted(editing.Id);
        },
        initial: editing
      }))), creating && React.createElement(_core.Dialog, {
        open: !!creatingOpened,
        fullScreen: true,
        onClose: closeCreating
      }, React.createElement(_ProductDetail.default, _extends({
        intl: intl,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        authCtx: authCtx
      }, {
        warehouseCtx: warehouseCtx,
        cancel: closeCreating,
        changed: function changed(p) {
          _this2._creatingChanged();
        },
        onDelete: function onDelete() {
          _this2._creatingChanged();
        },
        initial: creating
      }))));
    }
  }, {
    key: "_editingChanged",
    value: function _editingChanged(product) {
      this.props.productCtx.update();
      this.setState(function (prev) {
        return {
          editing: undefined
        };
      });
    }
  }, {
    key: "_editingDeleted",
    value: function _editingDeleted(id) {
      this.props.productCtx.update();
      this.setState(function (prev) {
        return {
          editing: undefined
        };
      });
    }
  }, {
    key: "_creatingChanged",
    value: function _creatingChanged() {
      var _this3 = this;

      this.setState(function () {
        return {
          creating: undefined
        };
      }, function () {
        return _this3.props.productCtx.update();
      });
    }
  }]);

  return ProductPage;
}(React.Component); // tslint:disable-next-line:max-line-length


exports.ProductPage = ProductPage;

var _default = (0, _ModelBaseList.withList)(ProductPage, _services.Products);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _AccountFields = _interopRequireDefault(require("./AccountFields"));

var _services = require("../../../_services");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Account =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Account, _React$Component);

  function Account(props) {
    var _this;

    _classCallCheck(this, Account);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Account).call(this, props));
    _this._OnSave = _this._OnSave.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(Account, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          intl = _this$props.intl,
          authCtx = _this$props.authCtx,
          shopCtx = _this$props.shopCtx,
          warehouseCtx = _this$props.warehouseCtx;
      return React.createElement(_AccountFields.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx
      }, {
        initial: authCtx.user || {}
      }));
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(changes) {
      var _this2 = this;

      return (0, _services.PatchUser)(changes).then(function (model) {
        var refresh = _this2.props.authCtx.refresh;
        refresh();

        _this2.props.onChanged(model);

        return model;
      });
    } // private _fetch() {
    //     // fetch users 
    //     Users.GetAll(0, 50).then(result => {
    //         this.setState(prev => ({ users: result.Values }));
    //     });
    // }
    // private _registerUser() {
    //     const { registerUserEmail } = this.state;
    //     if (!registerUserEmail) { return; }
    //     Register(registerUserEmail).then(result => {
    //         this._fetch();
    //     });
    // }
    // private _renderRegisterUser() {
    //     return (
    //         <React.Fragment>
    //             <div className="settings__section-item">
    //                 <TextField
    //                     onChange={(value) => this.setState(prev => ({ registerUserEmail: value }))}
    //                     value={this.state.registerUserEmail || ''}
    //                     title={this.props.intl.formatMessage(SettingsMessages.registerUserEmail)}
    //                 />
    //             </div>
    //             <div className="settings__section-item">
    //                 <Button active={!!this.state.registerUserEmail} onClick={() => this._registerUser()}>
    //                     <FormattedMessage
    //                         {...SettingsMessages.registerUser}
    //                     />
    //                 </Button>
    //             </div>
    //         </React.Fragment>);
    // }
    // private _isAdmin(user: TUser) {
    //     return user.Roles && user.Roles.indexOf(Roles.Admin) >= 0;
    // }
    // private _isMe(user: TUser) {
    //     return this.props.user && user.UserName === this.props.user.UserName;
    // }
    // private _renderUserLists() {
    //     return (
    //         <React.Fragment>
    //             {this._renderAdmins()}
    //             {this._renderUsers()}
    //         </React.Fragment>);
    // }
    // private _renderUsers() {
    //     const users = this.state.users.filter(u => !this._isAdmin(u) && !this._isMe(u));
    //     return (
    //         <section className="settings__section">
    //             <h3 className="settings__section-title">{this.props.intl.formatMessage(SettingsMessages.users)}</h3>
    //             {users.map(user => {
    //                 return (
    //                     <UserForm
    //                         key={user.UserName}
    //                         group="users-forms"
    //                         initial={user}
    //                         onChange={(newuser) =>
    //                             this.setState(prev => ({
    //                                 users: prev.users
    //                                     .map(u => u.UserName === newuser.UserName ? newuser : u)
    //                             }))
    //                         }
    //                         save={(changes) => Users.Patch(user.Id, changes)}
    //                         transition="left"
    //                         uid={this.props.uid}
    //                     />);
    //             })}
    //         </section>);
    // }
    // private _renderAdmins() {
    //     const admins = this.state.users.filter(u => this._isAdmin(u) && !this._isMe(u));
    //     return (
    //         <section className="settings__section">
    //             <h3 className="settings__section-title">{this.props.intl.formatMessage(SettingsMessages.admins)}</h3>
    //             {admins.map(user => {
    //                 return (
    //                     <UserForm
    //                         key={user.UserName}
    //                         group="users-forms"
    //                         initial={user}
    //                         onChange={(newuser) =>
    //                             this.setState(prev => ({
    //                                 users: prev.users
    //                                     .map(u => u.UserName === newuser.UserName ? newuser : u)
    //                             }))
    //                         }
    //                         save={(changes) => Users.Patch(user.Id, changes)}
    //                         transition="left"
    //                         uid={this.props.uid}
    //                     />);
    //             })}
    //         </section>);
    // }

  }]);

  return Account;
}(React.Component);

var _default = Account; // <div className="settings__column">
// {isAmdin && this._renderUserLists()}
// {isAmdin && this._renderRegisterUser()}
// </div>

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _UsersMessages = _interopRequireDefault(require("../UsersMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _services = require("src/_services");

var _notistack = require("notistack");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var AccountFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(AccountFields, _React$Component);

  function AccountFields(props) {
    var _this;

    _classCallCheck(this, AccountFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(AccountFields).call(this, props));
    _this._handleShowPasswordClick = _this._handleShowPasswordClick.bind(_assertThisInitialized(_this));
    _this._handleShowPasswordMouseDown = _this._handleShowPasswordMouseDown.bind(_assertThisInitialized(_this));
    _this.state = {
      changes: {},
      initial: _this.props.initial,
      currentpassword: '',
      newpassword: '',
      confirmPassword: ''
    };
    return _this;
  }

  _createClass(AccountFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          showPassword = _this$state.showPassword,
          newpassword = _this$state.newpassword,
          currentpassword = _this$state.currentpassword,
          confirmPassword = _this$state.confirmPassword,
          initial = _this$state.initial,
          changes = _this$state.changes;
      var _this$props = this.props,
          shopCtx = _this$props.shopCtx,
          warehouseCtx = _this$props.warehouseCtx,
          formatMessage = _this$props.intl.formatMessage;

      var preview = _objectSpread({}, initial, changes);

      var changed = !!Object.keys(changes).length || currentpassword && newpassword && newpassword === confirmPassword;
      var currentpasswordTitle = formatMessage(_UsersMessages.default.currentPassword);
      var passwordTitle = formatMessage(_UsersMessages.default.resetPassword);
      var confirmTitle = formatMessage(_UsersMessages.default.confirmPassword);
      return React.createElement("form", {
        onSubmit: changed ? this._handleSubmit : undefined
      }, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        inputProps: {
          autoComplete: 'given-name'
        },
        name: "firstname",
        label: formatMessage(_UsersMessages.default.firstName),
        value: preview.FirstName,
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            FirstName: e.target.value
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_UsersMessages.default.lastName),
        inputProps: {
          autoComplete: 'family-name'
        },
        name: "lastname",
        value: preview.LastName,
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            LastName: e.target.value
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_UsersMessages.default.email),
        inputProps: {
          autoComplete: 'email'
        },
        name: "email",
        value: preview.Email,
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            Email: e.target.value
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        label: formatMessage(_UsersMessages.default.phoneNumber),
        value: preview.PhoneNumber,
        inputProps: {
          autoComplete: 'tel'
        },
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            PhoneNumber: e.target.value
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        select: true,
        label: formatMessage(_UsersMessages.default.defaultShop),
        value: preview.ShopId ? preview.ShopId : '',
        name: "shop",
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            ShopId: e.target.value
          });
        }
      }, shopCtx.Shops.map(function (s) {
        return React.createElement(_core.MenuItem, {
          key: s.Id,
          value: s.Id
        }, s.Name);
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        select: true,
        label: formatMessage(_UsersMessages.default.defaultWarehouse),
        value: preview.WarehouseId ? preview.WarehouseId : '',
        name: "warehouse",
        onChange: function onChange(e) {
          return _this2._HandleMeChange({
            WarehouseId: e.target.value
          });
        }
      }, warehouseCtx.Warehouses.map(function (w) {
        return React.createElement(_core.MenuItem, {
          key: w.Id,
          value: w.Id
        }, w.Name);
      }))), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "password"
      }, currentpasswordTitle), React.createElement(_core.Input, {
        id: "password",
        type: showPassword ? 'text' : 'password',
        autoComplete: "current-password",
        value: currentpassword,
        name: "password",
        onChange: function onChange(e) {
          var v = e.target.value;

          _this2.setState(function () {
            return {
              currentpassword: v
            };
          });
        },
        endAdornment: React.createElement(_core.InputAdornment, {
          position: "end"
        }, React.createElement(_core.IconButton, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowPasswordClick,
          onMouseDown: this._handleShowPasswordMouseDown
        }, showPassword ? React.createElement(_icons.VisibilityOff, null) : React.createElement(_icons.Visibility, null)))
      }))), currentpassword && React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "new-password"
      }, passwordTitle), React.createElement(_core.Input, {
        id: "new-password",
        type: showPassword ? 'text' : 'password',
        value: newpassword,
        autoComplete: "new-password",
        name: "newpassword",
        onChange: function onChange(e) {
          var v = e.target.value;

          _this2.setState(function () {
            return {
              newpassword: v
            };
          });
        },
        endAdornment: React.createElement(_core.InputAdornment, {
          position: "end"
        }, React.createElement(_core.IconButton, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowPasswordClick,
          onMouseDown: this._handleShowPasswordMouseDown
        }, showPassword ? React.createElement(_icons.VisibilityOff, null) : React.createElement(_icons.Visibility, null)))
      }))), currentpassword && newpassword && React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "confirm-password"
      }, confirmTitle), React.createElement(_core.Input, {
        id: "confirm-password",
        type: showPassword ? 'text' : 'password',
        value: confirmPassword,
        autoComplete: "new-password",
        name: "newpasswordconfirm",
        onChange: function onChange(e) {
          var v = e.target.value;

          _this2.setState(function () {
            return {
              confirmPassword: v
            };
          });
        },
        endAdornment: React.createElement(_core.InputAdornment, {
          position: "end"
        }, React.createElement(_core.IconButton, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowPasswordClick,
          onMouseDown: this._handleShowPasswordMouseDown
        }, showPassword ? React.createElement(_icons.VisibilityOff, null) : React.createElement(_icons.Visibility, null)))
      })))), changed && React.createElement(_Fabs.default, {
        map: [{
          icon: React.createElement(_icons.Check, null),
          onClick: function onClick() {
            _this2._HandleSave();
          },
          legend: 'save',
          color: 'primary',
          themeColor: 'green'
        }, {
          icon: React.createElement(_icons.Close, null),
          legend: 'cancel',
          onClick: function onClick() {
            _this2._HandleCancel();
          }
        }]
      }));
    }
  }, {
    key: "_handleShowPasswordClick",
    value: function _handleShowPasswordClick() {
      this.setState(function (prev) {
        return {
          showPassword: !prev.showPassword
        };
      });
    }
  }, {
    key: "_handleSubmit",
    value: function _handleSubmit(e) {
      e.preventDefault();

      this._HandleSave();
    }
  }, {
    key: "_handleShowPasswordMouseDown",
    value: function _handleShowPasswordMouseDown(e) {
      e.preventDefault();
    }
  }, {
    key: "_HandleMeChange",
    value: function _HandleMeChange(changes) {
      var newChanges = _objectSpread({}, this.state.changes, changes);

      this.setState(function () {
        return {
          changes: newChanges
        };
      });
    }
  }, {
    key: "_HandleSave",
    value: function _HandleSave() {
      var _this3 = this;

      var _this$props2 = this.props,
          authCtx = _this$props2.authCtx,
          enqueueSnackbar = _this$props2.enqueueSnackbar;
      var _this$state2 = this.state,
          currentpassword = _this$state2.currentpassword,
          newpassword = _this$state2.newpassword,
          confirmPassword = _this$state2.confirmPassword,
          changes = _this$state2.changes;

      if (!!Object.keys(changes).length) {
        (0, _services.PatchUser)(changes).then(function (model) {
          authCtx.refresh();
          return model;
        }).then(function (model) {
          _this3.setState(function () {
            return {
              changes: {},
              initial: model
            };
          }, function () {
            enqueueSnackbar('user updated with success', {
              variant: 'success'
            });
          });
        }).catch(function (reason) {
          return enqueueSnackbar("error while updating account (".concat(reason, ")"), {
            variant: 'error'
          });
        });
      }

      if (currentpassword && newpassword && newpassword === confirmPassword) {
        (0, _services.ChangePassword)(currentpassword, newpassword).then(function () {
          _this3.setState(function () {
            return {
              currentpassword: '',
              newpassword: '',
              confirmPassword: ''
            };
          }, function () {
            enqueueSnackbar('password changed with success', {
              variant: 'success'
            });
          });
        }).catch(function (reason) {
          return enqueueSnackbar("error while changing password (".concat(reason, ")"), {
            variant: 'error'
          });
        });
      }
    }
  }, {
    key: "_HandleCancel",
    value: function _HandleCancel() {
      var _this4 = this;

      this.setState(function () {
        return {
          currentpassword: '',
          newpassword: '',
          confirmPassword: '',
          changes: {},
          initial: _objectSpread({}, _this4.props.initial)
        };
      });
    }
  }]);

  return AccountFields;
}(React.Component);

var _default = (0, _notistack.withSnackbar)(AccountFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _CategoriesFields = _interopRequireDefault(require("../CategoriesFields/CategoriesFields"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _CategoriesDetailMessages = _interopRequireDefault(require("./CategoriesDetailMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CategoriesDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CategoriesDetail, _React$Component);

  function CategoriesDetail(props) {
    var _this;

    _classCallCheck(this, CategoriesDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CategoriesDetail).call(this, props));
    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(CategoriesDetail, [{
    key: "render",
    value: function render() {
      return this._renderCategories();
    }
  }, {
    key: "_renderCategories",
    value: function _renderCategories() {
      var _this2 = this;

      var _this$props = this.props,
          cancel = _this$props.cancel,
          Id = _this$props.initial.Id,
          intl = _this$props.intl,
          initial = _this$props.initial;
      var changes = this.state.changes;
      return React.createElement(React.Fragment, null, React.createElement(_core.DialogContent, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          e.preventDefault();

          _this2._OnSave(changes);
        }
      }, React.createElement(_CategoriesFields.default, {
        intl: intl,
        initial: initial,
        onChange: function onChange(category) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, category)
            };
          });
        },
        changes: changes
      }))), React.createElement(_core.DialogActions, null, Id && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this2._OnDelete(Id);
        }
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: cancel
      }, "close"), (Object.keys(changes).length || !Id) && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnSave(changes);
        }
      }, "save")));
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete(id) {
      var _this$props2 = this.props,
          Categories = _this$props2.categoryCtx,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_CategoriesDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        Categories.delete(id).then(onDelete);
      }
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(modif) {
      var _this3 = this;

      var _this$props3 = this.props,
          Id = _this$props3.initial.Id,
          Categories = _this$props3.categoryCtx,
          changed = _this$props3.changed,
          changes = this.state.changes;

      var allChanges = _objectSpread({}, changes, modif);

      if (Id) {
        return Categories.patch(Id, allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      } else {
        return Categories.create(allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          _this3.props.changed(model);
        });
      }
    }
  }]);

  return CategoriesDetail;
}(React.Component);

var _default = CategoriesDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  title: {
    "id": "src.components.settings.categories.title",
    "defaultMessage": "Title"
  },
  deleteConfirm: {
    "id": "src.components.settings.categories.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this category?"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _CategoriesDetailMessages = _interopRequireDefault(require("../CategoriesDetail/CategoriesDetailMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CategoriesFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CategoriesFields, _React$Component);

  function CategoriesFields(props) {
    _classCallCheck(this, CategoriesFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(CategoriesFields).call(this, props));
  }

  _createClass(CategoriesFields, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this = this;

      var initial = this.props.initial;

      var preview = _objectSpread({}, initial, this.props.changes);

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(e) {
          return _this.props.onChange({
            Title: e.target.value
          });
        },
        value: preview.Title || '',
        label: this.props.intl.formatMessage(_CategoriesDetailMessages.default.title)
      })));
    }
  }]);

  return CategoriesFields;
}(React.Component);

var _default = CategoriesFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../../_services");

var _core = require("@material-ui/core");

var _ItemPreview = _interopRequireWildcard(require("src/components/ItemPreview/ItemPreview"));

var _CategoriesDetail = _interopRequireDefault(require("../CategoriesDetail/CategoriesDetail"));

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CategoriesList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(CategoriesList, _React$Component);

  function CategoriesList(props) {
    var _this;

    _classCallCheck(this, CategoriesList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CategoriesList).call(this, props));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(CategoriesList, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          categoryCtx = _this$props.categoryCtx,
          intl = _this$props.intl,
          classes = _this$props.classes;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened,
          creating = _this$state.creating,
          creatingOpened = _this$state.creatingOpened;
      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'create new',
        themeColor: 'green',
        onClick: this._add
      };
      return React.createElement(_GridContainer.GridContainer, null, categoryCtx.Categories.map(function (category) {
        var name = category.Title || '(no title)';
        return React.createElement(_core.Grid, {
          key: category.Id,
          item: true,
          xs: 12
        }, React.createElement(_ItemPreview.default, {
          onClick: function onClick() {
            _this2.setState(function () {
              return {
                editing: category,
                editingOpened: true
              };
            });
          }
        }, React.createElement(_core.Avatar, null, React.createElement(_icons.Bookmarks, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, React.createElement("span", {
          className: classes.bold
        }, name)))));
      }), React.createElement(_SideDialog.default, {
        open: !!editingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, editing && React.createElement(_CategoriesDetail.default, {
        key: editing.Id,
        categoryCtx: categoryCtx,
        changed: function changed() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        initial: editing,
        intl: this.props.intl
      })), React.createElement(_SideDialog.default, {
        open: !!creatingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, creating && React.createElement(_CategoriesDetail.default, {
        key: creating.Id,
        categoryCtx: categoryCtx,
        changed: function changed() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        initial: creating,
        changes: creating,
        intl: intl
      })), React.createElement(_Fabs.default, {
        map: [addBtn]
      }));
    }
  }, {
    key: "_add",
    value: function _add() {
      var _this3 = this;

      _services.Categories.Empty('new category', {}).then(function (newCategory) {
        _this3.setState(function () {
          return {
            creating: newCategory,
            creatingOpened: true
          };
        });
      });
    }
  }]);

  return CategoriesList;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {},
    bold: {
      fontWeight: 'bold',
      color: 'black'
    },
    spacer: {
      marginRight: 10
    }
  };
})(CategoriesList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _ConfigurationFields = _interopRequireDefault(require("./ConfigurationFields"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Configuration =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Configuration, _React$Component);

  function Configuration(props) {
    _classCallCheck(this, Configuration);

    return _possibleConstructorReturn(this, _getPrototypeOf(Configuration).call(this, props));
  }

  _createClass(Configuration, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          intl = _this$props.intl,
          settingsCtx = _this$props.settingsCtx,
          Settings = _this$props.settingsCtx.Settings;
      return React.createElement(_ConfigurationFields.default, _extends({
        intl: intl,
        settingsCtx: settingsCtx
      }, {
        initial: Settings || {}
      }));
    }
  }]);

  return Configuration;
}(React.Component);

var _default = Configuration;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _notistack = require("notistack");

var _NumberField = _interopRequireDefault(require("src/components/NumberField/NumberField"));

var _ConfigurationMessages = _interopRequireDefault(require("./ConfigurationMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ConfigurationFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ConfigurationFields, _React$Component);

  function ConfigurationFields(props) {
    var _this;

    _classCallCheck(this, ConfigurationFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ConfigurationFields).call(this, props));
    _this.state = {
      changes: {},
      initial: props.initial
    };
    return _this;
  }

  _createClass(ConfigurationFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          initial = _this$state.initial,
          changes = _this$state.changes;
      var formatMessage = this.props.intl.formatMessage;

      var preview = _objectSpread({}, initial, changes);

      var changed = !!Object.keys(changes).length;
      return React.createElement(React.Fragment, null, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!preview.ShowWeight,
          onChange: function onChange(e) {
            return _this2._HandleChange({
              ShowWeight: e.target.checked
            });
          },
          color: "primary"
        }),
        label: formatMessage(_ConfigurationMessages.default.showWeight)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!preview.ShowTaxRateIncluded,
          onChange: function onChange(e) {
            return _this2._HandleChange({
              ShowTaxRateIncluded: e.target.checked
            });
          },
          color: "primary"
        }),
        label: formatMessage(_ConfigurationMessages.default.showTaxRateIncluded)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControlLabel, {
        control: React.createElement(_core.Switch, {
          checked: !!preview.ShowTaxRateExcluded,
          onChange: function onChange(e) {
            return _this2._HandleChange({
              ShowTaxRateExcluded: e.target.checked
            });
          },
          color: "primary"
        }),
        label: formatMessage(_ConfigurationMessages.default.showTaxRateExcluded)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_NumberField.default, {
        fullWidth: true,
        label: formatMessage(_ConfigurationMessages.default.taxRateExcluded),
        step: "0.01",
        value: preview.TaxRateIncluded,
        onNumberChange: function onNumberChange(value) {
          return _this2._HandleChange({
            TaxRateIncluded: value
          });
        }
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_NumberField.default, {
        fullWidth: true,
        label: formatMessage(_ConfigurationMessages.default.taxRateIncluded),
        step: "0.01",
        value: preview.TaxRateExcluded,
        onNumberChange: function onNumberChange(value) {
          return _this2._HandleChange({
            TaxRateExcluded: value
          });
        }
      }))))), changed && React.createElement(_Fabs.default, {
        map: [{
          icon: React.createElement(_icons.Check, null),
          onClick: function onClick() {
            _this2._HandleSave();
          },
          legend: 'save',
          color: 'primary',
          themeColor: 'green'
        }, {
          icon: React.createElement(_icons.Close, null),
          legend: 'cancel',
          onClick: function onClick() {
            _this2._HandleCancel();
          }
        }]
      }));
    }
  }, {
    key: "_HandleChange",
    value: function _HandleChange(changes) {
      var newChanges = _objectSpread({}, this.state.changes, changes);

      this.setState(function () {
        return {
          changes: newChanges
        };
      });
    }
  }, {
    key: "_HandleSave",
    value: function _HandleSave() {
      var _this3 = this;

      var _this$props = this.props,
          update = _this$props.settingsCtx.update,
          enqueueSnackbar = _this$props.enqueueSnackbar;
      var changes = this.state.changes;

      if (!Object.keys(changes).length) {
        return;
      }

      update(changes).then(function (model) {
        _this3.setState(function () {
          return {
            changes: {},
            initial: model
          };
        }, function () {
          enqueueSnackbar('configuration updated with success', {
            variant: 'success'
          });
        });
      }).catch(function (reason) {
        return enqueueSnackbar("error while updating configuration (".concat(reason, ")"), {
          variant: 'error'
        });
      });
    }
  }, {
    key: "_HandleCancel",
    value: function _HandleCancel() {
      var _this4 = this;

      this.setState(function () {
        return {
          changes: {},
          initial: _objectSpread({}, _this4.props.initial)
        };
      });
    }
  }]);

  return ConfigurationFields;
}(React.Component);

var _default = (0, _notistack.withSnackbar)(ConfigurationFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ConfigurationMessages = void 0;

var _reactIntl = require("react-intl");

var ConfigurationMessages = (0, _reactIntl.defineMessages)({
  showWeight: {
    "id": "src.components.settings.configuration.showWeight",
    "defaultMessage": "Show weight"
  },
  showTaxRateIncluded: {
    "id": "src.components.settings.configuration.showTaxRateIncluded",
    "defaultMessage": "Show tax rate included"
  },
  showTaxRateExcluded: {
    "id": "src.components.settings.configuration.showTaxRateExcluded",
    "defaultMessage": "Show tax rate excluded"
  },
  taxRateIncluded: {
    "id": "src.components.settings.configuration.taxRateIncluded",
    "defaultMessage": "Tax rate included value"
  },
  taxRateExcluded: {
    "id": "src.components.settings.configuration.taxRateExcluded",
    "defaultMessage": "Tax rate excluded value"
  },
  bankTransferSentence: {
    "id": "src.components.settings.configuration.bankTransferSentence",
    "defaultMessage": "Bank transfer message"
  }
});
exports.ConfigurationMessages = ConfigurationMessages;
var _default = ConfigurationMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _DocumentTemplateFields = _interopRequireDefault(require("../DocumentTemplateFields/DocumentTemplateFields"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _DocumentTemplateDetailMessages = _interopRequireDefault(require("./DocumentTemplateDetailMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var DocumentTemplateDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DocumentTemplateDetail, _React$Component);

  function DocumentTemplateDetail(props) {
    var _this;

    _classCallCheck(this, DocumentTemplateDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(DocumentTemplateDetail).call(this, props));
    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(DocumentTemplateDetail, [{
    key: "render",
    value: function render() {
      return this._renderCategories();
    }
  }, {
    key: "_renderCategories",
    value: function _renderCategories() {
      var _this2 = this;

      var _this$props = this.props,
          cancel = _this$props.cancel,
          Id = _this$props.initial.Id,
          intl = _this$props.intl,
          initial = _this$props.initial;
      var changes = this.state.changes;
      return React.createElement(React.Fragment, null, React.createElement(_core.DialogContent, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          e.preventDefault();

          _this2._OnSave(changes);
        }
      }, React.createElement(_DocumentTemplateFields.default, {
        intl: intl,
        initial: initial,
        onChange: function onChange(category) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, category)
            };
          });
        },
        changes: changes
      }))), React.createElement(_core.DialogActions, null, Id && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this2._OnDelete(Id);
        }
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: cancel
      }, "close"), (Object.keys(changes).length || !Id) && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnSave(changes);
        }
      }, "save")));
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete(id) {
      var _this$props2 = this.props,
          templates = _this$props2.templateCtx,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_DocumentTemplateDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        templates.delete(id).then(onDelete);
      }
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(modif) {
      var _this3 = this;

      var _this$props3 = this.props,
          Id = _this$props3.initial.Id,
          templates = _this$props3.templateCtx,
          changed = _this$props3.changed,
          changes = this.state.changes;

      var allChanges = _objectSpread({}, changes, modif);

      if (Id) {
        return templates.patch(Id, allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      } else {
        return templates.create(allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      }
    }
  }]);

  return DocumentTemplateDetail;
}(React.Component);

var _default = DocumentTemplateDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  title: {
    "id": "src.components.settings.documenttemplate.title",
    "defaultMessage": "Title"
  },
  template: {
    "id": "src.components.settings.documenttemplate.template",
    "defaultMessage": "Template code"
  },
  description: {
    "id": "src.components.settings.documenttemplate.description",
    "defaultMessage": "Description"
  },
  applyTo: {
    "id": "src.components.settings.documenttemplate.applyTo",
    "defaultMessage": "applyTo"
  },
  styles: {
    "id": "src.components.settings.documenttemplate.styles",
    "defaultMessage": "CSS styles code"
  },
  order: {
    "id": "src.components.settings.documenttemplate.order",
    "defaultMessage": "Order"
  },
  client: {
    "id": "src.components.settings.documenttemplate.client",
    "defaultMessage": "Client"
  },
  payment: {
    "id": "src.components.settings.documenttemplate.payment",
    "defaultMessage": "Payment"
  },
  dashboardProduct: {
    "id": "src.components.settings.documenttemplate.dashboardProduct",
    "defaultMessage": "Dashboard products"
  },
  dashboardOrders: {
    "id": "src.components.settings.documenttemplate.dashboardOrders",
    "defaultMessage": "Dashboard orders"
  },
  orders: {
    "id": "src.components.settings.documenttemplate.orders",
    "defaultMessage": "Orders"
  },
  ordersProducts: {
    "id": "src.components.settings.documenttemplate.ordersProducts",
    "defaultMessage": "Orders products"
  },
  deleteConfirm: {
    "id": "src.components.settings.documenttemplate.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this template?"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _DocumentTemplateDetailMessages = _interopRequireDefault(require("../DocumentTemplateDetail/DocumentTemplateDetailMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _reactDropzone = _interopRequireDefault(require("react-dropzone"));

var _icons = require("@material-ui/icons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var DocumentTemplateFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DocumentTemplateFields, _React$Component);

  function DocumentTemplateFields(props) {
    _classCallCheck(this, DocumentTemplateFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(DocumentTemplateFields).call(this, props));
  }

  _createClass(DocumentTemplateFields, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this = this;

      var _this$props = this.props,
          initial = _this$props.initial,
          changes = _this$props.changes,
          classes = _this$props.classes,
          intl = _this$props.intl,
          onChange = _this$props.onChange;

      var preview = _objectSpread({}, initial, changes);

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            Title: e.target.value
          });
        }),
        value: preview.Title || '',
        label: intl.formatMessage(_DocumentTemplateDetailMessages.default.title)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        multiline: true,
        onChange: function (_onChange2) {
          function onChange(_x2) {
            return _onChange2.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange2.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            Description: e.target.value
          });
        }),
        value: preview.Description || '',
        label: intl.formatMessage(_DocumentTemplateDetailMessages.default.description)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_reactDropzone.default, {
        accept: "text/html",
        style: {},
        className: classes.drop,
        acceptClassName: classes.dropAccepted,
        activeClassName: classes.dropActive,
        rejectClassName: classes.dropRejected,
        onDrop: function onDrop(acceptedFiles) {
          return _this._onDrop('Template', acceptedFiles);
        }
      }, React.createElement("div", {
        className: classes.icon
      }, preview.Template && React.createElement(_icons.CheckCircle, {
        className: classes.iconImage
      })), React.createElement("div", {
        className: classes.legend
      }, intl.formatMessage(_DocumentTemplateDetailMessages.default.template)))), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_reactDropzone.default, {
        accept: "text/css",
        style: {},
        className: classes.drop,
        acceptClassName: classes.dropAccepted,
        activeClassName: classes.dropActive,
        rejectClassName: classes.dropRejected,
        onDrop: function onDrop(acceptedFiles) {
          return _this._onDrop('Styles', acceptedFiles);
        }
      }, React.createElement("div", {
        className: classes.icon
      }, preview.Styles && React.createElement(_icons.CheckCircle, {
        className: classes.iconImage
      })), React.createElement("div", {
        className: classes.legend
      }, intl.formatMessage(_DocumentTemplateDetailMessages.default.styles)))), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, intl.formatMessage(_DocumentTemplateDetailMessages.default.applyTo)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function (_onChange3) {
          function onChange(_x3) {
            return _onChange3.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange3.toString();
          };

          return onChange;
        }(function (e) {
          return onChange({
            ApplyTo: e.target.value
          });
        }),
        value: preview.ApplyTo || ''
      }, ['Order', 'Client', 'Payment'].map(function (c) {
        return React.createElement(_core.MenuItem, {
          key: c,
          value: c.toLowerCase()
        }, intl.formatMessage(_DocumentTemplateDetailMessages.default[c.toLowerCase()]));
      }), React.createElement(_core.MenuItem, {
        key: "OrdersProducts",
        value: "OrdersProducts"
      }, intl.formatMessage(_DocumentTemplateDetailMessages.default.ordersProducts))))));
    }
  }, {
    key: "_onDrop",
    value: function _onDrop(field, acceptedFiles) {
      var _this2 = this;

      var first = acceptedFiles[0];

      if (!first) {
        return;
      }

      var reader = new FileReader();

      reader.onload = function () {
        if (reader.result) {
          _this2.props.onChange(_defineProperty({}, field, reader.result));
        }
      }; // tslint:disable-next-line:no-console


      reader.onabort = function () {
        return console.log('file reading was aborted');
      }; // tslint:disable-next-line:no-console


      reader.onerror = function () {
        return console.log('file reading has failed');
      };

      reader.readAsText(first, 'utf-8');
    }
  }]);

  return DocumentTemplateFields;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    drop: {
      display: 'inline-flex',
      position: 'relative',
      width: '100%',
      marginTop: 16,
      color: 'rgba(0, 0, 0, 0.5)',
      alignItems: 'center',
      '&:before': {
        content: '""',
        position: 'absolute',
        bottom: 0,
        left: 0,
        right: 0,
        borderBottom: '1px solid rgba(0, 0, 0, 0.5)'
      },
      '&:hover:before': {
        borderBottomWidth: 2,
        borderBottom: '1px solid rgba(0, 0, 0, 0.87)'
      }
    },
    dropActive: {
      color: theme.Colors.green.primary.contrastText
    },
    dropAccepted: {
      color: theme.Colors.green.primary.main,
      '&:hover:before': {
        borderBottomWidth: 2,
        borderColor: theme.Colors.green.primary.main
      }
    },
    dropRejected: {
      color: theme.Colors.red.primary.main,
      '&:hover:before': {
        borderBottomWidth: 2,
        borderColor: theme.Colors.red.primary.main
      }
    },
    icon: {
      height: '0.01em',
      display: 'flex',
      maxHeight: '2em',
      alignItems: 'center',
      color: 'inherit'
    },
    legend: {
      padding: '6px 0 7px',
      color: 'inherit'
    },
    iconImage: {
      marginRight: theme.spacing.unit
    }
  };
})(DocumentTemplateFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../../_services");

var _core = require("@material-ui/core");

var _ItemPreview = _interopRequireWildcard(require("src/components/ItemPreview/ItemPreview"));

var _DocumentTemplateDetail = _interopRequireDefault(require("../DocumentTemplateDetail/DocumentTemplateDetail"));

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var DocumentTemplatesList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DocumentTemplatesList, _React$Component);

  function DocumentTemplatesList(props) {
    var _this;

    _classCallCheck(this, DocumentTemplatesList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(DocumentTemplatesList).call(this, props));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(DocumentTemplatesList, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          templateCtx = _this$props.templateCtx,
          user = _this$props.authCtx.user,
          intl = _this$props.intl,
          classes = _this$props.classes;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened,
          creating = _this$state.creating,
          creatingOpened = _this$state.creatingOpened;
      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'create new',
        themeColor: 'green',
        onClick: this._add
      };
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Templates');
      return React.createElement(_GridContainer.GridContainer, null, templateCtx.templates.map(function (documentTemplate) {
        var name = documentTemplate.Title || '(no title)';
        var desciption = documentTemplate.Description || '';
        return React.createElement(_core.Grid, {
          key: documentTemplate.Id,
          item: true,
          xs: 12
        }, React.createElement(_ItemPreview.default, {
          onClick: hasRights ? function () {
            _this2.setState(function () {
              return {
                editing: documentTemplate,
                editingOpened: true
              };
            });
          } : undefined
        }, React.createElement(_core.Avatar, null, React.createElement(_icons.FileCopy, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, React.createElement("span", {
          className: classes.title
        }, name)), React.createElement(_ItemPreview.Line, null, desciption && React.createElement("span", {
          className: classes.description
        }, desciption)))));
      }), editing && React.createElement(_SideDialog.default, {
        open: !!editingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, React.createElement(_DocumentTemplateDetail.default, {
        templateCtx: templateCtx,
        key: editing.Id,
        changed: function changed(template) {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        initial: editing,
        intl: intl
      })), creating && React.createElement(_SideDialog.default, {
        open: !!creatingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        }
      }, React.createElement(_DocumentTemplateDetail.default, {
        templateCtx: templateCtx,
        key: creating.Id,
        changed: function changed() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        initial: creating,
        changes: creating,
        intl: intl
      })), React.createElement(_Fabs.default, {
        map: [addBtn]
      }));
    }
  }, {
    key: "_add",
    value: function _add() {
      var _this3 = this;

      _services.DocumentTemplates.Empty('new template', {}).then(function (newTemplate) {
        _this3.setState(function () {
          return {
            creating: newTemplate,
            creatingOpened: true
          };
        });
      });
    }
  }]);

  return DocumentTemplatesList;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {},
    title: {
      color: 'black',
      marginRight: theme.spacing.unit
    },
    description: {}
  };
})(DocumentTemplatesList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _PaymentsFields = _interopRequireDefault(require("./PaymentsFields"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Payments =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Payments, _React$Component);

  function Payments() {
    _classCallCheck(this, Payments);

    return _possibleConstructorReturn(this, _getPrototypeOf(Payments).apply(this, arguments));
  }

  _createClass(Payments, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          intl = _this$props.intl,
          settingsCtx = _this$props.settingsCtx,
          Settings = _this$props.settingsCtx.Settings;
      return React.createElement(_PaymentsFields.default, _extends({
        intl: intl,
        settingsCtx: settingsCtx
      }, {
        initial: Settings || {}
      }));
    }
  }]);

  return Payments;
}(React.Component);

var _default = Payments;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _notistack = require("notistack");

var _NumberField = _interopRequireDefault(require("src/components/NumberField/NumberField"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var PaymentsFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(PaymentsFields, _React$Component);

  function PaymentsFields(props) {
    var _this;

    _classCallCheck(this, PaymentsFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(PaymentsFields).call(this, props));
    _this.state = {
      changes: {},
      initial: props.initial
    };
    return _this;
  }

  _createClass(PaymentsFields, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          initial = _this$state.initial,
          changes = _this$state.changes,
          expandedIndex = _this$state.expandedIndex;

      var preview = _objectSpread({}, initial, changes);

      var changed = !!Object.keys(changes).length;
      return React.createElement(React.Fragment, null, React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, preview.Currencies.map(function (currency, index) {
        return React.createElement(_core.ExpansionPanel, {
          key: index,
          expanded: expandedIndex === index,
          onChange: function onChange() {
            return _this2.setState(function () {
              return {
                expandedIndex: expandedIndex === index ? undefined : index
              };
            });
          }
        }, React.createElement(_core.ExpansionPanelSummary, {
          expandIcon: React.createElement(_icons.ExpandMore, null)
        }, React.createElement("div", null, currency.Name, " - ", currency.Code, " - ", currency.Rate)), React.createElement(_core.ExpansionPanelDetails, null, React.createElement(_core.TextField, {
          label: 'currency name',
          value: currency.Name || '',
          onChange: function onChange(e) {
            var v = _toConsumableArray(preview.Currencies);

            v[index] = _objectSpread({}, v[index], {
              Name: e.target.value
            });

            _this2._HandleChange({
              Currencies: v
            });
          }
        }), React.createElement(_core.TextField, {
          label: 'currency code',
          value: currency.Code || '',
          onChange: function onChange(e) {
            var v = _toConsumableArray(preview.Currencies);

            v[index] = _objectSpread({}, v[index], {
              Code: e.target.value
            });

            _this2._HandleChange({
              Currencies: v
            });
          }
        }), React.createElement(_NumberField.default, {
          label: 'currency rate',
          value: currency.Rate || 0,
          step: "0.01",
          onNumberChange: function onNumberChange(value) {
            var v = _toConsumableArray(preview.Currencies);

            v[index] = _objectSpread({}, v[index], {
              Rate: value
            });

            _this2._HandleChange({
              Currencies: v
            });
          }
        })), React.createElement(_core.Divider, null), React.createElement(_core.ExpansionPanelActions, null, React.createElement(_core.Button, {
          size: "small",
          color: "secondary",
          variant: "contained",
          onClick: function onClick() {
            var v = _toConsumableArray(preview.Currencies);

            v.splice(index, 1);

            _this2._HandleChange({
              Currencies: v
            });
          }
        }, "remove currency", React.createElement(_icons.Delete, null))));
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_GridContainer.GridContainer, {
        justify: "center"
      }, React.createElement(_core.Button, {
        variant: "contained",
        color: "primary",
        size: "small",
        onClick: function onClick() {
          var v = [].concat(_toConsumableArray(preview.Currencies), [{
            Name: '',
            Code: '',
            Rate: 1
          }]);

          _this2._HandleChange({
            Currencies: v
          });
        }
      }, "add option", React.createElement(_icons.PlaylistAdd, {
        style: {
          paddingLeft: '7px'
        }
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.List, null, preview.PaymentProviders.map(function (paymentProvider) {
        return React.createElement(_core.ListItem, {
          key: paymentProvider
        }, React.createElement(_core.ListItemText, {
          primary: paymentProvider
        }), React.createElement(_core.ListItemSecondaryAction, null, React.createElement(_core.Switch, {
          checked: preview.HidePaymentProviders.indexOf(paymentProvider) < 0,
          onChange: function onChange(e) {
            var checked = e.target.checked;

            _this2.setState(function () {
              return {
                changes: {
                  HidePaymentProviders: !checked ? [].concat(_toConsumableArray(preview.HidePaymentProviders), [paymentProvider]).filter(function (elem, pos, arr) {
                    return arr.indexOf(elem) === pos;
                  }) : preview.HidePaymentProviders.filter(function (p) {
                    return p !== paymentProvider;
                  })
                }
              };
            });
          },
          value: "Hide"
        })));
      }))), preview.HidePaymentProviders.indexOf('transfer') < 0 && React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        multiline: true,
        label: "bank transfer message",
        value: preview.TransferMessage || '',
        onChange: function onChange(e) {
          return _this2._HandleChange({
            TransferMessage: e.target.value
          });
        }
      }))), changed && React.createElement(_Fabs.default, {
        map: [{
          icon: React.createElement(_icons.Check, null),
          onClick: function onClick() {
            _this2._HandleSave();
          },
          legend: 'save',
          color: 'primary',
          themeColor: 'green'
        }, {
          icon: React.createElement(_icons.Close, null),
          legend: 'cancel',
          onClick: function onClick() {
            _this2._HandleCancel();
          }
        }]
      }));
    }
  }, {
    key: "_HandleChange",
    value: function _HandleChange(changes) {
      var newChanges = _objectSpread({}, this.state.changes, changes);

      this.setState(function () {
        return {
          changes: newChanges
        };
      });
    }
  }, {
    key: "_HandleSave",
    value: function _HandleSave() {
      var _this3 = this;

      var _this$props = this.props,
          update = _this$props.settingsCtx.update,
          enqueueSnackbar = _this$props.enqueueSnackbar;
      var changes = this.state.changes;

      if (!Object.keys(changes).length) {
        return;
      }

      update(changes).then(function (model) {
        _this3.setState(function () {
          return {
            changes: {},
            initial: model
          };
        }, function () {
          enqueueSnackbar('configuration updated with success', {
            variant: 'success'
          });
        });
      }).catch(function (reason) {
        return enqueueSnackbar("error while updating configuration (".concat(reason, ")"), {
          variant: 'error'
        });
      });
    }
  }, {
    key: "_HandleCancel",
    value: function _HandleCancel() {
      var _this4 = this;

      this.setState(function () {
        return {
          changes: {},
          initial: _objectSpread({}, _this4.props.initial)
        };
      });
    }
  }]);

  return PaymentsFields;
}(React.Component);

var _default = (0, _notistack.withSnackbar)(PaymentsFields);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var md5 = _interopRequireWildcard(require("md5"));

var _services = require("../../_services");

var _core = require("@material-ui/core");

var _ListItem = _interopRequireDefault(require("@material-ui/core/ListItem"));

var _ListItemText = _interopRequireDefault(require("@material-ui/core/ListItemText"));

var _Avatar = _interopRequireDefault(require("@material-ui/core/Avatar"));

var _PowerSettingsNew = _interopRequireDefault(require("@material-ui/icons/PowerSettingsNew"));

var _Account = _interopRequireDefault(require("./Account/Account"));

var _icons = require("@material-ui/icons");

var _CategoriesList = _interopRequireDefault(require("./Categories/CategoriesList/CategoriesList"));

var _WarehousesList = _interopRequireDefault(require("./Warehouses/WarehousesList/WarehousesList"));

var _ShopsList = _interopRequireDefault(require("./Shops/ShopsList/ShopsList"));

var _UsersList = _interopRequireDefault(require("./Users/UsersList/UsersList"));

var classNames = _interopRequireWildcard(require("classnames"));

var _GridContainer = require("../GridContainer/GridContainer");

var _DocumentTemplatesList = _interopRequireDefault(require("./DocumentTemplate/DocumentTemplateList/DocumentTemplatesList"));

var _WarehouseIcon = _interopRequireDefault(require("../Products/ProductDetail/WarehouseIcon"));

var _Configuration = _interopRequireDefault(require("./Configuration/Configuration"));

var _Payments = _interopRequireDefault(require("./Payments/Payments"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Settings =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Settings, _React$Component);

  function Settings(props) {
    var _this;

    _classCallCheck(this, Settings);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Settings).call(this, props));
    _this._handleLogOut = _this._handleLogOut.bind(_assertThisInitialized(_this));
    _this._changeSubmenu = _this._changeSubmenu.bind(_assertThisInitialized(_this));
    _this.state = {
      user: _this.props.authCtx.user || {},
      users: [],
      activeSubmenu: 'Account'
    };
    return _this;
  }

  _createClass(Settings, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._fetch();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          user = _this$state.user,
          activeSubmenu = _this$state.activeSubmenu;
      var _this$props = this.props,
          classes = _this$props.classes,
          shopCtx = _this$props.shopCtx,
          warehouseCtx = _this$props.warehouseCtx,
          intl = _this$props.intl,
          settingsCtx = _this$props.settingsCtx,
          authCtx = _this$props.authCtx,
          templateCtx = _this$props.templateCtx,
          categoryCtx = _this$props.categoryCtx;
      var md5Hash = user && user.Email ? md5(user.Email) : '';
      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classNames(classes.menu)
      }, React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Account');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Account' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_Avatar.default, {
        className: classes.avatar,
        src: "https://www.gravatar.com/avatar/".concat(md5Hash, "?d=mm"),
        alt: "".concat(user.FirstName, " ").concat(user.LastName)
      })), React.createElement(_ListItemText.default, {
        primary: "Account"
      })), (0, _roles.IsAdminOrInRole)(user, 'CRUD_Users') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Users');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Users' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.People, null)), React.createElement(_ListItemText.default, {
        primary: "Users"
      })), (0, _roles.IsAdminOrInRole)(user, 'View_Shops') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Shops');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Shops' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Store, null)), React.createElement(_ListItemText.default, {
        primary: "Shops"
      })), (0, _roles.IsAdminOrInRole)(user, 'View_Warehouses') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Warehouses');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Warehouses' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_WarehouseIcon.default, null)), React.createElement(_ListItemText.default, {
        primary: "Warehouses"
      })), (0, _roles.IsAdminOrInRole)(user, 'CRUD_Categories') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Categories');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Categories' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Bookmarks, null)), React.createElement(_ListItemText.default, {
        primary: "Categories"
      })), (0, _roles.IsAdminOrInRole)(user, 'View_Templates') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Templates');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Templates' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.FileCopy, null)), React.createElement(_ListItemText.default, {
        primary: "Templates"
      })), (0, _roles.IsAdminOrInRole)(user, 'View_Payments') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Payments');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Payments' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.EuroSymbol, null)), React.createElement(_ListItemText.default, {
        primary: "Payments"
      })), (0, _roles.IsAdminOrInRole)(user, 'View_Configuration') && React.createElement(_ListItem.default, {
        button: true,
        onClick: function onClick(e) {
          return _this2._changeSubmenu('Configuration');
        },
        className: classNames(classes.menuItem, activeSubmenu === 'Configuration' && classes.menuItemActive)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_icons.Settings, null)), React.createElement(_ListItemText.default, {
        primary: "Configuration"
      })), React.createElement(_ListItem.default, {
        button: true,
        onClick: this._handleLogOut,
        className: classNames(classes.menuItem, classes.menuLogout)
      }, React.createElement(_core.ListItemIcon, null, React.createElement(_PowerSettingsNew.default, null)), React.createElement(_ListItemText.default, {
        primary: "Log out"
      })))), React.createElement(_core.Grid, {
        item: true,
        className: classes.main
      }, React.createElement("div", {
        className: classes.mainInner
      }, this.state.activeSubmenu === 'Account' && React.createElement(_Account.default, {
        shopCtx: shopCtx,
        warehouseCtx: warehouseCtx,
        onChanged: function onChanged(changed) {
          return _this2.setState(function () {
            return {
              user: changed
            };
          });
        },
        intl: this.props.intl,
        authCtx: this.props.authCtx
      }), this.state.activeSubmenu === 'Users' && React.createElement(_UsersList.default, {
        intl: intl,
        settingsCtx: settingsCtx,
        authCtx: authCtx
      }), this.state.activeSubmenu === 'Shops' && React.createElement(_ShopsList.default, {
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx
      }), this.state.activeSubmenu === 'Warehouses' && React.createElement(_WarehousesList.default, {
        intl: intl,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx
      }), this.state.activeSubmenu === 'Categories' && React.createElement(_CategoriesList.default, {
        intl: intl,
        categoryCtx: categoryCtx
      }), this.state.activeSubmenu === 'Templates' && React.createElement(_DocumentTemplatesList.default, {
        intl: intl,
        templateCtx: templateCtx,
        authCtx: authCtx
      }), this.state.activeSubmenu === 'Payments' && React.createElement(_Payments.default, {
        intl: intl,
        settingsCtx: settingsCtx
      }), this.state.activeSubmenu === 'Configuration' && React.createElement(_Configuration.default, {
        intl: intl,
        settingsCtx: settingsCtx
      }))));
    }
  }, {
    key: "_fetch",
    value: function _fetch() {
      var _this3 = this;

      // fetch users 
      _services.Users.GetAll(0, 50).then(function (result) {
        _this3.setState(function () {
          return {
            users: result.Values
          };
        });
      });
    }
  }, {
    key: "_handleLogOut",
    value: function _handleLogOut() {
      this.props.authCtx.logout();
    }
  }, {
    key: "_changeSubmenu",
    value: function _changeSubmenu(activeSubmenu) {
      this.setState({
        activeSubmenu: activeSubmenu
      });
      localStorage.setItem('settingActiveSubmenu', activeSubmenu);
    } // private _isAdmin(user: TUser) {
    //     return user.Roles && user.'indexOf'('Admin') >= 0;
    // }

  }]);

  return Settings;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative',
      flexWrap: 'nowrap'
    },
    menu: {
      height: '100%',
      boxSizing: 'border-box',
      display: 'flex',
      flexDirection: 'column'
    },
    menuItem: {
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      opacity: 0.5,
      flex: '0 0 auto',
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    main: {
      height: '100%',
      position: 'relative',
      flex: '1 1 auto',
      padding: '10px 40px'
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    mainInner: {
      padding: '8px 8px 0 8px',
      overflow: 'auto',
      height: '100%'
    },
    menuLogout: {
      marginTop: 'auto'
    },
    avatar: {
      width: 24,
      height: 24
    }
  };
})(Settings);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.UsersDetailStandalone = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ShopsFields = _interopRequireDefault(require("../ShopsFields/ShopsFields"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _ShopsDetailMessages = _interopRequireDefault(require("./ShopsDetailMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ShopsDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ShopsDetail, _React$Component);

  function ShopsDetail(props) {
    var _this;

    _classCallCheck(this, ShopsDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopsDetail).call(this, props));
    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(ShopsDetail, [{
    key: "render",
    value: function render() {
      return this._renderShop();
    }
  }, {
    key: "_renderShop",
    value: function _renderShop() {
      var _this2 = this;

      var _this$props = this.props,
          cancel = _this$props.cancel,
          Id = _this$props.initial.Id,
          intl = _this$props.intl,
          initial = _this$props.initial;
      var changes = this.state.changes;
      return React.createElement(React.Fragment, null, React.createElement(_core.DialogContent, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          e.preventDefault();

          _this2._OnSave(_this2.state.changes);
        }
      }, React.createElement(_ShopsFields.default, {
        intl: intl,
        initial: initial,
        onChange: function onChange(shop) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, shop)
            };
          });
        },
        changes: changes
      }))), React.createElement(_core.DialogActions, null, Id && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this2._OnDelete(Id);
        }
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: cancel
      }, "close"), (Object.keys(changes).length || !Id) && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnSave(changes);
        }
      }, "save")));
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete(id) {
      var _this$props2 = this.props,
          Shops = _this$props2.shopCtx,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_ShopsDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        Shops.delete(id).then(onDelete);
      }
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(modif) {
      var _this3 = this;

      var _this$props3 = this.props,
          Id = _this$props3.initial.Id,
          Shops = _this$props3.shopCtx,
          changed = _this$props3.changed,
          changes = this.state.changes;

      var allChanges = _objectSpread({}, changes, modif);

      if (Id) {
        return Shops.patch(Id, allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      } else {
        return Shops.create(allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      }
    }
  }]);

  return ShopsDetail;
}(React.Component);

var UsersDetailStandalone = (0, _reactIntl.injectIntl)(ShopsDetail);
exports.UsersDetailStandalone = UsersDetailStandalone;
var _default = ShopsDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ShopDetailMesseges = void 0;

var _reactIntl = require("react-intl");

var ShopDetailMesseges = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.settings.shops.name",
    "defaultMessage": "Name"
  },
  address: {
    "id": "src.components.settings.shops.address",
    "defaultMessage": "Address"
  },
  city: {
    "id": "src.components.settings.shops.city",
    "defaultMessage": "City"
  },
  countryIso: {
    "id": "src.components.settings.shops.countryIso",
    "defaultMessage": "Country Iso"
  },
  email: {
    "id": "src.components.settings.shops.email",
    "defaultMessage": "Email"
  },
  organizationName: {
    "id": "src.components.settings.shops.organizationName",
    "defaultMessage": "Organization name"
  },
  phone: {
    "id": "src.components.settings.shops.phone",
    "defaultMessage": "Phone"
  },
  postalCode: {
    "id": "src.components.settings.shops.postalCode",
    "defaultMessage": "Postal code"
  },
  state: {
    "id": "src.components.settings.shops.state",
    "defaultMessage": "State"
  },
  vatNumber: {
    "id": "src.components.settings.shops.vatNumber",
    "defaultMessage": "VAT number"
  },
  deleteConfirm: {
    "id": "src.components.settings.shops.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this shop?"
  }
});
exports.ShopDetailMesseges = ShopDetailMesseges;
var _default = ShopDetailMesseges;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ShopsFieldsStandalone = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _reactIntl = require("react-intl");

var _ShopsDetailMessages = _interopRequireDefault(require("../ShopsDetail/ShopsDetailMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _i18nIsoCountries = _interopRequireDefault(require("i18n-iso-countries"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var ShopsFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ShopsFields, _React$Component);

  function ShopsFields(props) {
    var _this;

    _classCallCheck(this, ShopsFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopsFields).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_countries", void 0);

    var countriesList = _i18nIsoCountries.default.getNames(props.intl.locale);

    _this._countries = Object.keys(countriesList).map(function (v) {
      return {
        value: v,
        preview: countriesList[v]
      };
    });
    return _this;
  }

  _createClass(ShopsFields, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this2 = this;

      var initial = this.props.initial;

      var preview = _objectSpread({}, initial, this.props.changes);

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(e) {
          return _this2.props.onChange({
            Name: e.target.value
          });
        },
        value: preview.Name || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.firstName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Address: value.target.value
          });
        },
        value: preview.Address || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.address)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            City: value.target.value
          });
        },
        value: preview.City || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.city)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "age-simple"
      }, this.props.intl.formatMessage(_ShopsDetailMessages.default.countryIso)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            CountryIso: value.target.value
          });
        },
        value: preview.CountryIso || ''
      }, this._countries.map(function (c) {
        return React.createElement(_core.MenuItem, {
          key: c.value,
          value: c.value
        }, c.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Email: value.target.value
          });
        },
        value: preview.Email || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.email)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            OrganizationName: value.target.value
          });
        },
        value: preview.OrganizationName || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.organizationName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Phone: value.target.value
          });
        },
        value: preview.Phone || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.phone)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            State: value.target.value
          });
        },
        value: preview.State || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.state)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            PostalCode: value.target.value
          });
        },
        value: preview.PostalCode || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.postalCode)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            VATNumber: value.target.value
          });
        },
        value: preview.VATNumber || '',
        label: this.props.intl.formatMessage(_ShopsDetailMessages.default.vatNumber)
      })));
    }
  }]);

  return ShopsFields;
}(React.Component);

var ShopsFieldsStandalone = (0, _reactIntl.injectIntl)(ShopsFields);
exports.ShopsFieldsStandalone = ShopsFieldsStandalone;
var _default = ShopsFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _ShopsDetail = _interopRequireDefault(require("../ShopsDetail/ShopsDetail"));

var _services = require("../../../../_services");

var _core = require("@material-ui/core");

var _ItemPreview = _interopRequireWildcard(require("../../../ItemPreview/ItemPreview"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var classNames = _interopRequireWildcard(require("classnames"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ShopsList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ShopsList, _React$Component);

  function ShopsList(props) {
    var _this;

    _classCallCheck(this, ShopsList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopsList).call(this, props));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(ShopsList, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          shopCtx = _this$props.shopCtx,
          user = _this$props.authCtx.user,
          intl = _this$props.intl,
          classes = _this$props.classes;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened,
          creating = _this$state.creating,
          creatingOpened = _this$state.creatingOpened;
      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'create new',
        themeColor: 'green',
        onClick: this._add
      };
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Shops');
      return React.createElement(_GridContainer.GridContainer, null, shopCtx.Shops.map(function (shop) {
        var name = shop.Name || '';
        var city = shop.City || '';
        var email = shop.Email || '';
        var phone = shop.Phone || '';
        return React.createElement(_core.Grid, {
          key: shop.Id,
          item: true,
          xs: 12
        }, React.createElement(_ItemPreview.default, {
          onClick: hasRights ? function () {
            _this2.setState(function () {
              return {
                editing: shop,
                editingOpened: true
              };
            });
          } : undefined
        }, React.createElement(_core.Avatar, null, React.createElement(_icons.Store, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, name && React.createElement("span", {
          className: classNames(classes.bold, classes.spacer)
        }, name), city && React.createElement("span", null, city)), React.createElement(_ItemPreview.Line, null, email && React.createElement("span", {
          className: classes.spacer
        }, email), phone && React.createElement("span", null, phone)))));
      }), React.createElement(_SideDialog.default, {
        open: !!editingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, editing && React.createElement(_ShopsDetail.default, {
        key: editing.Id,
        shopCtx: shopCtx,
        changed: function changed(shop) {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        initial: editing,
        intl: intl
      })), React.createElement(_SideDialog.default, {
        open: !!creatingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, creating && React.createElement(_ShopsDetail.default, {
        key: creating.Id,
        shopCtx: shopCtx,
        changed: function changed(shop) {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        initial: creating,
        changes: creating,
        intl: intl
      })), hasRights && React.createElement(_Fabs.default, {
        map: [addBtn]
      }));
    }
  }, {
    key: "_add",
    value: function _add() {
      var _this3 = this;

      _services.Shops.Empty('New Shop', {}).then(function (newShop) {
        _this3.setState(function () {
          return {
            creating: newShop,
            creatingOpened: true
          };
        });
      });
    }
  }]);

  return ShopsList;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {},
    bold: {
      fontWeight: 'bold',
      color: 'black'
    },
    spacer: {
      marginRight: '.4rem'
    }
  };
})(ShopsList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _UsersFields = _interopRequireDefault(require("../UsersFileds/UsersFields"));

var _services = require("src/_services");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _notistack = require("notistack");

var _UsersDetailMessages = _interopRequireDefault(require("./UsersDetailMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var UsersDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(UsersDetail, _React$Component);

  function UsersDetail(props) {
    var _this;

    _classCallCheck(this, UsersDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(UsersDetail).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_RegisterLinkRef", React.createRef());

    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(UsersDetail, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this2 = this;

      var _this$props = this.props,
          cancel = _this$props.cancel,
          Id = _this$props.initial.Id,
          intl = _this$props.intl,
          initial = _this$props.initial,
          enqueueSnackbar = _this$props.enqueueSnackbar,
          formatMessage = _this$props.intl.formatMessage;
      var _this$state = this.state,
          changes = _this$state.changes,
          resetLink = _this$state.resetLink;
      return React.createElement(React.Fragment, null, React.createElement(_core.DialogContent, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          e.preventDefault();

          _this2._OnSave(_this2.state.changes);
        }
      }, React.createElement(_UsersFields.default, {
        intl: intl,
        initial: initial,
        onChange: function onChange(user) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, user)
            };
          });
        },
        changes: this.state.changes
      }), Id && React.createElement(_core.ButtonBase, {
        disableRipple: true,
        onClick: !resetLink ? function (e) {
          _this2._Reset(Id);

          e.preventDefault();
          e.stopPropagation();
        } : undefined,
        style: {
          width: '100%',
          cursor: 'pointer'
        }
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, null, formatMessage(_UsersDetailMessages.default.resetPassword)), React.createElement(_core.Input, {
        inputRef: this._RegisterLinkRef,
        fullWidth: true,
        type: 'text',
        value: resetLink || '',
        endAdornment: resetLink && React.createElement(_core.InputAdornment, {
          position: "end"
        }, React.createElement(_core.IconButton, {
          onClick: function onClick(e) {
            try {
              var input = _this2._RegisterLinkRef.current;

              if (input && resetLink) {
                input.select();
                document.execCommand('copy');
                enqueueSnackbar('link copied');
              }
            } finally {// prevent crash
            }
          }
        }, React.createElement(_icons.FileCopy, null)), React.createElement(_core.IconButton, {
          onClick: function onClick(e) {
            try {
              window.open(resetLink, '_blank');
            } finally {// prevent crash
            }
          }
        }, React.createElement(_icons.OpenInNew, null)))
      }))))), React.createElement(_core.DialogActions, null, Id && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this2._OnDelete(Id);
        }
      }, React.createElement(_icons.Delete, null), formatMessage(_UsersDetailMessages.default.delete)), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: cancel
      }, "close"), Object.keys(changes).length && Id && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnSave(changes);
        }
      }, formatMessage(_UsersDetailMessages.default.save)), !Id && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnAdd(changes);
        }
      }, formatMessage(_UsersDetailMessages.default.create))));
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete(id) {
      var _this$props2 = this.props,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_UsersDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        _services.Users.Delete(id).then(function () {
          onDelete();
        });
      }
    }
  }, {
    key: "_Reset",
    value: function _Reset(id) {
      var _this3 = this;

      _services.Users.Reset(id).then(function (resp) {
        var base = location.href.replace(location.hash, ''); // tslint:disable-next-line:max-line-length

        var hash = "action=reset&id=".concat(encodeURIComponent(resp.Id), "&code=").concat(encodeURIComponent(resp.Code), "&username=").concat(encodeURIComponent(resp.Username));
        var resetLink = "".concat(base, "#").concat(hash);

        _this3.setState(function () {
          return {
            resetLink: resetLink
          };
        });
      });
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(changes) {
      var _this4 = this;

      return _services.Users.Patch(this.props.initial.Id, changes).then(function (model) {
        _this4.setState(function () {
          return {
            initial: model,
            changes: {}
          };
        });

        _this4.props.changed(model);
      });
    }
  }, {
    key: "_OnAdd",
    value: function _OnAdd(changes) {
      var _this5 = this;

      return _services.Users.Create(changes).then(function (model) {
        _this5.setState(function () {
          return {
            initial: model,
            changes: {}
          };
        });

        _this5.props.changed(model);
      });
    }
  }]);

  return UsersDetail;
}(React.Component);

var _default = (0, _notistack.withSnackbar)(UsersDetail);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.UsersDetailMessages = void 0;

var _reactIntl = require("react-intl");

var UsersDetailMessages = (0, _reactIntl.defineMessages)({
  deleteConfirm: {
    "id": "src.components.settings.users.usersDetail.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this product?"
  },
  delete: {
    "id": "src.components.settings.users.usersDetail.delete",
    "defaultMessage": "delete"
  },
  save: {
    "id": "src.components.settings.users.usersDetail.save",
    "defaultMessage": "save"
  },
  create: {
    "id": "src.components.settings.users.usersDetail.create",
    "defaultMessage": "create"
  },
  resetPassword: {
    "id": "src.components.settings.users.usersDetail.resetPassword",
    "defaultMessage": "Request Reset Password link"
  }
});
exports.UsersDetailMessages = UsersDetailMessages;
var _default = UsersDetailMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _UsersFieldsMessages = _interopRequireDefault(require("./UsersFieldsMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var UserFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(UserFields, _React$Component);

  function UserFields(props) {
    _classCallCheck(this, UserFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(UserFields).call(this, props));
  }

  _createClass(UserFields, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this = this;

      var initial = this.props.initial;

      var preview = _objectSpread({}, initial, this.props.changes); // TODO: what to do with this fields:
      // ShopId: string;
      // Token: string;


      var Roles = preview.Roles;
      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(e) {
          return _this.props.onChange({
            FirstName: e.target.value
          });
        },
        value: preview.FirstName || '',
        label: this.props.intl.formatMessage(_UsersFieldsMessages.default.firstName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this.props.onChange({
            LastName: value.target.value
          });
        },
        value: preview.LastName || '',
        label: this.props.intl.formatMessage(_UsersFieldsMessages.default.lastName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this.props.onChange({
            Email: value.target.value
          });
        },
        value: preview.Email || '',
        label: this.props.intl.formatMessage(_UsersFieldsMessages.default.email)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this.props.onChange({
            UserName: value.target.value
          });
        },
        value: preview.UserName || '',
        label: this.props.intl.formatMessage(_UsersFieldsMessages.default.userName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "shops-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this.props.onChange({
            PhoneNumber: value.target.value
          });
        },
        value: preview.PhoneNumber || '',
        label: this.props.intl.formatMessage(_UsersFieldsMessages.default.phoneNumber)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "select-roles"
      }, this.props.intl.formatMessage(_UsersFieldsMessages.default.roles)), React.createElement(_core.Select, {
        fullWidth: true,
        multiple: true,
        value: Roles // tslint:disable-next-line:no-any
        ,
        onChange: function onChange(e) {
          return _this.props.onChange({
            Roles: e.target.value
          });
        },
        input: React.createElement(_core.Input, {
          id: "select-roles"
        }),
        renderValue: function renderValue(rs) {
          return React.createElement("div", {
            style: {
              display: 'flex',
              flexWrap: 'wrap'
            }
          }, rs.map(function (value) {
            return value ? React.createElement(_core.Chip, {
              key: value,
              label: value,
              style: {
                marginRight: '5px'
              }
            }) : null;
          }));
        }
      }, ['Admin', 'View_Dashboard', 'List_Orders', 'CRUD_Own_Orders', 'CRUD_All_Orders', 'CRUD_Clients', 'CRUD_Products', 'List_Vouchers', 'CRUD_Vouchers', 'View_Shops_Movements', 'CRUD_Shops_Movements', 'CRUD_Stocks_Units_Movements', 'CRUD_Users', 'CRUD_Categories', 'View_Shops', 'CRUD_Shops', 'View_Warehouses', 'CRUD_Warehouses', 'View_Templates', 'CRUD_Templates', 'View_Payments', 'View_Configuration'].map(function (r) {
        return React.createElement(_core.MenuItem, {
          value: r,
          style: {
            fontWeight: Roles.indexOf(r) >= 0 ? 'bold' : 'inherit'
          }
        }, r);
      })))));
    }
  }]);

  return UserFields;
}(React.Component);

var _default = UserFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.settings.users.firstName",
    "defaultMessage": "First name"
  },
  lastName: {
    "id": "src.components.settings.users.lastName",
    "defaultMessage": "Last name"
  },
  email: {
    "id": "src.components.settings.users.email",
    "defaultMessage": "Email"
  },
  userName: {
    "id": "src.components.settings.users.userName",
    "defaultMessage": "User name"
  },
  phoneNumber: {
    "id": "src.components.settings.users.phoneNumber",
    "defaultMessage": "Phone number"
  },
  roles: {
    "id": "src.components.settings.users.roles",
    "defaultMessage": "Role"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../../_services");

var _UsersDetail = _interopRequireDefault(require("../UsersDetail/UsersDetail"));

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var classNames = _interopRequireWildcard(require("classnames"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _ItemPreview = _interopRequireWildcard(require("src/components/ItemPreview/ItemPreview"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var UsersList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(UsersList, _React$Component);

  function UsersList(props) {
    var _this;

    _classCallCheck(this, UsersList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(UsersList).call(this, props));
    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this.state = {
      user: _this.props.authCtx.user || {},
      users: []
    };
    return _this;
  }

  _createClass(UsersList, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._fetch();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var users = this.state.users.filter(function (u) {
        return !_this2._isMe(u);
      });
      var _this$props = this.props,
          intl = _this$props.intl,
          classes = _this$props.classes;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened;
      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'create new',
        themeColor: 'green',
        onClick: this._add
      };
      return React.createElement(_GridContainer.GridContainer, null, users.map(function (user) {
        var firstName = user.FirstName || '';
        var lastName = user.LastName || '';
        var email = user.Email || '';
        var userName = user.UserName || '';
        var baseCls = 'users-detail__preview';
        return React.createElement(_core.Grid, {
          key: user.Id,
          item: true,
          xs: 12
        }, React.createElement(_ItemPreview.default, {
          onClick: function onClick() {
            _this2.setState(function () {
              return {
                editing: user,
                editingOpened: true
              };
            });
          }
        }, React.createElement(_core.Avatar, null, React.createElement(_icons.Person, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, firstName && React.createElement("span", {
          className: classNames(classes.bold, classes.spacer)
        }, firstName), lastName && React.createElement("span", {
          className: classNames(classes.bold, classes.spacer)
        }, lastName)), React.createElement(_ItemPreview.Line, null, email && React.createElement("span", {
          className: classes.spacer
        }, email), userName && React.createElement("span", {
          className: "".concat(baseCls, " ").concat(baseCls, "--phone")
        }, userName)))));
      }), editing && React.createElement(_SideDialog.default, {
        open: !!editingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, React.createElement(_UsersDetail.default, {
        initial: editing,
        intl: intl,
        changed: function changed() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });

          _this2._fetch();
        },
        onDelete: function onDelete() {
          _this2._fetch();

          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      })), React.createElement(_Fabs.default, {
        map: [addBtn]
      }));
    }
  }, {
    key: "_add",
    value: function _add() {
      var _this3 = this;

      _services.Users.Empty({}).then(function (result) {
        _this3.setState(function () {
          return {
            editing: result,
            editingOpened: true
          };
        });
      });
    }
  }, {
    key: "_fetch",
    value: function _fetch() {
      var _this4 = this;

      _services.Users.GetAll(0, 50).then(function (result) {
        _this4.setState(function () {
          return {
            users: result.Values
          };
        });
      });
    } // private _isAdmin(user: TUser) {
    //     return user.Roles && user.Roles.indexOf(Roles.Admin) >= 0;
    // }

  }, {
    key: "_isMe",
    value: function _isMe(user) {
      return this.props.authCtx.user && user.UserName === this.props.authCtx.user.UserName;
    }
  }]);

  return UsersList;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {},
    bold: {
      fontWeight: 'bold',
      color: 'black'
    },
    spacer: {
      marginRight: '.4rem'
    }
  };
})(UsersList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.settings.user.firstName",
    "defaultMessage": "First Name"
  },
  lastName: {
    "id": "src.components.settings.user.lastName",
    "defaultMessage": "Last Name"
  },
  phoneNumber: {
    "id": "src.components.settings.user.phone",
    "defaultMessage": "Phone number"
  },
  email: {
    "id": "src.components.settings.user.email",
    "defaultMessage": "Email"
  },
  defaultShop: {
    "id": "src.components.settings.user.shop",
    "defaultMessage": "Shop"
  },
  defaultWarehouse: {
    "id": "src.components.settings.user.warehouse",
    "defaultMessage": "Warehouse"
  },
  resetPassword: {
    "id": "src.components.settings.user.resetPassword",
    "defaultMessage": "New password"
  },
  confirmPassword: {
    "id": "src.components.settings.user.confirmPassword",
    "defaultMessage": "Confirm password"
  },
  currentPassword: {
    "id": "src.components.settings.user.currentPassword",
    "defaultMessage": "Current password"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.WarehousesDetailStandalone = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _WarehousesFields = _interopRequireDefault(require("../WarehousesFields/WarehousesFields"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _WarehousesDetailMessages = _interopRequireDefault(require("./WarehousesDetailMessages"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var WarehousesDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(WarehousesDetail, _React$Component);

  function WarehousesDetail(props) {
    var _this;

    _classCallCheck(this, WarehousesDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(WarehousesDetail).call(this, props));
    _this.state = {
      changes: {}
    };
    return _this;
  }

  _createClass(WarehousesDetail, [{
    key: "render",
    value: function render() {
      return this._renderWarehouse();
    }
  }, {
    key: "_renderWarehouse",
    value: function _renderWarehouse() {
      var _this2 = this;

      var _this$props = this.props,
          cancel = _this$props.cancel,
          Id = _this$props.initial.Id,
          intl = _this$props.intl,
          initial = _this$props.initial,
          user = _this$props.authCtx.user;
      var changes = this.state.changes;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Products');
      return React.createElement(React.Fragment, null, React.createElement(_core.DialogContent, null, React.createElement("form", {
        onSubmit: function onSubmit(e) {
          e.preventDefault();

          _this2._OnSave(changes);
        }
      }, React.createElement(_WarehousesFields.default, {
        intl: intl,
        initial: initial,
        onChange: function onChange(warehouse) {
          _this2.setState(function (prev) {
            return {
              changes: _objectSpread({}, prev.changes, warehouse)
            };
          });
        },
        changes: changes
      }))), React.createElement(_core.DialogActions, null, hasRights && Id && React.createElement(_core.Button, {
        color: "secondary",
        variant: "contained",
        onClick: function onClick() {
          return _this2._OnDelete(Id);
        }
      }, React.createElement(_icons.Delete, null), "delete"), React.createElement(_core.Button, {
        color: "default",
        variant: "contained",
        onClick: cancel
      }, "close"), hasRights && (Object.keys(changes).length || !Id) && React.createElement(_core.Button, {
        color: "primary",
        variant: "contained",
        onClick: function onClick() {
          _this2._OnSave(changes);
        }
      }, "save")));
    }
  }, {
    key: "_OnDelete",
    value: function _OnDelete(id) {
      var _this$props2 = this.props,
          Warehouses = _this$props2.warehouseCtx,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_WarehousesDetailMessages.default.deleteConfirm));

      if (isTodelete) {
        Warehouses.delete(id).then(onDelete);
      }
    }
  }, {
    key: "_OnSave",
    value: function _OnSave(modif) {
      var _this3 = this;

      var _this$props3 = this.props,
          Id = _this$props3.initial.Id,
          Warehouses = _this$props3.warehouseCtx,
          changed = _this$props3.changed,
          changes = this.state.changes;

      var allChanges = _objectSpread({}, changes, modif);

      if (Id) {
        return Warehouses.patch(Id, allChanges).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      } else {
        return Warehouses.create(changes).then(function (model) {
          _this3.setState(function () {
            return {
              initial: model,
              changes: {}
            };
          });

          changed(model);
        });
      }
    }
  }]);

  return WarehousesDetail;
}(React.Component);

var WarehousesDetailStandalone = (0, _reactIntl.injectIntl)(WarehousesDetail);
exports.WarehousesDetailStandalone = WarehousesDetailStandalone;
var _default = WarehousesDetail;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.WarehouseDetailMessages = void 0;

var _reactIntl = require("react-intl");

var WarehouseDetailMessages = (0, _reactIntl.defineMessages)({
  firstName: {
    "id": "src.components.settings.warehouses.name",
    "defaultMessage": "Name"
  },
  address: {
    "id": "src.components.settings.warehouses.address",
    "defaultMessage": "Address"
  },
  city: {
    "id": "src.components.settings.warehouses.city",
    "defaultMessage": "City"
  },
  countryIso: {
    "id": "src.components.settings.warehouses.countryIso",
    "defaultMessage": "Country"
  },
  email: {
    "id": "src.components.settings.warehouses.email",
    "defaultMessage": "Email"
  },
  phone: {
    "id": "src.components.settings.warehouses.phone",
    "defaultMessage": "Phone"
  },
  postalCode: {
    "id": "src.components.settings.warehouses.postalCode",
    "defaultMessage": "Postal code"
  },
  state: {
    "id": "src.components.settings.warehouses.state",
    "defaultMessage": "State"
  },
  vatNumber: {
    "id": "src.components.settings.warehouses.vatNumber",
    "defaultMessage": "VAT number"
  },
  deleteConfirm: {
    "id": "src.components.settings.warehouses.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this product?"
  }
});
exports.WarehouseDetailMessages = WarehouseDetailMessages;
var _default = WarehouseDetailMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.WarehousesFieldsStandalone = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _reactIntl = require("react-intl");

var _WarehousesDetailMessages = _interopRequireDefault(require("../WarehousesDetail/WarehousesDetailMessages"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _i18nIsoCountries = _interopRequireDefault(require("i18n-iso-countries"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var WarehousesFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(WarehousesFields, _React$Component);

  function WarehousesFields(props) {
    var _this;

    _classCallCheck(this, WarehousesFields);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(WarehousesFields).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_countries", void 0);

    var countriesList = _i18nIsoCountries.default.getNames(props.intl.locale);

    _this._countries = Object.keys(countriesList).map(function (v) {
      return {
        value: v,
        preview: countriesList[v]
      };
    });
    return _this;
  }

  _createClass(WarehousesFields, [{
    key: "render",
    value: function render() {
      return this._renderUser();
    }
  }, {
    key: "_renderUser",
    value: function _renderUser() {
      var _this2 = this;

      var initial = this.props.initial;

      var preview = _objectSpread({}, initial, this.props.changes);

      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(e) {
          return _this2.props.onChange({
            Name: e.target.value
          });
        },
        value: preview.Name || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.firstName)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Address: value.target.value
          });
        },
        value: preview.Address || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.address)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            City: value.target.value
          });
        },
        value: preview.City || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.city)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.FormControl, {
        fullWidth: true
      }, React.createElement(_core.InputLabel, {
        htmlFor: "age-simple"
      }, this.props.intl.formatMessage(_WarehousesDetailMessages.default.countryIso)), React.createElement(_core.Select, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            CountryIso: value.target.value
          });
        },
        value: preview.CountryIso || ''
      }, this._countries.map(function (c) {
        return React.createElement(_core.MenuItem, {
          key: c.value,
          value: c.value
        }, c.preview);
      })))), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Email: value.target.value
          });
        },
        value: preview.Email || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.email)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            Phone: value.target.value
          });
        },
        value: preview.Phone || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.phone)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            State: value.target.value
          });
        },
        value: preview.State || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.state)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12,
        className: "warehouses-detail__lightbox-field"
      }, React.createElement(_core.TextField, {
        fullWidth: true,
        onChange: function onChange(value) {
          return _this2.props.onChange({
            PostalCode: value.target.value
          });
        },
        value: preview.PostalCode || '',
        label: this.props.intl.formatMessage(_WarehousesDetailMessages.default.postalCode)
      })));
    }
  }]);

  return WarehousesFields;
}(React.Component);

var WarehousesFieldsStandalone = (0, _reactIntl.injectIntl)(WarehousesFields);
exports.WarehousesFieldsStandalone = WarehousesFieldsStandalone;
var _default = WarehousesFields;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _services = require("../../../../_services");

var _core = require("@material-ui/core");

var _ItemPreview = _interopRequireWildcard(require("src/components/ItemPreview/ItemPreview"));

var _WarehousesDetail = _interopRequireDefault(require("../WarehousesDetail/WarehousesDetail"));

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _icons = require("@material-ui/icons");

var _SideDialog = _interopRequireDefault(require("src/components/SideDialog/SideDialog"));

var classNames = _interopRequireWildcard(require("classnames"));

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _WarehouseIcon = _interopRequireDefault(require("src/components/Products/ProductDetail/WarehouseIcon"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var WarehousesList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(WarehousesList, _React$Component);

  function WarehousesList(props) {
    var _this;

    _classCallCheck(this, WarehousesList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(WarehousesList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_add", function () {
      _services.Warehouses.Empty('New Warehouse', {}).then(function (newWarehouse) {
        _this.setState(function () {
          return {
            creating: newWarehouse,
            creatingOpened: true
          };
        });
      });
    });

    _this._add = _this._add.bind(_assertThisInitialized(_this));
    _this.state = {};
    return _this;
  }

  _createClass(WarehousesList, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          user = _this$props.authCtx.user,
          intl = _this$props.intl,
          classes = _this$props.classes;
      var _this$state = this.state,
          editing = _this$state.editing,
          editingOpened = _this$state.editingOpened,
          creating = _this$state.creating,
          creatingOpened = _this$state.creatingOpened;
      var addBtn = {
        icon: React.createElement(_icons.Add, null),
        legend: 'create new',
        themeColor: 'green',
        onClick: this._add
      };
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Warehouses');
      return React.createElement(_GridContainer.GridContainer, null, warehouseCtx.Warehouses.map(function (warehouse) {
        var name = warehouse.Name || '';
        var city = warehouse.City || '';
        var email = warehouse.Email || '';
        var phone = warehouse.Phone || '';
        return React.createElement(_core.Grid, {
          key: warehouse.Id,
          item: true,
          xs: 12
        }, React.createElement(_ItemPreview.default, {
          onClick: hasRights ? function () {
            _this2.setState(function () {
              return {
                editing: warehouse,
                editingOpened: true
              };
            });
          } : undefined
        }, React.createElement(_core.Avatar, null, React.createElement(_WarehouseIcon.default, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, name && React.createElement("span", {
          className: classNames(classes.bold, classes.spacer)
        }, name), city && React.createElement("span", null, city)), React.createElement(_ItemPreview.Line, null, email && React.createElement("span", {
          className: classes.spacer
        }, email), phone && React.createElement("span", null, phone)))));
      }), React.createElement(_SideDialog.default, {
        open: !!editingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, editing && React.createElement(_WarehousesDetail.default, {
        key: editing.Id,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        changed: function changed(warehouse) {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        initial: editing,
        intl: intl
      })), React.createElement(_SideDialog.default, {
        open: !!creatingOpened,
        onClose: function onClose() {
          return _this2.setState(function () {
            return {
              editingOpened: false
            };
          });
        }
      }, creating && React.createElement(_WarehousesDetail.default, {
        key: creating.Id,
        warehouseCtx: warehouseCtx,
        authCtx: authCtx,
        changed: function changed(warehouse) {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        onDelete: function onDelete() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        cancel: function cancel() {
          _this2.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        initial: creating,
        changes: creating,
        intl: intl
      })), hasRights && React.createElement(_Fabs.default, {
        map: [addBtn]
      }));
    }
  }]);

  return WarehousesList;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    container: {},
    bold: {
      fontWeight: 'bold',
      color: 'black'
    },
    spacer: {
      marginRight: 10
    }
  };
})(WarehousesList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _core = require("@material-ui/core");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var ShopsField = function ShopsField(props) {
  var Shops = props.shopCtx.Shops,
      textFieldProps = _objectWithoutProperties(props, ["shopCtx"]);

  if (Shops.length <= 1) {
    return React.createElement(_TextField.default, _extends({}, textFieldProps, {
      disabled: true
    }));
  }

  return React.createElement(_TextField.default, _extends({}, textFieldProps, {
    select: true
  }), Shops.map(function (c) {
    return React.createElement(_core.MenuItem, {
      key: c.Id,
      value: c.Id
    }, c.Name);
  }));
};

var _default = ShopsField;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SideDialogStyles = void 0;

var React = _interopRequireWildcard(require("react"));

var _Slide = _interopRequireDefault(require("@material-ui/core/Slide"));

var _core = require("@material-ui/core");

var _styles = require("@material-ui/core/styles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var Transition = function Transition(direction) {
  return function (props) {
    return React.createElement(_Slide.default, _extends({
      direction: direction
    }, props));
  };
};

var TransitionLeft = Transition('left');

var SideDialogStyles = function SideDialogStyles(theme) {
  return {
    dialogCls: {
      width: '50%',
      left: 'auto'
    },
    dialogScrollPaperCls: {
      justifyContent: 'flex-end'
    }
  };
};

exports.SideDialogStyles = SideDialogStyles;

var SideDialog =
/*#__PURE__*/
function (_React$Component) {
  _inherits(SideDialog, _React$Component);

  function SideDialog(props) {
    _classCallCheck(this, SideDialog);

    return _possibleConstructorReturn(this, _getPrototypeOf(SideDialog).call(this, props));
  }

  _createClass(SideDialog, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          _this$props$classes = _this$props.classes,
          dialogCls = _this$props$classes.dialogCls,
          dialogScrollPaperCls = _this$props$classes.dialogScrollPaperCls,
          rest = _objectWithoutProperties(_this$props, ["classes"]);

      return React.createElement(_core.Dialog, _extends({}, rest, {
        TransitionComponent: TransitionLeft,
        classes: {
          paperFullScreen: dialogCls,
          scrollPaper: dialogScrollPaperCls
        },
        fullScreen: true
      }), this.props.children);
    }
  }]);

  return SideDialog;
}(React.Component);

var _default = React.memo((0, _styles.withStyles)(SideDialogStyles)(SideDialog));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.Stock = void 0;

var React = _interopRequireWildcard(require("react"));

var _Table = _interopRequireDefault(require("@material-ui/core/Table"));

var _TableBody = _interopRequireDefault(require("@material-ui/core/TableBody"));

var _TableCell = _interopRequireDefault(require("@material-ui/core/TableCell"));

var _TableHead = _interopRequireDefault(require("@material-ui/core/TableHead"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _TablePagination = _interopRequireDefault(require("@material-ui/core/TablePagination"));

var _TableRow = _interopRequireDefault(require("@material-ui/core/TableRow"));

var _services = require("../../_services");

var _Filter = require("src/_helpers/Filter");

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Stock =
/*#__PURE__*/
function (_React$Component) {
  _inherits(Stock, _React$Component);

  function Stock(props) {
    var _this;

    _classCallCheck(this, Stock);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Stock).call(this, props));
    _this._onChange = _this._onChange.bind(_assertThisInitialized(_this));
    _this._handleChangePage = _this._handleChangePage.bind(_assertThisInitialized(_this));
    var units = {};
    props.skus.forEach(function (sku) {
      return units[sku.sku] = undefined;
    });
    _this.state = {
      loading: false,
      units: units,
      page: 0
    };
    return _this;
  }

  _createClass(Stock, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      // fetch results :
      this._fetch();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          warehouseCtx = _this$props.warehouseCtx,
          skus = _this$props.skus,
          user = _this$props.authCtx.user;
      var _this$state = this.state,
          units = _this$state.units,
          page = _this$state.page;
      var rowCount = Object.keys(units).length;
      var rowsPerPage = 10;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Products');
      return React.createElement(React.Fragment, null, React.createElement(_Table.default, {
        "aria-labelledby": "tableTitle"
      }, React.createElement(_TableHead.default, null, React.createElement(_TableRow.default, null, React.createElement(_TableCell.default, {
        numeric: false
      }, "Product name"), warehouseCtx.Warehouses.map(function (s, i) {
        return React.createElement(_TableCell.default, {
          key: s.Id,
          numeric: true
        }, s.Name);
      }))), React.createElement(_TableBody.default, null, skus.filter(function (sku, i) {
        return i >= page * rowsPerPage && i < (page + 1) * rowsPerPage;
      }).map(function (sku) {
        var title = sku.legend || sku.sku;
        var unit = units[sku.sku] || {
          Id: '',
          Name: '',
          SKU: sku.sku,
          Units: {},
          Detail: ''
        };
        var SKU = unit.SKU;
        return React.createElement(_TableRow.default, {
          hover: true,
          role: "checkbox",
          tabIndex: -1,
          key: SKU
        }, React.createElement(_TableCell.default, {
          component: "th",
          scope: "row",
          padding: "none"
        }, title), warehouseCtx.Warehouses.map(function (s) {
          var c = unit.Units && unit.Units[s.Id];
          return React.createElement(_TableCell.default, {
            key: s.Id,
            numeric: true
          }, React.createElement(_TextField.default, {
            value: c === null ? '' : c,
            type: "number",
            fullWidth: true,
            disabled: !hasRights,
            onChange: function onChange(e) {
              var val = e.target.value;
              var stock = val === '' ? null : parseInt(val, 10);

              _this2._onChange(SKU, s.Id, stock);
            }
          }));
        }));
      }))), rowCount > rowsPerPage && React.createElement(_TablePagination.default, {
        component: "div",
        count: rowCount,
        rowsPerPage: rowsPerPage,
        rowsPerPageOptions: [],
        page: page,
        backIconButtonProps: {
          'aria-label': 'Previous Page'
        },
        nextIconButtonProps: {
          'aria-label': 'Next Page'
        },
        onChangePage: this._handleChangePage
      }));
    }
  }, {
    key: "_fetch",
    value: function _fetch() {
      var _this3 = this;

      var skus = this.props.skus;
      var _this$state2 = this.state,
          loading = _this$state2.loading,
          units = _this$state2.units;

      if (loading) {
        return;
      }

      var filters = skus.map(function (sku) {
        return _Filter.Filter.Eq('SKU', sku.sku);
      });
      var def = {
        filters: filters,
        operator: 'or',
        query: '',
        sort: ''
      }; // TODO: infinte scroll or get them all;

      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        _services.StockUnits.Find(def, 0, 999999).then(function (result) {
          result.Values.forEach(function (v) {
            return units[v.SKU] = v;
          });

          _this3.setState(function () {
            return {
              units: units,
              loading: false
            };
          });
        });
      });
    }
  }, {
    key: "_onChange",
    value: function _onChange(sku, shopId, value) {
      var _this4 = this;

      var units = this.state.units;
      var old = units[sku] || {
        SKU: sku,
        Units: {}
      };
      old.Units[shopId] = value || 0;
      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        if (old.Id) {
          _services.StockUnits.Patch(old.Id, old).then(function (newUnit) {
            _this4.setState(function (prev) {
              return {
                loading: false,
                units: _objectSpread({}, prev.units, _defineProperty({}, sku, newUnit))
              };
            });
          });
        } else {
          _services.StockUnits.Create(old).then(function (newUnit) {
            _this4.setState(function (prev) {
              return {
                loading: false,
                units: _objectSpread({}, prev.units, _defineProperty({}, sku, newUnit))
              };
            });
          });
        }
      });
    }
  }, {
    key: "_handleChangePage",
    value: function _handleChangePage(event, page) {
      this.setState({
        page: page
      });
    }
  }]);

  return Stock;
}(React.Component);

exports.Stock = Stock;
var _default = Stock;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DropdownToggleWithStyle = exports.DropdownMenuWithStyle = exports.StyledDropdown = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactDropdown = _interopRequireWildcard(require("@trendmicro/react-dropdown"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var StyledDropdown = function StyledDropdown(props) {
  return React.createElement(_reactDropdown.default, _extends({
    style: {
      border: 0,
      lineHeight: 'inherit',
      width: '100%'
    }
  }, props));
};

exports.StyledDropdown = StyledDropdown;

var DropdownMenuWithStyle = function DropdownMenuWithStyle(props, children) {
  return React.createElement(_reactDropdown.DropdownMenu, _extends({}, props, {
    style: {
      overflow: 'auto',
      maxHeight: '10rem'
    }
  }), children);
};

exports.DropdownMenuWithStyle = DropdownMenuWithStyle;

var DropdownToggleWithStyle = function DropdownToggleWithStyle(props, children) {
  return React.createElement(_reactDropdown.DropdownToggle, _extends({
    btnStyle: "link",
    style: {
      padding: '0',
      border: 0,
      lineHeight: 'inherit',
      fontSize: 'inherit',
      width: '100%',
      display: 'flex',
      justifyContent: 'space-between',
      alignItems: 'center',
      minHeight: '2rem'
    }
  }, props), children);
};

exports.DropdownToggleWithStyle = DropdownToggleWithStyle;
var _default = StyledDropdown;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.ThemeProvider = void 0;

var React = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _createPalette = _interopRequireDefault(require("@material-ui/core/styles/createPalette"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var defaultThemeOptions = {
  Colors: {
    blue: {
      primary: {
        main: '#64b4ff',
        contrastText: '#fff'
      }
    },
    green: {
      primary: {
        main: '#64c864',
        contrastText: '#fff'
      }
    },
    gray: {
      primary: {
        main: '#ddd',
        contrastText: '#fff'
      }
    },
    orange: {
      primary: {
        main: '#ffc864',
        contrastText: '#fff'
      }
    },
    white: {
      primary: {
        main: '#fff',
        contrastText: '#ddd'
      }
    },
    red: {
      primary: {
        main: '#f00',
        contrastText: '#fff'
      }
    }
  },
  stylesheets: [],
  palette: {
    primary: {
      // light: will be calculated from palette.primary.main,
      main: '#64b4ff',
      // dark: will be calculated from palette.primary.main,
      // contrastText: will be calculated to contrast with palette.primary.main,
      contrastText: '#fff'
    },
    secondary: {
      main: '#ff6464',
      contrastText: '#fff'
    },
    error: {
      main: '#ff0000'
    }
  },
  typography: {
    useNextVariants: true
  },
  ActiveMenuBorderWidth: 3
};

var ThemeProvider =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ThemeProvider, _React$Component);

  function ThemeProvider(props) {
    var _this;

    _classCallCheck(this, ThemeProvider);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ThemeProvider).call(this, props));
    _this.state = {
      theme: _this._GetTheme(defaultThemeOptions),
      loading: true
    };
    return _this;
  }

  _createClass(ThemeProvider, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this2 = this;

      var path = this.props.path; // load the theme...

      fetch("".concat(path)).then(function (response) {
        if (response.ok) {
          return response.json();
        } else {
          throw new Error('Network response was not ok.');
        }
      }).then(function (options) {
        _this2.setState(function () {
          return {
            loading: false,
            error: false,
            path: path,
            theme: _this2._GetTheme(options)
          };
        });
      }).catch(function (reason) {
        // tslint:disable-next-line:no-console
        console.log("no custom theme loaded: (".concat(reason, ")"));

        _this2.setState(function () {
          return {
            loading: false,
            error: true
          };
        });
      });
    }
  }, {
    key: "render",
    value: function render() {
      var theme = this.state.theme;
      return React.createElement(_styles.MuiThemeProvider, {
        theme: theme
      }, this.props.children);
    }
  }, {
    key: "_GetTheme",
    value: function _GetTheme(options) {
      var Colors = options.Colors,
          rest = _objectWithoutProperties(options, ["Colors"]);

      var opts = _objectSpread({}, defaultThemeOptions, rest, {
        Colors: {}
      });

      var theme = (0, _styles.createMuiTheme)(opts);

      if (Colors) {
        var _arr = Object.keys(Colors);

        for (var _i = 0; _i < _arr.length; _i++) {
          var k = _arr[_i];
          theme.Colors[k] = _objectSpread({}, theme.palette, (0, _createPalette.default)(Colors[k]));
        }
      }

      return theme;
    }
  }]);

  return ThemeProvider;
}(React.Component);

exports.ThemeProvider = ThemeProvider;
var _default = ThemeProvider;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.CODE_LENGTH = void 0;

var React = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _styles = require("@material-ui/core/styles");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var classNames = _interopRequireWildcard(require("classnames"));

var _roles = require("src/_helpers/roles");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var CODE_LENGTH = 6;
exports.CODE_LENGTH = CODE_LENGTH;

var VoucherCode =
/*#__PURE__*/
function (_React$Component) {
  _inherits(VoucherCode, _React$Component);

  function VoucherCode(props) {
    var _this;

    _classCallCheck(this, VoucherCode);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(VoucherCode).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_inputs", Array.from({
      length: CODE_LENGTH
    }, function () {
      return React.createRef();
    }));

    _this.state = {};
    return _this;
  }

  _createClass(VoucherCode, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          classes = _this$props.classes,
          onChange = _this$props.onChange,
          valid = _this$props.valid,
          code = _this$props.code,
          user = _this$props.authCtx.user;
      var canEdit = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Vouchers');

      var change = function change(index) {
        return function (e) {
          var value = e.target.value[0] || '';
          var next = _this2._inputs[index + 1];

          if (value && next && next.current) {
            next.current.focus();
          }

          var newCode = Array.from({
            length: CODE_LENGTH
          }, function (v, i) {
            return i === index ? value : code[i] || '';
          });
          onChange(newCode);
        };
      };

      return React.createElement(_GridContainer.GridContainer, null, this._inputs.map(function (x, i) {
        return React.createElement(_core.Grid, {
          key: i,
          item: true,
          xs: 2
        }, React.createElement("input", {
          ref: x,
          className: classNames(classes.input, valid === false && classes.inputWrong, valid === true && classes.inputGood),
          value: code[i] || '',
          onChange: change(i),
          disabled: !canEdit
        }));
      }));
    }
  }]);

  return VoucherCode;
}(React.Component);

var _default = (0, _styles.withStyles)(function (theme) {
  return {
    input: {
      display: 'flex',
      height: 150,
      borderRadius: theme.shape.borderRadius,
      border: "1px solid ".concat(theme.palette.divider),
      boxShadow: "inset 2px 1px 15px -7px rgba(0, 0, 0, 0.2)",
      fontSize: 80,
      width: '100%',
      justifyContent: 'center',
      // tslint:disable-next-line:no-any
      textAlign: 'center',
      fontFamily: 'monospace'
    },
    inputWrong: {
      borderColor: theme.palette.error.main,
      boxShadow: "inset 2px 1px 15px -7px ".concat(theme.palette.error.light),
      color: theme.palette.error.main
    },
    inputGood: {
      borderColor: theme.Colors.green.primary.main,
      boxShadow: "inset 2px 1px 15px -7px ".concat(theme.Colors.green.primary.light),
      color: theme.Colors.green.primary.main
    }
  };
})(VoucherCode);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherDetail = void 0;

var React = _interopRequireWildcard(require("react"));

var _icons = require("@material-ui/icons");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _VoucherFields = _interopRequireDefault(require("../VoucherFields/VoucherFields"));

var _services = require("src/_services");

var _DetailGridContainer = _interopRequireDefault(require("src/components/DetailGridContainer/DetailGridContainer"));

var _DetailGridColumn = _interopRequireDefault(require("src/components/DetailGridColumn/DetailGridColumn"));

var _OrderListItem = _interopRequireDefault(require("src/components/Orders/OrderListItem/OrderListItem"));

var _core = require("@material-ui/core");

var _OrderDetail = _interopRequireDefault(require("src/components/Orders/OrderDetail/OrderDetail"));

var _Filter = require("src/_helpers/Filter");

var _VoucherCode = _interopRequireWildcard(require("src/components/VoucherCode/VoucherCode"));

var _VoucherDetailMessages = _interopRequireDefault(require("./VoucherDetailMessages"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var VoucherDetail =
/*#__PURE__*/
function (_React$Component) {
  _inherits(VoucherDetail, _React$Component);

  function VoucherDetail(props) {
    var _this;

    _classCallCheck(this, VoucherDetail);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(VoucherDetail).call(this, props));
    _this._Save = _this._Save.bind(_assertThisInitialized(_this));
    _this._Delete = _this._Delete.bind(_assertThisInitialized(_this));
    _this._OnChanged = _this._OnChanged.bind(_assertThisInitialized(_this));
    var id = props.id,
        preview = props.preview;
    _this.state = {
      id: id,
      changes: id ? {} : preview,
      current: preview,
      orders: []
    };
    return _this;
  }

  _createClass(VoucherDetail, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._loadOrders();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          intl = _this$props.intl,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          settingsCtx = _this$props.settingsCtx,
          templateCtx = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          shopCtx = _this$props.shopCtx,
          classes = _this$props.classes;
      var _this$state = this.state,
          current = _this$state.current,
          loading = _this$state.loading,
          orders = _this$state.orders,
          orderOpened = _this$state.orderOpened;
      var Code = current.Code;
      var code = Code && Code.split('', _VoucherCode.CODE_LENGTH) || [];
      var fieldsProps = {
        settingsCtx: settingsCtx,
        authCtx: authCtx,
        current: current,
        intl: intl,
        onChange: this._OnChanged
      };
      return React.createElement(_DetailGridContainer.default, null, React.createElement(_core.Grid, {
        container: true,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement("div", {
        className: classes.codeWrapper
      }, React.createElement(_VoucherCode.default, {
        onChange: function onChange(c) {
          return _this2._OnChanged({
            Code: c.join('')
          });
        },
        code: code,
        authCtx: authCtx
      }))), React.createElement(_DetailGridColumn.default, {
        className: classes.columnsWrapper
      }, React.createElement(_VoucherFields.default, fieldsProps)), React.createElement(_DetailGridColumn.default, {
        className: classes.columnsWrapper
      }, !loading && orders && orders.map(function (o) {
        var Id = o.Id;

        var open = function open() {
          return _this2.setState(function () {
            return {
              orderOpened: Id
            };
          });
        };

        var close = function close(callback) {
          return _this2.setState(function () {
            return {
              orderOpened: undefined
            };
          }, callback);
        };

        return React.createElement("div", {
          key: Id
        }, React.createElement(_OrderListItem.default, {
          intl: intl,
          onClick: open,
          order: o
        }), React.createElement(_core.Dialog, {
          open: orderOpened === o.Id,
          fullScreen: true
        }, React.createElement(_core.DialogContent, null, React.createElement(_OrderDetail.default, _extends({
          intl: intl,
          shopCtx: shopCtx,
          warehouseCtx: warehouseCtx,
          templateCtx: templateCtx,
          authCtx: authCtx,
          usersCtx: usersCtx,
          settingsCtx: settingsCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        }, {
          preventEditClient: true,
          preview: o,
          id: o.Id,
          onCancel: close,
          onChanged: function onChanged() {
            _this2._loadOrders();
          },
          onDelete: function onDelete() {
            close(function () {
              return _this2._loadOrders();
            });
          }
        })))));
      })), this._renderActions()));
    }
  }, {
    key: "_renderActions",
    value: function _renderActions() {
      var _this3 = this;

      var _this$state2 = this.state,
          loading = _this$state2.loading,
          changes = _this$state2.changes,
          id = _this$state2.id;
      var changed = !!Object.keys(changes).length;
      var user = this.props.authCtx.user;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Vouchers');
      var saveBtn = {
        icon: React.createElement(_icons.Check, null),
        onClick: function onClick() {
          return _this3._Save();
        },
        themeColor: 'green',
        legend: 'save'
      };
      var deleteBtn = {
        icon: React.createElement(_icons.Delete, null),
        legend: 'delete',
        themeColor: 'red',
        onClick: this._Delete
      };
      var cancelBtn = {
        icon: React.createElement(_icons.Close, null),
        onClick: function onClick() {
          return _this3.props.onCancel();
        },
        themeColor: 'gray',
        legend: changed ? 'cancel' : 'close'
      };

      if (loading) {
        return React.createElement(_Fabs.default, {
          map: ['loading']
        });
      }

      return React.createElement(_Fabs.default, {
        map: [hasRights && changed && saveBtn, cancelBtn, hasRights && !!id && deleteBtn]
      });
    }
  }, {
    key: "_OnChanged",
    value: function _OnChanged(changes) {
      var old = this.state.current;

      var current = _objectSpread({}, old, changes);

      this.setState(function (prev) {
        return {
          current: current,
          changes: _objectSpread({}, prev.changes, changes)
        };
      });
    }
  }, {
    key: "_loadOrders",
    value: function _loadOrders() {
      var _this4 = this;

      var user = this.props.authCtx.user;
      var canListOrders = (0, _roles.IsAdminOrInRole)(user, 'List_Orders');
      var _this$state3 = this.state,
          id = _this$state3.id,
          OrderIds = _this$state3.current.OrderIds;

      if (!id || !canListOrders || !OrderIds || !OrderIds.length) {
        return;
      }

      this.setState(function () {
        return {
          loading: true
        };
      }, function () {
        var filters = OrderIds.map(function (Id) {
          return _Filter.Filter.Eq('Id', Id);
        });
        var def = {
          filters: filters,
          operator: 'or'
        };

        _services.Orders.Find(def, 0, 100).then(function (orders) {
          _this4.setState(function () {
            return {
              orders: orders.Values,
              loading: false
            };
          });
        });
      });
    }
  }, {
    key: "_Save",
    value: function _Save() {
      var _this5 = this;

      var _this$state4 = this.state,
          changes = _this$state4.changes,
          current = _this$state4.current,
          id = _this$state4.id;

      var final = _objectSpread({}, current, changes);

      if (id) {
        return _services.Vouchers.Patch(id, final).then(function (model) {
          _this5.setState(function () {
            return {
              changes: {},
              current: model
            };
          });

          if (_this5.props.onChanged) {
            _this5.props.onChanged(model);
          }
        });
      } else {
        return _services.Vouchers.Create(final).then(function (model) {
          _this5.setState(function () {
            return {
              changes: {},
              current: model,
              id: model.Id
            };
          });

          if (_this5.props.onChanged) {
            _this5.props.onChanged(model);
          }
        });
      }
    }
  }, {
    key: "_Delete",
    value: function _Delete() {
      var id = this.state.id;
      var _this$props2 = this.props,
          onDelete = _this$props2.onDelete,
          formatMessage = _this$props2.intl.formatMessage;
      var isTodelete = window.confirm(formatMessage(_VoucherDetailMessages.default.deleteConfirm));

      if (id && isTodelete) {
        _services.Vouchers.Delete(id).then(onDelete);
      }
    }
  }]);

  return VoucherDetail;
}(React.Component);

exports.VoucherDetail = VoucherDetail;
var padding = 20;

var _default = (0, _core.withStyles)(function (theme) {
  return {
    codeWrapper: {
      marginTop: padding,
      marginBottom: padding
    },
    columnsWrapper: {
      height: "calc(100% - 200px)"
    }
  };
})(VoucherDetail);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherDetailMessages = void 0;

var _reactIntl = require("react-intl");

var VoucherDetailMessages = (0, _reactIntl.defineMessages)({
  deleteConfirm: {
    "id": "src.components.vouchers.voucherDetail.deleteConfirm",
    "defaultMessage": "Are you sure you want to delete this voucher?"
  }
});
exports.VoucherDetailMessages = VoucherDetailMessages;
var _default = VoucherDetailMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OrderFieldsStandalone = exports.default = exports.VoucherFields = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _VoucherFieldsMessages = _interopRequireDefault(require("./VoucherFieldsMessages"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Switch = _interopRequireDefault(require("@material-ui/core/Switch"));

var _FormControlLabel = _interopRequireDefault(require("@material-ui/core/FormControlLabel"));

var _core = require("@material-ui/core");

var _materialUiPickers = require("material-ui-pickers");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var _CurrenciesField = _interopRequireDefault(require("src/components/CurrenciesField/CurrenciesField"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var VoucherFields =
/*#__PURE__*/
function (_React$Component) {
  _inherits(VoucherFields, _React$Component);

  function VoucherFields(props) {
    _classCallCheck(this, VoucherFields);

    return _possibleConstructorReturn(this, _getPrototypeOf(VoucherFields).call(this, props));
  }

  _createClass(VoucherFields, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          current = _this$props.current,
          onChange = _this$props.onChange,
          formatMessage = _this$props.intl.formatMessage,
          settingsCtx = _this$props.settingsCtx,
          user = _this$props.authCtx.user;
      var InitialValue = current.InitialValue,
          Value = current.Value,
          Expiration = current.Expiration,
          MultipleUse = current.MultipleUse,
          Used = current.Used;
      var hasRights = (0, _roles.IsAdminOrInRole)(user, 'CRUD_Vouchers');
      return React.createElement(_GridContainer.GridContainer, null, React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        label: formatMessage(_VoucherFieldsMessages.default.currentValue),
        value: Value || 0,
        inputProps: {
          step: '0.01'
        },
        type: "number",
        fullWidth: true,
        onChange: function (_onChange) {
          function onChange(_x) {
            return _onChange.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange.toString();
          };

          return onChange;
        }(function (e) {
          var val = e.target.value;
          var parsedVal = val === '' ? 0 : parseFloat(val);
          onChange({
            Value: parsedVal
          });
        }),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_TextField.default, {
        label: formatMessage(_VoucherFieldsMessages.default.initialValue),
        value: InitialValue || 0,
        inputProps: {
          step: '0.01'
        },
        type: "number",
        fullWidth: true,
        onChange: function (_onChange2) {
          function onChange(_x2) {
            return _onChange2.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange2.toString();
          };

          return onChange;
        }(function (e) {
          var val = e.target.value;
          var parsedVal = val === '' ? 0 : parseFloat(val);
          onChange({
            InitialValue: parsedVal
          });
        }),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 4
      }, React.createElement(_CurrenciesField.default, {
        settingsCtx: settingsCtx,
        label: formatMessage(_VoucherFieldsMessages.default.currency),
        fullWidth: true,
        value: current.Currency,
        onChange: function (_onChange3) {
          function onChange(_x3) {
            return _onChange3.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange3.toString();
          };

          return onChange;
        }(function (e) {
          onChange({
            Currency: e.target.value
          });
        }),
        disabled: !hasRights
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 12
      }, React.createElement(_materialUiPickers.DatePicker, {
        label: formatMessage(_VoucherFieldsMessages.default.expiration),
        fullWidth: true,
        keyboard: true,
        clearable: true,
        format: "dd/MM/yyyy",
        disabled: !hasRights,
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/] : [];
        },
        value: Expiration && new Date(Expiration) || null,
        onChange: function (_onChange4) {
          function onChange(_x4) {
            return _onChange4.apply(this, arguments);
          }

          onChange.toString = function () {
            return _onChange4.toString();
          };

          return onChange;
        }(function (value) {
          return onChange({
            Expiration: value
          });
        }),
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_FormControlLabel.default, {
        control: React.createElement(_Switch.default, {
          checked: !!MultipleUse,
          onChange: function (_onChange5) {
            function onChange(_x5) {
              return _onChange5.apply(this, arguments);
            }

            onChange.toString = function () {
              return _onChange5.toString();
            };

            return onChange;
          }(function (e) {
            return onChange({
              MultipleUse: e.target.checked
            });
          }),
          color: "primary",
          disabled: !hasRights
        }),
        label: formatMessage(_VoucherFieldsMessages.default.multipleUse)
      })), React.createElement(_core.Grid, {
        item: true,
        xs: 6
      }, React.createElement(_FormControlLabel.default, {
        control: React.createElement(_Switch.default, {
          checked: !!Used,
          onChange: function (_onChange6) {
            function onChange(_x6) {
              return _onChange6.apply(this, arguments);
            }

            onChange.toString = function () {
              return _onChange6.toString();
            };

            return onChange;
          }(function (e) {
            return onChange({
              Used: e.target.checked
            });
          }),
          color: "primary",
          disabled: !hasRights
        }),
        label: formatMessage(_VoucherFieldsMessages.default.usedVoucher)
      })));
    }
  }]);

  return VoucherFields;
}(React.Component);

exports.VoucherFields = VoucherFields;
var _default = VoucherFields;
exports.default = _default;
var OrderFieldsStandalone = (0, _reactIntl.injectIntl)(VoucherFields);
exports.OrderFieldsStandalone = OrderFieldsStandalone;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherFieldsMessages = void 0;

var _reactIntl = require("react-intl");

var VoucherFieldsMessages = (0, _reactIntl.defineMessages)({
  initialValue: {
    "id": "src.components.forms.vouchers.initialValue",
    "defaultMessage": "Initial value"
  },
  currentValue: {
    "id": "src.components.forms.vouchers.currentValue",
    "defaultMessage": "Current value"
  },
  code: {
    "id": "src.components.forms.vouchers.code",
    "defaultMessage": "Code"
  },
  expiration: {
    "id": "src.components.forms.vouchers.expiration",
    "defaultMessage": "Expiration date"
  },
  multipleUse: {
    "id": "src.components.forms.vouchers.multipleUse",
    "defaultMessage": "Allow multiple uses"
  },
  canceled: {
    "id": "src.components.forms.vouchers.canceled",
    "defaultMessage": "Canceled"
  },
  usedVoucher: {
    "id": "src.components.forms.vouchers.usedVoucher",
    "defaultMessage": "Used"
  },
  currency: {
    "id": "src.components.forms.vouchers.currency",
    "defaultMessage": "Currency"
  }
});
exports.VoucherFieldsMessages = VoucherFieldsMessages;
var _default = VoucherFieldsMessages;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.VoucherIconStyles = void 0;

var VoucherIconStyles = function VoucherIconStyles(theme) {
  return {
    Canceled: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Expired: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Used: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.gray.primary.main
    },
    Initial: {
      color: theme.Colors.gray.primary.contrastText,
      backgroundColor: theme.Colors.green.primary.main
    }
  };
};

exports.VoucherIconStyles = VoucherIconStyles;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactVirtualized = require("react-virtualized");

var _VoucherListItem = _interopRequireDefault(require("../VoucherListItem/VoucherListItem"));

var _services = require("../../../_services");

var _Fabs = _interopRequireDefault(require("src/components/Fabs/Fabs"));

var _icons = require("@material-ui/icons");

var _core = require("@material-ui/core");

var _GridContainer = require("src/components/GridContainer/GridContainer");

var classNames = _interopRequireWildcard(require("classnames"));

var _throttleDebounce = require("throttle-debounce");

var _VoucherDetail = _interopRequireDefault(require("../VoucherDetail/VoucherDetail"));

var _materialUiPickers = require("material-ui-pickers");

var shortid = _interopRequireWildcard(require("shortid"));

var _VoucherCode = require("src/components/VoucherCode/VoucherCode");

var _VoucherListMesseges = _interopRequireDefault(require("./VoucherListMesseges"));

var _Filter = require("src/_helpers/Filter");

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var LOCAL_STORAGE_KEY = 'our.orders.VoucherList';

var DefaultFilters = function DefaultFilters() {
  return {
    valid: true,
    expired: false,
    used: false,
    code: '',
    from: null,
    to: null,
    sortAttribute: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute")) || 'Creation',
    sortDirection: localStorage.getItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection")) || 'descending'
  };
};

var VoucherList =
/*#__PURE__*/
function (_React$Component) {
  _inherits(VoucherList, _React$Component);

  // private _editingLighboxId = `${this.props.uid}/editing`;
  // private _creatingLighboxId = `${this.props.uid}/creating`;
  function VoucherList(props) {
    var _this;

    _classCallCheck(this, VoucherList);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(VoucherList).call(this, props));

    _defineProperty(_assertThisInitialized(_this), "_loadedRowsMap", {});

    _defineProperty(_assertThisInitialized(_this), "_list", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStartIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_loadMoreRowsStopIndex", void 0);

    _defineProperty(_assertThisInitialized(_this), "_searchInput", void 0);

    _this._isRowLoaded = _this._isRowLoaded.bind(_assertThisInitialized(_this));
    _this._loadMore = _this._loadMore.bind(_assertThisInitialized(_this));
    _this._rowRenderer = _this._rowRenderer.bind(_assertThisInitialized(_this));
    _this._refresh = (0, _throttleDebounce.debounce)(100, _this._refresh);
    _this._toggleFilterUsed = _this._toggleFilterUsed.bind(_assertThisInitialized(_this));
    _this._toggleFilterValid = _this._toggleFilterValid.bind(_assertThisInitialized(_this));
    _this._toggleFilterExpired = _this._toggleFilterExpired.bind(_assertThisInitialized(_this));
    _this._searchInput = React.createRef();
    _this.state = {
      filter: DefaultFilters(),
      loading: 0,
      loaded: 0,
      rowHeight: 80,
      rowCount: 0,
      editing: -1,
      drawerOpen: false,
      lastUpdate: new Date().getTime(),
      lightboxes: []
    };
    return _this;
  }

  _createClass(VoucherList, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      this._loadMore({
        startIndex: 0,
        stopIndex: 0
      });
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      var _this2 = this;

      setTimeout(function () {
        var _prevState$filter = prevState.filter,
            prevSortAttribute = _prevState$filter.sortAttribute,
            prevSortDirection = _prevState$filter.sortDirection;
        var _this2$state$filter = _this2.state.filter,
            sortAttribute = _this2$state$filter.sortAttribute,
            sortDirection = _this2$state$filter.sortDirection;

        if (sortAttribute !== prevSortAttribute) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortAttribute"), sortAttribute);
        }

        if (sortDirection !== prevSortDirection) {
          localStorage.setItem("".concat(LOCAL_STORAGE_KEY, ".sortDirection"), sortDirection);
        }
      }, 0);
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this,
          _classNames;

      var _this$state = this.state,
          rowCount = _this$state.rowCount,
          editing = _this$state.editing,
          creating = _this$state.creating,
          drawerOpen = _this$state.drawerOpen,
          editingOpened = _this$state.editingOpened,
          creatingOpened = _this$state.creatingOpened,
          _this$state$filter = _this$state.filter,
          valid = _this$state$filter.valid,
          used = _this$state$filter.used,
          expired = _this$state$filter.expired,
          code = _this$state$filter.code,
          fromDate = _this$state$filter.from,
          toDate = _this$state$filter.to,
          sortDirection = _this$state$filter.sortDirection,
          sortAttribute = _this$state$filter.sortAttribute;
      var _this$props = this.props,
          intl = _this$props.intl,
          classes = _this$props.classes,
          templateCtx = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          shopCtx = _this$props.shopCtx,
          authCtx = _this$props.authCtx,
          user = _this$props.authCtx.user,
          warehouseCtx = _this$props.warehouseCtx,
          settingsCtx = _this$props.settingsCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx,
          Currencies = _this$props.settingsCtx.Settings.Currencies;

      var add = function add() {
        _this3.setState(function () {
          return {
            fetching: true
          };
        }, function () {
          _services.Vouchers.Empty({
            Code: shortid().substr(0, _VoucherCode.CODE_LENGTH),
            Currency: Currencies ? Currencies[0].Code : undefined
          }).then(function (empty) {
            return _this3.setState(function () {
              return {
                creating: empty,
                creatingOpened: true,
                fetching: false
              };
            });
          });
        });
      };

      var cancel = function cancel() {
        _this3.setState(function () {
          return {
            editing: -1,
            creating: undefined
          };
        });
      };

      var codeChange = function codeChange(e) {
        var q = e.target.value;

        _this3.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              code: q
            })
          };
        }, _this3._refresh);
      };

      var fromDateChange = function fromDateChange(value) {
        _this3.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              from: value
            })
          };
        }, _this3._refresh);
      };

      var toDateChange = function toDateChange(value) {
        _this3.setState(function (prev) {
          return {
            filter: _objectSpread({}, prev.filter, {
              to: value
            })
          };
        }, _this3._refresh);
      };

      var toggle = function toggle() {
        _this3.setState(function (prev) {
          return {
            drawerOpen: !prev.drawerOpen
          };
        });
      };

      return React.createElement(_GridContainer.GridContainer, {
        className: classes.containerCls,
        spacing: 0
      }, React.createElement(_core.Grid, {
        item: true,
        className: classes.menuContainer
      }, React.createElement(_core.List, {
        className: classes.menu
      }, React.createElement(_core.ListItem, {
        onClick: function onClick() {
          return _this3._toggleFilterValid();
        },
        className: classNames(classes.menuItem, valid && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_VoucherListMesseges.default.valid),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.CheckCircle, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick() {
          return _this3._toggleFilterExpired();
        },
        className: classNames(classes.menuItem, expired && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_VoucherListMesseges.default.expired),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon)
      }, React.createElement(_icons.Timelapse, null)))), React.createElement(_core.ListItem, {
        onClick: function onClick() {
          return _this3._toggleFilterUsed();
        },
        className: classNames(classes.menuItem, used && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_VoucherListMesseges.default.used),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classes.menuItemIcon
      }, React.createElement(_icons.Block, null)))), React.createElement(_core.ListItem, {
        className: classNames(classes.menuItem, classes.menuSort, (code || fromDate || toDate) && classes.menuItemActive)
      }, React.createElement(_core.Tooltip, {
        title: intl.formatMessage(_VoucherListMesseges.default.sortBtn),
        placement: "right",
        classes: {
          tooltip: classes.tooltip
        }
      }, React.createElement(_core.IconButton, {
        className: classNames(classes.menuItemIcon),
        onClick: toggle
      }, React.createElement(_icons.Sort, null)))))), React.createElement(_core.Grid, {
        item: true,
        className: classNames(classes.drawer, (_classNames = {}, _defineProperty(_classNames, classes.drawerOpen, drawerOpen), _defineProperty(_classNames, classes.drawerClose, !drawerOpen), _classNames))
      }, React.createElement(_GridContainer.GridContainer, {
        className: classes.drawerContent,
        direction: "column"
      }, React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_core.TextField, {
        label: "Code",
        fullWidth: true,
        value: code || '',
        inputRef: this._searchInput,
        onChange: codeChange
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: intl.formatMessage(_VoucherListMesseges.default.from),
        fullWidth: true,
        keyboard: true,
        clearable: true,
        format: "dd/MM/yyyy HH:mm",
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: fromDate,
        onChange: fromDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true
      }, React.createElement(_materialUiPickers.DateTimePicker, {
        label: intl.formatMessage(_VoucherListMesseges.default.to),
        fullWidth: true,
        keyboard: true,
        format: "dd/MM/yyyy HH:mm",
        clearable: true,
        mask: function mask(value // tslint:disable-next-line:max-line-length
        ) {
          return value ? [/\d/, /\d/, '/', /\d/, /\d/, '/', /\d/, /\d/, /\d/, /\d/, / /, /\d/, /\d/, /\:/, /\d/, /\d/] : [];
        },
        value: toDate,
        onChange: toDateChange,
        disableOpenOnEnter: true,
        animateYearScrolling: false
      })), React.createElement(_core.Grid, {
        item: true,
        style: {
          marginTop: 'auto',
          display: 'flex'
        }
      }, React.createElement(_core.IconButton, {
        onClick: function onClick() {
          return _this3.setState(function (prev) {
            var dir = prev.filter.sortDirection === 'ascending' ? 'descending' : 'ascending';
            return {
              filter: _objectSpread({}, prev.filter, {
                sortDirection: dir
              })
            };
          }, _this3._refresh);
        }
      }, sortDirection === 'descending' ? React.createElement(_icons.ArrowUpward, null) : React.createElement(_icons.ArrowDownward, null)), React.createElement(_core.TextField, {
        label: "Sort",
        fullWidth: true,
        value: sortAttribute || '',
        select: true,
        onChange: function onChange(value) {
          var v = value.target.value;

          _this3.setState(function (prev) {
            return {
              filter: _objectSpread({}, prev.filter, {
                sortAttribute: v
              })
            };
          }, _this3._refresh);
        }
      }, ['Value', 'Code', 'Currency', 'Expiration', 'LastMod', 'Creation'].map(function (v) {
        return React.createElement(_core.MenuItem, {
          key: v,
          value: v
        }, v);
      }))))), React.createElement("div", {
        className: classes.content
      }, React.createElement(_reactVirtualized.InfiniteLoader, {
        isRowLoaded: this._isRowLoaded,
        loadMoreRows: this._loadMore,
        rowCount: rowCount
      }, function (_ref) {
        var onRowsRendered = _ref.onRowsRendered,
            registerChild = _ref.registerChild;
        return React.createElement(_reactVirtualized.AutoSizer, null, function (_ref2) {
          var h = _ref2.height,
              w = _ref2.width;
          return React.createElement(_reactVirtualized.List, {
            ref: function ref(list) {
              _this3._list = list;
              registerChild(list);
            },
            height: h,
            onRowsRendered: onRowsRendered,
            rowCount: rowCount,
            rowHeight: _this3.state.rowHeight,
            rowRenderer: _this3._rowRenderer,
            width: w,
            style: {
              outline: 'none'
            }
          });
        });
      })), React.createElement(_Fabs.default, {
        map: [this.state.fetching ? 'loading' : (0, _roles.IsAdminOrInRole)(user, 'CRUD_Vouchers') && {
          icon: React.createElement(_icons.Add, null),
          legend: 'add new',
          onClick: add,
          color: 'primary',
          themeColor: 'green'
        }]
      }), editing >= 0 && React.createElement(_core.Dialog, {
        open: !!editingOpened,
        fullScreen: true,
        onClose: cancel
      }, React.createElement(_VoucherDetail.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templateCtx
      }, {
        id: this._loadedRowsMap[editing].Id,
        preview: this._loadedRowsMap[editing],
        onCancel: function onCancel() {
          _this3.setState(function () {
            return {
              editingOpened: false
            };
          });
        },
        onChanged: function onChanged(order) {
          _this3._handleItemChanged(order, editing);
        },
        onDelete: function onDelete() {
          _this3._handleOrderDeleted();
        } // uid={this._editingLighboxId}
        ,
        key: editing
      }))), creating && React.createElement(_core.Dialog, {
        open: !!creatingOpened,
        fullScreen: true,
        onClose: close
      }, React.createElement(_VoucherDetail.default, _extends({
        intl: intl,
        shopCtx: shopCtx,
        authCtx: authCtx,
        usersCtx: usersCtx,
        warehouseCtx: warehouseCtx,
        settingsCtx: settingsCtx,
        categoryCtx: categoryCtx,
        productCtx: productCtx,
        templateCtx: templateCtx
      }, {
        preview: creating,
        onCancel: function onCancel() {
          _this3.setState(function () {
            return {
              creatingOpened: false
            };
          });
        },
        onChanged: function onChanged() {
          _this3._resetFilters();
        },
        onDelete: function onDelete() {
          _this3._handleOrderDeleted();
        }
      }))));
    }
  }, {
    key: "_toggleFilterValid",
    value: function _toggleFilterValid() {
      var _this4 = this;

      this.setState(function (prev) {
        return {
          filter: _objectSpread({}, prev.filter, {
            valid: !prev.filter.valid
          })
        };
      }, function () {
        return _this4._refresh();
      });
    }
  }, {
    key: "_toggleFilterUsed",
    value: function _toggleFilterUsed() {
      var _this5 = this;

      this.setState(function (prev) {
        return {
          filter: _objectSpread({}, prev.filter, {
            used: !prev.filter.used
          })
        };
      }, function () {
        return _this5._refresh();
      });
    }
  }, {
    key: "_toggleFilterExpired",
    value: function _toggleFilterExpired() {
      var _this6 = this;

      this.setState(function (prev) {
        return {
          filter: _objectSpread({}, prev.filter, {
            expired: !prev.filter.expired
          })
        };
      }, function () {
        return _this6._refresh();
      });
    }
  }, {
    key: "_rowRenderer",
    value: function _rowRenderer(props) {
      var _this7 = this;

      var intl = this.props.intl;
      var index = props.index;
      var voucher = this._loadedRowsMap[index];
      return React.createElement("div", {
        key: "".concat(props.key, "-").concat(this.state.lastUpdate),
        style: props.style
      }, React.createElement(_VoucherListItem.default, {
        voucher: voucher,
        intl: intl,
        onClick: voucher ? function () {
          return _this7.setState(function () {
            return {
              editing: index,
              editingOpened: true
            };
          });
        } : undefined
      }));
    }
  }, {
    key: "_loadMore",
    value: function _loadMore(range) {
      var _this8 = this;

      var stopIndex = range.stopIndex,
          startIndex = range.startIndex;
      this._loadMoreRowsStartIndex = startIndex;
      this._loadMoreRowsStopIndex = stopIndex;
      var _this$state$filter2 = this.state.filter,
          valid = _this$state$filter2.valid,
          used = _this$state$filter2.used,
          expired = _this$state$filter2.expired,
          from = _this$state$filter2.from,
          to = _this$state$filter2.to,
          code = _this$state$filter2.code,
          sortAttribute = _this$state$filter2.sortAttribute,
          sortDirection = _this$state$filter2.sortDirection;
      var orfilters = [];

      if (expired) {
        orfilters.push(_Filter.Filter.And(_Filter.Filter.Eq('Used', false), _Filter.Filter.Lt('Expiration', new Date())));
      }

      if (used) {
        orfilters.push(_Filter.Filter.Eq('Used', true));
      }

      if (valid) {
        orfilters.push(_Filter.Filter.And(_Filter.Filter.Or(_Filter.Filter.IsNull('Expiration'), _Filter.Filter.Gt('Expiration', new Date())), _Filter.Filter.Eq('Used', false)));
      }

      var andfilters = [];

      if (code) {
        andfilters.push(_Filter.Filter.Like('Code', code));
      }

      if (from) {
        andfilters.push(_Filter.Filter.Gte('Creation', from));
      }

      if (to) {
        andfilters.push(_Filter.Filter.Lte('Creation', to));
      }

      var delta = stopIndex - startIndex;
      var sort = "".concat(sortDirection === 'ascending' ? '' : '-').concat(sortAttribute);
      this.setState(function (prev) {
        return {
          loading: prev.loading + delta,
          fetching: true
        };
      });
      return _services.Vouchers.Find({
        filters: andfilters.length ? [_Filter.Filter.Or.apply(_Filter.Filter, orfilters)].concat(andfilters) : orfilters,
        operator: andfilters.length ? 'and' : 'or',
        sort: sort
      }, startIndex, stopIndex + 1).then(function (response) {
        var count = response.Values.length;
        response.Values.forEach(function (voucher, i) {
          _this8._loadedRowsMap[startIndex + i] = voucher;
        });

        _this8.setState(function (prev) {
          return {
            loading: prev.loading - count,
            loaded: prev.loaded + count,
            rowCount: response.Count,
            fetching: false,
            lastUpdate: new Date().getTime()
          };
        });
      });
    }
  }, {
    key: "_refresh",
    value: function _refresh() {
      var _this9 = this;

      this._loadedRowsMap = {};

      if (this._list) {
        this._list.forceUpdate();

        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: -1,
          rowCount: 0,
          loaded: 0,
          loading: 0,
          lastUpdate: new Date().getTime()
        };
      }, function () {
        _this9._loadMore({
          startIndex: _this9._loadMoreRowsStartIndex,
          stopIndex: _this9._loadMoreRowsStopIndex
        }).then(function () {
          if (_this9._list) {
            _this9._list.forceUpdate();

            _this9._list.forceUpdateGrid();
          }
        });
      });
    }
  }, {
    key: "_resetFilters",
    value: function _resetFilters() {
      var _this10 = this;

      this.setState(function () {
        return {
          filter: DefaultFilters()
        };
      }, function () {
        return _this10._refresh();
      });
    }
  }, {
    key: "_handleItemChanged",
    value: function _handleItemChanged(voucher, index) {
      this._loadedRowsMap[index] = voucher;

      if (this._list) {
        this._list.forceUpdateGrid();
      }

      this.setState(function () {
        return {
          editing: index,
          lastUpdate: new Date().getTime()
        };
      });
    }
  }, {
    key: "_handleOrderDeleted",
    value: function _handleOrderDeleted() {
      var _this11 = this;

      this.setState(function () {
        return {
          editing: -1
        };
      }, function () {
        return _this11._refresh();
      });
    }
  }, {
    key: "_isRowLoaded",
    value: function _isRowLoaded(ind) {
      // No entry in this map signifies that the row has never been loaded before
      return !!this._loadedRowsMap[ind.index];
    }
  }]);

  return VoucherList;
}(React.Component);

var drawerWidth = '16rem';

var _default = (0, _core.withStyles)(function (theme) {
  return {
    containerCls: {
      height: '100%',
      position: 'relative'
    },
    searchInput: {},
    menu: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      zIndex: theme.zIndex.drawer + 1,
      display: 'flex',
      flexDirection: 'column',
      boxSizing: 'border-box'
    },
    menuContainer: {
      borderRight: "1px solid ".concat(theme.palette.divider),
      height: '100%',
      position: 'relative',
      flex: '0 0 auto',
      overflow: 'auto'
    },
    content: {
      flex: '1 1 auto',
      height: '100%',
      position: 'relative',
      padding: '0 40px'
    },
    menuSort: {
      marginTop: 'auto'
    },
    drawer: {
      flexShrink: 0,
      whiteSpace: 'nowrap',
      height: '100%',
      position: 'relative',
      boxSizing: 'border-box',
      borderRight: "1px solid ".concat(theme.palette.divider),
      overflow: 'hidden'
    },
    drawerContent: {
      width: drawerWidth,
      padding: "".concat(theme.spacing.unit, "px ").concat(theme.spacing.unit, "px ").concat(theme.spacing.unit * 2, "px ").concat(theme.spacing.unit, "px"),
      position: 'absolute',
      height: '100%',
      left: 0,
      right: 0,
      overflow: 'auto',
      flexWrap: 'nowrap'
    },
    drawerOpen: {
      width: drawerWidth,
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.enteringScreen
      })
    },
    drawerClose: {
      transition: theme.transitions.create('width', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.leavingScreen
      }),
      overflowX: 'hidden',
      width: 0,
      marginLeft: -1
    },
    mainCls: {
      height: '100%',
      overflow: 'auto',
      flexGrow: 1
    },
    menuItemIcon: {},
    menuItem: {
      paddingRight: theme.spacing.unit,
      paddingLeft: theme.spacing.unit,
      borderLeftWidth: theme.ActiveMenuBorderWidth,
      borderLeftColor: 'transparent',
      borderLeftStyle: 'solid',
      opacity: 0.5,
      flex: '0 0 auto',
      transition: theme.transitions.create('opacity', {
        easing: theme.transitions.easing.sharp,
        duration: theme.transitions.duration.short
      })
    },
    menuItemActive: {
      borderLeftColor: theme.palette.primary.main,
      opacity: 1
    },
    drawerSpacer: {
      height: 60
    },
    tooltip: {
      background: theme.palette.common.white,
      color: theme.palette.text.primary,
      boxShadow: theme.shadows[1],
      fontSize: 11
    }
  };
})(VoucherList);

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherListMesseges = void 0;

var _reactIntl = require("react-intl");

var VoucherListMesseges = (0, _reactIntl.defineMessages)({
  sortBtn: {
    "id": "src.components.orders.orderList.sortBtn",
    "defaultMessage": "Sort and Filters"
  },
  valid: {
    "id": "src.components.orders.orderList.valid",
    "defaultMessage": "Valid"
  },
  expired: {
    "id": "src.components.orders.orderList.expired",
    "defaultMessage": "Expired"
  },
  used: {
    "id": "src.components.orders.orderList.used",
    "defaultMessage": "Used"
  },
  search: {
    "id": "src.components.orders.orderList.search",
    "defaultMessage": "Search"
  },
  to: {
    "id": "src.components.orders.orderList.to",
    "defaultMessage": "To"
  },
  from: {
    "id": "src.components.orders.orderList.from",
    "defaultMessage": "From"
  },
  sort: {
    "id": "src.components.orders.orderList.sort",
    "defaultMessage": "Sort"
  }
});
exports.VoucherListMesseges = VoucherListMesseges;
var _default = VoucherListMesseges;
exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.VoucherListItem = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ItemPreview = _interopRequireWildcard(require("../../ItemPreview/ItemPreview"));

var _core = require("@material-ui/core");

var _VoucherIcons = require("../VoucherIcons");

var _icons = require("@material-ui/icons");

var classNames = _interopRequireWildcard(require("classnames"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

var VoucherListItem = function VoucherListItem(props) {
  var onClick = props.onClick,
      voucher = props.voucher,
      classes = props.classes;
  var cls = ['order-list-item', 'order-list-item__status'];

  if (props.classNames) {
    cls.push.apply(cls, _toConsumableArray(props.classNames));
  }

  if (!voucher) {
    return React.createElement("div", {
      className: classes.container
    }, React.createElement(_ItemPreview.default, null, React.createElement(_ItemPreview.Thumb, {
      loading: true
    }), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, {
      loading: true
    }), React.createElement(_ItemPreview.Line, {
      loading: true
    }))));
  }

  return React.createElement("div", {
    onClick: onClick,
    className: classes.container
  }, React.createElement(_ItemPreview.default, null, voucher.Valid && React.createElement(_core.Avatar, {
    className: classNames(classes.Initial)
  }, React.createElement(_icons.CheckCircle, null)), !voucher.Used && voucher.Expired && React.createElement(_core.Avatar, {
    className: classNames(classes.Used)
  }, React.createElement(_icons.Timelapse, null)), voucher.Used && React.createElement(_core.Avatar, {
    className: classNames(classes.Expired)
  }, React.createElement(_icons.Block, null)), React.createElement(_ItemPreview.Lines, null, React.createElement(_ItemPreview.Line, null, voucher.Code), React.createElement(_ItemPreview.Line, null, React.createElement("span", null, React.createElement(_reactIntl.FormattedNumber, {
    value: voucher.Value,
    style: "currency",
    currency: voucher.Currency
  })), "/", React.createElement("span", null, React.createElement(_reactIntl.FormattedNumber, {
    value: voucher.InitialValue
  }))), React.createElement(_ItemPreview.Line, null, voucher.Expiration && React.createElement(React.Fragment, null, React.createElement("span", null, "Expiration date: "), React.createElement(_reactIntl.FormattedDate, {
    value: " ".concat(new Date(voucher.Expiration)),
    year: "2-digit",
    month: "numeric",
    day: "numeric"
  }))))));
};

exports.VoucherListItem = VoucherListItem;
var width = '3rem';
var height = '3rem';

var _default = (0, _core.withStyles)(function (theme) {
  var iconStyles = (0, _VoucherIcons.VoucherIconStyles)(theme);
  return {
    container: {
      paddingLeft: theme.spacing.unit * 2,
      paddingRight: theme.spacing.unit * 2
    },
    Initial: _objectSpread({}, iconStyles.Initial, {
      width: width,
      height: height
    }),
    Canceled: _objectSpread({}, iconStyles.Canceled, {
      width: width,
      height: height
    }),
    Used: _objectSpread({}, iconStyles.Used, {
      width: width,
      height: height
    }),
    Expired: _objectSpread({}, iconStyles.Expired, {
      width: width,
      height: height
    })
  };
})(VoucherListItem);

exports.default = _default;
"use strict";

var React = _interopRequireWildcard(require("react"));

var ReactDOM = _interopRequireWildcard(require("react-dom"));

var _App = _interopRequireDefault(require("./App"));

var _registerServiceWorker = _interopRequireDefault(require("./registerServiceWorker"));

require("../node_modules/reset-css/reset.css");

require("./index.css");

require("./fonts.css");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

// import { IntlProvider, addLocaleData } from 'react-intl';
// const supportedLanguages = ['de', 'en', 'pt', 'fr'];
// Define user's language. Different browsers have the user locale defined
// on different fields on the `navigator` object, so we make sure to account
// for these different by checking all of them
// const language = (navigator.languages && navigator.languages[0]) ||
//   navigator.language;
// || navigator.userLanguage;
// const languageWithoutRegionCode = language.toLowerCase().split(/[_-]+/)[0];
// addLocaleData([...en, ...pt, ...fr, ...de]);
// import * as en from 'react-intl/locale-data/en';
// import * as fr from 'react-intl/locale-data/fr';
// import * as de from 'react-intl/locale-data/de';
// import * as pt from 'react-intl/locale-data/de';
// import { ConnectedIntlProvider } from './_containers';
// // // Our translated strings
// // import * as messagesFR from './i18n/locales/fr.json';
// const localeData = {
//   en: en,
//   fr: fr,
//   pt: pt,
//   de: de
// };
// const messages = localeData[languageWithoutRegionCode] || localeData[language] || localeData.en;
// const messagesFR = require('react-intl/locale-data/fr');
// addLocaleData(fr);
// Split locales with a region code
// Try full locale, try locale without region code, fallback to 'en'
ReactDOM.render(React.createElement(_App.default, null), document.getElementById('root'));
(0, _registerServiceWorker.default)();
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.HomePageStandalone = exports.HomePage = exports.HomePageMessages = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _ContentView = _interopRequireDefault(require("../../components/ContentView"));

var _context = require("src/_context");

var _Settings = _interopRequireDefault(require("src/components/Settings/Settings"));

var _ClientList = _interopRequireDefault(require("src/components/Clients/ClientList/ClientList"));

var _ProductPage = _interopRequireDefault(require("src/components/Products/ProductPage/ProductPage"));

var _OrderList = _interopRequireDefault(require("src/components/Orders/OrderList/OrderList"));

var _Category = require("src/_context/Category");

var _Product = require("src/_context/Product");

var _icons = require("@material-ui/icons");

var _VoucherList = _interopRequireDefault(require("src/components/Vouchers/VoucherList/VoucherList"));

var _Templates = require("src/_context/Templates");

var _MovementsList = _interopRequireDefault(require("src/components/Movements/MovementsList/MovementsList"));

var _Dashboard = _interopRequireDefault(require("src/components/Dashboard/Dashboard"));

var _roles = require("src/_helpers/roles");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var HomePageMessages = (0, _reactIntl.defineMessages)({
  dashboard: {
    "id": "pages.home.dashboard",
    "defaultMessage": "Dashboard"
  },
  orders: {
    "id": "pages.home.orders",
    "defaultMessage": "Orders"
  },
  shop: {
    "id": "pages.home.shop",
    "defaultMessage": "shops"
  },
  deliveries: {
    "id": "pages.home.deliveries",
    "defaultMessage": "Deliveries"
  },
  clients: {
    "id": "pages.home.clients",
    "defaultMessage": "Clients"
  },
  products: {
    "id": "pages.home.products",
    "defaultMessage": "Products"
  },
  specials: {
    "id": "pages.home.specials",
    "defaultMessage": "Specials"
  },
  settings: {
    "id": "pages.home.settings",
    "defaultMessage": "Settings"
  },
  vouchers: {
    "id": "pages.home.vouchers",
    "defaultMessage": "Vouchers"
  }
});
exports.HomePageMessages = HomePageMessages;

var HomePage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(HomePage, _React$Component);

  function HomePage() {
    _classCallCheck(this, HomePage);

    return _possibleConstructorReturn(this, _getPrototypeOf(HomePage).apply(this, arguments));
  }

  _createClass(HomePage, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          intl = _this$props.intl,
          templateCtx = _this$props.templateCtx,
          usersCtx = _this$props.usersCtx,
          user = _this$props.authCtx.user,
          settingsCtx = _this$props.settingsCtx,
          warehouseCtx = _this$props.warehouseCtx,
          authCtx = _this$props.authCtx,
          shopCtx = _this$props.shopCtx,
          categoryCtx = _this$props.categoryCtx,
          productCtx = _this$props.productCtx;
      var tabs = [(0, _roles.IsAdminOrInRole)(user, 'View_Dashboard') && {
        Key: 'dashboard',
        Title: this.props.intl.formatMessage(HomePageMessages.dashboard),
        Icon: React.createElement(_icons.Dashboard, null),
        View: React.createElement(_Dashboard.default, {
          intl: intl,
          usersCtx: usersCtx,
          authCtx: authCtx,
          settingsCtx: settingsCtx,
          warehouseCtx: warehouseCtx,
          categoryCtx: categoryCtx,
          shopCtx: shopCtx,
          productCtx: productCtx
        })
      }, (0, _roles.IsAdminOrInRole)(user, 'List_Orders', 'CRUD_All_Orders', 'CRUD_Own_Orders') && {
        Key: 'orders',
        Title: intl.formatMessage(HomePageMessages.orders),
        Icon: React.createElement(_icons.ShoppingCart, null),
        View: React.createElement(_OrderList.default, {
          intl: intl,
          templateCtx: templateCtx,
          settingsCtx: settingsCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          usersCtx: usersCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        })
      }, {
        Key: 'clients',
        Title: intl.formatMessage(HomePageMessages.clients),
        Icon: React.createElement(_icons.FolderShared, null),
        View: React.createElement(_ClientList.default, {
          intl: intl,
          settingsCtx: settingsCtx,
          usersCtx: usersCtx,
          templateCtx: templateCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        })
      }, {
        Key: 'products',
        Title: intl.formatMessage(HomePageMessages.products),
        Icon: React.createElement(_icons.Layers, null),
        View: React.createElement(_ProductPage.default, {
          intl: intl,
          settingsCtx: settingsCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        })
      }, (0, _roles.IsAdminOrInRole)(user, 'List_Vouchers', 'CRUD_Vouchers') && {
        Key: 'voucher',
        Title: intl.formatMessage(HomePageMessages.vouchers),
        Icon: React.createElement(_icons.CardGiftcard, null),
        View: React.createElement(_VoucherList.default, {
          intl: intl,
          settingsCtx: settingsCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          usersCtx: usersCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx,
          templateCtx: templateCtx
        })
      }, {
        Key: 'shop',
        Title: intl.formatMessage(HomePageMessages.shop),
        Icon: React.createElement(_icons.Store, null),
        View: React.createElement(_MovementsList.default, {
          intl: intl,
          settingsCtx: settingsCtx,
          templateCtx: templateCtx,
          usersCtx: usersCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          productCtx: productCtx
        })
      }, {
        Key: 'settings',
        Title: intl.formatMessage(HomePageMessages.settings),
        Icon: React.createElement(_icons.Settings, null),
        View: React.createElement(_Settings.default, {
          intl: intl,
          settingsCtx: settingsCtx,
          warehouseCtx: warehouseCtx,
          authCtx: authCtx,
          shopCtx: shopCtx,
          categoryCtx: categoryCtx,
          templateCtx: templateCtx
        })
      }];
      return React.createElement(_ContentView.default, {
        Tabs: tabs.filter(function (t) {
          return !!t;
        })
      });
    }
  }]);

  return HomePage;
}(React.Component);

exports.HomePage = HomePage;
var HomePageStandalone = (0, _context.withAuth)((0, _context.withUsers)((0, _context.withSettings)((0, _Category.withCategory)((0, _Product.withProduct)((0, _context.withWarehouse)((0, _context.withShop)((0, _Templates.withTemplates)((0, _reactIntl.injectIntl)(HomePage)))))))));
exports.HomePageStandalone = HomePageStandalone;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _context = require("../../_context");

var _IconButton = _interopRequireDefault(require("@material-ui/core/IconButton"));

var _Input = _interopRequireDefault(require("@material-ui/core/Input"));

var _InputLabel = _interopRequireDefault(require("@material-ui/core/InputLabel"));

var _InputAdornment = _interopRequireDefault(require("@material-ui/core/InputAdornment"));

var _FormControl = _interopRequireDefault(require("@material-ui/core/FormControl"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Visibility = _interopRequireDefault(require("@material-ui/icons/Visibility"));

var _VisibilityOff = _interopRequireDefault(require("@material-ui/icons/VisibilityOff"));

var _core = require("@material-ui/core");

var _LoginPageMessages = require("./LoginPageMessages");

var _icons = require("@material-ui/icons");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var LoginPage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(LoginPage, _React$Component);

  function LoginPage(props) {
    var _this;

    _classCallCheck(this, LoginPage);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(LoginPage).call(this, props));
    var user = _this.props.authCtx.user;
    _this.state = {
      username: user && user.UserName || undefined
    };
    _this._handleShowPasswordClick = _this._handleShowPasswordClick.bind(_assertThisInitialized(_this));
    _this._handleShowPasswordMouseDown = _this._handleShowPasswordMouseDown.bind(_assertThisInitialized(_this));
    _this._handleUsernameChange = _this._handleUsernameChange.bind(_assertThisInitialized(_this));
    _this._handlePasswordChange = _this._handlePasswordChange.bind(_assertThisInitialized(_this));
    _this._handleLoginSubmit = _this._handleLoginSubmit.bind(_assertThisInitialized(_this));
    _this._handleResetSubmit = _this._handleResetSubmit.bind(_assertThisInitialized(_this));
    _this._handleForgotPassword = _this._handleForgotPassword.bind(_assertThisInitialized(_this));
    _this._handleRmemberMeCLick = _this._handleRmemberMeCLick.bind(_assertThisInitialized(_this));
    return _this;
  }

  _createClass(LoginPage, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          password = _this$state.password,
          username = _this$state.username,
          forgot = _this$state.forgot,
          rememberMe = _this$state.rememberMe,
          error = _this$state.error,
          errorMessage = _this$state.errorMessage;
      var _this$props = this.props,
          formatMessage = _this$props.intl.formatMessage,
          fetching = _this$props.authCtx.fetching,
          classes = _this$props.classes;
      var usernameTitle = formatMessage(_LoginPageMessages.logInMessages.usernameTitle);
      var passwordTitle = formatMessage(_LoginPageMessages.logInMessages.passwordTitle);
      return React.createElement("div", {
        className: classes.loginPage
      }, React.createElement("form", {
        className: classes.form,
        onSubmit: this.state.forgot ? this._handleResetSubmit : this._handleLoginSubmit
      }, React.createElement("h2", {
        className: classes.title
      }, React.createElement(_reactIntl.FormattedMessage, {
        id: "pages.login.loginpage.mainTitle",
        defaultMessage: "Login"
      })), React.createElement(_TextField.default, {
        label: usernameTitle,
        onChange: function onChange(value) {
          return _this2._handleUsernameChange(value.target.value);
        },
        value: username || '',
        fullWidth: true,
        inputProps: {
          autoComplete: 'username'
        }
      }), !this.state.forgot && React.createElement(React.Fragment, null, React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, passwordTitle), React.createElement(_Input.default, {
        id: "password",
        type: this.state.showPassword ? 'text' : 'password',
        autoComplete: "current-password",
        value: password || '',
        onChange: function onChange(value) {
          return _this2._handlePasswordChange(value.target.value);
        },
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowPasswordClick,
          onMouseDown: this._handleShowPasswordMouseDown
        }, this.state.showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), React.createElement("div", {
        className: classes.passwordOptions
      }, React.createElement("div", {
        className: classes.forgot
      }, React.createElement(_reactIntl.FormattedMessage, _extends({}, _LoginPageMessages.logInMessages.forgot, {
        values: {
          password_link: React.createElement("a", {
            className: classes.forgotLink,
            onClick: this._handleForgotPassword
          }, React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.passwordLink))
        }
      }))), React.createElement("a", {
        className: classes.remember,
        onClick: this._handleRmemberMeCLick
      }, React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.rememberMe), React.createElement("span", {
        className: classes.rememberIcon
      }, rememberMe ? React.createElement(_icons.CheckCircle, null) : React.createElement(_icons.RadioButtonUnchecked, null))))), forgot && React.createElement(_core.Button, {
        onClick: function onClick() {
          return _this2._handleBackClick();
        }
      }, React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.backBtn)), fetching ? React.createElement(_core.Button, {
        variant: "contained",
        color: "secondary",
        disabled: true
      }, React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.loadingText)) : React.createElement(_core.Button, {
        type: "submit",
        variant: "contained",
        color: "secondary"
      }, forgot ? React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.resetBtn) : React.createElement(_reactIntl.FormattedMessage, _LoginPageMessages.logInMessages.submitBtn)), error && React.createElement("div", {
        className: classes.errorMessage
      }, errorMessage)));
    }
  }, {
    key: "_handleShowPasswordClick",
    value: function _handleShowPasswordClick() {
      this.setState(function (prev) {
        return {
          showPassword: !prev.showPassword
        };
      });
    }
  }, {
    key: "_handleShowPasswordMouseDown",
    value: function _handleShowPasswordMouseDown(e) {
      e.preventDefault();
    }
  }, {
    key: "_handleRmemberMeCLick",
    value: function _handleRmemberMeCLick() {
      this.setState(function (prev) {
        return {
          rememberMe: !prev.rememberMe
        };
      });
    }
  }, {
    key: "_handleLoginSubmit",
    value: function _handleLoginSubmit(e) {
      var _this3 = this;

      e.preventDefault();
      var _this$state2 = this.state,
          username = _this$state2.username,
          password = _this$state2.password;
      var _this$props2 = this.props,
          authCtx = _this$props2.authCtx,
          formatMessage = _this$props2.intl.formatMessage;

      if (!username || !password) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: formatMessage(_LoginPageMessages.logInMessages.imcomplete)
          };
        });
        return;
      }

      authCtx.login(username, password).then(function (result) {
        if (!result) {
          _this3.setState(function () {
            return {
              error: true,
              errorMessage: formatMessage(_LoginPageMessages.logInMessages.failed)
            };
          });
        }
      });
    }
  }, {
    key: "_handleResetSubmit",
    value: function _handleResetSubmit(e) {
      e.preventDefault();
      var username = this.state.username;
      var authCtx = this.props.authCtx;

      if (username) {
        authCtx.reset(username);
      }
    }
  }, {
    key: "_handlePasswordChange",
    value: function _handlePasswordChange(value) {
      this.setState(function () {
        return {
          password: value
        };
      });
    }
  }, {
    key: "_handleUsernameChange",
    value: function _handleUsernameChange(value) {
      this.setState(function () {
        return {
          username: value
        };
      });
    }
  }, {
    key: "_handleBackClick",
    value: function _handleBackClick() {
      this.setState(function () {
        return {
          forgot: false
        };
      });
    }
  }, {
    key: "_handleForgotPassword",
    value: function _handleForgotPassword(e) {
      this.setState(function (prev) {
        return {
          forgot: !prev.forgot
        };
      });
    }
  }]);

  return LoginPage;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    root: {},
    loginPage: {
      position: 'relative',
      width: '100%',
      height: '100%',
      backgroundColor: '#f0f0f0'
    },
    form: {
      position: 'absolute',
      width: 250,
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)',
      boxShadow: '3px 3px 3px rgba(0, 0, 0, 0.15); //1px 1px 5px rgba(0,0,0,.2)',
      background: '#f8f8f8',
      borderRadius: 4,
      padding: '30px 35px',
      textAlign: 'right'
    },
    title: {
      fontSize: '2.4rem',
      paddingSottom: '0.5rem',
      margin: '0 0 0.5rem 0',
      fontWeight: 'bold',
      color: theme.Colors.blue.primary.main,
      borderBottom: '1px solid #969696',
      textAlign: 'center'
    },
    cancel: {
      display: 'inline-block',
      marginRight: 10,
      fontSize: '0.7rem',
      color: theme.Colors.blue.primary.main
    },
    resetBtn: {
      marginTop: 15
    },
    passwordOptions: {
      display: 'flex',
      flexDirection: 'row',
      flexWrap: 'nowrap',
      justifyContent: 'space-between',
      padding: '0.3rem 0 0.7rem',
      alignItems: 'center'
    },
    forgot: {
      flexGrow: 1,
      flexShrink: 1,
      fontSize: '0.8rem',
      color: '#969696',
      textAlign: 'left'
    },
    remember: {
      flexGrow: 1,
      flexShrink: 1,
      fontSize: '0.8rem',
      color: '#969696',
      textAlign: 'right',
      display: 'flex',
      justifyContent: 'flex-end',
      alignItems: 'center'
    },
    forgotLink: {
      color: theme.Colors.blue.primary.main
    },
    rememberIcon: {
      marginLeft: 5
    },
    submitBtn: {
      textTransform: 'uppercase',
      fontWeight: 'bold'
    },
    errorMessage: {
      display: 'block',
      marginTop: 10,
      color: theme.Colors.red.primary.main,
      fontSize: '.8rem',
      textAlign: 'left'
    }
  };
})((0, _context.withAuth)((0, _reactIntl.injectIntl)(LoginPage)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.logInMessages = void 0;

var _reactIntl = require("react-intl");

var logInMessages = (0, _reactIntl.defineMessages)({
  mainTitle: {
    "id": "pages.login.loginpage.mainTitle",
    "defaultMessage": "Login"
  },
  usernamePlaceholder: {
    "id": "pages.login.loginpage.usernamePlaceholder",
    "defaultMessage": "Username placeholder"
  },
  usernameTitle: {
    "id": "pages.login.loginpage.usernameTitle",
    "defaultMessage": "Username"
  },
  passwordTitle: {
    "id": "pages.login.loginpage.passwordTitle",
    "defaultMessage": "Password"
  },
  rememberMe: {
    "id": "pages.login.loginpage.rememberMe",
    "defaultMessage": "remember me"
  },
  backBtn: {
    "id": "pages.login.loginpage.backBtn",
    "defaultMessage": "Back"
  },
  loadingText: {
    "id": "pages.login.loginpage.loadingText",
    "defaultMessage": "Loading"
  },
  forgot: {
    "id": "pages.login.loginpage.forgot",
    "defaultMessage": "forgot your {password_link}?"
  },
  passwordLink: {
    "id": "pages.login.loginpage.passwordLink",
    "defaultMessage": "password"
  },
  resetBtn: {
    "id": "pages.login.loginpage.resetBtn",
    "defaultMessage": "Reset"
  },
  submitBtn: {
    "id": "pages.login.loginpage.submitBtn",
    "defaultMessage": "Submit"
  },
  failed: {
    "id": "pages.login.loginpage.error.failed",
    "defaultMessage": "Please check your credentials"
  },
  imcomplete: {
    "id": "pages.login.loginpage.error.imcomplete",
    "defaultMessage": "Please fill all information"
  }
});
exports.logInMessages = logInMessages;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _context = require("../../_context");

var _IconButton = _interopRequireDefault(require("@material-ui/core/IconButton"));

var _Input = _interopRequireDefault(require("@material-ui/core/Input"));

var _InputLabel = _interopRequireDefault(require("@material-ui/core/InputLabel"));

var _InputAdornment = _interopRequireDefault(require("@material-ui/core/InputAdornment"));

var _FormControl = _interopRequireDefault(require("@material-ui/core/FormControl"));

var _Visibility = _interopRequireDefault(require("@material-ui/icons/Visibility"));

var _VisibilityOff = _interopRequireDefault(require("@material-ui/icons/VisibilityOff"));

var _core = require("@material-ui/core");

var _RegisterPageMessages = _interopRequireDefault(require("./RegisterPageMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var RegisterPage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(RegisterPage, _React$Component);

  function RegisterPage(props) {
    var _this;

    _classCallCheck(this, RegisterPage);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(RegisterPage).call(this, props));
    _this._handleSubmit = _this._handleSubmit.bind(_assertThisInitialized(_this));
    _this.state = {
      password: '',
      confirmPassword: '',
      error: false,
      showPassword: false,
      errorMessage: ''
    };
    return _this;
  }

  _createClass(RegisterPage, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          password = _this$state.password,
          confirmPassword = _this$state.confirmPassword,
          showPassword = _this$state.showPassword;
      var _this$props = this.props,
          fetching = _this$props.authCtx.fetching,
          classes = _this$props.classes,
          userName = _this$props.userName;

      var change = function change(key) {
        return function (e) {
          var v = e.target.value; // tslint:disable-next-line:no-any

          _this2.setState(function () {
            return _defineProperty({}, key, v);
          });
        };
      };

      return React.createElement("div", {
        className: classes.page
      }, React.createElement("form", {
        className: classes.form,
        onSubmit: this._handleSubmit
      }, React.createElement("h2", {
        className: classes.title
      }, React.createElement(_reactIntl.FormattedMessage, _RegisterPageMessages.default.mainTitle)), React.createElement(_core.TextField, {
        label: 'username',
        name: "username",
        value: userName || '',
        fullWidth: true,
        inputProps: {
          autoComplete: 'username'
        }
      }), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, React.createElement(_reactIntl.FormattedMessage, _RegisterPageMessages.default.passwordTitle)), React.createElement(_Input.default, {
        id: "password",
        type: showPassword ? 'text' : 'password',
        value: password || '',
        name: "password",
        onChange: change('password'),
        autoComplete: "new-password",
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: function onClick() {
            return _this2.setState(function (p) {
              return {
                showPassword: !p.showPassword
              };
            });
          },
          onMouseDown: function onMouseDown(e) {
            return e.preventDefault();
          }
        }, showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, React.createElement(_reactIntl.FormattedMessage, _RegisterPageMessages.default.confirmPasswordTitle)), React.createElement(_Input.default, {
        id: "confirm-password",
        type: showPassword ? 'text' : 'password',
        value: confirmPassword || '',
        onChange: change('confirmPassword'),
        autoComplete: "new-password",
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: function onClick() {
            return _this2.setState(function (p) {
              return {
                showPassword: !p.showPassword
              };
            });
          },
          onMouseDown: function onMouseDown(e) {
            return e.preventDefault();
          }
        }, showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), fetching ? React.createElement(_core.Button, {
        variant: "contained",
        color: "secondary",
        disabled: true
      }, React.createElement(_reactIntl.FormattedMessage, _RegisterPageMessages.default.loadingText)) : React.createElement(_core.Button, {
        type: "submit",
        variant: "contained",
        color: "secondary"
      }, React.createElement(_reactIntl.FormattedMessage, _RegisterPageMessages.default.resetBtn)), this.state.error && React.createElement("div", {
        className: classes.errorMessage
      }, this.state.errorMessage)));
    }
  }, {
    key: "_handleSubmit",
    value: function _handleSubmit(e) {
      var _this3 = this;

      e.preventDefault();
      var _this$state2 = this.state,
          password = _this$state2.password,
          confirmPassword = _this$state2.confirmPassword;
      var _this$props2 = this.props,
          registerKey = _this$props2.registerKey,
          userId = _this$props2.userId,
          authCtx = _this$props2.authCtx,
          intl = _this$props2.intl;

      if (!password) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: intl.formatMessage(_RegisterPageMessages.default.incomplete)
          };
        });
        return;
      }

      if (password !== confirmPassword) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: intl.formatMessage(_RegisterPageMessages.default.different)
          };
        });
        return;
      }

      authCtx.confirmRegister(userId, registerKey, password).then(function (result) {
        if (!result) {
          _this3.setState(function () {
            return {
              error: true,
              errorMessage: intl.formatMessage(_RegisterPageMessages.default.failed)
            };
          });

          return;
        }

        document.location.hash = 'home';
      }).catch(function (reason) {
        _this3.setState(function () {
          return {
            error: true,
            errorMessage: reason
          };
        });
      });
    }
  }]);

  return RegisterPage;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    root: {},
    page: {
      position: 'relative',
      width: '100%',
      height: '100%',
      backgroundColor: '#f0f0f0'
    },
    form: {
      position: 'absolute',
      width: 250,
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)',
      boxShadow: '3px 3px 3px rgba(0, 0, 0, 0.15); //1px 1px 5px rgba(0,0,0,.2)',
      background: '#f8f8f8',
      borderRadius: 4,
      padding: '30px 35px',
      textAlign: 'right'
    },
    title: {
      fontSize: '2.4rem',
      paddingBottom: '0.5rem',
      margin: '0 0 0.5rem 0',
      fontWeight: 'bold',
      color: theme.Colors.blue.primary.main,
      borderBottom: '1px solid #969696',
      textAlign: 'center'
    },
    cancel: {
      display: 'inline-block',
      marginRight: 10,
      fontSize: '0.7rem',
      color: theme.Colors.blue.primary.main
    },
    submitBtn: {
      textTransform: 'uppercase',
      fontWeight: 'bold'
    },
    errorMessage: {
      display: 'block',
      marginTop: 10,
      color: theme.Colors.red.primary.main,
      fontSize: '.8rem',
      textAlign: 'left'
    }
  };
})((0, _context.withAuth)((0, _reactIntl.injectIntl)(RegisterPage)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  mainTitle: {
    "id": "pages.register.registerpage.mainTitle",
    "defaultMessage": "Register"
  },
  passwordTitle: {
    "id": "pages.register.registerpage.passwordTitle",
    "defaultMessage": "Password"
  },
  confirmPasswordTitle: {
    "id": "pages.register.registerpage.passwordTitle",
    "defaultMessage": "Password"
  },
  backBtn: {
    "id": "pages.register.registerpage.backBtn",
    "defaultMessage": "Back"
  },
  loadingText: {
    "id": "pages.register.registerpage.loadingText",
    "defaultMessage": "Loading"
  },
  forgot: {
    "id": "pages.register.registerpage.forgot",
    "defaultMessage": "forgot your {password_link}?"
  },
  passwordLink: {
    "id": "pages.register.registerpage.passwordLink",
    "defaultMessage": "password"
  },
  resetBtn: {
    "id": "pages.register.registerpage.resetBtn",
    "defaultMessage": "Reset"
  },
  submitBtn: {
    "id": "pages.register.registerpage.submitBtn",
    "defaultMessage": "Submit"
  },
  failed: {
    "id": "pages.register.registerpage.error.failed",
    "defaultMessage": "Please check your credentials"
  },
  incomplete: {
    "id": "pages.register.registerpage.error.incomplete",
    "defaultMessage": "Please fill all information"
  },
  different: {
    "id": "pages.register.registerpage.error.different",
    "defaultMessage": "Different password and confirm"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _context = require("../../_context");

var _IconButton = _interopRequireDefault(require("@material-ui/core/IconButton"));

var _Input = _interopRequireDefault(require("@material-ui/core/Input"));

var _InputLabel = _interopRequireDefault(require("@material-ui/core/InputLabel"));

var _InputAdornment = _interopRequireDefault(require("@material-ui/core/InputAdornment"));

var _FormControl = _interopRequireDefault(require("@material-ui/core/FormControl"));

var _Visibility = _interopRequireDefault(require("@material-ui/icons/Visibility"));

var _VisibilityOff = _interopRequireDefault(require("@material-ui/icons/VisibilityOff"));

var _core = require("@material-ui/core");

var _ResetPageMessages = _interopRequireDefault(require("./ResetPageMessages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var ResetPage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(ResetPage, _React$Component);

  function ResetPage(props) {
    var _this;

    _classCallCheck(this, ResetPage);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResetPage).call(this, props));
    _this._handleSubmit = _this._handleSubmit.bind(_assertThisInitialized(_this));
    _this.state = {
      password: '',
      confirmPassword: '',
      error: false,
      showPassword: false,
      errorMessage: ''
    };
    return _this;
  }

  _createClass(ResetPage, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          password = _this$state.password,
          confirmPassword = _this$state.confirmPassword,
          showPassword = _this$state.showPassword;
      var _this$props = this.props,
          fetching = _this$props.authCtx.fetching,
          classes = _this$props.classes,
          userName = _this$props.userName;

      var change = function change(key) {
        return function (e) {
          var v = e.target.value; // tslint:disable-next-line:no-any

          _this2.setState(function () {
            return _defineProperty({}, key, v);
          });
        };
      };

      return React.createElement("div", {
        className: classes.page
      }, React.createElement("form", {
        className: classes.form,
        onSubmit: this._handleSubmit
      }, React.createElement("h2", {
        className: classes.title
      }, React.createElement(_reactIntl.FormattedMessage, _ResetPageMessages.default.mainTitle)), React.createElement(_core.TextField, {
        label: 'username',
        name: "username",
        value: userName || '',
        fullWidth: true,
        inputProps: {
          autoComplete: 'username'
        }
      }), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, React.createElement(_reactIntl.FormattedMessage, _ResetPageMessages.default.passwordTitle)), React.createElement(_Input.default, {
        id: "password",
        type: showPassword ? 'text' : 'password',
        value: password || '',
        onChange: change('password'),
        autoComplete: "new-password",
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: function onClick() {
            return _this2.setState(function (p) {
              return {
                showPassword: !p.showPassword
              };
            });
          },
          onMouseDown: function onMouseDown(e) {
            return e.preventDefault();
          }
        }, showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, React.createElement(_reactIntl.FormattedMessage, _ResetPageMessages.default.confirmPasswordTitle)), React.createElement(_Input.default, {
        id: "confirm-password",
        type: showPassword ? 'text' : 'password',
        value: confirmPassword || '',
        onChange: change('confirmPassword'),
        autoComplete: "new-password",
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: function onClick() {
            return _this2.setState(function (p) {
              return {
                showPassword: !p.showPassword
              };
            });
          },
          onMouseDown: function onMouseDown(e) {
            return e.preventDefault();
          }
        }, showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), fetching ? React.createElement(_core.Button, {
        variant: "contained",
        color: "secondary",
        disabled: true
      }, React.createElement(_reactIntl.FormattedMessage, _ResetPageMessages.default.loadingText)) : React.createElement(_core.Button, {
        type: "submit",
        variant: "contained",
        color: "secondary"
      }, React.createElement(_reactIntl.FormattedMessage, _ResetPageMessages.default.resetBtn)), this.state.error && React.createElement("div", {
        className: classes.errorMessage
      }, this.state.errorMessage)));
    }
  }, {
    key: "_handleSubmit",
    value: function _handleSubmit(e) {
      var _this3 = this;

      e.preventDefault();
      var _this$state2 = this.state,
          password = _this$state2.password,
          confirmPassword = _this$state2.confirmPassword;
      var _this$props2 = this.props,
          registerKey = _this$props2.registerKey,
          userId = _this$props2.userId,
          authCtx = _this$props2.authCtx,
          intl = _this$props2.intl;

      if (!password) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: intl.formatMessage(_ResetPageMessages.default.imcomplete)
          };
        });
        return;
      }

      if (password !== confirmPassword) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: intl.formatMessage(_ResetPageMessages.default.different)
          };
        });
        return;
      }

      authCtx.confirmRegister(userId, registerKey, password).then(function (result) {
        if (!result) {
          _this3.setState(function () {
            return {
              error: true,
              errorMessage: intl.formatMessage(_ResetPageMessages.default.failed)
            };
          });

          return;
        }

        document.location.hash = 'home';
      }).catch(function (reason) {
        _this3.setState(function () {
          return {
            error: true,
            errorMessage: reason.Result.Message
          };
        });
      });
    }
  }]);

  return ResetPage;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    root: {},
    page: {
      position: 'relative',
      width: '100%',
      height: '100%',
      backgroundColor: '#f0f0f0'
    },
    form: {
      position: 'absolute',
      width: 250,
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)',
      boxShadow: '3px 3px 3px rgba(0, 0, 0, 0.15); //1px 1px 5px rgba(0,0,0,.2)',
      background: '#f8f8f8',
      borderRadius: 4,
      padding: '30px 35px',
      textAlign: 'right'
    },
    title: {
      fontSize: '2.4rem',
      paddingSottom: '0.5rem',
      margin: '0 0 0.5rem 0',
      fontWeight: 'bold',
      color: theme.Colors.blue.primary.main,
      borderBottom: '1px solid #969696',
      textAlign: 'center'
    },
    cancel: {
      display: 'inline-block',
      marginRight: 10,
      fontSize: '0.7rem',
      color: theme.Colors.blue.primary.main
    },
    submitBtn: {
      textTransform: 'uppercase',
      fontWeight: 'bold'
    },
    errorMessage: {
      display: 'block',
      marginTop: 10,
      color: theme.Colors.red.primary.main,
      fontSize: '.8rem',
      textAlign: 'left'
    }
  };
})((0, _context.withAuth)((0, _reactIntl.injectIntl)(ResetPage)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactIntl = require("react-intl");

var _default = (0, _reactIntl.defineMessages)({
  mainTitle: {
    "id": "pages.register.resetpage.mainTitle",
    "defaultMessage": "Reset"
  },
  passwordTitle: {
    "id": "pages.register.resetpage.passwordTitle",
    "defaultMessage": "Password"
  },
  confirmPasswordTitle: {
    "id": "pages.register.resetpage.passwordTitle",
    "defaultMessage": "Password"
  },
  loadingText: {
    "id": "pages.register.resetpage.loadingText",
    "defaultMessage": "Loading"
  },
  resetBtn: {
    "id": "pages.register.resetpage.resetBtn",
    "defaultMessage": "Reset"
  },
  failed: {
    "id": "pages.register.resetpage.error.failed",
    "defaultMessage": "Please check your credentials"
  },
  imcomplete: {
    "id": "pages.register.resetpage.error.imcomplete",
    "defaultMessage": "Please fill all information"
  },
  different: {
    "id": "pages.register.resetpage.error.different",
    "defaultMessage": "Different passord and confirm"
  }
});

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactIntl = require("react-intl");

var _context = require("../../_context");

var _IconButton = _interopRequireDefault(require("@material-ui/core/IconButton"));

var _Input = _interopRequireDefault(require("@material-ui/core/Input"));

var _InputLabel = _interopRequireDefault(require("@material-ui/core/InputLabel"));

var _InputAdornment = _interopRequireDefault(require("@material-ui/core/InputAdornment"));

var _FormControl = _interopRequireDefault(require("@material-ui/core/FormControl"));

var _TextField = _interopRequireDefault(require("@material-ui/core/TextField"));

var _Visibility = _interopRequireDefault(require("@material-ui/icons/Visibility"));

var _VisibilityOff = _interopRequireDefault(require("@material-ui/icons/VisibilityOff"));

var _core = require("@material-ui/core");

var _SetupPageMessages = require("./SetupPageMessages");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var SetupPage =
/*#__PURE__*/
function (_React$Component) {
  _inherits(SetupPage, _React$Component);

  function SetupPage(props) {
    var _this;

    _classCallCheck(this, SetupPage);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(SetupPage).call(this, props));
    _this.state = {
      username: '',
      email: '',
      password: '',
      confirmPassword: ''
    };
    _this._handleShowPasswordClick = _this._handleShowPasswordClick.bind(_assertThisInitialized(_this));
    _this._handleShowConfirmPasswordClick = _this._handleShowConfirmPasswordClick.bind(_assertThisInitialized(_this));
    _this._handleShowPasswordMouseDown = _this._handleShowPasswordMouseDown.bind(_assertThisInitialized(_this));
    _this._handleShowConfirmPasswordMouseDown = _this._handleShowConfirmPasswordMouseDown.bind(_assertThisInitialized(_this));
    _this._handleNameChange = _this._handleNameChange.bind(_assertThisInitialized(_this));
    _this._handlePasswordChange = _this._handlePasswordChange.bind(_assertThisInitialized(_this));
    _this._handleLoginSubmit = _this._handleLoginSubmit.bind(_assertThisInitialized(_this));
    return _this;
  }

  _createClass(SetupPage, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$state = this.state,
          password = _this$state.password,
          name = _this$state.username,
          email = _this$state.email,
          confirmPassword = _this$state.confirmPassword,
          error = _this$state.error,
          errorMessage = _this$state.errorMessage,
          showConfirmPassword = _this$state.showConfirmPassword,
          showPassword = _this$state.showPassword;
      var _this$props = this.props,
          formatMessage = _this$props.intl.formatMessage,
          fetching = _this$props.authCtx.fetching,
          classes = _this$props.classes;
      return React.createElement("div", {
        className: classes.loginPage
      }, React.createElement("form", {
        className: classes.form,
        onSubmit: this._handleLoginSubmit
      }, React.createElement("h2", {
        className: classes.title
      }, formatMessage(_SetupPageMessages.SetupPageMessages.title)), React.createElement(_TextField.default, {
        label: formatMessage(_SetupPageMessages.SetupPageMessages.username),
        onChange: function onChange(value) {
          return _this2._handleNameChange(value.target.value);
        },
        name: "username",
        value: name || '',
        inputProps: {
          autoComplete: 'username'
        },
        fullWidth: true
      }), React.createElement(_TextField.default, {
        label: formatMessage(_SetupPageMessages.SetupPageMessages.email),
        onChange: function onChange(value) {
          return _this2._handleEmailChange(value.target.value);
        },
        value: email || '',
        name: "email",
        inputProps: {
          autoComplete: 'email'
        },
        fullWidth: true
      }), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "password"
      }, formatMessage(_SetupPageMessages.SetupPageMessages.passwordTitle)), React.createElement(_Input.default, {
        id: "password",
        type: showPassword ? 'text' : 'password',
        name: "password",
        value: password || '',
        autoComplete: "new-password",
        onChange: function onChange(value) {
          return _this2._handlePasswordChange(value.target.value);
        },
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowPasswordClick,
          onMouseDown: this._handleShowPasswordMouseDown
        }, this.state.showPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), React.createElement(_FormControl.default, {
        fullWidth: true
      }, React.createElement(_InputLabel.default, {
        htmlFor: "confirm_password"
      }, formatMessage(_SetupPageMessages.SetupPageMessages.confirmPasswordTitle)), React.createElement(_Input.default, {
        id: "confirm_password",
        type: showConfirmPassword ? 'text' : 'password',
        value: confirmPassword || '',
        autoComplete: "new-password",
        onChange: function onChange(value) {
          return _this2._handleConfirmPasswordChange(value.target.value);
        },
        endAdornment: React.createElement(_InputAdornment.default, {
          position: "end"
        }, React.createElement(_IconButton.default, {
          "aria-label": "Toggle password visibility",
          onClick: this._handleShowConfirmPasswordClick,
          onMouseDown: this._handleShowConfirmPasswordMouseDown
        }, this.state.showConfirmPassword ? React.createElement(_VisibilityOff.default, null) : React.createElement(_Visibility.default, null)))
      })), fetching ? React.createElement(_core.Button, {
        variant: "contained",
        color: "secondary",
        disabled: true
      }, React.createElement(_reactIntl.FormattedMessage, _SetupPageMessages.SetupPageMessages.loadingText)) : React.createElement(_core.Button, {
        type: "submit",
        variant: "contained",
        color: "secondary"
      }, React.createElement(_reactIntl.FormattedMessage, _SetupPageMessages.SetupPageMessages.submitBtn)), error && React.createElement("div", {
        className: classes.errorMessage
      }, errorMessage)));
    }
  }, {
    key: "_handleShowPasswordClick",
    value: function _handleShowPasswordClick() {
      this.setState(function (prev) {
        return {
          showPassword: !prev.showPassword
        };
      });
    }
  }, {
    key: "_handleShowConfirmPasswordClick",
    value: function _handleShowConfirmPasswordClick() {
      this.setState(function (prev) {
        return {
          showConfirmPassword: !prev.showConfirmPassword
        };
      });
    }
  }, {
    key: "_handleShowPasswordMouseDown",
    value: function _handleShowPasswordMouseDown(e) {
      e.preventDefault();
    }
  }, {
    key: "_handleShowConfirmPasswordMouseDown",
    value: function _handleShowConfirmPasswordMouseDown(e) {
      e.preventDefault();
    }
  }, {
    key: "_handleLoginSubmit",
    value: function _handleLoginSubmit(e) {
      var _this3 = this;

      e.preventDefault(); // tslint:disable-next-line:no-console

      console.log('handle submit');
      var _this$state2 = this.state,
          username = _this$state2.username,
          password = _this$state2.password,
          email = _this$state2.email,
          confirmPassword = _this$state2.confirmPassword;
      var _this$props2 = this.props,
          authCtx = _this$props2.authCtx,
          formatMessage = _this$props2.intl.formatMessage;

      if (!username || !password || confirmPassword !== password) {
        this.setState(function () {
          return {
            error: true,
            errorMessage: formatMessage(_SetupPageMessages.SetupPageMessages.incomplete)
          };
        });
        return;
      }

      authCtx.setup(username, password, {
        Email: email
      }).then(function (result) {
        if (!result) {
          _this3.setState(function () {
            return {
              error: true,
              errorMessage: formatMessage(_SetupPageMessages.SetupPageMessages.failed)
            };
          });
        }
      }).catch(function (reason) {
        _this3.setState(function () {
          return {
            error: true,
            errorMessage: reason.Result.Message
          };
        });
      });
    }
  }, {
    key: "_handlePasswordChange",
    value: function _handlePasswordChange(value) {
      this.setState(function () {
        return {
          password: value
        };
      });
    }
  }, {
    key: "_handleConfirmPasswordChange",
    value: function _handleConfirmPasswordChange(value) {
      this.setState(function () {
        return {
          confirmPassword: value
        };
      });
    }
  }, {
    key: "_handleNameChange",
    value: function _handleNameChange(value) {
      this.setState(function () {
        return {
          username: value
        };
      });
    }
  }, {
    key: "_handleEmailChange",
    value: function _handleEmailChange(value) {
      this.setState(function () {
        return {
          email: value
        };
      });
    }
  }]);

  return SetupPage;
}(React.Component);

var _default = (0, _core.withStyles)(function (theme) {
  return {
    root: {},
    loginPage: {
      position: 'relative',
      width: '100%',
      height: '100%',
      backgroundColor: '#f0f0f0'
    },
    form: {
      position: 'absolute',
      width: 250,
      top: '50%',
      left: '50%',
      transform: 'translate(-50%, -50%)',
      boxShadow: '3px 3px 3px rgba(0, 0, 0, 0.15); //1px 1px 5px rgba(0,0,0,.2)',
      background: '#f8f8f8',
      borderRadius: 4,
      padding: '30px 35px',
      textAlign: 'right'
    },
    title: {
      fontSize: '2.4rem',
      paddingBottom: '0.5rem',
      margin: '0 0 0.5rem 0',
      fontWeight: 'bold',
      color: theme.Colors.blue.primary.main,
      borderBottom: '1px solid #969696',
      textAlign: 'center'
    },
    cancel: {
      display: 'inline-block',
      marginRight: 10,
      fontSize: '0.7rem',
      color: theme.Colors.blue.primary.main
    },
    resetBtn: {
      marginTop: 15
    },
    passwordOptions: {
      display: 'flex',
      flexDirection: 'row',
      flexWrap: 'nowrap',
      justifyContent: 'space-between',
      padding: '0.3rem 0 0.7rem',
      alignItems: 'center'
    },
    forgot: {
      flexGrow: 1,
      flexShrink: 1,
      fontSize: '0.8rem',
      color: '#969696',
      textAlign: 'left'
    },
    remember: {
      flexGrow: 1,
      flexShrink: 1,
      fontSize: '0.8rem',
      color: '#969696',
      textAlign: 'right'
    },
    forgotLink: {
      color: theme.Colors.blue.primary.main
    },
    rememberIcon: {
      marginLeft: 5
    },
    submitBtn: {
      textTransform: 'uppercase',
      fontWeight: 'bold'
    },
    errorMessage: {
      display: 'block',
      marginTop: 10,
      color: theme.Colors.red.primary.main,
      fontSize: '.8rem',
      textAlign: 'left'
    }
  };
})((0, _context.withAuth)((0, _reactIntl.injectIntl)(SetupPage)));

exports.default = _default;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SetupPageMessages = void 0;

var _reactIntl = require("react-intl");

var SetupPageMessages = (0, _reactIntl.defineMessages)({
  title: {
    "id": "pages.login.loginpage.title",
    "defaultMessage": "Setup"
  },
  usernamePlaceholder: {
    "id": "pages.login.loginpage.usernamePlaceholder",
    "defaultMessage": "Username placeholder"
  },
  username: {
    "id": "pages.login.loginpage.username",
    "defaultMessage": "UserName"
  },
  passwordTitle: {
    "id": "pages.login.loginpage.passwordTitle",
    "defaultMessage": "Password"
  },
  confirmPasswordTitle: {
    "id": "pages.login.loginpage.confirmPasswordTitle",
    "defaultMessage": "Confirm password"
  },
  email: {
    "id": "pages.login.loginpage.email",
    "defaultMessage": "Email"
  },
  backBtn: {
    "id": "pages.login.loginpage.backBtn",
    "defaultMessage": "Back"
  },
  loadingText: {
    "id": "pages.login.loginpage.loadingText",
    "defaultMessage": "Loading"
  },
  forgot: {
    "id": "pages.login.loginpage.forgot",
    "defaultMessage": "forgot your {password_link}?"
  },
  passwordLink: {
    "id": "pages.login.loginpage.passwordLink",
    "defaultMessage": "password"
  },
  resetBtn: {
    "id": "pages.login.loginpage.resetBtn",
    "defaultMessage": "Reset"
  },
  submitBtn: {
    "id": "pages.login.loginpage.submitBtn",
    "defaultMessage": "Submit"
  },
  failed: {
    "id": "pages.login.loginpage.error.failed",
    "defaultMessage": "Please check your credentials"
  },
  incomplete: {
    "id": "pages.login.loginpage.error.incomplete",
    "defaultMessage": "Please fill all information"
  }
});
exports.SetupPageMessages = SetupPageMessages;
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = register;
exports.unregister = unregister;
// tslint:disable:no-console
// In production, we register a service worker to serve assets from local cache.
// This lets the app load faster on subsequent visits in production, and gives
// it offline capabilities. However, it also means that developers (and users)
// will only see deployed updates on the 'N+1' visit to a page, since previously
// cached resources are updated in the background.
// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.
// This link also includes instructions on opting out of this behavior.
var isLocalhost = Boolean(window.location.hostname === 'localhost' || // [::1] is the IPv6 localhost address.
window.location.hostname === '[::1]' || // 127.0.0.1/8 is considered localhost for IPv4.
window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));

function register() {
  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {
    // The URL constructor is available in all browsers that support SW.
    var publicUrl = new URL(process.env.PUBLIC_URL, window.location.toString());

    if (publicUrl.origin !== window.location.origin) {
      // Our service worker won't work if PUBLIC_URL is on a different origin
      // from what our page is served on. This might happen if a CDN is used to
      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374
      return;
    }

    window.addEventListener('load', function () {
      var swUrl = "".concat(process.env.PUBLIC_URL, "/service-worker.js");

      if (!isLocalhost) {
        // Is not local host. Just register service worker
        registerValidSW(swUrl);
      } else {
        // This is running on localhost. Lets check if a service worker still exists or not.
        checkValidServiceWorker(swUrl);
      }
    });
  }
}

function registerValidSW(swUrl) {
  navigator.serviceWorker.register(swUrl).then(function (registration) {
    registration.onupdatefound = function () {
      var installingWorker = registration.installing;

      if (installingWorker) {
        installingWorker.onstatechange = function () {
          if (installingWorker.state === 'installed') {
            if (navigator.serviceWorker.controller) {
              // At this point, the old content will have been purged and
              // the fresh content will have been added to the cache.
              // It's the perfect time to display a 'New content is
              // available; please refresh.' message in your web app.
              console.log('New content is available; please refresh.');
            } else {
              // At this point, everything has been precached.
              // It's the perfect time to display a
              // 'Content is cached for offline use.' message.
              console.log('Content is cached for offline use.');
            }
          }
        };
      }
    };
  }).catch(function (error) {
    console.error('Error during service worker registration:', error);
  });
}

function checkValidServiceWorker(swUrl) {
  // Check if the service worker can be found. If it can't reload the page.
  fetch(swUrl).then(function (response) {
    // Ensure service worker exists, and that we really are getting a JS file.
    if (response.status === 404 || response.headers.get('content-type').indexOf('javascript') === -1) {
      // No service worker found. Probably a different app. Reload the page.
      navigator.serviceWorker.ready.then(function (registration) {
        registration.unregister().then(function () {
          window.location.reload();
        });
      });
    } else {
      // Service worker found. Proceed as normal.
      registerValidSW(swUrl);
    }
  }).catch(function () {
    console.log('No internet connection found. App is running in offline mode.');
  });
}

function unregister() {
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.ready.then(function (registration) {
      registration.unregister();
    });
  }
}
